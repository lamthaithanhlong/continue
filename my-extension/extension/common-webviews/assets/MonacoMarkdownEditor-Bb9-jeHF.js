import{t as Y,u,O as y,a8 as ee,P as A,C as g,G as d,a9 as te,x as ne,A as oe,Z as L,_ as k,E as f,J as v,aa as se,I as z,n as I,F as ie,T as F,a5 as G,K as ae,a0 as re}from"./TextAugment-CCgoKCVh.js";import"./IconButtonAugment-CsdawHyK.js";import{S as de,M as le}from"./index-BuNY6jLF.js";try{c=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(V=new c.Error().stack)&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[V]="54867445-2708-41f0-9562-01ef9390d725",c._sentryDebugIdIdentifier="sentry-dbid-54867445-2708-41f0-9562-01ef9390d725")}catch{}var c,V,ce=ne('<div class="l-markdown-editor svelte-6764n4"><div class="c-markdown-editor__header svelte-6764n4"><!></div> <!> <div class="c-markdown-editor__content svelte-6764n4"><!> <div class="c-monaco-editor svelte-6764n4"><!></div></div></div> <div class="c-markdown-editor__status svelte-6764n4"><!> <!></div>',1);function ve(_,i){Y(i,!0);let a=u(i,"value",15,""),S=u(i,"selectedText",15,""),C=u(i,"selectionStart",15,0),M=u(i,"selectionEnd",15,0),R=u(i,"monacoOptions",19,()=>({})),t=u(i,"editorInstance",15),r=y(ee(a())),m=!1;const B={readOnly:!1,wordWrap:"on",lineNumbers:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1,automaticLayout:!0,theme:"vs-dark",language:"markdown",fontSize:14,lineHeight:20,padding:{top:16,bottom:16},...R()};let x,w,h,b=y(!1),p=y(void 0);const E=async()=>{t()&&await(async()=>{try{if(t()){const e=t().getValue();d(r,e,!0),a(e)}i.saveFunction(),d(b,!0),clearTimeout(x),x=setTimeout(()=>{d(b,!1)},1500)}catch(e){d(p,e instanceof Error?e.message:String(e),!0)}})()},H=()=>{if(!t()||m)return;const e=t().getValue();e!==g(r)&&(d(r,e,!0),a(e))},J=()=>{if(!t())return;let e,n;e=t().onDidChangeModelContent(H),n=t().addAction({id:"save-markdown-content",label:"Save Markdown Content",keybindings:[2097],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:()=>{E()}}),(()=>{if(typeof window>"u")return;const o=()=>{E()};window.addEventListener("blur",o),h=()=>{window.removeEventListener("blur",o)}})(),w=()=>{e?.dispose(),n?.dispose(),h?.()}};A(()=>{if(a()!==g(r))if(t()){if(!m){m=!0;const e=t().getPosition(),n=t().getSelection(),o=t().getModel();if(o&&o.getValue()!==a()){if(o.setValue(a()),d(r,a(),!0),e&&o.getLineCount()>=e.lineNumber){const s=o.getLineLength(e.lineNumber);e.column<=s+1&&t().setPosition(e)}if(n&&o.getLineCount()>=n.endLineNumber){const s=o.getLineLength(n.endLineNumber);n.endColumn<=s+1&&t().setSelection(n)}}setTimeout(()=>{m=!1},10)}}else d(r,a(),!0)}),A(()=>{if(t()){J();const e=t(),n=e.onDidChangeCursorSelection(()=>{const s=e.getSelection();if(s){const l=e.getModel();l&&(C(l.getOffsetAt(s.getStartPosition())),M(l.getOffsetAt(s.getEndPosition())),C()!==M()?S(l.getValueInRange(s)):S(""))}}),o=w;w=()=>{o?.(),n?.dispose()}}}),te(()=>{w?.(),h?.()});var T=ce(),D=oe(T),O=f(D),K=f(O);L(K,()=>i.header??k);var $=v(O,2);L($,()=>i.children??k);var W=v($,2),N=f(W);L(N,()=>i.title??k);var Z=v(N,2),j=f(Z);se(j,()=>le.Root,(e,n)=>{n(e,{children:(o,s)=>{de(o,{get text(){return g(r)},lang:"markdown",get options(){return B},height:void 0,get editorInstance(){return t()},set editorInstance(l){t(l)}})},$$slots:{default:!0}})});var q=v(D,2),P=f(q),Q=e=>{F(e,{size:1,weight:"light",color:"error",children:(n,o)=>{var s=G();ae(()=>re(s,g(p))),I(n,s)},$$slots:{default:!0}})};z(P,e=>{g(p)&&e(Q)});var U=v(P,2),X=e=>{F(e,{size:1,weight:"light",color:"success",children:(n,o)=>{var s=G("Saved");I(n,s)},$$slots:{default:!0}})};z(U,e=>{g(b)&&e(X)}),I(_,T),ie()}export{ve as M};
//# sourceMappingURL=MonacoMarkdownEditor-Bb9-jeHF.js.map
