import{H as x}from"./TextAugment-CCgoKCVh.js";import{R as u,a as c,F as f}from"./index-Czcl53hR.js";import{C as $,a as b}from"./message-broker-CppRv-qk.js";try{l=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(_=new l.Error().stack)&&(l._sentryDebugIds=l._sentryDebugIds||{},l._sentryDebugIds[_]="60ef2804-941c-41a2-af72-c48dbd1da895",l._sentryDebugIdIdentifier="sentry-dbid-60ef2804-941c-41a2-af72-c48dbd1da895")}catch{}var l,_;function w(t){return t.replace(/\.git$/,"")}function y(t){if(!t)return"";const e=t.match(/github\.com\/([^/]+)\/([^/]+)/);if(e)return e[2].replace(/\.git$/,"");const n=t.split("/").filter(Boolean);return(n.length>0?n[n.length-1]:"").replace(/\.git$/,"")}function I(t){if(!t)return"";const e=t.match(/github\.com\/([^/]+)\/([^/]+)/);if(e)return`${e[1]}/${e[2].replace(/\.git$/,"")}`;const n=t.split("/").filter(Boolean);return n.length>1?`${n[n.length-2]}/${n[n.length-1].replace(/\.git$/,"")}`:n.length>0?n[n.length-1].replace(/\.git$/,""):""}function d(t){return t.workspace_setup?.starting_files?.github_commit_ref?.repository_url||""}function T(t){if(!t||typeof t!="object"||!("workspace_setup"in t))return{name:"Unknown",fullPath:"Unknown"};const e=d(t);return{name:y(e),fullPath:I(e)}}function v(t,e){if(!t||typeof t!="object"||!("workspace_setup"in t))return!1;const n=d(t);return!!n&&n!==e}function D(t){return x(t,e=>n=>{if(!e)return!0;const s=w(e),o=w(d(n));return!!o&&!!s&&o!==s})}function k(t){return function(e){try{if(isNaN(e.getTime()))return"Unknown time";const n=new Date().getTime()-e.getTime(),s=Math.floor(n/1e3),o=Math.floor(s/60),a=Math.floor(o/60),r=Math.floor(a/24);return s<60?`${s}s ago`:o<60?`${o}m ago`:a<24?`${a}h ago`:r<30?`${r}d ago`:e.toLocaleDateString()}catch(n){return console.error("Error formatting date:",n),"Unknown time"}}(new Date(t))}function U(t,e){let n=1e3;const s=new Date(t),o=setInterval(()=>{const a=Math.floor((new Date().getTime()-s.getTime())/1e3/60);a>=1&&(n=6e4),a>=60&&(n=36e5),a>=1440&&(n=864e5),e(k(t))},n);return()=>clearInterval(o)}function S(t,e){const n=setInterval(()=>{const s=t.getTime()-Date.now();if(s<=0)return void clearInterval(n);const o=Math.floor(s/1e3),a=Math.floor(o/60),r=Math.floor(a/60),i=Math.floor(r/24);e(o<60?`${o}s`:a<60?`${a}m ${o%60}s`:r<24?`${r}h`:i<30?`${i}d`:"1mo")},1e3);return()=>clearInterval(n)}function q(t){if(t===void 0)return"neutral";switch(t){case c.agentPending:case c.agentStarting:case c.agentRunning:return"info";case c.agentIdle:return"success";case c.agentFailed:return"error";default:return"neutral"}}function F(t){if(t===void 0)return"neutral";switch(t){case u.workspaceRunning:return"info";case u.workspacePausing:case u.workspacePaused:case u.workspaceResuming:default:return"neutral"}}function L(t,e,n){if(e===u.workspaceResuming)return"Resuming";switch(t){case c.agentStarting:return"Starting";case c.agentRunning:return"Running";case c.agentIdle:return n?"Unread":"Idle";case c.agentPending:return"Pending";case c.agentFailed:return"Failed";default:return"Unknown"}}function O(t){switch(t){case"Unread":return"accent";case"Starting":case"Resuming":return"iris";case"Running":return"success";case"Idle":case"Pending":default:return"neutral";case"Failed":return"error"}}const g=t=>E(t),E=t=>{const e={};for(const a of t){const r=a.old_path||a.new_path;if(e[r])e[r].finalExists=a.new_path!=="",e[r].finalContent=a.new_path!==""?a.new_contents:"",e[r].finalPath=a.new_path||a.old_path,e[r].latestChange=a,a.change_type===f.deleted&&a.old_contents!==""&&(e[r].originalContent=a.old_contents);else{const i=a.old_path!=="";e[r]={originalExists:i,originalContent:i?a.old_contents:"",finalExists:a.new_path!=="",finalContent:a.new_path!==""?a.new_contents:"",finalPath:a.new_path||a.old_path,latestChange:a}}}const n=[];for(const[a,r]of Object.entries(e))if(r.originalExists!==r.finalExists||r.originalExists&&r.finalExists&&r.originalContent!==r.finalContent){const i={id:r.latestChange.id,old_path:r.originalExists?a:"",new_path:r.finalExists?r.finalPath:"",old_contents:r.originalContent,new_contents:r.finalContent,change_type:(s=r.originalExists,o=r.finalExists,!s&&o?f.added:s&&!o?f.deleted:f.modified)};n.push(i)}var s,o;return n},j=t=>{const e=t.flatMap(n=>n.changed_files);return g(e)},B=(t,e)=>{const n=h(t,e);return t[n]?.exchange.request_message??""},h=(t,e)=>e<0||e>=t.length?-1:t[e]?.exchange.request_message?e:t.slice(0,e).findLastIndex(n=>n.exchange.request_message),m=(t,e)=>{const n=t.slice(e+1).findIndex(s=>s.exchange.request_message);return n===-1?t.length:e+n+1},C=(t,e)=>{const n=h(t,e);let s=m(t,e);const o=n===-1?0:n+1;return t.slice(o,s)},N=(t,e)=>{if(e<0||e>=t.length)return[];if(h(t,e)===-1){const s=t.flatMap(o=>o.changed_files);return g(s)}const n=C(t,e).flatMap(s=>s.changed_files);return g(n)},H=(t,e)=>{const n=m(t,e),s=t.slice(e,n),o=t[e].exchange.response_nodes?.find(i=>i.type===$.TOOL_USE);if(!o)return[];const a=o.tool_use?.tool_use_id;if(!a)return[];const r=s.find(i=>i.exchange.request_nodes?.some(p=>p.type===b.TOOL_RESULT&&p.tool_result_node?.tool_use_id===a));return r?r.changed_files:[]};export{O as a,k as b,y as c,I as d,q as e,F as f,L as g,T as h,v as i,D as j,j as k,S as l,H as m,B as n,N as o,C as p,U as s};
//# sourceMappingURL=utils-BOGwHecm.js.map
