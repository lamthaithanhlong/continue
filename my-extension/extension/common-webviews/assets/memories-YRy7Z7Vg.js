import{t as Me,u as ge,aG as V,a6 as r,N as Be,W as ze,w as re,a1 as Re,C as e,a2 as Se,m as g,a3 as Ve,v as Ee,z as ke,A as me,I as le,n as o,F as Te,a4 as Ge,G as d,x as D,Y as Pe,a5 as K,K as De,a0 as Ne,y as W,D as j,J as ie,E as x,a7 as je,T as He,a9 as Je,M as Ke,an as Qe,aE as Ye}from"./TextAugment-CCgoKCVh.js";import"./design-system-init-D_ikSdGN.js";import{M as Le}from"./message-broker-CppRv-qk.js";import{M as Xe}from"./MonacoMarkdownEditor-Bb9-jeHF.js";import{i as T,E as Ue,D as q,g as Ze,o as et,M as Ie,a as tt,s as st,S as at,F as nt}from"./Store-CzuxPCq8.js";import{S as ot}from"./SuccessfulButton-CqblPP5m.js";import{O as rt}from"./OpenFileButton-DcM9qoQQ.js";import{I as J,e as lt,i as it}from"./IconButtonAugment-CsdawHyK.js";import{F as dt}from"./Filespan-DQTy5qup.js";import{T as Oe,a as ve}from"./CardAugment-Bqwu5ahx.js";import{B as Ae}from"./ButtonAugment-dm8Gq3Cq.js";import"./index-BuNY6jLF.js";import"./focusTrapStack-9JCo5vKi.js";import"./Chevron-Cl2ZClCm.js";import"./BaseTextInput-CKEk7GUD.js";import"./index-B4NDmpYR.js";/* empty css                                                */import"./chat-model-context-DwFUhpQk.js";import"./index-Czcl53hR.js";import"./index-Bz1AJAWu.js";import"./remote-agents-client-3ykFyqEs.js";import"./types-DGsjtdxm.js";try{U=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(_e=new U.Error().stack)&&(U._sentryDebugIds=U._sentryDebugIds||{},U._sentryDebugIds[_e]="b3dc5e23-a02c-438c-abd7-324b2e7708f5",U._sentryDebugIdIdentifier="sentry-dbid-b3dc5e23-a02c-438c-abd7-324b2e7708f5")}catch{}var U,_e,ut=D("<!> <!>",1),ct=D('<div class="rules-dropdown-content svelte-16zpwc"><!> <!></div>'),mt=D("<!> <!>",1);function vt(de,Q){Me(Q,!1);const p=()=>r(c,"$rulesFiles",u),N=()=>r(O,"$selectedRule",u),R=()=>r(e(z),"$focusedIndex",u),[u,Y]=Ge(),S=g(),X=g(),Z=g();let G=ge(Q,"onRuleSelected",8),f=ge(Q,"disabled",8,!1);const ee=new Le(V),Fe=T("enableRules"),ue=T("enablePersonalities"),pe=T("enableExternalSourcesInChat"),fe=T("retryChatStreamTimeouts"),he=new Ue(V,ee,{enableRules:r(Fe,"$enableRules",u),enablePersonalities:r(ue,"$enablePersonalities",u),enableExternalSourcesInChat:r(pe,"$enableExternalSourcesInChat",u),retryChatStreamTimeouts:r(fe,"$retryChatStreamTimeouts",u)}),c=re([]),M=re(!0),O=re(void 0);let z=g(void 0),te=g(()=>{});Be(()=>{(async function(){try{M.set(!0);const n=await he.findRules("",100);c.set(n)}catch(n){console.error("Failed to load rules:",n),c.set([])}finally{M.set(!1)}})();const h=n=>{n.data?.type===ze.getRulesListResponse&&(c.set(n.data.data||[]),M.set(!1))};return window.addEventListener("message",h),()=>{window.removeEventListener("message",h)}});let m=g(),L=g(!1);function $e(h){d(L,h)}Re(()=>p(),()=>{d(S,p().length>0)}),Re(()=>(Se(f()),e(S)),()=>{d(X,f()||!e(S))}),Re(()=>e(S),()=>{d(Z,e(S)?"Move highlighted text to a .augment/rules file":"Please add at least 1 file to .augment/rules and reload VSCode")}),Ve(),Ee();var ce=ke(),be=me(ce),ye=h=>{var n=ke(),v=me(n),se=$=>{q.Root($,{onOpenChange:$e,get requestClose(){return e(te)},set requestClose(b){d(te,b)},get focusedIndex(){return e(z)},set focusedIndex(b){je(d(z,b),"$focusedIndex",u)},children:(b,F)=>{var A=mt(),y=me(A);q.Trigger(y,{children:(k,we)=>{{let t=j(()=>(Se(ve),W(()=>[ve.Hover]))),s=j(()=>!e(L)&&void 0);Pe(Oe(k,{get content(){return e(Z)},get triggerOn(){return e(t)},side:"top",get open(){return e(s)},children:(l,w)=>{Ae(l,{color:"neutral",variant:"soft",size:1,get disabled(){return e(X)},children:(a,i)=>{var I=K();De(()=>Ne(I,(N(),W(()=>N()?N().path:"Rules")))),o(a,I)},$$slots:{default:!0,iconLeft:(a,i)=>{J(a,{slot:"iconLeft",name:"arrow-right"})},iconRight:(a,i)=>{J(a,{slot:"iconRight",name:"chevron-down"})}}})},$$slots:{default:!0},$$legacy:!0}),l=>d(m,l),()=>e(m))}},$$slots:{default:!0}});var _=ie(y,2);q.Content(_,{side:"bottom",align:"start",children:(k,we)=>{var t=ct(),s=x(t);lt(s,1,p,it,(a,i,I)=>{{let ne=j(()=>R()===I);q.Item(a,{onSelect:()=>function(E){O.set(E),G()(E),e(te)()}(e(i)),get highlight(){return e(ne)},children:(E,Ce)=>{dt(E,{get filepath(){return e(i),W(()=>e(i).path)}})},$$slots:{default:!0}})}});var l=ie(s,2),w=a=>{var i=ut(),I=me(i);q.Separator(I,{});var ne=ie(I,2);q.Label(ne,{children:(E,Ce)=>{He(E,{size:1,color:"neutral",children:(P,xe)=>{var C=K();De(B=>Ne(C,B),[()=>(p(),R(),W(()=>`Move to ${p()[R()].path}`))]),o(P,C)},$$slots:{default:!0}})},$$slots:{default:!0}}),o(a,i)};le(l,a=>{R(),p(),W(()=>R()!==void 0&&p()[R()])&&a(w)}),o(k,t)},$$slots:{default:!0}}),o(b,A)},$$slots:{default:!0},$$legacy:!0})},ae=$=>{{let b=j(()=>(Se(ve),W(()=>[ve.Hover])));Pe(Oe($,{get content(){return e(Z)},get triggerOn(){return e(b)},side:"top",children:(F,A)=>{Ae(F,{color:"neutral",variant:"soft",size:1,disabled:!0,children:(y,_)=>{var k=K("Rules");o(y,k)},$$slots:{default:!0,iconLeft:(y,_)=>{J(y,{slot:"iconLeft",name:"arrow-right"})},iconRight:(y,_)=>{J(y,{slot:"iconRight",name:"chevron-down"})}}})},$$slots:{default:!0},$$legacy:!0}),F=>d(m,F),()=>e(m))}};le(v,$=>{e(S)?$(se):$(ae,!1)}),o(h,n)};le(be,h=>{r(M,"$loading",u)||h(ye)}),o(de,ce),Te(),Y()}var gt=D('<div class="c-move-text-btn__left_icon svelte-1im2ez7"><!></div>'),pt=D('<div class="l-file-controls svelte-1im2ez7"><div class="l-file-controls-left svelte-1im2ez7"><div class="c-move-text-btn svelte-1im2ez7"><!></div> <div class="c-move-text-btn svelte-1im2ez7"><!></div></div> <div class="l-file-controls-right svelte-1im2ez7"><!></div></div>'),ft=D('<div class="l-memories-editor svelte-1im2ez7"><div class="c-memories-editor__content svelte-1im2ez7"><!></div></div>'),ht=D('<div class="c-memories-container svelte-17pit4j"><!></div>');Ye(function(de,Q){Me(Q,!1);const p=()=>r(S,"$editorContent",R),N=()=>r(X,"$editorPath",R),[R,u]=Ge(),Y=new Le(V),S=re(null),X=re(null),Z={handleMessageFromExtension(G){const f=G.data;if(f&&f.type===ze.loadFile){if(f.data.content!==void 0){const ee=f.data.content.replace(/^\n+/,"");S.set(ee)}f.data.pathName&&X.set(f.data.pathName)}return!0}};Be(()=>{Y.registerConsumer(Z),V.postMessage({type:ze.memoriesLoaded})}),Je(()=>{Y.dispose()}),Ee(),Ke("message",Qe,function(...G){Y.onMessageFromExtension?.apply(this,G)}),at(de,{children:(G,f)=>{nt(G,{fetch:!0,children:(ee,Fe)=>{var ue=ht(),pe=x(ue),fe=c=>{(function(M,O){Me(O,!1);const[z,te]=Ge();let m=ge(O,"text",12),L=ge(O,"path",8);const $e=new Le(V),ce=T("enableRules"),be=T("enablePersonalities"),ye=T("enableExternalSourcesInChat"),h=T("retryChatStreamTimeouts"),n=new Ue(V,$e,{enableRules:r(ce,"$enableRules",z),enablePersonalities:r(be,"$enablePersonalities",z),enableExternalSourcesInChat:r(ye,"$enableExternalSourcesInChat",z),retryChatStreamTimeouts:r(h,"$retryChatStreamTimeouts",z)});let v=g(""),se=g(0),ae=g(0),$=g("neutral");const b=async()=>{L()&&n.saveFile({repoRoot:"",pathName:L(),content:m()})},F=Ze();async function A(t){if(!e(v))return;let s,l,w;const a=e(v).slice(0,20);if(t==="userGuidelines"?(s="Move Content to User Guidelines",l=`Are you sure you want to move the selected content "${a}" to your user guidelines?`,w=Ie.userGuidelines):t==="augmentGuidelines"?(s="Move Content to Workspace Guidelines",l=`Are you sure you want to move the selected content "${a}" to workspace guidelines?`,w=Ie.augmentGuidelines):(s="Move Content to Rule",l=`Are you sure you want to move the selected content "${a}" to rule file "${t.rule.path}"?`,w=Ie.rules),!await n.openConfirmationModal({title:s,message:l,confirmButtonText:"Move",cancelButtonText:"Cancel"}))return;t==="userGuidelines"?n.updateUserGuidelines(e(v)):t==="augmentGuidelines"?n.updateWorkspaceGuidelines(e(v)):(F(st({type:t.rule.type,path:t.rule.path,content:t.rule.content+`

`+e(v),description:t.rule.description,settingsStored:t.rule.settingsStored})),n.showNotification({message:`Moved content "${a}" to rule file "${t.rule.path}"`,type:"info",openFileMessage:{repoRoot:"",pathName:t.rule.path}}));const i=m().substring(0,e(se))+m().substring(e(ae));return m(i),await b(),n.reportAgentSessionEvent({eventName:tt.memoriesMove,conversationId:"",eventData:{memoriesMoveData:{target:w}}}),"success"}async function y(t){await A({rule:t})}Ee();var _=ft(),k=x(_),we=x(k);Xe(we,{saveFunction:b,get selectedText(){return e(v)},set selectedText(s){d(v,s)},get selectionStart(){return e(se)},set selectionStart(s){d(se,s)},get selectionEnd(){return e(ae)},set selectionEnd(s){d(ae,s)},get value(){return m()},set value(s){m(s)},header:s=>{var l=pt(),w=x(l),a=x(w),i=x(a);{const P=C=>{var B=gt(),oe=x(B),We=H=>{J(H,{name:"check"})},qe=H=>{J(H,{name:"arrow-right"})};le(oe,H=>{e($)==="success"?H(We):H(qe,!1)}),o(C,B)};let xe=j(()=>!e(v));ot(i,{tooltip:{neutral:"Move highlighted text to user guidelines",success:"Text moved to user guidelines"},stateVariant:{success:"solid",neutral:"soft"},defaultColor:"neutral",onClick:()=>A("userGuidelines"),get disabled(){return e(xe)},stickyColor:!1,persistOnTooltipClose:!0,replaceIconOnSuccess:!0,size:1,get state(){return e($)},set state(C){d($,C)},iconLeft:P,children:(C,B)=>{var oe=K("User Guidelines");o(C,oe)},$$slots:{iconLeft:!0,default:!0},$$legacy:!0})}var I=ie(a,2),ne=x(I);{let P=j(()=>!e(v));vt(ne,{onRuleSelected:y,get disabled(){return e(P)}})}var E=ie(w,2),Ce=x(E);rt(Ce,{size:1,get path(){return L()},variant:"soft",onOpenLocalFile:async()=>(F(et({repoRoot:"",pathName:L()})),"success"),$$slots:{text:(P,xe)=>{He(P,{slot:"text",size:1,children:(C,B)=>{var oe=K("Augment-Memories.md");o(C,oe)},$$slots:{default:!0}})}}}),o(s,l)},$$slots:{header:!0},$$legacy:!0}),o(M,_),Te(),te()})(c,{get text(){return p()},get path(){return N()}})},he=c=>{var M=K("Loading memories...");o(c,M)};le(pe,c=>{p()!==null&&N()!==null?c(fe):c(he,!1)}),o(ee,ue)},$$slots:{default:!0}})},$$slots:{default:!0}}),Te(),u()},{target:document.getElementById("app")});
//# sourceMappingURL=memories-YRy7Z7Vg.js.map
