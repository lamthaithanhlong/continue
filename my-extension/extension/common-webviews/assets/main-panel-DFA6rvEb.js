const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BuNY6jLF.js","./TextAugment-CCgoKCVh.js","./TextAugment-DrPtHmV8.css","./index-CicAFC3Z.css"])))=>i.map(i=>d[i]);
import{bS as Id,av as zd,H as Ct,aU as Ze,W as Sn,t as ke,u as k,x as v,C as t,Q as p,E as g,J as _,T as Le,a5 as se,K as pe,a0 as ze,n as r,I as b,F as Ae,aa as Qe,ah as Vs,L as Lt,bT as Dd,ai as Ld,S as wr,ab as Fe,z as ee,A as S,a4 as at,Y as pn,a6 as Y,G as T,O as ct,w as Dt,aD as Dn,al as Js,a8 as Cr,P as zt,N as mn,M as Nt,an as ts,aR as Kn,ak as Os,$ as en,Z as Rt,_ as Kt,aY as Hn,ac as Nn,a9 as As,bd as Ko,am as kr,v as wt,B as Et,bU as Pd,ag as qa,a1 as Ne,b3 as zs,a2 as Ee,m as _e,a3 as hn,R as br,y as Re,bc as Xo,at as Od,o as Ws,D as Ge,aF as ia,b4 as Xr,bV as Ba,b5 as Ti,aE as Rl,bl as El,a7 as ds,l as Jo,aG as Rn,aB as Il,bb as Ri,bW as Nd,bX as Ei,bY as Fd,bR as qd,bi as zl,bZ as rs,b_ as Bd,b6 as mo,bP as pr}from"./TextAugment-CCgoKCVh.js";import"./design-system-init-D_ikSdGN.js";import{t as _r,S as Ud,M as Dl}from"./index-BuNY6jLF.js";import{a5 as Qs,aX as Dr,aY as Lr,W as us,aZ as Ll,D as He,a_ as pa,i as _t,a$ as Eo,b0 as Hd,b1 as $s,T as Nr,aH as da,ab as la,b2 as ma,g as Xn,o as ws,b as Pl,b3 as Gd,z as xs,b4 as Wd,b5 as Zn,a as Rs,b6 as jd,b7 as Vd,b8 as Kd,b9 as Xd,ba as Jd,bb as Yd,bc as sr,bd as Ii,be as Fr,at as Qd,bf as Ol,U as Nl,bg as Fl,bh as Zd,bi as eu,Z as tu,bj as nu,O as su,as as ru,bk as zi,bl as Di,N as au,ap as ou,an as iu,ao as lu,P as cu,aq as du,J as uu,bm as hu,bn as gu,K as vu,bo as pu,bp as mu,bq as Yo,x as fu,br as Ua,bs as Ha,bt as Fn,bu as Io,bv as _u,bw as yu,bx as $u,by as bu,bz as wu,bA as fo,bB as Cu,bC as ku,aG as Mr,bD as Au,bE as Su,bF as ql,bG as Bl,bH as xr,bI as Li,bJ as Mu,bK as Pi,bL as xu,bM as Tu,bN as Ru,bO as Eu,bP as Iu,bQ as zu,bR as Du,bS as Lu,bT as Pu,bU as Ou,bV as Nu,bW as Fu,bX as qu,d as Bu,bY as Uu,bZ as Hu,b_ as Gu,b$ as Wu,c0 as ju,u as Vu,c1 as Ku,c2 as Xu,c3 as Ju,E as Ul,c4 as Yu,F as Qu,S as Zu}from"./Store-CzuxPCq8.js";import{I as oe,c as vt,e as ln,d as is,i as ls,B as eh,b as vn,g as th}from"./IconButtonAugment-CsdawHyK.js";import{by as hs,bz as cr,bA as zo,bB as Oi,bC as Ga,bD as Hl,bE as ar,bF as Wn,bG as nh,bH as sh,bI as rh,bJ as ah,bK as oh,bL as ks,bM as Gl,bw as Er,bN as fr,bO as Qo,bP as ao,bQ as Wa,bR as ih,bS as Do,bT as Ar,bU as rr,bV as An,bW as Lo,bX as Wl,bY as jl,bZ as Vl,b_ as Zo,b$ as Kl,c0 as Xl,c1 as Jl,c2 as lh,c3 as oo,c4 as ch,c5 as dh,c6 as ei,c7 as uh,c8 as Po,c9 as hh,ca as gh,cb as vh,cc as ph,cd as Yl,ce as Ql,cf as _o,cg as Ni,ch as mh,ci as fa,cj as fh,ck as ti,cl as _h,aL as yh,cm as $h,cn as bh,co as wh,cp as Ch,cq as kh,cr as Ah,cs as Sh,ct as Mh,cu as xh,cv as Th,cw as Fi,cx as Rh,cy as Eh,cz as Ih,cA as zh,cB as Dh,cC as Jr}from"./AugmentMessage-BHgnxRkx.js";import{l as Ks,i as Gr,c as Lh,C as Tr,A as Is,E as zn,g as qi,d as ja,j as ca,m as ni,h as Zl,n as ec,o as Ph,p as tc,q as nc,r as Bi,S as sc,t as Va,u as Oh,v as Nh,M as io}from"./message-broker-CppRv-qk.js";import{A as bs,d as Pr,g as Ka,f as rc,h as Ds,i as ac,T as Fh,N as qh,n as Bh,m as Uh,a as oc,P as ic,j as Hh,l as Ma,o as Gh,p as Wh,q as Ui,S as js,r as _a,s as Hi,t as yo,c as jh,E as lc,D as qs,u as Vh,v as Kh,w as Xh,x as Jh,y as Yh,C as Qh,z as Zh}from"./chat-model-DaVfYv7o.js";/* empty css                                                */import{c as eg,d as cc,e as tg,f as ng,i as sg,h as rg,j as ag,k as og,l as ig}from"./utils-BOGwHecm.js";import{R as an,S as lg,a as dc}from"./OpenFileButton-DcM9qoQQ.js";import{T as je,a as Be,b as Gn,s as Xs,p as or,g as $o,C as uc,H as cg,o as dg,t as ug}from"./CardAugment-Bqwu5ahx.js";import{S as hg,a as hc,R as gg,B as vg,b as pg,v as mg,c as fg}from"./RepoBadge-BhbKrzzY.js";import"./index-Bz1AJAWu.js";import{B as Mt}from"./ButtonAugment-dm8Gq3Cq.js";import{C as ns,B as Jt,a as _g}from"./CalloutAugment-BUb-HAQ6.js";import{k as qr,h as yg,C as ur,a as Wr,g as $g}from"./CollapseButtonAugment-CdECN-QQ.js";import"./Chevron-Cl2ZClCm.js";import{b as Xa}from"./BaseTextInput-CKEk7GUD.js";import{R as yr,a as In,b as Rr}from"./index-Czcl53hR.js";import{t as Mn,f as Ls,s as si,b as Ja,a as Oo}from"./index-B9uIMiyK.js";import{C as bg}from"./CopyButton-CYoKSKPU.js";import{T as Br}from"./TextCombo-BcswIAtX.js";import{R as Gi}from"./ra-diff-ops-model-CAjBEmft.js";import{F as wg,T as Cg,e as kg,S as xa,h as Ag,a as gc,s as Sg,i as Wi,j as ji,k as Mg,c as vc,m as ri,b as pc,d as as,u as xg,l as Tg,f as Rg}from"./extension-client-context-DEcT1UDn.js";import{o as Eg,I as Ig}from"./IconFilePath-FUDbu4ts.js";import{a as ua,C as zg,b as Dg,g as Lg,c as bo,d as Vi,e as Pg,K as ai,P as oi,R as dr,A as ii,f as wo}from"./Keybindings-CIVfIIto.js";import{a as mc}from"./await-Bft3-TRy.js";import{M as fc,t as Og}from"./ModalAugment-IuAGqBL4.js";import{i as Ng,c as Fg}from"./file-type-utils-CBkYZ4gj.js";import{g as _c,T as $r,s as qg}from"./chat-model-context-DwFUhpQk.js";import{m as Bg,D as Ki,c as Ug,d as Hg,M as Ta,C as Gg,e as Wg}from"./Markdown-F1hzawoT.js";import{o as yc}from"./keypress-fD7XHdyk.js";import{F as Ra}from"./Filespan-DQTy5qup.js";import{g as li,a as No}from"./focusTrapStack-9JCo5vKi.js";import{_ as jg}from"./preload-helper-iZIsTGZK.js";import{e as Vg}from"./LanguageIcon-BRHvdy0u.js";import{d as Xi,s as Kg}from"./index-B4NDmpYR.js";import{T as Xg}from"./TextAreaAugment-Pjr5jpcU.js";import"./SuccessfulButton-CqblPP5m.js";import"./types-DGsjtdxm.js";import"./partner-mcp-utils-8KSbNsEE.js";import"./augment-logo-CnRinIIJ.js";import"./toggleHighContrast-BIKVVoPO.js";import"./remote-agents-client-3ykFyqEs.js";import"./next-edit-types-B8NR3rVy.js";try{Sr=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(xi=new Sr.Error().stack)&&(Sr._sentryDebugIds=Sr._sentryDebugIds||{},Sr._sentryDebugIds[xi]="a470e4e0-2ab9-454e-863b-477240732059",Sr._sentryDebugIdIdentifier="sentry-dbid-a470e4e0-2ab9-454e-863b-477240732059")}catch{}var Sr,xi;const Ji=!0,Jg=Qs(i=>i.mainPanel.visibleApp),Ea={chat:{icon:"message-square",type:"chat",primaryText:"Chat",bannerText:"Running locally"},localAgent:{icon:"wand-sparkles",type:"localAgent",primaryText:"Agent",bannerText:"Running locally"},remoteAgent:{icon:"cloud-upload",type:"remoteAgent",primaryText:"Remote Agent",bannerText:"Running in the cloud"}};function Ya(i){const{isConversationAgentic:e,agentExecutionMode:n,isBackgroundAgent:s}=i;return s?Ea.remoteAgent:e?(n===bs.manual||bs.auto,Ea.localAgent):Ea.chat}const lo=(i,e)=>({chatMode:i,agentExecution:e}),Yg=lo(Ks.chat),Yi=lo(Ks.agent,bs.manual),Qi=lo(Ks.agent,bs.auto),Qg=lo(Ks.remoteAgent);class Ys{constructor(e,n,s,a){this._chatModel=e,this._agentConversationModel=n,this._remoteAgentsModel=s,this._config=a,this._chatModeType=Ct([this._agentConversationModel.isCurrConversationAgentic,this._chatModel.agentExecutionMode,this._remoteAgentsModel],([o,l,c])=>Ya({isConversationAgentic:o,agentExecutionMode:l,isBackgroundAgent:c?.isActive||!1}).type),this._remoteAgentsModel.subscribe(o=>{o.isRemoteAgentSshWindow===this._prevRemoteAgentWindowOpts.isRemoteAgentSshWindow&&o.remoteAgentSshWindowId===this._prevRemoteAgentWindowOpts.remoteAgentId||(this._prevRemoteAgentWindowOpts={remoteAgentId:o.remoteAgentSshWindowId,isRemoteAgentSshWindow:o.isRemoteAgentSshWindow},this.handleisRemoteAgentSshWindow(o))})}static key="chatModeModel";_prevRemoteAgentWindowOpts={remoteAgentId:void 0,isRemoteAgentSshWindow:!1};_chatModeType;handleisRemoteAgentSshWindow(e){e.isRemoteAgentSshWindow&&this.setToRemoteAgent(e.remoteAgentSshWindowId)}getCurrentModeSelectorMode(){const e=Ze(this._agentConversationModel.isCurrConversationAgentic);return this._remoteAgentsModel.isActive?Dr.remoteAgent:e?Dr.agent:Dr.chat}async reportModeSelectorEvent(e,n){try{const s=n||this.getCurrentModeSelectorMode();this._config.enableBackgroundAgents&&await this._remoteAgentsModel.reportChatModeEvent(e,s)}catch(s){console.error("Failed to report chat mode event:",s)}}reportModeSelectorOpen(){this.reportModeSelectorEvent(Lr.open)}reportModeSelectorClose(){this.reportModeSelectorEvent(Lr.close)}reportModeSelectorInit(){this.reportModeSelectorEvent(Lr.init)}async toggleChatAgentAutoMode(e){if(!this.isInAgentState())return;const n=Ze(this._chatModel.agentExecutionMode)===bs.auto?bs.manual:bs.auto;this._chatModel.agentExecutionMode.set(n),this._chatModel.eventTracker?.trackSimpleEvent(us.AGENT_EXECUTION_MODE_TOGGLED,{source:e,newMode:n})}isInAgentState(){const e=this.getCurrentModeState();return e===Qi||e===Yi}getCurrentModeState(){const e=Ze(this._agentConversationModel.isCurrConversationAgentic),n=Ze(this._chatModel.agentExecutionMode);return this._remoteAgentsModel.isActive?Qg:e&&n===bs.auto?Qi:e&&n===bs.manual?Yi:Yg}get isRemoteAgentSshWindow(){return this._remoteAgentsModel.isRemoteAgentSshWindow}get remoteAgentSshWindowId(){return this._remoteAgentsModel.remoteAgentSshWindowId}get isRemoteAgentActive(){return this._remoteAgentsModel.isActive}async setToLocal(e){this.isRemoteAgentSshWindow||(this._agentConversationModel?(this._remoteAgentsModel.setIsActive(!1),e&&this._chatModel.agentExecutionMode.set(e),this._chatModel.currentConversationModel.resetTotalCharactersCache()):console.error("AgentConversationModel is not initialized"))}async setToRemoteAgent(e){if(this._agentConversationModel){if(this.isRemoteAgentSshWindow&&(e&&this.remoteAgentSshWindowId&&e!==this.remoteAgentSshWindowId&&(e=this.remoteAgentSshWindowId),!e&&this.remoteAgentSshWindowId&&(e=this.remoteAgentSshWindowId)),this._remoteAgentsModel.setIsActive(!0),e)this._remoteAgentsModel.setCurrentAgent(e);else if(e===null)this._remoteAgentsModel.clearCurrentAgent();else if(!this._remoteAgentsModel?.currentAgent){const n=this._remoteAgentsModel.agentOverviews.length>0?this._remoteAgentsModel.agentOverviews[0]:void 0;n&&this._remoteAgentsModel.setCurrentAgent(n.remote_agent_id)}this._chatModel.currentConversationModel.resetTotalCharactersCache()}else console.error("AgentConversationModel is not initialized")}_setModelIdOnNewConversation(e){this._config.enableModelRegistry&&e!==void 0&&this._chatModel.currentConversationModel.setSelectedModelId(e)}async createNewThread(e,n){const s=this._chatModel.currentConversationModel.selectedModelId;this._chatModel.dispatchReduxAction(Ll()),e==="chat"?(await this._chatModel.setCurrentConversation(void 0,!0,{noopIfSameConversation:!0}),await this.setToLocal(n),this._chatModel.currentConversationModel.extraData={...this._chatModel.currentConversationModel.extraData,isAgentConversation:!1,baselineTimestamp:0}):e==="localAgent"?(await this._chatModel.setCurrentConversation(void 0,!0,{noopIfSameConversation:!0}),await this.setToLocal(n),this._chatModel.currentConversationModel.extraData={...this._chatModel.currentConversationModel.extraData,isAgentConversation:!0,baselineTimestamp:0},this._setModelIdOnNewConversation(s)):e==="remoteAgent"&&(this._remoteAgentsModel.setIsActive(!0),this.setToRemoteAgent(null),this._setModelIdOnNewConversation(s))}get chatModeType(){return this._chatModeType}get getAgentExecutionMode(){return this._chatModel.agentExecutionMode}async createThreadOfCurrentType(){const e=Ze(this._chatModel.agentExecutionMode),n=Ze(this.chatModeType);if(n==="remoteAgent")await this.createNewThread("remoteAgent");else if(n==="localAgent"){const s=e;await this.createNewThread("localAgent",s)}else await this.createNewThread("chat")}findLatestThread(e){const n=this._chatModel.orderedConversations();switch(e){case"chat":return n.find(s=>!s.extraData?.isAgentConversation&&s.id!==Pr)?.id;case"localAgent":return n.find(s=>s.extraData?.isAgentConversation===!0&&!s.extraData?.isRemoteAgentConversation&&s.id!==Pr)?.id;case"remoteAgent":{if(this._remoteAgentsModel.currentAgent)return this._remoteAgentsModel.currentAgent.remote_agent_id;const s=this._remoteAgentsModel.agentOverviews||[];return s.length>0?s[0].remote_agent_id:void 0}default:return}}handleSetToChat(){this.handleSetToThreadType("chat")}handleSetToAgent(e){this.handleSetToThreadType("localAgent",e)}handleSetToBackgroundAgent(){this.handleSetToThreadType("remoteAgent")}async handleSetToThreadType(e,n){if(e==="remoteAgent"&&!this._remoteAgentsModel)return void console.error("No remote agents model found");const s=this.findLatestThread(e);if(s)await this.switchToThread(e,s,n);else switch(e){case"chat":await this.createNewThread("chat");break;case"localAgent":await this.createNewThread("localAgent",n);break;case"remoteAgent":await this.createNewThread("remoteAgent")}}switchToThread(e,n,s){return(!this.isRemoteAgentSshWindow||!(e!=="remoteAgent"||this.remoteAgentSshWindowId&&n!==this.remoteAgentSshWindowId))&&(e==="remoteAgent"?n===Pr?this.setToRemoteAgent(null):this.setToRemoteAgent(n):this._chatModel.setCurrentConversation(n,!0,{noopIfSameConversation:!0}).then(async()=>{await this.setToLocal(s)}),!0)}handleMessageFromExtension(e){const n=e.data;return n.type===Sn.remoteAgentSelectAgentId&&(this.setToRemoteAgent(n.data.agentId),!0)}}var es=(i=>(i.Pinned="Pinned",i.Active="Ready for Review",i.Today="Today",i.New="New",i.ThisWeek="Last 7 days",i.ThisMonth="Last 30 days",i.Older="Older",i))(es||{});const Zg=300,ev=[es.Active,es.Pinned,es.New,es.Today,es.ThisWeek,es.ThisMonth,es.Older];function tv(i){return i.sort((e,n)=>n.sortTimestamp.getTime()-e.sortTimestamp.getTime())}function Zi(i,e=Zg){const n=new Map,s=new Date(new Date().setHours(0,0,0,0)),a=[{age:es.Today,date:s},{age:es.ThisWeek,date:new Date(s.getTime()-6048e5)},{age:es.ThisMonth,date:new Date(s.getTime()-2592e6)}];for(const d of i){const u=d.sortTimestamp;let h=a.find(y=>u>=y.date)?.age||es.Older;d.type==="remoteAgent"&&d.has_updates&&(h=es.Active),d.isPinned&&(h=es.Pinned),d.isNew&&(h=es.New),n.set(h,[...n.get(h)||[],d])}const o=ev.map(d=>({groupTitle:d,threads:tv(n.get(d)||[])})).filter(d=>d.threads.length>0);let l=0;const c=[];for(const d of o){const u=[];for(const h of d.threads){if(l>=e)break;u.push(h),l++}c.push({groupTitle:d.groupTitle,threads:u})}return c}function Fo(i){const e=i.match(/github\.com\/([^/]+)\/([^/]+?)(?:\.git|\/|$)/);if(e)return{owner:e[1],name:e[2]}}function $c(i){const e=i.match(/^[^/]+\/HEAD\s*->\s*(.+)$/);if(e)return $c(e[1]);const n=function(s){const a=s.match(/^refs\/remotes\/([^/]+)\/(.+)$/);if(a)return{remote:a[1],branch:a[2]};const o=s.match(/^([^/]+)\/(.+)$/);if(o){const[,l,c]=o;if(["origin","upstream","fork","github","gitlab","bitbucket"].includes(l)||l.includes("."))return{remote:l,branch:c}}return null}(i);return n?n.branch:i}function nv(i,e,n){if(i.type==="remoteAgent"){const s=e===i.id?n:void 0;if(s)return s.exchanges.slice(0,20).map(o=>o.exchange.request_message||"").join(" ");const a=i.agent;return a?[a.session_summary||"",...a.turn_summaries||[]].join(" "):""}return i.conversation&&i.conversation.chatHistory?i.conversation.chatHistory.slice(0,20).filter(s=>Gr(s)).map(s=>s.request_message||"").join(" "):""}function sv(i){if(!i.agent||!i.agent.workspace_setup?.starting_files?.github_commit_ref)return"";const e=i.agent.workspace_setup.starting_files.github_commit_ref.repository_url;return[e,eg(e),cc(e)].filter(Boolean).join(" ")}var rv=v('<div class="c-mode-display__bottom svelte-dxxia1"><!></div>'),av=v('<div class="c-mode-display svelte-dxxia1"><div class="c-mode-display__top svelte-dxxia1"><!> <!> <!></div> <!></div>'),ov=v('<div class="c-mode-display-item svelte-3vmnfj"><!></div>'),iv=v("<div><!></div>");function Or(i,e){let n=k(e,"description",3,""),s=k(e,"isConversationAgentic",3,!1),a=k(e,"agentExecutionMode",19,()=>{}),o=k(e,"selected",3,!1),l=k(e,"isBackgroundAgent",3,!1),c=wr(e,["$$slots","$$events","$$legacy","onSelect","description","isConversationAgentic","agentExecutionMode","selected","isBackgroundAgent"]),d=p(()=>Dd(e.class,"")),u=p(()=>Ld(c,["class"]));var h=iv();let y;var m=g(h);Qe(m,()=>He.Item,(f,$)=>{$(f,Vs({get onSelect(){return e.onSelect}},()=>t(u),{children:(R,C)=>{var x=ov();(function(G,L){ke(L,!0);let A=k(L,"isConversationAgentic",3,!1),E=k(L,"agentExecutionMode",19,()=>{}),F=k(L,"isBackgroundAgent",3,!1),z=k(L,"description",3,""),D=k(L,"doShowSecondaryText",3,!0),M=p(()=>Ya({isConversationAgentic:A(),agentExecutionMode:E(),isBackgroundAgent:F()}));var w=av(),W=g(w),P=g(W);oe(P,{get name(){return t(M).icon},size:1});var K=_(P,2);Le(K,{size:1,children:(U,I)=>{var B=se();pe(()=>ze(B,t(M).primaryText)),r(U,B)},$$slots:{default:!0}});var X=_(K,2),q=U=>{Le(U,{size:1,class:"c-mode-secondary-label",children:(I,B)=>{var Q=se();pe(()=>ze(Q,t(M).secondaryText)),r(I,Q)},$$slots:{default:!0}})};b(X,U=>{t(M).secondaryText&&U(q)});var V=_(W,2),N=U=>{var I=rv(),B=g(I);Le(B,{size:0,class:"c-mode-secondary-label",color:"secondary",children:(Q,Z)=>{var ae=se();pe(()=>ze(ae,z())),r(Q,ae)},$$slots:{default:!0}}),r(U,I)};b(V,U=>{z()&&D()&&U(N)}),r(G,w),Ae()})(g(x),{get isConversationAgentic(){return s()},get agentExecutionMode(){return a()},get isBackgroundAgent(){return l()},get description(){return n()}}),r(R,x)},$$slots:{default:!0}}))}),pe(f=>y=Lt(h,1,`c-mode-display-item-container ${t(d)??""}`,"svelte-3vmnfj",y,f),[()=>({"c-mode-display-item--selected":o()})]),r(i,h)}function qo(i){switch(i){case"remoteAgent":return pa.remoteAgent;case"localAgent":return pa.agent;case"chat":return pa.chat;default:return pa.unknown}}const el="new-thread-button";var lv=v('<div class="c-new-thread-dropdown__button-container"><!></div>'),cv=v('<div slot="content" class="c-new-thread-dropdown__tooltip svelte-7ts7rl">New Thread <!></div>'),dv=v("<!> <!>",1),uv=v('<div class="c-new-thread-dropdown__content"><!> <!> <!></div>'),hv=v("<!> <!>",1);function gv(i,e){ke(e,!0);const[n,s]=at();let a=k(e,"isDropdownOpen",15,!1),o=k(e,"showLabel",3,!0),l=k(e,"onNewThreadCreated",3,()=>{});const c=Fe(an.key),d=Fe(Ys.key),u=Fe("chatModel"),h=_t("enableBackgroundAgents"),y=_t("enableAgentMode");async function m(x){await c.reportRemoteAgentNewThreadButtonEvent(Eo.click,qo(x)),d.createNewThread(x),u.eventTracker?.trackEvent(us.THREAD_CREATION_ATTEMPTED,{source:"button"}),f?.requestClose(),l()(x)}let f;function $(x){a(x)}var R=ee(),C=S(R);Qe(C,()=>He.Root,(x,G)=>{pn(G(x,{onOpenChange:$,nested:!1,children:(L,A)=>{var E=hv(),F=S(E);Qe(F,()=>He.Trigger,(D,M)=>{M(D,{$$events:{click:w=>{w.stopPropagation()}},children:(w,W)=>{{let P=p(()=>!a()&&void 0);je(w,{side:"top",nested:!1,get open(){return t(P)},children:(K,X)=>{var q=lv(),V=g(q),N=I=>{Mt(I,{size:.5,variant:"ghost",color:"neutral","data-testid":el,children:(B,Q)=>{Le(B,{size:1,truncate:!0,children:(Z,ae)=>{var j=se("New Thread");r(Z,j)},$$slots:{default:!0}})},$$slots:{default:!0,iconLeft:(B,Q)=>{oe(B,{name:"plus",slot:"iconLeft"})}}})},U=I=>{vt(I,{size:.5,variant:"ghost-block",color:"neutral","data-testid":el,children:(B,Q)=>{oe(B,{name:"plus"})},$$slots:{default:!0}})};b(V,I=>{o()?I(N):I(U,!1)}),r(K,q)},$$slots:{default:!0,content:(K,X)=>{var q=cv(),V=_(g(q));hs(V,{commandName:"newConversation",keysOnly:!0}),r(K,q)}}})}},$$slots:{default:!0}})});var z=_(F,2);Qe(z,()=>He.Content,(D,M)=>{M(D,{size:1,side:"bottom",align:"start",children:(w,W)=>{var P=uv(),K=g(P),X=U=>{Or(U,{onSelect:()=>m("localAgent"),isConversationAgentic:!0,description:"Complete coding tasks autonomously."})};b(K,U=>{Y(y,"$enableAgentMode",n)&&U(X)});var q=_(K,2);Or(q,{onSelect:()=>m("chat"),isConversationAgentic:!1,description:"Ask questions, collaborate on projects."});var V=_(q,2),N=U=>{var I=dv(),B=S(I);Qe(B,()=>He.Separator,(Q,Z)=>{Z(Q,{})}),Or(_(B,2),{onSelect:()=>m("remoteAgent"),isBackgroundAgent:!0,description:"Run agents remotely."}),r(U,I)};b(V,U=>{Y(h,"$enableRemoteAgents",n)&&U(N)}),r(w,P)},$$slots:{default:!0}})}),r(L,E)},$$slots:{default:!0}}),L=>f=L,()=>f)}),r(i,R),Ae(),s()}var vv=v('<div class="c-thread-bulk-delete-prompt__content svelte-9nu469">Large number of threads can slow down the extension.<br/> Consider deleting some threads. <div class="c-thread-bulk-delete-prompt__action svelte-9nu469"><!> <!></div></div>'),pv=v('<div class="c-thread-bulk-delete-prompt svelte-9nu469"><!></div>');const mv=6048e5;function bc(i,e){if(!i?.expires_at)return!1;const n=new Date(i.expires_at).getTime(),s=Date.now(),a=n-s;return e&&s<new Date(i.updated_at).getTime()+24*e*60*60*1e3?!1:a<mv}var fv=v('<div class="remote-agent-icon svelte-v2ow54"><!></div>');function _v(i,e){ke(e,!0);const[n,s]=at(),a=Hd();let o=p(()=>bc(e.remoteAgent.agent,Y(a,"$remoteAgentsResumeHintAvailableTtlDays",n))),l=p(()=>e.remoteAgent.agent?.expires_at?zo(new Date(e.remoteAgent.agent.expires_at),new Date):0),c=p(()=>t(l)<0?"This remote agent will be deleted soon due to inactivity.":`${cr(t(l),"day")} remaining`);var d=fv(),u=g(d),h=m=>{je(m,{get content(){return t(c)},class:"remote-agent-icon__warning",children:(f,$)=>{oe(f,{name:"circle-alert",size:2})},$$slots:{default:!0}})},y=m=>{oe(m,{name:"cloud-upload",size:2})};b(u,m=>{t(o)?m(h):m(y,!1)}),r(i,d),Ae(),s()}async function yv(i,e){try{const n=await async function(o,l){const c={id:o.id,name:o.name,createdAtIso:o.createdAtIso,lastInteractedAtIso:o.lastInteractedAtIso,chatHistory:o.chatHistory,feedbackStates:o.feedbackStates,toolUseStates:o.toolUseStates,draftExchange:o.draftExchange,draftActiveContextIds:o.draftActiveContextIds,requestIds:o.requestIds,isPinned:o.isPinned,lastUrl:o.lastUrl,isShareable:o.isShareable,extraData:o.extraData,personaType:o.personaType,rootTaskUuid:o.rootTaskUuid},d={version:"1.0.0",exportedAt:new Date().toISOString(),conversation:c};d.metadata={exportedBy:"Augment Debug Utils",notes:l.notes};const u=l?.prettyPrint?2:void 0;return JSON.stringify(d,null,u)}(i,{includeMetadata:e?.includeMetadata??!0,notes:e?.notes,prettyPrint:e?.prettyPrint??!0}),s=(e?.filename||i.name||"conversation").replace(/[/:*?"<>|\s]/g,"_"),a=`${s}_${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}.json`;if(e?.extensionClient)e.extensionClient.createFile(n,a);else{const o=new Blob([n],{type:"application/json"}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download=a,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l)}}catch(n){throw console.error("Error downloading conversation as JSON:",n),n}}async function tl(i,e,n){const{conversation:s}=i,a={...s,id:n?.generateNewId!==!1?crypto.randomUUID():s.id,name:n?.namePrefix?`${n.namePrefix}${s.name||"Imported Conversation"}`:s.name,lastInteractedAtIso:new Date().toISOString()};n?.markAsImported&&(a.extraData={...a.extraData,isImported:!0,importedAt:new Date().toISOString(),originalExportVersion:i.version});for(const o of a.chatHistory)if(typeof o.request_id=="string")try{e.markExchangeDirty(o.request_id)}catch(l){console.warn("Failed to mark exchange dirty during import",l)}try{return e.saveConversation(a),e.saveImmediate(),a.id}catch(o){throw console.error("Error creating imported conversation:",o),new Error(`Failed to import conversation: ${o}`)}}async function $v(i,e){try{const n=document.createElement("input");n.type="file",n.accept=".json,application/json",n.style.display="none";const s=new Promise(d=>{n.onchange=()=>{d(n.files?n.files[0]:null)},n.oncancel=()=>{d(null)}});document.body.appendChild(n),n.click();const a=await s;if(document.body.removeChild(n),!a)return null;const o=await a.text(),l=JSON.parse(o);if(!function(d){if(!d||typeof d!="object")return!1;const u=d;if(typeof u.version!="string"||typeof u.exportedAt!="string"||!u.conversation||typeof u.conversation!="object")return!1;const h=u.conversation;return typeof h.id=="string"&&typeof h.createdAtIso=="string"&&typeof h.lastInteractedAtIso=="string"&&!!Array.isArray(h.chatHistory)&&!(!h.feedbackStates||typeof h.feedbackStates!="object")&&!!Array.isArray(h.requestIds)}(l))throw new Error("Invalid conversation export file format");const c=e?.repetitions??1;if(c===1)return await tl(l,i,{generateNewId:e?.generateNewId??!0,namePrefix:e?.namePrefix??"[Imported] ",markAsImported:e?.markAsImported??!0});{let d=null;for(let u=1;u<=c;u++){const h=e?.namePrefix?`${e.namePrefix}${u} - `:`[Imported ${u}] `,y=await tl(l,i,{generateNewId:e?.generateNewId??!0,namePrefix:h,markAsImported:e?.markAsImported??!0});u===1&&(d=y)}return d}}catch(n){throw console.error("Error importing conversation from file:",n),n}}var bv=v("<!> <!>",1),wv=v("<!> <!>",1),Cv=v("<!> <!> <!> <!>",1),kv=v("<!> <!> <!> <!>",1),Av=v('<div class="c-thread-menu svelte-p0wrmr"><!> <!> <!> <!> <!> <!></div>'),Sv=v("<!> <!>",1);function Mv(i,e){ke(e,!0);const n=()=>Y(R,"$agentIdCopyTextMap",s),[s,a]=at();let o=Fe("chatModel");const l=Fe(an.key);let c=k(e,"type",3,"chat"),d=k(e,"afterDelete",19,()=>{}),u=k(e,"onTogglePinned",19,()=>{}),h=k(e,"onRename",19,()=>{});const y=_t("enableShareService");let m=ct(void 0),f=ct(void 0),$=ct("");const R=Dt(new Map);function C(){u()?u()():c()==="remoteAgent"?l?.toggleAgentPinned(e.thread.id,e.thread.isPinned||!1):o&&o.toggleConversationPinned(e.thread.id)}const x=_t("enableDebugFeatures"),G=_t("enableConversationDebugUtils");async function L(){if(c()==="remoteAgent"){if(!await l?.deleteAgent(e.thread.id))return}else await o.deleteConversation(e.thread.id);d()?.()}function A(){h()?.(e.thread.id,e.thread.title),t(m)?.()}function E(){navigator.clipboard.writeText(e.thread.id),R.update(M=>(M.set(e.thread.id,"Copied!"),M)),setTimeout(()=>{R.update(M=>(M.delete(e.thread.id),M))},1e3)}async function F(){if(!e.thread.conversation?.id||t(f)!==void 0)return;const M=o?.conversations[e.thread.conversation.id];T(f,M?.lastUrl?"copied":"retrieving",!0);try{if(o){const w=await o.getConversationUrl(e.thread.conversation.id);navigator.clipboard.writeText(w),T(f,"copied")}}catch(w){console.error("Failed to get conversation URL: ",w),T($,w instanceof Error?w.message:"Unknown error",!0),T(f,"failure")}finally{setTimeout(()=>{T(f,void 0)},1200)}}var z=ee(),D=S(z);Qe(D,()=>He.Root,(M,w)=>{w(M,{nested:!1,get requestClose(){return t(m)},set requestClose(W){T(m,W,!0)},children:(W,P)=>{var K=Sv(),X=S(K);Qe(X,()=>He.Trigger,(V,N)=>{N(V,{children:(U,I)=>{vt(U,{variant:"ghost-block",color:"neutral",size:.5,class:"c-agent-header__options-btn",$$events:{keydown:B=>{B.key!=="Enter"&&B.key!==" "||B.stopPropagation()}},children:(B,Q)=>{oe(B,{name:"ellipsis",size:1})},$$slots:{default:!0}})},$$slots:{default:!0}})});var q=_(X,2);Qe(q,()=>He.Content,(V,N)=>{N(V,{size:1,side:"bottom",align:"end",children:(U,I)=>{var B=Av(),Q=g(B),Z=he=>{var $e=bv(),me=S($e),fe=we=>{var Se=ee(),ie=S(Se);Qe(ie,()=>He.Item,(Ce,le)=>{le(Ce,{onSelect:A,children:(Me,ue)=>{var be=se("Rename");r(Me,be)},$$slots:{default:!0,iconLeft:(Me,ue)=>{oe(Me,{name:"square-pen",size:1,slot:"iconLeft"})}}})}),r(we,Se)};b(me,we=>{h()&&we(fe)});var ge=_(me,2),ce=we=>{var Se=ee(),ie=S(Se);Qe(ie,()=>He.Item,(Ce,le)=>{le(Ce,{class:"c-thread-menu__share-link",onSelect:F,children:(Me,ue)=>{var be=ee(),ye=S(be),de=Oe=>{var De=se();pe(()=>ze(De,t($))),r(Oe,De)},xe=Oe=>{var De=ee(),Ue=S(De),Ie=qe=>{var Te=se("Creating link");r(qe,Te)},Ke=qe=>{var Te=ee(),Ye=S(Te),it=Ve=>{var rt=se("Link copied");r(Ve,rt)},lt=Ve=>{var rt=ee(),ve=S(rt),Pe=Xe=>{var st=se("Unable to create link");r(Xe,st)},Je=Xe=>{var st=se("Share link to session");r(Xe,st)};b(ve,Xe=>{t(f)==="failure"?Xe(Pe):Xe(Je,!1)},!0),r(Ve,rt)};b(Ye,Ve=>{t(f)==="copied"?Ve(it):Ve(lt,!1)},!0),r(qe,Te)};b(Ue,qe=>{t(f)==="retrieving"?qe(Ie):qe(Ke,!1)},!0),r(Oe,De)};b(ye,Oe=>{t($)?Oe(de):Oe(xe,!1)}),r(Me,be)},$$slots:{default:!0,iconLeft:(Me,ue)=>{var be=ee(),ye=S(be),de=Oe=>{Dn(Oe,{size:1})},xe=Oe=>{var De=ee(),Ue=S(De),Ie=qe=>{oe(qe,{name:"check",size:1})},Ke=qe=>{var Te=ee(),Ye=S(Te),it=Ve=>{oe(Ve,{name:"x",size:1})},lt=Ve=>{oe(Ve,{name:"share-2",size:1})};b(Ye,Ve=>{t(f)==="failure"?Ve(it):Ve(lt,!1)},!0),r(qe,Te)};b(Ue,qe=>{t(f)==="copied"?qe(Ie):qe(Ke,!1)},!0),r(Oe,De)};b(ye,Oe=>{t(f)==="retrieving"?Oe(de):Oe(xe,!1)}),r(Me,be)}}})}),r(we,Se)};b(ge,we=>{Y(y,"$enableShareService",s)&&e.thread.conversation?.isShareable&&we(ce)}),r(he,$e)};b(Q,he=>{c()!=="remoteAgent"&&he(Z)});var ae=_(Q,2);Qe(ae,()=>He.Item,(he,$e)=>{$e(he,{onSelect:C,children:(me,fe)=>{var ge=se();pe(()=>ze(ge,e.thread.isPinned?"Unpin":"Pin")),r(me,ge)},$$slots:{default:!0,iconLeft:(me,fe)=>{oe(me,{name:"pin",size:1,slot:"iconLeft"})}}})});var j=_(ae,2),H=he=>{var $e=wv(),me=S($e);Qe(me,()=>He.Item,(ge,ce)=>{ce(ge,{onSelect:E,children:(we,Se)=>{var ie=ee(),Ce=S(ie),le=ue=>{var be=se();pe(ye=>ze(be,ye),[()=>n().get(e.thread.id)]),r(ue,be)},Me=ue=>{var be=se("Copy ID");r(ue,be)};b(Ce,ue=>{n().get(e.thread.id)?ue(le):ue(Me,!1)}),r(we,ie)},$$slots:{default:!0,iconLeft:(we,Se)=>{oe(we,{name:"copy",size:1,slot:"iconLeft"})}}})});var fe=_(me,2);Qe(fe,()=>He.Item,(ge,ce)=>{ce(ge,{onSelect:A,children:(we,Se)=>{var ie=se("Rename");r(we,ie)},$$slots:{default:!0,iconLeft:(we,Se)=>{oe(we,{name:"square-pen",size:1,slot:"iconLeft"})}}})}),r(he,$e)};b(j,he=>{c()==="remoteAgent"&&he(H)});var O=_(j,2);Qe(O,()=>He.Item,(he,$e)=>{$e(he,{color:"error",onSelect:L,children:(me,fe)=>{var ge=se("Delete");r(me,ge)},$$slots:{default:!0,iconLeft:(me,fe)=>{oe(me,{name:"trash",size:1,slot:"iconLeft"})}}})});var J=_(O,2),te=he=>{var $e=Cv(),me=S($e);Qe(me,()=>He.Separator,(we,Se)=>{Se(we,{})});var fe=_(me,2);Qe(fe,()=>He.Label,(we,Se)=>{Se(we,{children:(ie,Ce)=>{var le=se("Debug");r(ie,le)},$$slots:{default:!0}})});var ge=_(fe,2);Qe(ge,()=>He.Item,(we,Se)=>{Se(we,{onSelect:async()=>{(async function(){if(!e.thread.conversation?.id)return;const ie=o?.conversations[e.thread.conversation.id];if(ie)try{await yv(ie,{includeMetadata:!0,notes:`Exported from thread menu on ${new Date().toISOString()}`,extensionClient:o.extensionClient})}catch(Ce){console.error("Failed to export conversation:",Ce)}})(),t(m)?.()},children:(ie,Ce)=>{var le=se("Export conversation");r(ie,le)},$$slots:{default:!0,iconLeft:(ie,Ce)=>{oe(ie,{name:"upload",size:1,slot:"iconLeft"})}}})});var ce=_(ge,2);Qe(ce,()=>He.Item,(we,Se)=>{Se(we,{onSelect:async()=>{(async function(){try{const ie=await $v(o,{generateNewId:!0,namePrefix:"[Imported] ",markAsImported:!0});ie&&o.setCurrentConversation(ie)}catch(ie){console.error("Failed to import conversation:",ie)}})(),t(m)?.()},children:(ie,Ce)=>{var le=se("Import conversation");r(ie,le)},$$slots:{default:!0,iconLeft:(ie,Ce)=>{oe(ie,{name:"download",size:1,slot:"iconLeft"})}}})}),r(he,$e)};b(J,he=>{c()!=="remoteAgent"&&G&&he(te)});var ne=_(J,2),re=he=>{var $e=kv(),me=S($e);Qe(me,()=>He.Separator,(we,Se)=>{Se(we,{})});var fe=_(me,2);Qe(fe,()=>He.Label,(we,Se)=>{Se(we,{children:(ie,Ce)=>{var le=se("INTERNAL Debug Features");r(ie,le)},$$slots:{default:!0}})});var ge=_(fe,2);Qe(ge,()=>He.Item,(we,Se)=>{Se(we,{onSelect:()=>l.pauseRemoteAgentWorkspace(e.thread.id),children:(ie,Ce)=>{var le=se("Pause");r(ie,le)},$$slots:{default:!0,iconLeft:(ie,Ce)=>{oe(ie,{name:"pause",size:1,slot:"iconLeft"})}}})});var ce=_(ge,2);Qe(ce,()=>He.Item,(we,Se)=>{Se(we,{onSelect:()=>l.resumeRemoteAgentWorkspace(e.thread.id),children:(ie,Ce)=>{var le=se("Resume");r(ie,le)},$$slots:{default:!0,iconLeft:(ie,Ce)=>{oe(ie,{name:"play",size:1,slot:"iconLeft"})}}})}),r(he,$e)};b(ne,he=>{c()==="remoteAgent"&&Y(x,"$enableDebugFeatures",s)&&he(re)}),r(U,B)},$$slots:{default:!0}})}),r(W,K)},$$slots:{default:!0}})}),r(i,z),Ae(),a()}var xv=v('<div class="agent-chat-history__item svelte-ndjqhw">|</div>'),Tv=v('<div class="agent-chat-history svelte-ndjqhw"></div>'),Rv=v("<!> <!>",1),Ev=v("<div><!></div>");function wc(i,e){ke(e,!0);const n=()=>Y(u,"$remoteAgentsModel",s),[s,a]=at();let o=k(e,"agentId",19,()=>{}),l=k(e,"status",19,()=>{}),c=k(e,"workspaceStatus",19,()=>{}),d=k(e,"hasUpdates",3,!1);const u=Fe("remoteAgentsModel");let h=p(()=>c()===yr.workspaceRunning?tg(l()):ng(c())),y=p(()=>(l()===In.agentIdle||l()===In.agentFailed)&&d()),m=p(()=>o()??n().currentAgentId),f=p(()=>n().newAgentDraft),$=p(()=>t(m)?n().notificationSettings[t(m)]??!0:!!t(f)&&t(f).enableNotification),R=p(()=>t($)?"You'll be notified when the agent is ready for review. Click to turn off.":"Click to turn on notifications when the agent is ready for review. "+(o()===n().currentAgentId?"You will not be notified while you're actively viewing this agent.":""));(function(C,x){ke(x,!0);let G=k(x,"enabled",3,!1),L=k(x,"isUnread",3,!1),A=k(x,"unreadCount",3,1),E=k(x,"statusColor",3,"neutral"),F=k(x,"tooltipText",3,"");const z=Js();function D(W){W.stopPropagation(),z("toggle")}var M=Ev(),w=g(M);{let W=p(()=>[Be.Hover]);je(w,{get content(){return F()},hasPointerEvents:!1,get triggerOn(){return t(W)},children:(P,K)=>{{let X=p(()=>L()?E():"neutral"),q=p(()=>L()?"soft":"ghost-block");vt(P,{get color(){return t(X)},size:1,get variant(){return t(q)},onclick:D,onkeydown:V=>{V.key!=="Enter"&&V.key!==" "||V.stopPropagation()},radius:"full",children:(V,N)=>{var U=Rv(),I=S(U),B=j=>{oe(j,{name:"bell",size:2})},Q=j=>{oe(j,{name:"bell-off",size:2})};b(I,j=>{G()?j(B):j(Q,!1)});var Z=_(I,2),ae=j=>{var H=se();pe(()=>ze(H,A())),r(j,H)};b(Z,j=>{L()&&A()&&j(ae)}),r(V,U)},$$slots:{default:!0}})}},$$slots:{default:!0}})}pe(()=>Lt(M,1,"c-notify-button "+(G()?"c-notify-button--enabled":""))),r(C,M),Ae()})(i,{get enabled(){return t($)},get isUnread(){return t(y)},get statusColor(){return t(h)},get tooltipText(){return t(R)},$$events:{toggle:async function(){if(t(m))u.setNotificationEnabled(t(m),!t($));else{const C=u.newAgentDraft;if(C){const x=t($);u.setNewAgentDraft({...C,enableNotification:!x});try{const G=x?$s.disableNotifications:$s.enableNotifications;await u.reportRemoteAgentSetupWindowEvent(G)}catch(G){console.error("Failed to report notification toggle event:",G)}}}}}}),Ae(),a()}var Iv=v('<div class="c-thread-title-editor svelte-4d5y91"><!></div>');function zv(i,e){ke(e,!0);let n=k(e,"value",3,""),s=k(e,"size",3,1),a=k(e,"variant",3,"ghost"),o=k(e,"className",3,""),l=k(e,"onRename",3,()=>{}),c=k(e,"onCancel",3,()=>{}),d=ct(void 0),u=ct(!1),h=ct(Cr(n()));function y(){l()(t(h))}zt(()=>{T(h,n())}),mn(()=>{setTimeout(()=>t(d)?.focus(),0)});var m=Iv();Nt("click",ts,function(){t(d)&&!t(u)&&y(),T(u,!1)});var f=g(m);Nr(f,{get size(){return s()},get variant(){return a()},outline:!1,get class(){return`c-thread-title-editor__input ${o()??""}`},get textInput(){return t(d)},set textInput($){T(d,$,!0)},get value(){return t(h)},set value($){T(h,$,!0)},$$events:{keydown:function($){$.key==="Enter"?($.preventDefault(),y()):$.key==="Escape"&&($.preventDefault(),T(h,n()),c()()),$.stopPropagation()},click:$=>$.stopPropagation(),blur:()=>{t(u)||y()},selectionchange:()=>{T(u,!!document.getSelection()?.toString().length)},mouseup:()=>{T(u,!1)}}}),r(i,m),Ae()}const Qa="focusable-item";function nl(i,e){return(i%e+e)%e}function sl(i){const e=document.activeElement?.closest(`.${Qa}`);return i.findIndex(n=>n===e)}function rl(i,e){let n=e;e===-1||e>=i.length?n=i.length-1:e<0&&(n=0),i[n]?.focus()}function Dv(i){const e=n=>{const s=document.activeElement;if(s&&(s.tagName==="INPUT"||s.tagName==="TEXTAREA")||!s.closest(`.${Qa}`)&&!i.contains(s))return;const a=function(o){return Array.from(o.querySelectorAll(`.${Qa}`))}(i);if(a.length!==0)switch(n.key){case"ArrowUp":n.preventDefault(),function(o){const l=nl(sl(o)-1,o.length);o[l]?.focus()}(a);break;case"ArrowDown":n.preventDefault(),function(o){const l=nl(sl(o)+1,o.length);o[l]?.focus()}(a);break;case"Home":n.preventDefault(),rl(a,0);break;case"End":n.preventDefault(),rl(a,-1)}};return document.addEventListener("keydown",e),{destroy(){document.removeEventListener("keydown",e)}}}function Cc(i=document.activeElement){if(!i)return!1;if(i.getAttribute("role")==="textbox")return!0;const e=i.tagName.toLowerCase();if(e==="textarea")return!0;if(e==="input"){const n=i.type.toLowerCase();if(["text","password","email","search","tel","url","number"].includes(n))return!0}return!(!i.hasAttribute("contenteditable")&&!i.closest("[contenteditable]"))}function al(){const i=document.activeElement;if(!i)return!1;const e=i.tagName.toLowerCase();if(e==="select"||e==="button"||e==="input"||Cc(i)||i.hasAttribute("tabindex")&&i.getAttribute("tabindex")!=="-1")return!0;const n=i.getAttribute("role");return n==="textbox"||n==="combobox"||n==="listbox"||n==="button"||n==="menuitem"||n==="option"}var Lv=v('<div class="repo-pill svelte-u5mc2n"><div class="repo-pill-icon svelte-u5mc2n"><!></div> <div class="repo-pill-text svelte-u5mc2n"> </div></div>');const Pv="thread-list-item",Ov={chat:"Chat",localAgent:"Agent",remoteAgent:"Remote Agent"};var Nv=(i,e)=>{i.key!=="Enter"&&i.key!==" "||e.onSelect()},Fv=v('<div class="update-indicator svelte-7gavtm"></div>'),qv=v("<div><!></div>"),Bv=v('<div class="setup-script-badge svelte-7gavtm"><!></div>'),Uv=v('<div class="agent-title-content svelte-7gavtm"><!> <!> <!></div>'),Hv=v('<div class="agent-status svelte-7gavtm"><!></div> <!>',1),Gv=v('<div class="agent-actions svelte-7gavtm"><!></div>'),Wv=v('<div class="agent-content svelte-7gavtm"><div class="agent-details svelte-7gavtm"><div class="agent-details--left svelte-7gavtm"><div class="agent-icon svelte-7gavtm"><!> <!></div> <!> <!> <div class="agent-title svelte-7gavtm"><!></div></div> <!></div> <!> <!></div>'),jv=v('<div role="button" tabindex="0"><!></div>');function ol(i,e){ke(e,!0);let n=k(e,"thread",15),s=k(e,"isSelected",3,!1),a=k(e,"showIfPinned",3,!1),o=k(e,"containerWidth",3,0),l=k(e,"afterDelete",19,()=>{}),c=k(e,"currentRepoUrl",3,""),d=ct(!1);async function u(L){if(L.trim()&&L!==n().title)if(n().type==="remoteAgent")try{e.remoteAgentsModel&&await e.remoteAgentsModel.updateRemoteAgentTitle(n().id,L)}catch{}else["chat","localAgent"].includes(n().type)&&e.chatModel&&(e.chatModel.renameConversation(n().id,L),n(n().title=L,!0));h()}function h(){T(d,!1)}function y(){T(d,!0)}let m=p(()=>n().isNew),f=p(()=>Ea[n().type]),$=p(()=>n().type),R=p(()=>(n().conversation?.chatHistory??[]).filter(L=>!Lh(L)).map(L=>"request_message"in L?L.request_message?.trim():"").filter(Boolean));var C=jv();let x;C.__click=function(...L){e.onSelect?.apply(this,L)},C.__keydown=[Nv,e],en(C,"data-testid",Pv);var G=g(C);qr(G,()=>`${n().title}--${n().isPinned}`,L=>{var A=Wv(),E=g(A),F=g(E),z=g(F),D=g(z),M=j=>{var H=Fv();r(j,H)};b(D,j=>{n().type==="remoteAgent"&&n().has_updates&&j(M)});var w=_(D,2),W=j=>{_v(j,{get remoteAgent(){return n()}})},P=j=>{oe(j,{get name(){return t(f).icon},size:2})};b(w,j=>{n().type==="remoteAgent"?j(W):j(P,!1)});var K=_(z,2),X=j=>{var H=qv();let O;var J=g(H);{let te=p(()=>n().isPinned?"Unpin thread":"Pin thread");je(J,{nested:!1,hasPointerEvents:!1,get content(){return t(te)},children:(ne,re)=>{{let he=p(()=>n().isPinned?"Unpin thread":"Pin thread");vt(ne,{variant:"ghost-block",color:"accent",size:.5,class:"pin-icon__button",onclick:$e=>{$e.stopPropagation(),e.onTogglePinned($e)},onkeydown:$e=>{$e.key!=="Enter"&&$e.key!==" "||($e.stopPropagation(),e.onTogglePinned($e))},type:"button",get"aria-label"(){return t(he)},children:($e,me)=>{oe($e,{name:"pin",size:2})},$$slots:{default:!0}})}},$$slots:{default:!0}})}pe(te=>O=Lt(H,1,"pin-icon svelte-7gavtm",null,O,te),[()=>({"is-pinned":n().isPinned})]),r(j,H)};b(K,j=>{!t(m)&&n().isPinned&&a()&&j(X)});var q=_(K,2),V=j=>{const H=p(()=>rg(n().agent));(function(O,J){ke(J,!0);{let te=p(()=>`Repository: ${J.repoInfo.fullPath}`);je(O,{nested:!1,hasPointerEvents:!1,get content(){return t(te)},children:(ne,re)=>{var he=Lv(),$e=g(he),me=g($e);oe(me,{name:"github",size:0});var fe=_($e,2),ge=g(fe);pe(()=>ze(ge,J.repoInfo.name)),r(ne,he)},$$slots:{default:!0}})}Ae()})(j,{get repoInfo(){return t(H)}})};b(q,j=>{n().type==="remoteAgent"&&n().agent&&sg(n().agent,c())&&j(V)});var N=_(q,2),U=g(N);{let j=p(()=>function(H="",O){return H.length<=O?H:H.slice(0,O-3)+"..."}(n().title,200));je(U,{nested:!1,hasPointerEvents:!1,get content(){return t(j)},delayDurationMs:1e3,children:(H,O)=>{var J=Uv(),te=g(J),ne=ge=>{je(ge,{nested:!1,hasPointerEvents:!1,content:"Setup Script Agent",children:(ce,we)=>{var Se=Bv(),ie=g(Se);oe(ie,{name:"terminal"}),r(ce,Se)},$$slots:{default:!0}})};b(te,ge=>{n().type==="remoteAgent"&&n().is_setup_script_agent&&ge(ne)});var re=_(te,2),he=ge=>{je(ge,{nested:!1,hasPointerEvents:!1,content:"Draft message",children:(ce,we)=>{var Se=ee(),ie=S(Se);Qe(ie,()=>Jt.Root,(Ce,le)=>{le(Ce,{color:"neutral",size:0,variant:"soft",children:(Me,ue)=>{Le(Me,{size:0,children:(be,ye)=>{var de=se("Draft");r(be,de)},$$slots:{default:!0}})},$$slots:{default:!0}})}),r(ce,Se)},$$slots:{default:!0}})};b(re,ge=>{t(m)&&function(ce){return!!ce.conversation?.draftExchange?.request_message?.trim()}(n())&&ge(he)});var $e=_(re,2),me=ge=>{Le(ge,{size:1,truncate:!0,class:"setup-script-title",children:(ce,we)=>{var Se=se("Generate a setup script");r(ce,Se)},$$slots:{default:!0}})},fe=ge=>{var ce=ee(),we=S(ce),Se=Ce=>{Le(Ce,{size:1,truncate:!0,class:"draft-title",children:(le,Me)=>{var ue=se();pe(()=>ze(ue,n().title||n().conversation?.draftExchange?.request_message||`New ${Ov[n().type]}`)),r(le,ue)},$$slots:{default:!0}})},ie=Ce=>{var le=ee(),Me=S(le),ue=ye=>{zv(ye,{get value(){return n().title},onRename:u,onCancel:h})},be=ye=>{{let de=p(()=>n().type==="remoteAgent"&&n().has_updates?"medium":"regular");Le(ye,{size:1,truncate:!0,get weight(){return t(de)},children:(xe,Oe)=>{var De=se();pe(Ue=>ze(De,Ue),[()=>n().title||Ka(n().conversation)]),r(xe,De)},$$slots:{default:!0}})}};b(Me,ye=>{t(d)?ye(ue):ye(be,!1)},!0),r(Ce,le)};b(we,Ce=>{t(m)?Ce(Se):Ce(ie,!1)},!0),r(ge,ce)};b($e,ge=>{n().type==="remoteAgent"&&n().is_setup_script_agent?ge(me):ge(fe,!1)}),r(H,J)},$$slots:{default:!0}})}var I=_(F,2),B=j=>{var H=Hv(),O=S(H),J=g(O);{let te=p(()=>o()>300);hg(J,{get workspaceStatus(){return n().workspace_status},get status(){return n().status},get isExpanded(){return t(te)},get hasUpdates(){return n().has_updates}})}wc(_(O,2),{get agentId(){return n().agent.remote_agent_id},get status(){return n().status},get workspaceStatus(){return n().workspace_status}}),r(j,H)};b(I,j=>{n().type==="remoteAgent"&&n().status&&j(B)});var Q=_(E,2);(function(j,H){ke(H,!0);var O=ee(),J=S(O),te=ne=>{var re=ee(),he=S(re);qr(he,()=>JSON.stringify(H.userMessages.slice(-9)),$e=>{var me=Tv();ln(me,23,()=>H.userMessages.slice(-9),(fe,ge)=>fe+"-"+ge,(fe,ge)=>{{let ce=p(()=>function(Se="",ie){return Se.length<=ie?Se:Se.slice(0,ie-3)+"..."}(t(ge)||"",170)),we=p(()=>[Be.Hover]);je(fe,{delayDurationMs:0,get content(){return t(ce)},side:"bottom",nested:!1,hasPointerEvents:!1,get triggerOn(){return t(we)},children:(Se,ie)=>{var Ce=xv();r(Se,Ce)},$$slots:{default:!0}})}}),r($e,me)}),r(ne,re)};b(J,ne=>{H.userMessages.length>0&&ne(te)}),r(j,O),Ae()})(Q,{get userMessages(){return t(R)}});var Z=_(Q,2),ae=j=>{var H=Gv();Mv(g(H),{get thread(){return n()},get type(){return t($)},get afterDelete(){return l()},get onTogglePinned(){return e.onTogglePinned},onRename:y}),r(j,H)};b(Z,j=>{n().id!==Pr&&j(ae)}),r(L,A)}),is(C,(L,A)=>function(E,F){let z=!1;const D=M=>{M&&!z&&Kn().then(()=>{E.focus()}),z=M};return D(F),{update:D,destroy(){}}}(L,A),()=>s()&&!Cc()),pe(L=>x=Lt(C,1,`agent-row agent-row--${n().type??""} ${Qa}`,"svelte-7gavtm",x,L),[()=>({"agent-row--active":s(),"agent-row--setup-script":n().type==="remoteAgent"&&n().is_setup_script_agent})]),r(i,C),Ae()}Os(["click","keydown"]);var Vv=v('<div class="c-threads-list__group"><div class="c-threads-list__header svelte-1636rk3"><!> <div class="c-threads-list__actions svelte-1636rk3"><div class="c-threads-list__home-button svelte-1636rk3"><!></div></div></div> <div class="c-threads-list__items svelte-1636rk3"></div></div>'),Kv=v("<!> <!>",1),Xv=v('<div class="c-threads-list__group"><div class="c-threads-list__header svelte-1636rk3"><!> <div class="c-threads-list__options svelte-1636rk3"><!></div></div> <div class="c-threads-list__items svelte-1636rk3"></div></div>'),Jv=v('<div class="c-threads-list svelte-1636rk3"><!> <!></div>'),Yv=v('<div hidden=""><!></div>');function ci(i,e){ke(e,!0);let n=k(e,"target",3,"body");var s=Yv(),a=g(s);Rt(a,()=>e.children??Kt),is(s,(o,l)=>function(c,d="body"){let u;async function h(y){if(typeof(d=y)=="string"){if(u=document.querySelector(d),u===null&&(await Kn(),u=document.querySelector(d)),u===null)throw new Error(`No element found matching css selector: "${d}"`)}else{if(!(d instanceof HTMLElement))throw new TypeError(`Unknown portal target type: ${d===null?"null":typeof d}. Allowed types: string (CSS selector) or HTMLElement.`);u=d}u.appendChild(c),c.hidden=!1}return h(d),{update:h,destroy:function(){c.parentNode&&c.parentNode.removeChild(c)}}}(o,l),n),r(i,s),Ae()}var Qv=v('<div class="c-threads-search__icon-button"><!></div>'),Zv=v('<div class="search-field-container__icon svelte-1icxmtj" slot="iconLeft"><!></div>'),ep=v('<div class="c-threads-search"><div class="c-threads-search__field-container svelte-1icxmtj"><!></div></div>'),tp=v("<!> <!>",1),np=v('<div class="skeleton-row svelte-4a6h7v"><div class="skeleton-icon svelte-4a6h7v"></div> <div class="skeleton-text svelte-4a6h7v"></div></div>'),sp=v('<div class="loading-state svelte-4a6h7v"></div>'),rp=v('<div class="l-header-container svelte-12rln4c"><!></div>');function kc(i,e){var n=rp(),s=g(n);Rt(s,()=>e.children),r(i,n)}class ap{_activeTabValue;_nullable;_size;_variant;_color;_loop;_isResizing;_scrollable;_hideLabelOnNarrow;_tabElements=[];activeTab;nullable;size;variant;color;loop;isResizing;scrollable;hideLabelOnNarrow;constructor(e){this._activeTabValue=Dt(e?.activeTab??void 0),this._nullable=Dt(e?.nullable??!1),this._size=Dt(e?.size??2),this._variant=Dt(e?.variant??"default"),this._color=Dt(e?.color??"accent"),this._loop=Dt(e?.loop??!0),this._isResizing=Dt(!1),this._scrollable=Dt(e?.scrollable??!0),this._hideLabelOnNarrow=Dt(e?.hideLabelOnNarrow??!1),this.activeTab=Ct([this._activeTabValue,this._nullable],([n,s])=>s||n!==void 0?n:this._tabElements.filter(l=>!l.hasAttribute("disabled")&&l.getAttribute("aria-disabled")!=="true")[0]?.getAttribute("data-value")||void 0),this.nullable=Hn(this._nullable),this.size=Hn(this._size),this.variant=Hn(this._variant),this.color=Hn(this._color),this.loop=Hn(this._loop),this.isResizing=Hn(this._isResizing),this.scrollable=Hn(this._scrollable),this.hideLabelOnNarrow=Hn(this._hideLabelOnNarrow)}_getWritableStores(){return{activeTabValue:this._activeTabValue,nullable:this._nullable,size:this._size,variant:this._variant,color:this._color,loop:this._loop,isResizing:this._isResizing,scrollable:this._scrollable,hideLabelOnNarrow:this._hideLabelOnNarrow}}_updateTabElements(e){this._tabElements=e,this._activeTabValue.update(n=>n)}}class op{constructor(e){this._model=e,this._stores=this._model._getWritableStores(),this._activeTabUnsubscribe=this._model.activeTab.subscribe(()=>{this.updateSlidingBackground()})}_stores;_tabListElement;_slidingBackgroundElement;_resizeObserver;_mutationObserver;_resizeTimeout;_scrollRafId;_activeTabUnsubscribe;_tabElements=[];setActiveTab(e){if(!Ze(this._stores.nullable)&&e===void 0){const n=this._tabElements.filter(a=>!a.hasAttribute("disabled")&&a.getAttribute("aria-disabled")!=="true"),s=n[0]?.getAttribute("data-value");return s?void this._stores.activeTabValue.set(s):void 0}this._stores.activeTabValue.set(e)}setNullable(e){this._stores.nullable.set(e)}setSize(e){this._stores.size.set(e)}setVariant(e){this._stores.variant.set(e)}setColor(e){this._stores.color.set(e)}setLoop(e){this._stores.loop.set(e)}setScrollable(e){this._stores.scrollable.set(e)}setHideLabelOnNarrow(e){this._stores.hideLabelOnNarrow.set(e)}registerTabList(e){return this._tabListElement&&this._tabListElement!==e&&this._cleanupObservers(),this._tabListElement=e,this._setupObservers(),()=>{this._tabListElement===e&&(this._tabListElement=void 0,this._cleanupObservers())}}registerSlidingBackground(e){return this._slidingBackgroundElement=e,this.updateSlidingBackground(),()=>{this._slidingBackgroundElement===e&&(this._slidingBackgroundElement=void 0)}}withTabList(){return e=>{const n=this.registerTabList(e);return this.updateTabElements(),{destroy:n}}}withSlidingBackground(){return e=>({destroy:this.registerSlidingBackground(e)})}updateTabElements(){this._tabListElement&&(this._tabElements=Array.from(this._tabListElement.querySelectorAll('[role="tab"]')),this._model._updateTabElements(this._tabElements))}getEnabledTabElements(){return this._tabElements.filter(e=>!e.hasAttribute("disabled")&&e.getAttribute("aria-disabled")!=="true")}findNextEnabledTabIndex(e,n,s){const a=this.getEnabledTabElements();if(a.length===0)return-1;const o=this._tabElements[e],l=a.indexOf(o);if(l===-1)return this._tabElements.indexOf(a[0]);let c=l+n;return s?c>=a.length?c=0:c<0&&(c=a.length-1):c=Math.max(0,Math.min(a.length-1,c)),this._tabElements.indexOf(a[c])}handleKeyboardNavigation(e){if(!this._tabElements.length)return!1;const n=this._tabElements.findIndex(c=>c===e.target);if(n===-1)return!1;const s=this.getEnabledTabElements();if(s.length===0)return!1;let a=n,o=!1;const l=Ze(this._stores.loop);switch(e.key){case"ArrowLeft":e.preventDefault(),a=this.findNextEnabledTabIndex(n,-1,l),o=!0;break;case"ArrowRight":e.preventDefault(),a=this.findNextEnabledTabIndex(n,1,l),o=!0;break;case"Home":e.preventDefault(),a=this._tabElements.indexOf(s[0]),o=!0;break;case"End":e.preventDefault(),a=this._tabElements.indexOf(s[s.length-1]),o=!0;break;case"Escape":e.preventDefault(),Ze(this._stores.nullable)&&this.setActiveTab(void 0),o=!0;break}if(o&&a!==n){this._tabElements[a]?.focus();const c=this._tabElements[a]?.getAttribute("data-value");c&&this.setActiveTab(c)}return o}updateSlidingBackground(){const e=Ze(this._model.activeTab),n=this._tabListElement?.querySelector(`.c-tab-button-wrapper > button[data-value="${e}"]`);if(!this._tabListElement||!this._slidingBackgroundElement)return;if(!n)return this._slidingBackgroundElement.style.setProperty("--slider-opacity","0"),void this._slidingBackgroundElement.style.setProperty("--slider-visibility","hidden");const s=n.getBoundingClientRect(),a=this._tabListElement.getBoundingClientRect(),o=this._tabListElement.scrollLeft||0,l=s.left-a.left+o,c=s.width,d=s.height;this._slidingBackgroundElement.style.setProperty("--slider-opacity","1"),this._slidingBackgroundElement.style.setProperty("--slider-visibility","visible"),this._slidingBackgroundElement.style.setProperty("--slider-width",`${c}px`),this._slidingBackgroundElement.style.setProperty("--slider-height",`${d}px`),this._slidingBackgroundElement.style.setProperty("--slider-transform",`translateX(${l}px)`)}scrollActiveTabIntoView(){if(!this._tabListElement)return;const e=Ze(this._model.activeTab);if(!e)return;const n=this._tabListElement.querySelector(`[data-value="${e}"]`);n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}_setupObservers(){this._tabListElement&&(this._cleanupObservers(),this._tabListElement.addEventListener("scroll",this._handleScroll,{passive:!0}),this._resizeObserver=new ResizeObserver(()=>{this._stores.isResizing.set(!0),this.updateSlidingBackground(),this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(()=>{this._stores.isResizing.set(!1)},100)}),this._tabListElement&&this._resizeObserver.observe(this._tabListElement),this._mutationObserver=new MutationObserver(()=>{this.updateTabElements(),this.updateSlidingBackground()}),this._tabListElement&&this._mutationObserver.observe(this._tabListElement,{childList:!0,subtree:!0}))}_handleScroll=()=>{this._scrollRafId!==void 0&&cancelAnimationFrame(this._scrollRafId),this._scrollRafId=requestAnimationFrame(()=>{this.updateSlidingBackground(),this._scrollRafId=void 0})};_cleanupObservers(){this._resizeObserver?.disconnect(),this._mutationObserver?.disconnect(),this._resizeObserver=void 0,this._mutationObserver=void 0,this._resizeTimeout&&(clearTimeout(this._resizeTimeout),this._resizeTimeout=void 0),this._scrollRafId!==void 0&&(cancelAnimationFrame(this._scrollRafId),this._scrollRafId=void 0),this._tabListElement&&this._tabListElement.removeEventListener("scroll",this._handleScroll),this._stores.isResizing.set(!1)}destroy(){this._cleanupObservers(),this._activeTabUnsubscribe?.(),this._tabListElement=void 0,this._slidingBackgroundElement=void 0,this._activeTabUnsubscribe=void 0}}const Ac=Symbol("tab-group");function co(){return Fe(Ac)}var ip=v('<div role="tablist"><!></div>');function Sc(i,e){ke(e,!0);const n=()=>Y(x,"$activeTabStore",s),[s,a]=at();let o=k(e,"value",19,()=>{}),l=k(e,"nullable",3,!1),c=k(e,"size",3,2),d=k(e,"variant",3,"default"),u=k(e,"color",3,"accent"),h=k(e,"loop",3,!0),y=k(e,"scrollable",3,!0),m=k(e,"hideLabelOnNarrow",3,!1),f=k(e,"class",3,"");const $=function(D){const M=new ap(D);return{model:M,controller:new op(M)}}({activeTab:o(),nullable:l(),size:c(),variant:d(),color:u(),loop:h(),scrollable:y(),hideLabelOnNarrow:m()}),{model:R,controller:C}=$,{activeTab:x,size:G,variant:L,color:A}=R,E=Js();Nn(Ac,$),As(()=>{C.destroy()}),zt(()=>{C.setActiveTab(o())}),zt(()=>{C.setNullable(l())}),zt(()=>{C.setSize(c())}),zt(()=>{C.setVariant(d())}),zt(()=>{C.setColor(u())}),zt(()=>{C.setLoop(h())}),zt(()=>{C.setScrollable(y())}),zt(()=>{C.setHideLabelOnNarrow(m())}),zt(()=>{n()!==void 0&&(E("change",{value:n()}),e.onchange?.({value:n()}))});var F=ip(),z=g(F);Rt(z,()=>e.children??Kt),pe(()=>Lt(F,1,Ko(["ds-tabs",`ds-tabs--size-${Y(G,"$sizeStore",s)}`,`ds-tabs--variant-${Y(L,"$variantStore",s)}`,`ds-tabs--color-${Y(A,"$colorStore",s)}`,f()]),"svelte-dgd3cy")),r(i,F),Ae(),a()}function lp(i,e){var n=ee(),s=S(n);Rt(s,()=>e.children??Kt),r(i,n)}function cp(i,e){e.handleKeyboardNavigation(i)}var dp=v('<div class="background-slider svelte-1rv1smz" aria-hidden="true"></div>'),up=v('<div role="tablist" aria-label="Tab navigation" tabindex="-1"><!> <!></div>'),hp=v("<div><!></div>");function Mc(i,e){ke(e,!0);const n=()=>Y($,"$activeTabStore",o),s=()=>Y(L,"$scrollableStore",o),a=()=>Y(x,"$colorStore",o),[o,l]=at(),c=k(e,"class",3,""),d=k(e,"showSlidingBackground",3,!1),u=k(e,"outline",3,!1),h=k(e,"expandToFit",3,!1),y=co();if(!y)throw new Error("TabListAugment must be used within a TabsAugment component");const{model:m,controller:f}=y,{activeTab:$,size:R,variant:C,color:x,isResizing:G,scrollable:L}=m,A=f.withTabList(),E=f.withSlidingBackground();zt(()=>{n()&&s()&&f.scrollActiveTabIntoView()});const F=p(()=>s()?Hl:lp);var z=hp();let D;var M=g(z);Qe(M,()=>t(F),(w,W)=>{W(w,{stretch:!0,children:(P,K)=>{var X=up();let q;X.__keydown=[cp,f];var V=g(X);Rt(V,()=>e.children??Kt);var N=_(V,2),U=I=>{var B=dp();is(B,Q=>E?.(Q)),r(I,B)};b(N,I=>{d()&&I(U)}),is(X,I=>A?.(I)),pe(I=>{q=Lt(X,1,Ko(["ds-tab-list",`ds-tab-list--variant-${Y(C,"$variantStore",o)}`,`ds-tab-list--color-${a()}`,`ds-tabs--size-${Y(R,"$sizeStore",o)}`,c()]),"svelte-1rv1smz",q,I),en(X,"data-ds-color",a()),en(X,"data-active-tab",n())},[()=>({"ds-tab-list--with-sliding-background":d(),"ds-tab-list--outline":u(),"ds-tab-list--resizing":Y(G,"$isResizingStore",o),"ds-tab-list--expand-to-fit":h()})]),r(P,X)},$$slots:{default:!0}})}),pe(w=>D=Lt(z,1,"ds-tab-list-container svelte-1rv1smz",null,D,w),[()=>({"ds-tab-list-container--outline":u()})]),r(i,z),Ae(),l()}Os(["keydown"]);var gp=v('<div class="c-tab-button__content svelte-13dwl2i"><!></div>'),vp=v('<div class="c-tab-button-wrapper svelte-13dwl2i"><!></div>'),pp=v('<div class="ds-tab__left-icon svelte-1ngox2z"><!></div>'),mp=v("<div><!></div>"),fp=v("<div><!></div>"),_p=v("<div><!> <!> <!></div>"),yp=v("<div><!> <!></div>");function Ir(i,e){ke(e,!0);const[n,s]=at();let a=k(e,"grow",3,!0),o=k(e,"disabled",3,!1),l=k(e,"class",3,"");const c=co(),{size:d,variant:u,color:h,activeTab:y,hideLabelOnNarrow:m}=c?.model||{};let f=p(()=>d?Y(d,"$sizeStore",n):2),$=p(()=>u?Y(u,"$variantStore",n):"default"),R=p(()=>h?Y(h,"$colorStore",n):"accent"),C=p(()=>!!y&&Y(y,"$activeTabStore",n)===e.value),x=p(()=>!!m&&Y(m,"$hideLabelOnNarrowStore",n));const G=Js();function L(M){!o()&&c&&c.controller.setActiveTab(e.value),G("click",M)}let A=p(()=>["ds-tab",l()].filter(Boolean).join(" "));var E=yp();let F,z;var D=g(E);{let M=p(()=>t(C)?"ds-tab__separator--active":"");da(D,{orientation:"vertical",size:1,get class(){return`ds-tab__separator ${t(M)??""}`}})}(function(M,w){ke(w,!0);let W=k(w,"size",3,2),P=k(w,"variant",3,"default"),K=k(w,"color",3,"accent"),X=k(w,"active",3,!1),q=k(w,"disabled",3,!1),V=k(w,"class",3,""),N=wr(w,["$$slots","$$events","$$legacy","size","variant","color","active","disabled","class","children"]),U=p(W),I=p(()=>(P(),X()?"soft":"ghost-block")),B=p(K),Q=p(()=>["c-tab-button",`c-tab-button--variant-${P()}`,X()&&"c-tab-button--active",q()&&"c-tab-button--disabled",V()].filter(Boolean).join(" "));var Z=vp(),ae=g(Z);{let j=p(()=>P()==="pill"?"full":"medium"),H=p(()=>X()?0:-1);eh(ae,Vs({get size(){return t(U)},get variant(){return t(I)},get color(){return t(B)},get disabled(){return q()},highContrast:!1,loading:!1,alignment:"center",get radius(){return t(j)},get class(){return t(Q)},role:"tab",get"aria-selected"(){return X()},get tabindex(){return t(H)}},()=>N,{$$events:{click(O){vn.call(this,w,O)},keydown(O){vn.call(this,w,O)},keyup(O){vn.call(this,w,O)},mousedown(O){vn.call(this,w,O)},mouseover(O){vn.call(this,w,O)},focus(O){vn.call(this,w,O)},mouseleave(O){vn.call(this,w,O)},blur(O){vn.call(this,w,O)},contextmenu(O){vn.call(this,w,O)}},children:(O,J)=>{var te=gp(),ne=g(te);Rt(ne,()=>w.children??Kt),r(O,te)},$$slots:{default:!0}}))}r(M,Z),Ae()})(_(D,2),{get size(){return t(f)},get variant(){return t($)},get color(){return t(R)},get active(){return t(C)},get disabled(){return o()},get class(){return t(A)},get"aria-controls"(){return`panel-${e.value??""}`},get id(){return`tab-${e.value??""}`},get"data-value"(){return e.value},$$events:{click:L,keydown:function(M){M.key!=="Enter"&&M.key!==" "||o()||(M.preventDefault(),L(M)),G("keydown",M)}},children:(M,w)=>{var W=_p(),P=g(W),K=U=>{var I=pp(),B=g(I);Rt(B,()=>e.leftIcon??Kt),r(U,I)};b(P,U=>{e.leftIcon&&U(K)});var X=_(P,2),q=U=>{var I=mp();let B;var Q=g(I);Rt(Q,()=>e.children??Kt),pe(Z=>B=Lt(I,1,"ds-tab__label svelte-1ngox2z",null,B,Z),[()=>({"ds-tab__label--hide-on-narrow":t(x)})]),r(U,I)};b(X,U=>{e.children&&U(q)});var V=_(X,2),N=U=>{var I=fp();let B;var Q=g(I);Rt(Q,()=>e.rightIcon??Kt),pe(Z=>B=Lt(I,1,"ds-tab__right-icon svelte-1ngox2z",null,B,Z),[()=>({"ds-tab__right-icon--hide-on-narrow":t(x)})]),r(U,I)};b(V,U=>{e.rightIcon&&U(N)}),pe(()=>Lt(W,1,`ds-tab__content ds-tab--size-${t(f)??""}`,"svelte-1ngox2z")),r(M,W)},$$slots:{default:!0}}),pe((M,w)=>{F=Lt(E,1,"ds-tab svelte-1ngox2z",null,F,M),z=kr(E,"",z,w)},[()=>({"ds-tab--active":t(C)}),()=>({"--tab-button-flex":a()?"1":"0"})]),r(i,E),Ae(),s()}var $p=v('<div class="c-panel-card__header"><!></div>'),bp=v('<div class="c-panel-card__body svelte-b410ro"><!></div>'),wp=v('<div class="c-panel-card__footer"><!></div>'),Cp=v('<div class="c-panel-card svelte-b410ro"><!> <!> <!></div>');function ir(i,e){var n=Cp(),s=g(n),a=u=>{var h=$p(),y=g(h);Rt(y,()=>e.header),r(u,h)};b(s,u=>{e.header&&u(a)});var o=_(s,2),l=u=>{var h=bp(),y=g(h);Rt(y,()=>e.children??Kt),r(u,h)};b(o,u=>{e.children&&u(l)});var c=_(o,2),d=u=>{var h=wp(),y=g(h);Rt(y,()=>e.footer),r(u,h)};b(c,u=>{e.footer&&u(d)}),Mn(5,n,()=>Ls,()=>({duration:150,y:-10})),r(i,n)}var kp=v('<div class="c-thread-panel-empty svelte-1vgfmx"><div class="c-thread-panel-empty__card svelte-1vgfmx"><!></div> <div class="c-thread-panel-empty__footer svelte-1vgfmx"><!></div></div>');function uo(i,e){var n=kp(),s=g(n),a=g(s);Rt(a,()=>e.children??Kt);var o=_(s,2),l=g(o);Rt(l,()=>e.footer??Kt),r(i,n)}const lr=(i,e,n)=>{const s=document.createElement(i),[a,o]=Array.isArray(e)?[void 0,e]:[e,n];return a&&Object.assign(s,a),o?.forEach(l=>s.appendChild(l)),s},Ap=String.raw,xc=String.raw,Sp=(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0})(),Mp=typeof CSS<"u"&&CSS.supports&&CSS.supports("line-height","mod(1,1)"),na=typeof matchMedia<"u"?matchMedia("(prefers-reduced-motion: reduce)"):null,Za="--_number-flow-d-opacity",di="--_number-flow-d-width",eo="--_number-flow-dx",ui="--_number-flow-d",xp=(()=>{try{return CSS.registerProperty({name:Za,syntax:"<number>",inherits:!1,initialValue:"0"}),CSS.registerProperty({name:eo,syntax:"<length>",inherits:!0,initialValue:"0px"}),CSS.registerProperty({name:di,syntax:"<number>",inherits:!1,initialValue:"0"}),CSS.registerProperty({name:ui,syntax:"<number>",inherits:!0,initialValue:"0"}),!0}catch{return!1}})(),hi="var(--number-flow-char-height, 1em)",Us="var(--number-flow-mask-height, 0.25em)",Bo=`calc(${Us} / 2)`,Uo="var(--number-flow-mask-width, 0.5em)",mr=`calc(${Uo} / var(--scale-x))`,ya="#000 0, transparent 71%",il=xc`:host{display:inline-block;direction:ltr;white-space:nowrap;isolation:isolate;line-height:${hi} !important}.number,.number__inner{display:inline-block;transform-origin:left top}:host([data-will-change]) :is(.number,.number__inner,.section,.digit,.digit__num,.symbol){will-change:transform}.number{--scale-x:calc(1 + var(${di}) / var(--width));transform:translateX(var(${eo})) scaleX(var(--scale-x));margin:0 calc(-1 * ${Uo});position:relative;-webkit-mask-image:linear-gradient(to right,transparent 0,#000 ${mr},#000 calc(100% - ${mr}),transparent ),linear-gradient(to bottom,transparent 0,#000 ${Us},#000 calc(100% - ${Us}),transparent 100% ),radial-gradient(at bottom right,${ya}),radial-gradient(at bottom left,${ya}),radial-gradient(at top left,${ya}),radial-gradient(at top right,${ya});-webkit-mask-size:100% calc(100% - ${Us} * 2),calc(100% - ${mr} * 2) 100%,${mr} ${Us},${mr} ${Us},${mr} ${Us},${mr} ${Us};-webkit-mask-position:center,center,top left,top right,bottom right,bottom left;-webkit-mask-repeat:no-repeat}.number__inner{padding:${Bo} ${Uo};transform:scaleX(calc(1 / var(--scale-x))) translateX(calc(-1 * var(${eo})))}:host > :not(.number){z-index:5}.section,.symbol{display:inline-block;position:relative;isolation:isolate}.section::after{content:'\200b';display:inline-block}.section--justify-left{transform-origin:center left}.section--justify-right{transform-origin:center right}.section > [inert],.symbol > [inert]{margin:0 !important;position:absolute !important;z-index:-1}.digit{display:inline-block;position:relative;--c:var(--current) + var(${ui})}.digit__num,.number .section::after{padding:${Bo} 0}.digit__num{display:inline-block;--offset-raw:mod(var(--length) + var(--n) - mod(var(--c),var(--length)),var(--length));--offset:calc( var(--offset-raw) - var(--length) * round(down,var(--offset-raw) / (var(--length) / 2),1) );--y:clamp(-100%,var(--offset) * 100%,100%);transform:translateY(var(--y))}.digit__num[inert]{position:absolute;top:0;left:50%;transform:translateX(-50%) translateY(var(--y))}.digit:not(.is-spinning) .digit__num[inert]{display:none}.symbol__value{display:inline-block;mix-blend-mode:plus-lighter;white-space:pre}.section--justify-left .symbol > [inert]{left:0}.section--justify-right .symbol > [inert]{right:0}.animate-presence{opacity:calc(1 + var(${Za}))}`,Tp=HTMLElement,Rp=xc`:host{display:inline-block;direction:ltr;white-space:nowrap;line-height:${hi} !important}span{display:inline-block}:host([data-will-change]) span{will-change:transform}.number,.digit{padding:${Bo} 0}.symbol{white-space:pre}`,$a=(i,e)=>`<span part="${e}">${i.reduce((n,s)=>n+(a=>`<span class="${a.type==="integer"||a.type==="fraction"?"digit":"symbol"}" part="${a.type==="integer"||a.type==="fraction"?`digit ${a.type}-digit`:`symbol ${a.type}`}">${a.value}</span>`)(s),"")}</span>`,ll=i=>Ap`<template shadowroot="open" shadowrootmode="open"
			><style>
				${Rp}</style
			><span role="img" aria-label="${i.valueAsString}"
				>${$a(i.pre,"left")}<span part="number" class="number"
					>${$a(i.integer,"integer")}${$a(i.fraction,"fraction")}</span
				>${$a(i.post,"right")}</span
			></template
		><span
			style="font-kerning: none; display: inline-block; line-height: ${hi} !important; padding: ${Us} 0;"
			>${i.valueAsString}</span
		>`,Tc=Mp&&Sp&&xp;let ba;class Rc extends Tp{constructor(){super(),this.created=!1,this.batched=!1;const{animated:e,...n}=this.constructor.defaultProps;this._animated=this.computedAnimated=e,Object.assign(this,n)}get animated(){return this._animated}set animated(e){var n;this.animated!==e&&(this._animated=e,(n=this.shadowRoot)==null||n.getAnimations().forEach(s=>s.finish()))}set data(e){var n;if(e==null)return;const{pre:s,integer:a,fraction:o,post:l,value:c}=e;if(this.created){const d=this._data;this._data=e,this.computedTrend=typeof this.trend=="function"?this.trend(d.value,c):this.trend,this.computedAnimated=Tc&&this._animated&&(!this.respectMotionPreference||!(na!=null&&na.matches))&&(u=>u.offsetWidth>0&&u.offsetHeight>0)(this),(n=this.plugins)==null||n.forEach(u=>{var h;return(h=u.onUpdate)==null?void 0:h.call(u,e,d,this)}),this.batched||this.willUpdate(),this._pre.update(s),this._num.update({integer:a,fraction:o}),this._post.update(l),this.batched||this.didUpdate()}else{this._data=e,this.attachShadow({mode:"open"});try{this._internals??(this._internals=this.attachInternals()),this._internals.role="img"}catch{}if(typeof CSSStyleSheet<"u"&&this.shadowRoot.adoptedStyleSheets)ba||(ba=new CSSStyleSheet,ba.replaceSync(il)),this.shadowRoot.adoptedStyleSheets=[ba];else{const d=document.createElement("style");d.textContent=il,this.shadowRoot.appendChild(d)}this._pre=new dl(this,s,{justify:"right",part:"left"}),this.shadowRoot.appendChild(this._pre.el),this._num=new Ep(this,a,o),this.shadowRoot.appendChild(this._num.el),this._post=new dl(this,l,{justify:"left",part:"right"}),this.shadowRoot.appendChild(this._post.el),this.created=!0}try{this._internals.ariaLabel=e.valueAsString}catch{}}willUpdate(){this._pre.willUpdate(),this._num.willUpdate(),this._post.willUpdate()}didUpdate(){if(!this.computedAnimated)return;this._abortAnimationsFinish?this._abortAnimationsFinish.abort():this.dispatchEvent(new Event("animationsstart")),this._pre.didUpdate(),this._num.didUpdate(),this._post.didUpdate();const e=new AbortController;Promise.all(this.shadowRoot.getAnimations().map(n=>n.finished)).then(()=>{e.signal.aborted||(this.dispatchEvent(new Event("animationsfinish")),this._abortAnimationsFinish=void 0)}),this._abortAnimationsFinish=e}}Rc.defaultProps={transformTiming:{duration:900,easing:"linear(0,.005,.019,.039,.066,.096,.129,.165,.202,.24,.278,.316,.354,.39,.426,.461,.494,.526,.557,.586,.614,.64,.665,.689,.711,.731,.751,.769,.786,.802,.817,.831,.844,.856,.867,.877,.887,.896,.904,.912,.919,.925,.931,.937,.942,.947,.951,.955,.959,.962,.965,.968,.971,.973,.976,.978,.98,.981,.983,.984,.986,.987,.988,.989,.99,.991,.992,.992,.993,.994,.994,.995,.995,.996,.996,.9963,.9967,.9969,.9972,.9975,.9977,.9979,.9981,.9982,.9984,.9985,.9987,.9988,.9989,1)"},spinTiming:void 0,opacityTiming:{duration:450,easing:"ease-out"},animated:!0,trend:(i,e)=>Math.sign(e-i),respectMotionPreference:!0,plugins:void 0,digits:void 0};class Ep{constructor(e,n,s,{className:a,...o}={}){this.flow=e,this._integer=new cl(e,n,{justify:"right",part:"integer"}),this._fraction=new cl(e,s,{justify:"left",part:"fraction"}),this._inner=lr("span",{className:"number__inner"},[this._integer.el,this._fraction.el]),this.el=lr("span",{...o,part:"number",className:`number ${a??""}`},[this._inner])}willUpdate(){this._prevWidth=this.el.offsetWidth,this._prevLeft=this.el.getBoundingClientRect().left,this._integer.willUpdate(),this._fraction.willUpdate()}update({integer:e,fraction:n}){this._integer.update(e),this._fraction.update(n)}didUpdate(){const e=this.el.getBoundingClientRect();this._integer.didUpdate(),this._fraction.didUpdate();const n=this._prevLeft-e.left,s=this.el.offsetWidth,a=this._prevWidth-s;this.el.style.setProperty("--width",String(s)),this.el.animate({[eo]:[`${n}px`,"0px"],[di]:[a,0]},{...this.flow.transformTiming,composite:"accumulate"})}}class Ec{constructor(e,n,{justify:s,className:a,...o},l){this.flow=e,this.children=new Map,this.onCharRemove=d=>()=>{this.children.delete(d)},this.justify=s;const c=n.map(d=>this.addChar(d).el);this.el=lr("span",{...o,className:`section section--justify-${s} ${a??""}`},l?l(c):c)}addChar(e,{startDigitsAtZero:n=!1,...s}={}){const a=e.type==="integer"||e.type==="fraction"?new zc(this,e.type,n?0:e.value,e.pos,{...s,onRemove:this.onCharRemove(e.key)}):new Ip(this,e.type,e.value,{...s,onRemove:this.onCharRemove(e.key)});return this.children.set(e.key,a),a}unpop(e){e.el.removeAttribute("inert"),e.el.style.top="",e.el.style[this.justify]=""}pop(e){e.forEach(n=>{n.el.style.top=`${n.el.offsetTop}px`,n.el.style[this.justify]=`${((s,a)=>{var o;return a==="left"?s.offsetLeft:(((o=s.offsetParent instanceof HTMLElement?s.offsetParent:null)==null?void 0:o.offsetWidth)??0)-s.offsetWidth-s.offsetLeft})(n.el,this.justify)}px`}),e.forEach(n=>{n.el.setAttribute("inert",""),n.present=!1})}addNewAndUpdateExisting(e){const n=new Map,s=new Map,a=this.justify==="left",o=a?"prepend":"append";if(function(l,c,{reverse:d=!1}={}){const u=l.length;for(let h=d?u-1:0;d?h>=0:h<u;d?h--:h++)c(l[h],h)}(e,l=>{let c;this.children.has(l.key)?(c=this.children.get(l.key),s.set(l,c),this.unpop(c),c.present=!0):(c=this.addChar(l,{startDigitsAtZero:!0,animateIn:!0}),n.set(l,c)),this.el[o](c.el)},{reverse:a}),this.flow.computedAnimated){const l=this.el.getBoundingClientRect();n.forEach(c=>{c.willUpdate(l)})}n.forEach((l,c)=>{l.update(c.value)}),s.forEach((l,c)=>{l.update(c.value)})}willUpdate(){const e=this.el.getBoundingClientRect();this._prevOffset=e[this.justify],this.children.forEach(n=>n.willUpdate(e))}didUpdate(){const e=this.el.getBoundingClientRect();this.children.forEach(a=>a.didUpdate(e));const n=e[this.justify],s=this._prevOffset-n;s&&this.children.size&&this.el.animate({transform:[`translateX(${s}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"})}}class cl extends Ec{update(e){const n=new Map;this.children.forEach((s,a)=>{e.find(o=>o.key===a)||n.set(a,s),this.unpop(s)}),this.addNewAndUpdateExisting(e),n.forEach(s=>{s instanceof zc&&s.update(0)}),this.pop(n)}}class dl extends Ec{update(e){const n=new Map;this.children.forEach((s,a)=>{e.find(o=>o.key===a)||n.set(a,s)}),this.pop(n),this.addNewAndUpdateExisting(e)}}class Ho{constructor(e,n,{onRemove:s,animateIn:a=!1}={}){this.flow=e,this.el=n,this._present=!0,this._remove=()=>{var o;this.el.remove(),(o=this._onRemove)==null||o.call(this)},this.el.classList.add("animate-presence"),this.flow.computedAnimated&&a&&this.el.animate({[Za]:[-.9999,0]},{...this.flow.opacityTiming,composite:"accumulate"}),this._onRemove=s}get present(){return this._present}set present(e){if(this._present!==e){if(this._present=e,e?this.el.removeAttribute("inert"):this.el.setAttribute("inert",""),!this.flow.computedAnimated)return void(e||this._remove());this.el.style.setProperty("--_number-flow-d-opacity",e?"0":"-.999"),this.el.animate({[Za]:e?[-.9999,0]:[.999,0]},{...this.flow.opacityTiming,composite:"accumulate"}),e?this.flow.removeEventListener("animationsfinish",this._remove):this.flow.addEventListener("animationsfinish",this._remove,{once:!0})}}}class Ic extends Ho{constructor(e,n,s,a){super(e.flow,s,a),this.section=e,this.value=n,this.el=s}}class zc extends Ic{constructor(e,n,s,a,o){var l,c;const d=(((c=(l=e.flow.digits)==null?void 0:l[a])==null?void 0:c.max)??9)+1,u=Array.from({length:d}).map((y,m)=>{const f=lr("span",{className:"digit__num"},[document.createTextNode(String(m))]);return m!==s&&f.setAttribute("inert",""),f.style.setProperty("--n",String(m)),f}),h=lr("span",{part:`digit ${n}-digit`,className:"digit"},u);h.style.setProperty("--current",String(s)),h.style.setProperty("--length",String(d)),super(e,s,h,o),this.pos=a,this._onAnimationsFinish=()=>{this.el.classList.remove("is-spinning")},this._numbers=u,this.length=d}willUpdate(e){const n=this.el.getBoundingClientRect();this._prevValue=this.value;const s=n[this.section.justify]-e[this.section.justify],a=n.width/2;this._prevCenter=this.section.justify==="left"?s+a:s-a}update(e){this.el.style.setProperty("--current",String(e)),this._numbers.forEach((n,s)=>s===e?n.removeAttribute("inert"):n.setAttribute("inert","")),this.value=e}didUpdate(e){const n=this.el.getBoundingClientRect(),s=n[this.section.justify]-e[this.section.justify],a=n.width/2,o=this.section.justify==="left"?s+a:s-a,l=this._prevCenter-o;l&&this.el.animate({transform:[`translateX(${l}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"});const c=this.getDelta();c&&(this.el.classList.add("is-spinning"),this.el.animate({[ui]:[-c,0]},{...this.flow.spinTiming??this.flow.transformTiming,composite:"accumulate"}),this.flow.addEventListener("animationsfinish",this._onAnimationsFinish,{once:!0}))}getDelta(){var e;if(this.flow.plugins)for(const a of this.flow.plugins){const o=(e=a.getDelta)==null?void 0:e.call(a,this.value,this._prevValue,this);if(o!=null)return o}const n=this.value-this._prevValue,s=this.flow.computedTrend||Math.sign(n);return s<0&&this.value>this._prevValue?this.value-this.length-this._prevValue:s>0&&this.value<this._prevValue?this.length-this._prevValue+this.value:n}}class Ip extends Ic{constructor(e,n,s,a){const o=lr("span",{className:"symbol__value",textContent:s});super(e,s,lr("span",{part:`symbol ${n}`,className:"symbol"},[o]),a),this.type=n,this._children=new Map,this._onChildRemove=l=>()=>{this._children.delete(l)},this._children.set(s,new Ho(this.flow,o,{onRemove:this._onChildRemove(s)}))}willUpdate(e){if(this.type==="decimal")return;const n=this.el.getBoundingClientRect();this._prevOffset=n[this.section.justify]-e[this.section.justify]}update(e){if(this.value!==e){const n=this._children.get(this.value);n&&(n.present=!1);const s=this._children.get(e);if(s)s.present=!0;else{const a=lr("span",{className:"symbol__value",textContent:e});this.el.appendChild(a),this._children.set(e,new Ho(this.flow,a,{animateIn:!0,onRemove:this._onChildRemove(e)}))}}this.value=e}didUpdate(e){if(this.type==="decimal")return;const n=this.el.getBoundingClientRect()[this.section.justify]-e[this.section.justify],s=this._prevOffset-n;s&&this.el.animate({transform:[`translateX(${s}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"})}}let Dc=Symbol("group");function zp(i,e){ke(e,!1);const n=new Set;let s=!1;var a;a={register:c=>{n.add(c),Pd(async()=>{s||(s=!0,n.forEach(async d=>{{const u=Ze(d);if(!u||!u.created)return;u.willUpdate()}await Kn(),Ze(d)?.didUpdate()}),await Kn(),s=!1)}),As(()=>{n.delete(c)})}},Nn(Dc,a),wt();var o=ee(),l=S(o);Et(l,e,"default",{},null),r(i,o),Ae()}class Ms extends Rc{set __svelte_batched(e){this.batched=e}set data(e){super.data=e}}Object.keys(Ms.defaultProps).forEach(i=>{Object.defineProperty(Ms.prototype,`__svelte_${i.toLowerCase()}`,{set(e){this[i]=e},enumerable:!0,configurable:!0})}),((i,e)=>{!customElements.get(i)&&customElements.define(i,e)})("number-flow-svelte",Ms);var Dp=v("<number-flow-svelte><!></number-flow-svelte>",2);function Ia(i,e){const n=qa(e,["children","$$slots","$$events","$$legacy"]),s=qa(n,["locales","format","value","prefix","suffix","willChange","transformTiming","spinTiming","opacityTiming","animated","respectMotionPreference","trend","plugins","digits","el"]);ke(e,!1);const[a,o]=at(),l=_e(),c=_e();let d=k(e,"locales",24,()=>{}),u=k(e,"format",24,()=>{}),h=k(e,"value",8),y=k(e,"prefix",24,()=>{}),m=k(e,"suffix",24,()=>{}),f=k(e,"willChange",8,!1),$=k(e,"transformTiming",24,()=>Ms.defaultProps.transformTiming),R=k(e,"spinTiming",24,()=>Ms.defaultProps.spinTiming),C=k(e,"opacityTiming",24,()=>Ms.defaultProps.opacityTiming),x=k(e,"animated",24,()=>Ms.defaultProps.animated),G=k(e,"respectMotionPreference",24,()=>Ms.defaultProps.respectMotionPreference),L=k(e,"trend",24,()=>Ms.defaultProps.trend),A=k(e,"plugins",24,()=>Ms.defaultProps.plugins),E=k(e,"digits",24,()=>Ms.defaultProps.digits),F=k(e,"el",28,()=>{});const z=Dt(F()),D=Fe(Dc);D?.register?.(z),Ne(()=>Ee(F()),()=>{zs(z,F())}),Ne(()=>(Ee(d()),Ee(u())),()=>{T(l,new Intl.NumberFormat(d(),u()))}),Ne(()=>(Ee(h()),t(l),Ee(y()),Ee(m())),()=>{T(c,function(W,P,K,X){const q=P.formatToParts(W);K&&q.unshift({type:"prefix",value:K}),X&&q.push({type:"suffix",value:X});const V=[],N=[],U=[],I=[],B={},Q=O=>`${O}:${B[O]=(B[O]??-1)+1}`;let Z="",ae=!1,j=!1;for(const O of q){Z+=O.value;const J=O.type==="minusSign"||O.type==="plusSign"?"sign":O.type;J==="integer"?(ae=!0,N.push(...O.value.split("").map(te=>({type:J,value:parseInt(te)})))):J==="group"?N.push({type:J,value:O.value}):J==="decimal"?(j=!0,U.push({type:J,value:O.value,key:Q(J)})):J==="fraction"?U.push(...O.value.split("").map(te=>({type:J,value:parseInt(te),key:Q(J),pos:-1-B[J]}))):(ae||j?I:V).push({type:J,value:O.value,key:Q(J)})}const H=[];for(let O=N.length-1;O>=0;O--){const J=N[O];H.unshift(J.type==="integer"?{...J,key:Q(J.type),pos:B[J.type]}:{...J,key:Q(J.type)})}return{pre:V,integer:H,fraction:U,post:I,valueAsString:Z,value:typeof W=="string"?parseFloat(W):W}}(h(),t(l),y(),m()))}),hn(),wt();var M=Dp();br(M,W=>({...s,"data-will-change":f()?"":void 0,__svelte_batched:W,__svelte_transformtiming:$(),__svelte_spintiming:R(),__svelte_opacitytiming:C(),__svelte_animated:x(),__svelte_respectmotionpreference:G(),__svelte_trend:L(),__svelte_plugins:A(),__svelte_digits:E(),data:t(c)}),[()=>Re(()=>!!D)]);var w=g(M);yg(w,()=>(Ee(Ji),Ee(ll),t(c),Re(()=>Ji?void 0:ll(t(c))))),pn(M,W=>F(W),()=>F()),Nt("animationsstart",M,function(W){vn.call(this,e,W)}),Nt("animationsfinish",M,function(W){vn.call(this,e,W)}),r(i,M),Ae(),o()}const Lp=Xo(!1,i=>{mn(()=>{i(Tc)})}),Pp=Xo(!1,i=>{mn(()=>{i(na?.matches??!1);const e=({matches:n})=>{i(n)};return na?.addEventListener("change",e),()=>{na?.removeEventListener("change",e)}})});Ct([Lp,Pp],([i,e])=>i&&!e);var Op=v('<div class="c-notifications-badge svelte-1shmvp7"><!></div>');const Np=250,Co=30;function Fp(i){if(i.id===Pr||i.type!=="remoteAgent")return!1;const e=new Date(i.updated_at),n=new Date().getTime()-e.getTime();return Math.floor(n/1e3/60/60)<168}var qp=v('<div slot="content" class="c-threads-panel__tooltip svelte-11ypmbd">Go back <!></div>'),Bp=v('<div id="threads-search-button-container"></div>'),Up=v('<div class="reload-button"><!></div>'),Hp=v('<div class="remote-tab__content svelte-11ypmbd"><!> Remote <!></div>'),Gp=v("<!> <!>",1),Wp=v('<div class="c-threads-panel__filters svelte-11ypmbd"><div class="c-threads-panel__filters-tabs svelte-11ypmbd"><!></div> <div id="threads-search-button-container"></div></div>'),jp=v('<div class="c-threads-panel__header svelte-11ypmbd"><!> <!> <!> <div class="c-threads-panel__title"><!></div> <div class="c-threads-panel__header-right svelte-11ypmbd"><!> <!> <!></div></div> <div class="c-threads-panel__filters-panel svelte-11ypmbd"><!> <!></div>',1),Vp=v('<div class="c-threads-panel svelte-11ypmbd"><!> <div class="c-threads-panel__list svelte-11ypmbd"><!> <!> <!></div></div>');function Kp(i,e){ke(e,!0);const n=()=>Y(d,"$remoteAgentsModel",o),s=()=>Y(m(),"$chatModel",o),a=()=>Y(t(K),"$agentExecutionMode",o),[o,l]=at(),c=Pr,d=Fe(an.key),u=Fe(hc),h=Fe(ar.key),y=Fe(Ys.key);let m=k(e,"chatModel",19,()=>Fe("chatModel")),f=k(e,"onClose",3,()=>{});const $=_t("enableBulkDeleteThreads"),R=_t("enableBackgroundAgents"),C=h.currentRepositoryUrl;mn(async()=>{try{h.getRemoteUrl()}catch(ve){console.error("Failed to get current repository URL:",ve)}});let x=p(()=>n().currentAgentId),G=p(()=>n().agentOverviews||[]),L=p(()=>n()&&Y(R,"$enableBackgroundAgents",o)),A=p(()=>m()?Object.values(s().orderedConversations()):[]),E=p(()=>t(A).find(Ds.isNew)),F=p(()=>m()?t(A).filter(ve=>!ve.extraData?.isAgentConversation&&ve!==t(E)):[]),z=p(()=>m()?t(A).filter(ve=>ve.extraData?.isAgentConversation===!0&&ve!==t(E)):[]),D=p(()=>n().agentThreadsError),M=p(()=>n().isLoading),w=p(()=>n().hasFetchedOnce),W=p(()=>m()?m().sortConversationsBy:Dt("lastMessageTimestamp")),P=p(()=>Y(t(W),"$sortConversationsBy",o)||"lastMessageTimestamp"),K=p(()=>s().agentExecutionMode);function X(ve){if(!ve)return new Date(0);const Pe=t(P);return Ds.getTime(ve,Pe)}const q=la();let V=p(()=>n().isActive?t(x)??c:Y(q,"$currentConversationId",o)),N=p(()=>(()=>{if(n().isActive){if(n().isCreatingAgent)return;const ve=s().currentConversationModel.draftExchange?.request_message;return{id:c,isNew:!0,type:"remoteAgent",title:ve,hasDraft:!!ve,updated_at:new Date().toISOString(),started_at:new Date().toISOString(),isPinned:!1,conversation:void 0,sortTimestamp:new Date}}if(t(E))return{id:t(E).id,isNew:!0,type:t(E).extraData?.isAgentConversation?"localAgent":"chat",title:"",updated_at:t(E).lastInteractedAtIso,started_at:t(E).createdAtIso,isPinned:!1,conversation:t(E),sortTimestamp:X(t(E))}})()),U=p(()=>t(F).map(ve=>({id:ve.id,isNew:!1,type:"chat",title:Ka(ve),updated_at:ve.lastInteractedAtIso,started_at:ve.createdAtIso,isPinned:ve.isPinned,conversation:ve,sortTimestamp:X(ve)}))),I=p(()=>t(z).map(ve=>({id:ve.id,isNew:!1,type:"localAgent",title:Ka(ve),updated_at:ve.lastInteractedAtIso,started_at:ve.createdAtIso,isPinned:ve.isPinned,conversation:ve,sortTimestamp:X(ve)}))),B=p(()=>Y(u,"$sharedWebviewStore",o).state?.pinnedAgents||{}),Q=p(()=>t(G).map(ve=>({id:ve.remote_agent_id,isNew:!1,type:"remoteAgent",title:rc(ve),updated_at:ve.updated_at,started_at:ve.started_at,status:ve.status,workspace_status:ve.workspace_status,is_setup_script_agent:ve.is_setup_script_agent,workspace_setup:ve.workspace_setup||{},agent:ve,sortTimestamp:new Date(ve.updated_at||ve.started_at),isPinned:t(B)[ve.remote_agent_id]||!1,has_updates:ve.has_updates&&ve.remote_agent_id!==t(V)}))),Z=p(()=>t(N)&&t(V)===t(N).id),ae=p(()=>[t(Z)&&t(N),...t(U),...t(I),...t(Q)].filter(Boolean)),j=ct(""),H=ct("local");function O(ve){return t(H)==="local"?ve.type==="chat"||ve.type==="localAgent":ve.type==="remoteAgent"}mn(()=>{const ve=function(Pe){if(!Pe)return"local";const Je=t(ae).find(Xe=>Xe.id===Pe);return Je&&Je.type==="remoteAgent"?"remote":"local"}(t(V));ve!==t(H)&&T(H,ve,!0)});let J=p(()=>t(ae).filter(O)),te=p(()=>t(j).trim()?t(J).filter(ve=>function(Pe,Je,Xe,st){if(!Je.trim())return!0;const nt=Je.toLowerCase().split(/\s+/).filter(ht=>ht.length>0),et=[Pe.title,Pe.type==="remoteAgent"?sv(Pe):"",nv(Pe,Xe,st)].filter(Boolean).join(" ").toLowerCase();return nt.every(ht=>et.includes(ht))}(ve,t(j),n().currentAgentId,n().currentConversation)):t(J));function ne(ve){if(!ve)return!1;ve.type==="remoteAgent"&&ve.has_updates&&d.optimisticallyClearAgentUpdates(ve.id),d.setIsActive(ve.type==="remoteAgent");const Pe=y.switchToThread(ve.type,ve.id,a());return Pe&&f()(),Pe}let re=p(()=>t(D)?.errorMessage),he=p(()=>t(M)&&!t(w)),$e=p(()=>!!t(re)&&t(w)),me=p(()=>t(w)&&t(te).length===0),fe=p(()=>Zi(t(te))),ge=p(()=>t(te).filter(Fp)),ce=p(()=>"Search "+(t(H)==="local"?"Agent/Chat Threads":"Remote Threads"));async function we(ve){const Pe=[],Je=[];for(const Xe of ve)Xe.type==="remoteAgent"?Je.push(Xe.id):Pe.push(Xe.id);await m().deleteConversations(Pe,void 0,Je,d)}let Se=ct(0),ie=p(()=>m()?.bulkDeletePromptDismissed),Ce=p(()=>t(ie)?Y(t(ie),"$dismissalStore",o):void 0),le=ct(!1);zt(()=>{if(t(Ce))try{const ve=new Date(t(Ce).timestamp);(new Date().getTime()-ve.getTime())/864e5>=Co?(m()&&m().bulkDeletePromptDismissed.set(void 0),T(le,!1)):T(le,!0)}catch{m()&&m().bulkDeletePromptDismissed.set(void 0),T(le,!1)}else T(le,!1)});const Me=p(function(){return Zi(t(J)).find(ve=>ve.groupTitle===es.Older)?.threads||[]}),ue=p(()=>t(Me).length),be=p(()=>t(ae).length);let ye=p(()=>t(be)>Np),de=p(()=>Y($,"$enableBulkDeleteThreads",o)&&t(ye)&&!t(le)),xe=ct(!1);zt(()=>{t(de)&&!t(xe)&&m()?.eventTracker&&(m().eventTracker.trackSimpleEvent(us.BULK_DELETE_BANNER_SHOWN,{oldThreadsCount:t(ue),totalThreadsCount:t(be)}),T(xe,!0))}),zt(()=>{!t(de)&&t(xe)&&T(xe,!1)}),zt(()=>{t(be)>0&&m()&&!t(ye)&&t(le)&&m().bulkDeletePromptDismissed.set(void 0)});const Oe=async()=>{if(m()?.eventTracker&&m().eventTracker.trackSimpleEvent(us.BULK_DELETE_BANNER_CLICKED,{oldThreadsCount:t(ue),totalThreadsCount:t(be)}),t(ue)>0){const ve=t(ue),Pe=t(be);await we(t(Me)),m()?.eventTracker&&m().eventTracker.trackSimpleEvent(us.BULK_DELETE_CONFIRMED,{deletedThreadsCount:ve,totalThreadsCount:Pe}),m()&&m().bulkDeletePromptDismissed.set(void 0)}},De=()=>{if(!m())return;m().eventTracker&&m().eventTracker.trackSimpleEvent(us.BULK_DELETE_BANNER_DISMISSED,{oldThreadsCount:t(ue),totalThreadsCount:t(be),dismissalDurationDays:Co});const ve={timestamp:new Date().toISOString(),dismissedFor:`${Co} days`};m().bulkDeletePromptDismissed.set(ve)};function Ue(ve){ve.value==="remote"?T(H,"remote"):ve.value==="local"&&T(H,"local")}var Ie=Vp(),Ke=g(Ie);kc(Ke,{children:(ve,Pe)=>{var Je=jp(),Xe=S(Je);{const Ft=$t=>{vt($t,{variant:"ghost-block",color:"neutral",size:.5,$$events:{click(...We){f()?.apply(this,We)}},children:(We,tt)=>{oe(We,{name:"arrow-left",size:2})},$$slots:{default:!0}})};var st=g(Xe);Wn(st,{name:"toggleThreadsPanel",get handler(){return f()}});var nt=_(st,2);Wn(nt,{name:"closeThreadsPanel",get handler(){return f()}});var et=_(nt,2);je(et,{side:"bottom",nested:!1,children:($t,We)=>{Ft($t)},$$slots:{default:!0,content:($t,We)=>{var tt=qp(),ut=_(g(tt));hs(ut,{commandName:"closeThreadsPanel",keysOnly:!0}),r($t,tt)}}});var ht=_(et,2),dt=g(ht);Le(dt,{size:1,weight:"bold",children:($t,We)=>{var tt=se("Threads");r($t,tt)},$$slots:{default:!0}});var gt=_(ht,2),Tt=g(gt),mt=$t=>{var We=Bp();r($t,We)};b(Tt,$t=>{t(L)||$t(mt)});var pt=_(Tt,2),ot=$t=>{var We=Up(),tt=g(We);je(tt,{get content(){return`Failed to reload remote agents. Click to retry. ${t(re)??""}`},nested:!1,hasPointerEvents:!1,children:(ut,yt)=>{vt(ut,{variant:"ghost-block",color:"neutral",size:.5,$$events:{click:kt=>{kt.stopPropagation(),n().refreshAgentThreads()}},children:(kt,Pt)=>{oe(kt,{name:"refresh-ccw"})},$$slots:{default:!0}})},$$slots:{default:!0}}),r($t,We)};b(pt,$t=>{t($e)&&$t(ot)}),gv(_(pt,2),{get onNewThreadCreated(){return f()},showLabel:!1})}var ft=_(Xe,2),Wt=g(ft),Ut=Ft=>{var $t=Wp(),We=g($t);Sc(g(We),{size:1,color:"neutral",scrollable:!1,get value(){return t(H)},onchange:Ue,children:(tt,ut)=>{Mc(tt,{expandToFit:!1,showSlidingBackground:!0,children:(yt,kt)=>{var Pt=Gp(),tn=S(Pt);Ir(tn,{value:"local",children:(cn,Vt)=>{var Yt=se("Local");r(cn,Yt)},$$slots:{default:!0}}),Ir(_(tn,2),{value:"remote",class:"remote-tab",children:(cn,Vt)=>{var Yt=Hp(),nn=g(Yt);oe(nn,{name:"cloud-upload"}),function(fn,jt){ke(jt,!0);const Ht=()=>Y(xt,"$remoteAgentsModel",Xt),[Xt,At]=at(),xt=Fe(an.key);let Bt=p(()=>Ht().isActive?Ht().currentAgentId:null),Gt=p(()=>(Ht().agentOverviews||[]).filter(gn=>!!gn.has_updates&&gn.remote_agent_id!==t(Bt)&&gn.status===In.agentIdle).length);var Zt=ee(),_n=S(Zt),qn=gn=>{var Ln=Op(),Jn=g(Ln);Qe(Jn,()=>Jt.Root,(ss,fs)=>{fs(ss,{size:0,color:"accent",variant:"solid",children:(_s,ys)=>{Ia(_s,{get value(){return t(Gt)},willChange:!0})},$$slots:{default:!0}})}),Mn(3,Ln,()=>Ja,()=>({duration:150,start:.8})),r(gn,Ln)};b(_n,gn=>{t(Gt)>0&&gn(qn)}),r(fn,Zt),Ae(),At()}(_(nn,2),{}),r(cn,Yt)},$$slots:{default:!0}}),r(yt,Pt)},$$slots:{default:!0}})},$$slots:{default:!0}}),r(Ft,$t)};b(Wt,Ft=>{t(L)&&Ft(Ut)}),function(Ft,$t){ke($t,!0);let We=k($t,"searchQuery",15,""),tt=k($t,"placeholder",3,"Search threads"),ut=k($t,"isSearchActive",31,()=>!!We());function yt(){We(""),ut(!ut())}function kt(){We(""),ut(!1)}let Pt=ct(void 0);function tn(jt){jt.stopPropagation(),jt.key==="Escape"&&kt()}function cn(){We().trim()||kt()}zt(()=>{ut()&&t(Pt)&&setTimeout(()=>{t(Pt)?.focus()},200)});var Vt=tp(),Yt=S(Vt);ci(Yt,{target:"#threads-search-button-container",children:(jt,Ht)=>{var Xt=ee(),At=S(Xt),xt=Bt=>{var Gt=Qv(),Zt=g(Gt);je(Zt,{content:"Search threads",nested:!1,hasPointerEvents:!1,children:(_n,qn)=>{vt(_n,{variant:"ghost-block",color:"neutral",size:.5,$$events:{click:yt},children:(gn,Ln)=>{oe(gn,{name:"search"})},$$slots:{default:!0}})},$$slots:{default:!0}}),Mn(3,Gt,()=>Ls,()=>({y:6,duration:150})),r(Bt,Gt)};b(At,Bt=>{ut()||Bt(xt)}),r(jt,Xt)},$$slots:{default:!0}});var nn=_(Yt,2),fn=jt=>{var Ht=ep(),Xt=g(Ht),At=g(Xt);Nr(At,{get placeholder(){return tt()},size:1,variant:"surface",class:"search-input",get value(){return We()},set value(xt){We(xt)},get textInput(){return t(Pt)},set textInput(xt){T(Pt,xt,!0)},$$events:{keydown:tn,blur:cn},$$slots:{iconLeft:(xt,Bt)=>{var Gt=Zv(),Zt=g(Gt);oe(Zt,{name:"search",size:1}),r(xt,Gt)}}}),Mn(3,Xt,()=>si,()=>({duration:150,axis:"y"})),r(jt,Ht)};b(nn,jt=>{ut()&&jt(fn)}),r(Ft,Vt),Ae()}(_(Wt,2),{get placeholder(){return t(ce)},get searchQuery(){return t(j)},set searchQuery(Ft){T(j,Ft,!0)}}),r(ve,Je)}});var qe=_(Ke,2),Te=g(qe),Ye=ve=>{(function(Pe,Je){var Xe=pv(),st=g(Xe);ns(st,{variant:"soft",color:"neutral",size:1,padding:"var(--ds-spacing-3)",icon:et=>{oe(et,{name:"info"})},children:(et,ht)=>{var dt=vv(),gt=_(g(dt),3),Tt=g(gt);Mt(Tt,{variant:"soft",color:"neutral",size:1,$$events:{click(...pt){Je.bulkDeleteCallback?.apply(this,pt)}},children:(pt,ot)=>{var ft=se("Delete Old Threads");r(pt,ft)},$$slots:{default:!0}});var mt=_(Tt,2);Mt(mt,{variant:"ghost",color:"neutral",size:1,$$events:{click(...pt){Je.dismissBulkDeletePrompt?.apply(this,pt)}},children:(pt,ot)=>{var ft=se("Dismiss");r(pt,ft)},$$slots:{default:!0}}),r(et,dt)},$$slots:{icon:!0,default:!0}}),r(Pe,Xe)})(ve,{bulkDeleteCallback:Oe,dismissBulkDeletePrompt:De})};b(Te,ve=>{t(de)&&ve(Ye)});var it=_(Te,2);(function(ve,Pe){ke(Pe,!0);let Je=k(Pe,"recentRemoteAgents",19,()=>[]),Xe=k(Pe,"displayedGroups",19,()=>[]),st=k(Pe,"selectedThreadId",3,null),nt=k(Pe,"currentRepoUrl",3,"");function et(){Pe.remoteAgentsModel.showRemoteAgentHomePanel()}let ht=p(()=>Je().length),dt=ct(0);var gt=Jv(),Tt=g(gt),mt=ot=>{var ft=Vv(),Wt=g(ft),Ut=g(Wt);Le(Ut,{size:1,weight:"light",color:"secondary",children:(ut,yt)=>{var kt=se();pe(Pt=>ze(kt,`Recent remote ${Pt??""}`),[()=>Ga(t(ht),"agent")]),r(ut,kt)},$$slots:{default:!0}});var Ft=_(Ut,2),$t=g(Ft),We=g($t);je(We,{content:"Expand remote agents dashboard",nested:!1,hasPointerEvents:!1,children:(ut,yt)=>{vt(ut,{variant:"ghost-block",color:"neutral",size:.5,$$events:{click:et},children:(kt,Pt)=>{oe(kt,{name:"external-link"})},$$slots:{default:!0}})},$$slots:{default:!0}});var tt=_(Wt,2);ln(tt,23,Je,ut=>ut.id,(ut,yt,kt)=>{{let Pt=p(()=>st()===t(yt).id);ol(ut,{get chatModel(){return Pe.chatModel},get remoteAgentsModel(){return Pe.remoteAgentsModel},get thread(){return t(yt)},get containerWidth(){return t(dt)},get currentRepoUrl(){return nt()},get isSelected(){return t(Pt)},afterDelete:()=>Pe.onThreadDelete(t(yt),Je(),t(kt)),onSelect:()=>Pe.onThreadSelect(t(yt)),onTogglePinned:tn=>Pe.onTogglePinned(t(yt),tn)})}}),r(ot,ft)};b(Tt,ot=>{t(ht)>0&&ot(mt)});var pt=_(Tt,2);ln(pt,17,Xe,ot=>`${ot.groupTitle}`,(ot,ft)=>{var Wt=Xv(),Ut=g(Wt),Ft=g(Ut);Le(Ft,{size:1,weight:"light",color:"secondary",children:(ut,yt)=>{var kt=se();pe(()=>ze(kt,t(ft).groupTitle)),r(ut,kt)},$$slots:{default:!0}});var $t=_(Ft,2),We=g($t);Qe(We,()=>He.Root,(ut,yt)=>{yt(ut,{children:(kt,Pt)=>{var tn=Kv(),cn=S(tn);Qe(cn,()=>He.Trigger,(Yt,nn)=>{nn(Yt,{children:(fn,jt)=>{vt(fn,{variant:"ghost-block",color:"neutral",size:.5,title:"Group options",children:(Ht,Xt)=>{oe(Ht,{name:"ellipsis"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var Vt=_(cn,2);Qe(Vt,()=>He.Content,(Yt,nn)=>{nn(Yt,{size:1,side:"bottom",align:"end",children:(fn,jt)=>{var Ht=ee(),Xt=S(Ht);Qe(Xt,()=>He.Item,(At,xt)=>{xt(At,{color:"error",onSelect:()=>Pe.onDeleteAllThreadsInGroup(t(ft).threads),children:(Bt,Gt)=>{var Zt=se();pe(_n=>ze(Zt,`Delete ${_n??""}`),[()=>cr(t(ft).threads.length,"thread")]),r(Bt,Zt)},$$slots:{default:!0,iconLeft:(Bt,Gt)=>{oe(Bt,{name:"trash",slot:"iconLeft"})}}})}),r(fn,Ht)},$$slots:{default:!0}})}),r(kt,tn)},$$slots:{default:!0}})});var tt=_(Ut,2);ln(tt,23,()=>t(ft).threads,(ut,yt)=>`${ut.id}-${ut.isPinned}-${yt}`,(ut,yt,kt)=>{{let Pt=p(()=>st()===t(yt).id);ol(ut,{get chatModel(){return Pe.chatModel},get remoteAgentsModel(){return Pe.remoteAgentsModel},get thread(){return t(yt)},get containerWidth(){return t(dt)},showIfPinned:!0,get currentRepoUrl(){return nt()},get isSelected(){return t(Pt)},afterDelete:()=>Pe.onThreadDelete(t(yt),t(ft).threads,t(kt)),onSelect:()=>Pe.onThreadSelect(t(yt)),onTogglePinned:tn=>Pe.onTogglePinned(t(yt),tn)})}}),r(ot,Wt)}),Oi(gt,"clientWidth",ot=>T(dt,ot)),r(ve,gt),Ae()})(it,{get displayedGroups(){return t(fe)},get selectedThreadId(){return t(V)},get chatModel(){return m()},get remoteAgentsModel(){return d},get currentRepoUrl(){return Y(C,"$currentRepoUrl",o)},onThreadDelete:function(ve,Pe,Je){if(ve.type==="remoteAgent"&&d.reportRemoteAgentThreadListEvent(ma.deleteAgent,t(ge).length,ve.id),t(V)!==ve.id)return;const Xe=Pe[Je+1]||Pe[Je-1];Xe&&ne(Xe)},onThreadSelect:function(ve){ne(ve),ve.type==="remoteAgent"&&d.reportRemoteAgentThreadListEvent(ma.selectAgent,t(Q).length,ve.id)},onTogglePinned:async function(ve,Pe){if(Pe&&Pe.stopPropagation(),!ve.isNew)if(ve.type==="remoteAgent"){const Je=ve.isPinned||!1,Xe=await d.toggleAgentPinned(ve.id,Je);u.update(st=>{if(st)return{...st,pinnedAgents:Xe}}),d.reportRemoteAgentThreadListEvent(Je?ma.unpinAgent:ma.pinAgent,t(ge).length,ve.id)}else["chat","localAgent"].includes(ve.type)&&m()&&m().toggleConversationPinned(ve.id)},onDeleteAllThreadsInGroup:we});var lt=_(it,2),Ve=ve=>{(function(Pe,Je){ke(Je,!0);let Xe=k(Je,"rowCount",3,3),st=p(()=>Array(Xe()).fill(null));var nt=sp();ln(nt,21,()=>t(st),ls,(et,ht)=>{var dt=np();r(et,dt)}),r(Pe,nt),Ae()})(ve,{rowCount:3})},rt=ve=>{var Pe=ee(),Je=S(Pe),Xe=st=>{uo(st,{children:(nt,et)=>{var ht=ee(),dt=S(ht),gt=mt=>{(function(pt){ir(pt,{header:ft=>{Le(ft,{size:4,children:(Wt,Ut)=>{var Ft=se("No Results Found");r(Wt,Ft)},$$slots:{default:!0}})},children:(ft,Wt)=>{Le(ft,{size:1,variant:"surface",children:(Ut,Ft)=>{var $t=se("Try updating your search or filter.");r(Ut,$t)},$$slots:{default:!0}})}})})(mt)},Tt=mt=>{var pt=ee(),ot=S(pt),ft=Ut=>{(function(Ft){ir(Ft,{header:We=>{Le(We,{color:"primary",size:4,children:(tt,ut)=>{var yt=se("Work with Remote Agents");r(tt,yt)},$$slots:{default:!0}})},children:(We,tt)=>{Le(We,{color:"secondary",size:1,variant:"surface",children:(ut,yt)=>{var kt=se(`Spin off a chunk of work to let your agent work in its own environment. When your agent is
    finished, you can review changes and create a PR.`);r(ut,kt)},$$slots:{default:!0}})}})})(Ut)},Wt=Ut=>{(function(Ft){ir(Ft,{header:We=>{Le(We,{size:4,children:(tt,ut)=>{var yt=se("Work with Local Agents");r(tt,yt)},$$slots:{default:!0}})},children:(We,tt)=>{Le(We,{size:1,variant:"surface",children:(ut,yt)=>{var kt=se("Create a new thread to get started");r(ut,kt)},$$slots:{default:!0}})}})})(Ut)};b(ot,Ut=>{t(H)==="remote"?Ut(ft):Ut(Wt,!1)},!0),r(mt,pt)};b(dt,mt=>{t(j).trim()!==""?mt(gt):mt(Tt,!1)}),r(nt,ht)}})};b(Je,st=>{t(me)&&st(Xe)},!0),r(ve,Pe)};b(lt,ve=>{t(he)?ve(Ve):ve(rt,!1)}),Od(()=>Oi(Ie,"clientWidth",ve=>T(Se,ve))),is(Ie,ve=>Dv?.(ve)),r(i,Ie),Ae(),l()}const ko=typeof navigator<"u"&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function Ao(i,e,n,s){i.addEventListener?i.addEventListener(e,n,s):i.attachEvent&&i.attachEvent("on".concat(e),n)}function Yr(i,e,n,s){i.removeEventListener?i.removeEventListener(e,n,s):i.detachEvent&&i.detachEvent("on".concat(e),n)}function Lc(i,e){const n=e.slice(0,e.length-1);for(let s=0;s<n.length;s++)n[s]=i[n[s].toLowerCase()];return n}function Pc(i){typeof i!="string"&&(i="");const e=(i=i.replace(/\s/g,"")).split(",");let n=e.lastIndexOf("");for(;n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}const sa={backspace:8,"":8,tab:9,clear:12,enter:13,"":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,arrowup:38,arrowdown:40,arrowleft:37,arrowright:39,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"":20,",":188,".":190,"/":191,"`":192,"-":ko?173:189,"=":ko?61:187,";":ko?59:186,"'":222,"{":219,"}":221,"[":219,"]":221,"\\":220},Ts={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":91,cmd:91,meta:91,command:91},ea={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Vn={16:!1,18:!1,17:!1,91:!1},En={};for(let i=1;i<20;i++)sa["f".concat(i)]=111+i;let kn=[],ra=null,Oc="all";const Hs=new Map,Ur=i=>sa[i.toLowerCase()]||Ts[i.toLowerCase()]||i.toUpperCase().charCodeAt(0);function ul(i){Oc=i||"all"}function aa(){return Oc||"all"}function Nc(i){if(i===void 0)Object.keys(En).forEach(a=>{Array.isArray(En[a])&&En[a].forEach(o=>wa(o)),delete En[a]}),gi(null);else if(Array.isArray(i))i.forEach(a=>{a.key&&wa(a)});else if(typeof i=="object")i.key&&wa(i);else if(typeof i=="string"){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];let[a,o]=n;typeof a=="function"&&(o=a,a=""),wa({key:i,scope:a,method:o,splitKey:"+"})}}const wa=i=>{let{key:e,scope:n,method:s,splitKey:a="+"}=i;Pc(e).forEach(o=>{const l=o.split(a),c=l.length,d=l[c-1],u=d==="*"?"*":Ur(d);if(!En[u])return;n||(n=aa());const h=c>1?Lc(Ts,l):[],y=[];En[u]=En[u].filter(m=>{const f=(!s||m.method===s)&&m.scope===n&&function($,R){const C=$.length>=R.length?$:R,x=$.length>=R.length?R:$;let G=!0;for(let L=0;L<C.length;L++)x.indexOf(C[L])===-1&&(G=!1);return G}(m.mods,h);return f&&y.push(m.element),!f}),y.forEach(m=>gi(m))})};function hl(i,e,n,s){if(e.element!==s)return;let a;if(e.scope===n||e.scope==="all"){a=e.mods.length>0;for(const o in Vn)Object.prototype.hasOwnProperty.call(Vn,o)&&(!Vn[o]&&e.mods.indexOf(+o)>-1||Vn[o]&&e.mods.indexOf(+o)===-1)&&(a=!1);(e.mods.length!==0||Vn[16]||Vn[18]||Vn[17]||Vn[91])&&!a&&e.shortcut!=="*"||(e.keys=[],e.keys=e.keys.concat(kn),e.method(i,e)===!1&&(i.preventDefault?i.preventDefault():i.returnValue=!1,i.stopPropagation&&i.stopPropagation(),i.cancelBubble&&(i.cancelBubble=!0)))}}function gl(i,e){const n=En["*"];let s=i.keyCode||i.which||i.charCode;if(i.key&&i.key.toLowerCase()==="capslock"||!Cs.filter.call(this,i))return;if(s!==93&&s!==224||(s=91),kn.indexOf(s)===-1&&s!==229&&kn.push(s),["metaKey","ctrlKey","altKey","shiftKey"].forEach(c=>{const d=ea[c];i[c]&&kn.indexOf(d)===-1?kn.push(d):!i[c]&&kn.indexOf(d)>-1?kn.splice(kn.indexOf(d),1):c==="metaKey"&&i[c]&&(kn=kn.filter(u=>u in ea||u===s))}),s in Vn){Vn[s]=!0;for(const c in Ts)if(Object.prototype.hasOwnProperty.call(Ts,c)){const d=ea[Ts[c]];Cs[c]=i[d]}if(!n)return}for(const c in Vn)Object.prototype.hasOwnProperty.call(Vn,c)&&(Vn[c]=i[ea[c]]);i.getModifierState&&(!i.altKey||i.ctrlKey)&&i.getModifierState("AltGraph")&&(kn.indexOf(17)===-1&&kn.push(17),kn.indexOf(18)===-1&&kn.push(18),Vn[17]=!0,Vn[18]=!0);const a=aa();if(n)for(let c=0;c<n.length;c++)n[c].scope===a&&(i.type==="keydown"&&n[c].keydown||i.type==="keyup"&&n[c].keyup)&&hl(i,n[c],a,e);if(!(s in En))return;const o=En[s],l=o.length;for(let c=0;c<l;c++)if((i.type==="keydown"&&o[c].keydown||i.type==="keyup"&&o[c].keyup)&&o[c].key){const d=o[c],{splitKey:u}=d,h=d.key.split(u),y=[];for(let m=0;m<h.length;m++)y.push(Ur(h[m]));y.sort().join("")===kn.sort().join("")&&hl(i,d,a,e)}}function Cs(i,e,n){kn=[];const s=Pc(i);let a=[],o="all",l=document,c=0,d=!1,u=!0,h="+",y=!1,m=!1;for(n===void 0&&typeof e=="function"&&(n=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(o=e.scope),e.element&&(l=e.element),e.keyup&&(d=e.keyup),e.keydown!==void 0&&(u=e.keydown),e.capture!==void 0&&(y=e.capture),typeof e.splitKey=="string"&&(h=e.splitKey),e.single===!0&&(m=!0)),typeof e=="string"&&(o=e),m&&Nc(i,o);c<s.length;c++)a=[],(i=s[c].split(h)).length>1&&(a=Lc(Ts,i)),(i=(i=i[i.length-1])==="*"?"*":Ur(i))in En||(En[i]=[]),En[i].push({keyup:d,keydown:u,scope:o,mods:a,shortcut:s[c],method:n,key:s[c],splitKey:h,element:l});if(l!==void 0&&window){if(!Hs.has(l)){const f=function(){return gl(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event,l)},$=function(){let R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;gl(R,l),function(C){let x=C.keyCode||C.which||C.charCode;C.key&&C.key.toLowerCase()==="capslock"&&(x=Ur(C.key));const G=kn.indexOf(x);if(G>=0&&kn.splice(G,1),C.key&&C.key.toLowerCase()==="meta"&&kn.splice(0,kn.length),x!==93&&x!==224||(x=91),x in Vn){Vn[x]=!1;for(const L in Ts)Ts[L]===x&&(Cs[L]=!1)}}(R)};Hs.set(l,{keydownListener:f,keyupListenr:$,capture:y}),Ao(l,"keydown",f,y),Ao(l,"keyup",$,y)}if(!ra){const f=()=>{kn=[]};ra={listener:f,capture:y},Ao(window,"focus",f,y)}}}function gi(i){const e=Object.values(En).flat();if(e.findIndex(n=>{let{element:s}=n;return s===i})<0){const{keydownListener:n,keyupListenr:s,capture:a}=Hs.get(i)||{};n&&s&&(Yr(i,"keyup",s,a),Yr(i,"keydown",n,a),Hs.delete(i))}if((e.length<=0||Hs.size<=0)&&(Object.keys(Hs).forEach(n=>{const{keydownListener:s,keyupListenr:a,capture:o}=Hs.get(n)||{};s&&a&&(Yr(n,"keyup",a,o),Yr(n,"keydown",s,o),Hs.delete(n))}),Hs.clear(),Object.keys(En).forEach(n=>delete En[n]),ra)){const{listener:n,capture:s}=ra;Yr(window,"focus",n,s),ra=null}}const So={getPressedKeyString:function(){return kn.map(i=>{return e=i,Object.keys(sa).find(n=>sa[n]===e)||(n=>Object.keys(Ts).find(s=>Ts[s]===n))(i)||String.fromCharCode(i);var e})},setScope:ul,getScope:aa,deleteScope:function(i,e){let n,s;i||(i=aa());for(const a in En)if(Object.prototype.hasOwnProperty.call(En,a))for(n=En[a],s=0;s<n.length;)n[s].scope===i?n.splice(s,1).forEach(o=>{let{element:l}=o;return gi(l)}):s++;aa()===i&&ul(e||"all")},getPressedKeyCodes:function(){return kn.slice(0)},getAllKeyCodes:function(){const i=[];return Object.keys(En).forEach(e=>{En[e].forEach(n=>{let{key:s,scope:a,mods:o,shortcut:l}=n;i.push({scope:a,shortcut:l,mods:o,keys:s.split("+").map(c=>Ur(c))})})}),i},isPressed:function(i){return typeof i=="string"&&(i=Ur(i)),kn.indexOf(i)!==-1},filter:function(i){const e=i.target||i.srcElement,{tagName:n}=e;let s=!0;const a=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(a||n==="TEXTAREA"||n==="SELECT")&&!e.readOnly)&&(s=!1),s},trigger:function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(En).forEach(n=>{En[n].filter(s=>s.scope===e&&s.shortcut===i).forEach(s=>{s&&s.method&&s.method()})})},unbind:Nc,keyMap:sa,modifier:Ts,modifierMap:ea};for(const i in So)Object.prototype.hasOwnProperty.call(So,i)&&(Cs[i]=So[i]);if(typeof window<"u"){const i=window.hotkeys;Cs.noConflict=e=>(e&&window.hotkeys===Cs&&(window.hotkeys=i),Cs),window.hotkeys=Cs}function Xp(i,e,n){Cs(i,{keydown:!0,element:document.body},(s,a)=>e(s,a,n()))}function Jp(i){const{commandName:e}=i;if(e)return n=>{n.defaultPrevented||e.split(/,\s*/g).map(s=>sh(s)).find(s=>!!s)&&(n.preventDefault(),n.stopPropagation())}}function vl(i,e){const n=nh(i);for(const s of n){const a=Jp(s);a&&Xp(s.key,a,e)}}Cs.filter=()=>!0;const Yp=(i,{config:e,context:n})=>(vl(e,n),{update({config:s,context:a}){Cs.deleteScope("all"),vl(s,a)},destroy(){Cs.deleteScope("all")}});var Qp=v('<div class="c-card-button__subtitle svelte-18cj5ew"><!></div>'),Zp=v('<div class="c-card-button__icon-right svelte-18cj5ew"><!></div>'),em=v('<div class="c-card-button__icon-left svelte-18cj5ew"><!></div> <div class="c-card-button__content svelte-18cj5ew"><div class="c-card-button__title svelte-18cj5ew"><!></div> <!></div> <!>',1);function pl(i,e){const n=Ws(e);let s=k(e,"title",8,"Select an option"),a=k(e,"subtitle",8,"");var o=em(),l=S(o),c=g(l);Et(c,e,"iconLeft",{},null);var d=_(l,2),u=g(d),h=g(u);Et(h,e,"title",{},R=>{Le(R,{size:2,children:(C,x)=>{var G=se();pe(()=>ze(G,s())),r(C,G)},$$slots:{default:!0}})});var y=_(u,2),m=R=>{var C=Qp(),x=g(C);Et(x,e,"subtitle",{},G=>{Le(G,{size:2,children:(L,A)=>{var E=se();pe(()=>ze(E,a())),r(L,E)},$$slots:{default:!0}})}),r(R,C)};b(y,R=>{a()&&R(m)});var f=_(d,2),$=R=>{var C=Zp(),x=g(C);Et(x,e,"iconRight",{},null),r(R,C)};b(f,R=>{Re(()=>n.iconRight)&&R($)}),r(i,o)}var tm=v('<div role="button"><!></div>'),nm=v('<div class="c-card__dropdown-contents svelte-15clipb"><div class="c-card-button__dropdown-top svelte-15clipb"><!></div> <div class="c-card-button__dropdown-content svelte-15clipb"><!></div></div>'),sm=v("<!> <!>",1),rm=v('<button class="c-card-button__display svelte-15clipb" type="button"><!></button>'),am=v('<div class="c-card-button svelte-15clipb"><!></div>');function ml(i,e){ke(e,!1);let n=k(e,"type",8,"button"),s=k(e,"title",8,"Select an option"),a=k(e,"subtitle",8,""),o=k(e,"onClick",8,()=>{}),l=k(e,"items",24,()=>[]),c=k(e,"selectedItem",28,()=>{}),d=k(e,"formatItemLabel",8,A=>A?.toString()||""),u=k(e,"noItemsLabel",8,"No items found"),h=k(e,"onDropdownOpenChange",8,()=>{}),y=k(e,"requestClose",12,()=>{}),m=k(e,"disabled",8,!1);function f(A){c(A),$("select",A)}const $=Js();var R={selectItem:f};wt();var C=am(),x=g(C),G=A=>{He.Root(A,{get onOpenChange(){return h()},get requestClose(){return y()},set requestClose(E){y(E)},children:(E,F)=>{var z=sm(),D=S(z);He.Trigger(D,{children:(w,W)=>{var P=tm();let K;pl(g(P),{get subtitle(){return a()},$$slots:{iconLeft:(X,q)=>{var V=ee(),N=S(V);Et(N,e,"iconLeft",{},null),r(X,V)},title:(X,q)=>{var V=ee(),N=S(V);Et(N,e,"title",{},U=>{var I=se();pe(()=>ze(I,s())),r(U,I)}),r(X,V)},iconRight:(X,q)=>{var V=ee(),N=S(V);Et(N,e,"iconRight",{},U=>{oe(U,{name:"chevron-down"})}),r(X,V)}}}),pe(X=>{K=Lt(P,1,"c-card-button__display svelte-15clipb",null,K,X),en(P,"tabindex",m()?-1:0)},[()=>({disabled:m()})]),r(w,P)},$$slots:{default:!0}});var M=_(D,2);He.Content(M,{align:"start",side:"bottom",children:(w,W)=>{var P=nm(),K=g(P),X=g(K);Et(X,e,"dropdown-top",{},null);var q=_(K,2),V=g(q);Et(V,e,"dropdown-content",{},N=>{var U=ee(),I=S(U),B=Z=>{var ae=ee(),j=S(ae);ln(j,1,l,H=>d()(H),(H,O)=>{{let J=Ge(()=>c()===t(O));He.Item(H,{onSelect:()=>f(t(O)),get highlight(){return t(J)},children:(te,ne)=>{var re=se();pe(he=>ze(re,he),[()=>(Ee(d()),t(O),Re(()=>d()(t(O))))]),r(te,re)},$$slots:{default:!0}})}}),r(Z,ae)},Q=Z=>{He.Label(Z,{children:(ae,j)=>{var H=se();pe(()=>ze(H,u())),r(ae,H)},$$slots:{default:!0}})};b(I,Z=>{Ee(l()),Re(()=>l().length>0)?Z(B):Z(Q,!1)}),r(N,U)}),r(w,P)},$$slots:{default:!0}}),r(E,z)},$$slots:{default:!0},$$legacy:!0})},L=A=>{var E=rm();pl(g(E),{get title(){return s()},get subtitle(){return a()},$$slots:{iconLeft:(F,z)=>{var D=ee(),M=S(D);Et(M,e,"iconLeft",{},null),r(F,D)},iconRight:(F,z)=>{var D=ee(),M=S(D);Et(M,e,"iconRight",{},null),r(F,D)}}}),pe(()=>E.disabled=m()),Nt("click",E,()=>{o()(),$("click")}),Nt("keydown",E,F=>{F.key!=="Enter"&&F.key!==" "||(o()(),$("click"))}),r(A,E)};return b(x,A=>{n()==="dropdown"?A(G):A(L,!1)}),r(i,C),Gn(e,"selectItem",f),Ae(R)}var om=v('<div slot="iconRight"><!></div>'),im=v('<a target="_blank"> </a>'),lm=v('<!> <div class="github-auth-error-url-container svelte-g0bk5e"><!> <!></div>',1),cm=v('<div class="github-auth-error svelte-g0bk5e"><!> <!> <!></div>'),dm=v("<!> <!>",1),um=v("<!> <!>",1),hm=v('<div slot="dropdown-content"><!></div>'),gm=v('<div class="github-auth-card svelte-g0bk5e"><div class="github-auth-button"><!></div></div>');function vm(i,e){ke(e,!1);const n=Js(),s=Fe(ar.key);let a=_e(!1),o=_e(!1),l=_e(!1),c=null,d=null,u=_e(void 0),h=_e(void 0);async function y(){if(T(u,void 0),T(h,void 0),t(o))return T(o,!1),void(c&&(clearTimeout(c),c=null));T(o,!0);try{const{success:x,message:G,url:L}=await s.authenticateGithub();if(!x)throw T(h,L),new Error(G);d=setInterval(async()=>{try{await s.isGithubAuthenticated()&&(T(a,!0),T(o,!1),n("authStateChange",{isAuthenticated:!0}),d&&clearInterval(d),c&&(clearTimeout(c),c=null))}catch(A){console.error("Failed to check GitHub authentication status:",A)}},5e3),c=setTimeout(()=>{d&&clearInterval(d),T(o,!1),c=null},6e4)}catch(x){console.error("Failed to authenticate with GitHub:",x),T(u,`Error: ${x instanceof Error?x.message:String(x)}`),T(o,!1)}}mn(async()=>{await async function(){try{const x=await s.isGithubAuthenticated();x!==t(a)?(T(a,x),n("authStateChange",{isAuthenticated:t(a)})):T(a,x)}catch(x){console.error("Failed to check GitHub authentication status:",x),T(a,!1),n("authStateChange",{isAuthenticated:!1})}}()}),As(()=>{c&&(clearTimeout(c),c=null),d&&(clearInterval(d),d=null)}),wt();var m=gm(),f=g(m),$=g(f),R=x=>{var G=dm(),L=S(G);{let F=Ge(()=>t(o)?"Cancel":"Connect to GitHub");ml(L,{type:"button",get title(){return t(F)},onClick:y,$$slots:{iconLeft:(z,D)=>{oe(z,{name:"github",slot:"iconLeft"})},iconRight:(z,D)=>{var M=om(),w=g(M),W=K=>{Dn(K,{size:1,useCurrentColor:!0})},P=K=>{oe(K,{name:"chevron-right"})};b(w,K=>{t(o)?K(W):K(P,!1)}),r(z,M)}}})}var A=_(L,2),E=F=>{var z=cm(),D=g(z);Le(D,{size:1,children:(P,K)=>{var X=se("An error occurred while authenticating with GitHub.");r(P,X)},$$slots:{default:!0}});var M=_(D,2),w=P=>{var K=lm(),X=S(K);Le(X,{size:1,children:(U,I)=>{var B=se("Visit or copy the following URL in your browser to authenticate manually:");r(U,B)},$$slots:{default:!0}});var q=_(X,2),V=g(q);Le(V,{size:1,class:"github-auth-error-url",children:(U,I)=>{var B=im(),Q=g(B);pe(()=>{en(B,"href",t(h)),ze(Q,t(h))}),r(U,B)},$$slots:{default:!0}});var N=_(V,2);bg(N,{get text(){return t(h)},tooltipNested:!1}),r(P,K)};b(M,P=>{t(h)&&P(w)});var W=_(M,2);Le(W,{size:1,children:(P,K)=>{var X=se();pe(()=>ze(X,t(u))),r(P,X)},$$slots:{default:!0}}),r(F,z)};b(A,F=>{t(u)&&F(E)}),r(x,G)},C=x=>{ml(x,{type:"dropdown",title:"Connected to your GitHub account",$$slots:{iconLeft:(G,L)=>{oe(G,{name:"github",slot:"iconLeft"})},"dropdown-content":(G,L)=>{var A=hm(),E=g(A);He.Item(E,{color:"error",onSelect:()=>{(async function(){if(!t(l)){T(l,!0);try{const F=await s.revokeGithubAccess();F.success?(T(a,!1),n("authStateChange",{isAuthenticated:!1})):console.error("Failed to revoke GitHub access:",F.message)}catch(F){console.error("Error revoking GitHub access:",F)}finally{T(l,!1)}}})()},children:(F,z)=>{var D=ee(),M=S(D),w=P=>{var K=um(),X=S(K);Dn(X,{slot:"iconLeft",useCurrentColor:!0,size:1});var q=_(X,2);Le(q,{size:1,weight:"medium",children:(V,N)=>{var U=se("Revoking...");r(V,U)},$$slots:{default:!0}}),r(P,K)},W=P=>{Le(P,{size:1,weight:"medium",children:(K,X)=>{var q=se("Revoke Access");r(K,q)},$$slots:{default:!0}})};b(M,P=>{t(l)?P(w):P(W,!1)}),r(F,D)},$$slots:{default:!0}}),r(G,A)}}})};b($,x=>{t(a)?x(C,!1):x(R)}),r(i,m),Ae()}var pm=v('<div class="c-searchable-dropdown__input-container svelte-59urdx"><div class="c-searchable-dropdown__icon svelte-59urdx"><!></div> <input type="text" class="c-searchable-dropdown__trigger-input svelte-59urdx"/> <!></div>'),mm=v('<div role="button"><div class="c-searchable-dropdown__icon-text svelte-59urdx"><div class="c-searchable-dropdown__icon svelte-59urdx"><!></div> <span class="c-searchable-dropdown__button-text svelte-59urdx"><!></span></div> <div class="c-searchable-dropdown__chevron svelte-59urdx"><!></div></div>'),fm=v('<!> <div class="c-searchable-dropdown__separator svelte-59urdx"><!></div>',1),_m=v('<div class="c-searchable-dropdown__loading svelte-59urdx"><!> <span> </span></div>'),ym=v('<div class="c-searchable-dropdown__item-title svelte-59urdx"><!></div>'),$m=v("<!> <!>",1),bm=v('<div class="c-searchable-dropdown__content svelte-59urdx"><!> <!> <!> <div style="margin-bottom: var(--ds-spacing-2);"></div></div>'),wm=v("<!> <!>",1),Cm=v('<div class="c-searchable-dropdown svelte-59urdx"><!></div>');function Go(i,e){const n=Ws(e);ke(e,!1);let s=k(e,"title",8,""),a=k(e,"placeholder",8,"Search..."),o=k(e,"isLoading",8,!1),l=k(e,"disabled",8,!1),c=k(e,"searchValue",12,""),d=k(e,"items",24,()=>[]),u=k(e,"selectedItem",12,null),h=k(e,"actions",24,()=>[]),y=k(e,"actionLabelFn",8,z=>z?.toString()||""),m=k(e,"itemTitle",24,()=>{}),f=k(e,"itemLabelFn",8,z=>z?.toString()||""),$=k(e,"itemKeyFn",8,z=>z?.toString()||""),R=k(e,"isItemSelected",24,()=>{}),C=k(e,"noItemsLabel",8,"No items found"),x=k(e,"loadingLabel",8,"Loading..."),G=_e(!1),L=_e(()=>{});const A=Js();wt();var E=Cm(),F=g(E);He.Root(F,{onOpenChange:function(z){if(!l()){if(T(G,z),z&&u()){const D=f()(u());c(D),A("search",""),setTimeout(()=>{const M=document.querySelector(".c-searchable-dropdown__trigger-input");M&&M.select()},0)}else z&&(c(""),A("search",""));A("openChange",z)}},get requestClose(){return t(L)},set requestClose(z){T(L,z)},children:(z,D)=>{var M=wm(),w=S(M);He.Trigger(w,{children:(K,X)=>{var q=ee(),V=S(q),N=I=>{var B=pm(),Q=g(B),Z=g(Q);Et(Z,e,"searchIcon",{},O=>{var J=ee(),te=S(J);Et(te,e,"icon",{},null),r(O,J)});var ae=_(Q,2),j=_(ae,2),H=O=>{var J=ee(),te=S(J);Et(te,e,"inputButton",{},null),r(O,J)};b(j,O=>{Re(()=>n.inputButton)&&O(H)}),pe(()=>en(ae,"placeholder",a())),Xa(ae,c),Nt("input",ae,O=>{return J=O.currentTarget.value,c(J),void A("search",J);var J}),Nt("click",ae,Xs(function(O){vn.call(this,e,O)})),Nt("mousedown",ae,Xs(function(O){vn.call(this,e,O)})),r(I,B)},U=I=>{var B=mm();let Q;var Z=g(B),ae=g(Z),j=g(ae),H=me=>{Dn(me,{size:1,useCurrentColor:!0})},O=me=>{var fe=ee(),ge=S(fe);Et(ge,e,"icon",{},null),r(me,fe)};b(j,me=>{o()?me(H):me(O,!1)});var J=_(ae,2),te=g(J),ne=me=>{var fe=ee(),ge=S(fe);Et(ge,e,"title",{},null),r(me,fe)},re=me=>{var fe=se();pe(()=>ze(fe,o()?x():s())),r(me,fe)};b(te,me=>{Re(()=>n.title)?me(ne):me(re,!1)});var he=_(Z,2),$e=g(he);oe($e,{name:"chevron-down"}),pe(me=>{Q=Lt(B,1,"c-searchable-dropdown__button svelte-59urdx",null,Q,me),en(B,"tabindex",l()?-1:0)},[()=>({"c-searchable-dropdown__button--disabled":l()})]),r(I,B)};b(V,I=>{t(G)?I(N):I(U,!1)}),r(K,q)},$$slots:{default:!0}});var W=_(w,2),P=K=>{He.Content(K,{side:"top",align:"start",children:(X,q)=>{var V=bm(),N=g(V),U=j=>{var H=fm(),O=S(H);ln(O,1,h,ne=>ne.name,(ne,re)=>{He.Item(ne,{onSelect:()=>function(he){A("action",he.type),t(L)()}(t(re)),get disabled(){return t(re),Re(()=>t(re).disabled)},children:(he,$e)=>{var me=ee(),fe=S(me);Et(fe,e,"action",{get action(){return t(re)}},ge=>{var ce=se();pe(we=>ze(ce,we),[()=>(Ee(y()),t(re),Re(()=>y()(t(re))))]),r(ge,ce)}),r(he,me)},$$slots:{default:!0}})});var J=_(O,2),te=g(J);He.Separator(te,{}),r(j,H)};b(N,j=>{Ee(h()),Re(()=>h().length>0)&&j(U)});var I=_(N,2),B=j=>{He.Item(j,{disabled:!0,children:(H,O)=>{var J=_m(),te=g(J);Dn(te,{size:1,useCurrentColor:!0});var ne=_(te,2),re=g(ne);pe(()=>ze(re,x())),r(H,J)},$$slots:{default:!0}})},Q=j=>{var H=ee(),O=S(H),J=ne=>{var re=$m(),he=S(re),$e=fe=>{var ge=ym(),ce=g(ge);Le(ce,{size:1,class:"c-searchable-dropdown__item-title",children:(we,Se)=>{var ie=se();pe(()=>ze(ie,m())),r(we,ie)},$$slots:{default:!0}}),r(fe,ge)};b(he,fe=>{m()&&fe($e)});var me=_(he,2);ln(me,3,d,(fe,ge)=>fe===null?`null-item-${ge}`:$()(fe,ge),(fe,ge)=>{{let ce=Ge(()=>(Ee(R()),t(ge),Ee(u()),Ee(f()),Re(()=>R()?R()(t(ge),u()):!!u()&&f()(u())===f()(t(ge)))));He.Item(fe,{onSelect:()=>function(we){u(we),A("select",we),t(L)()}(t(ge)),get highlight(){return t(ce)},children:(we,Se)=>{var ie=ee(),Ce=S(ie);Et(Ce,e,"item",{get item(){return t(ge)}},le=>{var Me=se();pe(ue=>ze(Me,ue),[()=>(Ee(f()),t(ge),Re(()=>f()(t(ge))))]),r(le,Me)}),r(we,ie)},$$slots:{default:!0}})}}),r(ne,re)},te=ne=>{var re=ee(),he=S(re),$e=me=>{He.Item(me,{disabled:!0,children:(fe,ge)=>{var ce=se();pe(()=>ze(ce,C())),r(fe,ce)},$$slots:{default:!0}})};b(he,me=>{C()&&me($e)},!0),r(ne,re)};b(O,ne=>{Ee(d()),Re(()=>d().length>0)?ne(J):ne(te,!1)},!0),r(j,H)};b(I,j=>{o()?j(B):j(Q,!1)});var Z=_(I,2),ae=j=>{var H=ee(),O=S(H);Et(O,e,"footer",{},null),r(j,H)};b(Z,j=>{Re(()=>n.footer)&&j(ae)}),r(X,V)},$$slots:{default:!0}})};b(W,K=>{l()||K(P)}),r(z,M)},$$slots:{default:!0},$$legacy:!0}),r(i,E),Ae()}class vi{constructor(e,n=vi._defaultPagesPerLoad){this.gitRefModel=e,this._pagesPerLoad=n}_selectedRepo=Dt(void 0);_selectedBranch=Dt(void 0);_allRepos=Dt([]);_allBranches=Dt([]);_addedRepos=[];_error=void 0;_isDevDeploy=!1;static _defaultPagesPerLoad=20;_loadedRepoPages=0;_hasMoreRepoPages=!1;_loadedBranchPages=0;_hasMoreBranchPages=!1;_lastUsedRepoUrl;_lastUsedBranchName;_shouldCancelFetches=!1;cancelOngoingFetches(){this._shouldCancelFetches=!0}get selectedRepo(){return this._selectedRepo}set selectedRepo(e){this._selectedRepo.set(e),this._allBranches.set([])}get selectedBranch(){return this._selectedBranch}set selectedBranch(e){this._selectedBranch.set(e)}get allRepos(){return this._allRepos}get allBranches(){return this._allBranches}get error(){return this._error}get isDevDeploy(){return this._isDevDeploy}set lastUsedRepoUrl(e){this._lastUsedRepoUrl=e}get lastUsedRepoUrl(){return this._lastUsedRepoUrl}set lastUsedBranchName(e){this._lastUsedBranchName=e}get lastUsedBranchName(){return this._lastUsedBranchName}async updateReposList(){const{repos:e,error:n,isDevDeploy:s}=await this.gitRefModel.listUserRepos();if(s)return this._isDevDeploy=!0,void this._allRepos.set(await this.fetchLocalRepos());if(n)this._error=n;else{this._isDevDeploy=s||!1;try{const a=await this.getCurrentWorkspaceRepo();if(a&&!e.some(o=>o.name===a.name&&o.owner===a.owner)){const{repo:o,error:l}=await this.gitRefModel.getGithubRepo(a);l?console.error("Failed to fetch GitHub repo:",l):o&&e.unshift(o)}}catch(a){console.error("Failed to fetch GitHub repo:",a)}this._allRepos.set([...this._addedRepos,...e])}}async updateRepos(e=!1,n,s){return this._loadedRepoPages=0,this._hasMoreBranchPages=!1,this._allRepos.set([]),this._shouldCancelFetches=!1,await this.updateReposAtPage(1,e,n,s),this._hasMoreRepoPages}async loadMoreRepos(e){return!!this._hasMoreRepoPages&&(this._shouldCancelFetches=!1,await this.updateReposAtPage(this._loadedRepoPages+1,!1,void 0,e),this._hasMoreRepoPages)}async preselectRepo(){if(Ze(this._selectedRepo))return!1;const e=a=>{const o=Ze(this._allRepos).find(l=>l.html_url===a);return!!o&&(this._selectedRepo.set(o),!0)},n=await this.getCurrentWorkspaceRepo(),s=Ze(this._allRepos);if(n){const a=s.find(o=>o.name===n.name&&o.owner===n.owner);if(a)return this._selectedRepo.set(a),!0}return this._lastUsedRepoUrl?e(this._lastUsedRepoUrl):(this._selectedRepo.set(s[0]),!0)}async preselectLocalRepo(){if(Ze(this._selectedRepo))return!1;const e=await this.getCurrentWorkspaceRepo();if(!e)return!1;const{repo:n,error:s}=await this.gitRefModel.getGithubRepo(e);return s?(console.error("Failed to preselect local repo:",s),!1):(this._selectedRepo.set(n),!0)}addRepo(e){this._addedRepos.push(e),this._allRepos.update(n=>n.some(s=>s.name===e.name&&s.owner===e.owner)?n:[e,...n])}async updateBranches(e=!1,n,s){return!!Ze(this._selectedRepo)&&(this._isDevDeploy?(this._allBranches.set(await this.fetchLocalBranches()),!1):(this._loadedBranchPages=0,this._hasMoreBranchPages=!1,this._allBranches.set([]),this._shouldCancelFetches=!1,await this.updateBranchesAtPage(1,e,n,s),this._hasMoreBranchPages))}async loadMoreBranches(e){return!!this._hasMoreBranchPages&&(this._shouldCancelFetches=!1,await this.updateBranchesAtPage(this._loadedBranchPages+1,!1,void 0,e),this._hasMoreBranchPages)}preselectBranch(){const e=Ze(this._selectedRepo);if(!e||Ze(this._selectedBranch))return!1;const n=Ze(this._allBranches);if(this._lastUsedBranchName){const s=n.find(a=>a.name===this._lastUsedBranchName);if(s)return this._selectedBranch.set(s),!0}if(e.default_branch){const s=n.find(a=>a.name===e.default_branch);return s?(this._selectedBranch.set(s),!0):(this._selectedBranch.set({name:e.default_branch,commit:{sha:"",url:""},protected:!1}),!0)}return this._selectedBranch.set(n[0]),!0}async fetchLocalRepos(){console.warn("Fetching repos from local git environment.");const{remoteUrl:e,error:n}=await this.gitRefModel.getRemoteUrl(),s=Fo(e);if(!s||n)return this._error=n??"Failed to parse remote URL in your local git repo.",[];const{owner:a,name:o}=s;return[{name:o,owner:a,html_url:e}]}async fetchLocalBranches(){console.warn("Fetching branches from local git environment.");const e=function(a){return a.filter(o=>o.isRemote)}((await this.gitRefModel.listBranches()).branches),n=e.find(a=>a.isDefault),s=a=>({name:$c(a.name),commit:{sha:"",url:""},protected:!1});return n&&this._selectedBranch.set(s(n)),e.map(s)}async getCurrentWorkspaceRepo(){const{remoteUrl:e,error:n}=await this.gitRefModel.getRemoteUrl();if(n)return;const s=Fo(e);if(!s)return;const{owner:a,name:o}=s;return{name:o,owner:a,html_url:e}}async updateReposAtPage(e,n=!1,s,a){if(!(e<=this._loadedRepoPages))do{if(a?.aborted||this._shouldCancelFetches)break;await new Promise(l=>setTimeout(l,0));const o=await this.gitRefModel.listUserRepos(e);if(o.error){this._error=o.error;break}if(o.isDevDeploy){this._isDevDeploy=!0,this._allRepos.set(await this.fetchLocalRepos());break}this._isDevDeploy&&(this._isDevDeploy=!1),this._allRepos.update(l=>[...l,...o.repos]),e=o.nextPage,this._loadedRepoPages++,this._hasMoreRepoPages=o.hasNextPage,n&&await this.preselectRepo()&&s?.()}while(this._loadedRepoPages%this._pagesPerLoad!=0&&this._hasMoreRepoPages)}async updateBranchesAtPage(e,n=!1,s,a){const o=Ze(this._selectedRepo);if(o&&!(e<=this._loadedBranchPages))do{if(a?.aborted||this._shouldCancelFetches)break;if(o!==Ze(this._selectedRepo)){this._allBranches.set([]);break}await new Promise(c=>setTimeout(c,0));const l=await this.gitRefModel.listRepoBranches(o,e);if(l.error){this._error=l.error;break}this._allBranches.update(c=>[...c,...l.branches]),e=l.nextPage,this._loadedBranchPages++,this._hasMoreBranchPages=l.hasNextPage,n&&this.preselectBranch()&&s?.()}while(this._loadedBranchPages%this._pagesPerLoad!=0&&this._hasMoreBranchPages)}}var km=v("<!> <!>",1),Am=v('<button type="button" class="c-commit-ref-selector__item c-commit-ref-selector__item--loading svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></button>'),Sm=v('<div class="c-commit-ref-selector__item c-commit-ref-selector__item--loading c-commit-ref-selector__item--disabled svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></div>'),Mm=v("<!> <!>",1),xm=v('<div slot="inputButton" class="c-commit-ref-selector__refresh-button svelte-akmdmd"><!></div>'),Tm=v('<button type="button" class="c-commit-ref-selector__item c-commit-ref-selector__item--loading svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></button>'),Rm=v('<div class="c-commit-ref-selector__item c-commit-ref-selector__item--loading c-commit-ref-selector__item--disabled svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></div>'),Em=v('<div class="c-commit-ref-selector__selectors-container svelte-akmdmd"><div class="c-commit-ref-selector__selector svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__selector svelte-akmdmd"><!></div></div>'),Im=v('<span slot="iconLeft" class="svelte-akmdmd"><!></span>'),zm=v('<div class="c-commit-ref-selector__error-content svelte-akmdmd"><div class="c-commit-ref-selector__error-message svelte-akmdmd"> </div> <!></div>'),Dm=v('<div class="c-commit-ref-selector__error svelte-akmdmd"><!></div>'),Lm=v('<div class="c-commit-ref-selector svelte-akmdmd"><div class="c-commit-ref-selector__content svelte-akmdmd"><!></div></div>');function Pm(i,e){ke(e,!1);const n=()=>Y(z,"$selectedRepo",l),s=()=>Y(D,"$selectedBranch",l),a=()=>Y(E,"$allRepos",l),o=()=>Y(F,"$allBranches",l),[l,c]=at(),d=_e(),u=_e(),h=_e(),y=_e(),m=Js();let f=k(e,"errorMessage",12,""),$=k(e,"isLoading",12,!1),R=k(e,"lastUsedBranchName",8,null),C=k(e,"lastUsedRepoUrl",8,null),x=k(e,"onSelectedRepo",24,()=>{}),G=k(e,"onSelectedBranch",24,()=>{}),L=k(e,"gitRefModel",8);const A=_e(new vi(L())),E=t(A).allRepos,F=t(A).allBranches,z=t(A).selectedRepo,D=t(A).selectedBranch;let M=_e("warning"),w=_e(!1),W=_e(!1),P=_e(!1),K=_e(!1),X=_e(!1);const q=new Set;let V=_e("Choose repository..."),N=!1;const U=new Map;let I=_e(!1);const B=Dt(""),Q=Dt(""),Z=ia(function(ye){B.set(ye),N=!0},300,{leading:!1,trailing:!0}),ae=ia(function(ye){Q.set(ye),T(I,!0)},300,{leading:!1,trailing:!0}),j={failedToFetchBranches:"Failed to fetch branches. Please try again.",failedToFetchFromRemote:"Failed to fetch from remote. Please try again."};let H;mn(async()=>{H=new AbortController,await me()}),As(()=>{H&&(H.abort(),t(A).cancelOngoingFetches())});const O=Ct([E,B],([ye,de],xe)=>{T(d,!1),T(X,!1);try{if(N){const Oe=Fo(de);Oe&&L().getGithubRepo(Oe).then(({repo:De,error:Ue})=>{if(Ue)throw new Error(Ue);const Ie=`${De.owner}/${De.name}`;U.has(Ie)||(U.set(Ie,De),t(A).addRepo(De)),T(X,!0),xe([De])}).catch(De=>{console.error("Failed to get GitHub repo from URL",De),xe([])}),xe(function(De,Ue){if(Ue==="")return De;const Ie=Ue.toLowerCase().split("/",2).filter(Ke=>Ke.length>0);return De.filter(Ke=>{const qe=Ke.owner.toLowerCase(),Te=Ke.name.toLowerCase();return Ie.length===1?qe.includes(Ie[0])||Te.includes(Ie[0]):Ie.length!==2||Ie[0]===qe&&Te.includes(Ie[1])})}(ye,de))}else xe(ye)}catch(Oe){console.error("Error fetching repos:",Oe),fe(j.failedToFetchFromRemote),xe([])}}),J=Ct([F,z,Q],([ye,de,xe])=>{if(t(I)&&xe.trim()!=="")return Oe=xe,ye.filter(De=>De.name.toLowerCase().includes(Oe.toLowerCase()));if(de?.default_branch)return[ye.find(Ue=>Ue.name===de?.default_branch)||{name:de.default_branch,commit:{sha:"",url:""},protected:!1},...ye.filter(Ue=>Ue.name!==de?.default_branch)];return ye;var Oe});async function te(){T(W,!0),T(K,await t(A).updateRepos(!0,ce,H?.signal)),function(){q.clear();const ye=new Set;a().forEach(de=>{ye.has(de.name)?q.add(de.name):ye.add(de.name)})}(),await t(A).preselectRepo(),T(W,!1)}function ne(){z&&async function(){n()&&(T(w,!0),T(P,await t(A).updateBranches(!0,ce,H?.signal)),T(w,!1))}().then(()=>{$(!1),t(d)||ce()}).catch(ye=>{console.error("Error fetching all branches:",ye),fe(`Failed to fetch branches: ${ye instanceof Error?ye.message:String(ye)}`)})}let re=_e(!0);const he=async()=>{try{T(re,await L().isGithubAuthenticated()),t(re)||fe("Please authenticate with GitHub to use this feature.","info")}catch(ye){console.error("Failed to check GitHub authentication status:",ye),fe("Please authenticate with GitHub to use this feature."),T(re,!1)}};async function $e(){$(!0),T(d,!1),f(""),T(M,"warning");try{if(await he(),!t(re))return void $(!1);T(W,!0),T(w,!0);let ye=!1;t(A).preselectLocalRepo().then(de=>(ye=de,ce(),de)).then(de=>{de&&ne()}).catch(de=>{console.error("Failed to preselect local repo while fetching all repos: ",de)}),await te(),t(d)||ye||(T(W,!1),ne()),t(d)||ce()}catch(ye){console.error("Error fetching git data:",ye),fe(j.failedToFetchBranches)}finally{$(!1)}}async function me(){$(!0);try{await $e()}catch(ye){console.error("Error fetching and syncing branches:",ye),fe("Failed to fetch repos and branches. Please try again.")}finally{$(!1)}}function fe(ye,de="warning"){console.error("Error:",ye),T(d,!0),f(ye),T(M,de)}function ge(ye,de){ye||(de==="repo"?N=!1:(de==="branch"||(N=!1),T(I,!1)))}function ce(){if(!n()?.html_url||!s())return;const ye={github_commit_ref:{repository_url:n().html_url,git_ref:s().name}};m("commitRefChange",{commitRef:ye,selectedBranch:s()})}const we=ye=>{Q.set(ye)},Se=ye=>{B.set(ye)};function ie(){ne()}Ne(()=>Ee(C()),()=>{Xr(A,t(A).lastUsedRepoUrl=C()??void 0)}),Ne(()=>Ee(R()),()=>{Xr(A,t(A).lastUsedBranchName=R()??void 0)}),Ne(()=>Ee(f()),()=>{T(d,f()!=="")}),Ne(()=>(n(),t(w),s()),()=>{T(u,n()&&t(w)&&!s())}),Ne(()=>(t(W),n()),()=>{T(h,t(W)&&!n())}),Ne(()=>n(),()=>{if(n()){const{owner:ye,name:de}=n();T(V,q.has(de)?`${ye}/${de}`:de)}else T(V,"Choose repository...")}),Ne(()=>(t(I),s()),()=>{t(I)?we(""):we(s()?.name??"")}),Ne(()=>(n(),t(I),o()),()=>{T(y,!n()||!t(I)&&!o().length)}),hn(),wt();var Ce=Lm(),le=g(Ce),Me=g(le),ue=ye=>{var de=Em(),xe=g(de),Oe=g(xe);{let Ie=Ge(()=>(a(),Re(()=>!a().length)));Go(Oe,{get title(){return t(V)},placeholder:"Search repositories or paste a GitHub URL...",itemKeyFn:Ke=>`${Ke.owner}-${Ke.name}`,get isLoading(){return t(h)},get disabled(){return t(Ie)},get items(){return Y(O,"$displayedRepos",l)},get selectedItem(){return n()},itemLabelFn:Ke=>`${Ke.owner}/${Ke.name}`,noItemsLabel:"No repositories found",loadingLabel:"Loading repositories...",get searchValue(){return Ba(),Y(B,"$repoSearchValue",l)},set searchValue(Ke){zs(B,Ke)},$$events:{openChange:Ke=>{var qe;(qe=Ke.detail)&&!a().length||ge(qe,"repo")},search:Ke=>Z(Ke.detail),select:Ke=>async function(qe){T(w,!0),Xr(A,t(A).selectedRepo=qe),Xr(A,t(A).selectedBranch=void 0),N=!1,Se(""),ne(),x()?.()}(Ke.detail)},children:(Ke,qe)=>{var Te=km(),Ye=S(Te);oe(Ye,{name:"github"});var it=_(Ye,2);oe(it,{name:"search"}),r(Ke,Te)},$$slots:{default:!0,footer:(Ke,qe)=>{var Te=ee(),Ye=S(Te),it=Ve=>{{let rt=Ge(()=>(a(),Re(()=>`${a().length} repos loaded`))),ve=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(Ve,{get content(){return t(rt)},get triggerOn(){return t(ve)},nested:!1,children:(Pe,Je)=>{var Xe=Am(),st=g(Xe),nt=g(st);oe(nt,{name:"chevrons-down"});var et=_(st,2),ht=g(et);Le(ht,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(dt,gt)=>{var Tt=se("Load more repos");r(dt,Tt)},$$slots:{default:!0}}),Nt("click",Xe,async()=>{T(W,!0),T(K,await t(A).loadMoreRepos()),T(W,!1)}),r(Pe,Xe)},$$slots:{default:!0}})}},lt=Ve=>{var rt=ee(),ve=S(rt),Pe=Je=>{var Xe=Sm(),st=g(Xe),nt=g(st);Dn(nt,{size:1});var et=_(st,2),ht=g(et);Le(ht,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(dt,gt)=>{var Tt=se("Loading repos...");r(dt,Tt)},$$slots:{default:!0}}),r(Je,Xe)};b(ve,Je=>{t(W)&&Je(Pe)},!0),r(Ve,rt)};b(Ye,Ve=>{!t(K)||t(W)||t(X)?Ve(lt,!1):Ve(it)}),r(Ke,Te)}},$$legacy:!0})}var De=_(xe,2),Ue=g(De);{let Ie=Ge(()=>(s(),Re(()=>s()?.name||"Choose branch..."))),Ke=Ge(()=>t(w)?"":"No branches found");Go(Ue,{get title(){return t(Ie)},itemKeyFn:(qe,Te)=>`${qe.name}-${qe.commit.sha}=${Te}`,placeholder:"Search branches...",get isLoading(){return t(u)},get disabled(){return t(y)},get items(){return Y(J,"$displayedBranches",l)},get selectedItem(){return s()},itemLabelFn:qe=>qe.name.replace("origin/",""),get noItemsLabel(){return t(Ke)},loadingLabel:"Loading branches...",get searchValue(){return Ba(),Y(Q,"$branchSearchValue",l)},set searchValue(qe){zs(Q,qe)},$$events:{openChange:qe=>{var Te;(Te=qe.detail)&&t(y)||ge(Te,"branch")},search:qe=>ae(qe.detail),select:qe=>async function(Te){Xr(A,t(A).selectedBranch=Te),T(I,!1),we(s()?.name??""),ce(),G()?.()}(qe.detail)},children:(qe,Te)=>{var Ye=Mm(),it=S(Ye);oe(it,{name:"git-branch"});var lt=_(it,2);oe(lt,{name:"search"}),r(qe,Ye)},$$slots:{default:!0,inputButton:(qe,Te)=>{var Ye=xm(),it=g(Ye);{let lt=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(it,{content:"Refresh branches",get triggerOn(){return t(lt)},nested:!1,children:(Ve,rt)=>{vt(Ve,{variant:"ghost",color:"neutral",size:1,$$events:{click:ie},children:(ve,Pe)=>{oe(ve,{name:"rotate-cw"})},$$slots:{default:!0}})},$$slots:{default:!0}})}r(qe,Ye)},footer:(qe,Te)=>{var Ye=ee(),it=S(Ye),lt=rt=>{{let ve=Ge(()=>(o(),Re(()=>`${o().length} branches loaded`))),Pe=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(rt,{get content(){return t(ve)},get triggerOn(){return t(Pe)},nested:!1,children:(Je,Xe)=>{var st=Tm(),nt=g(st),et=g(nt);oe(et,{name:"chevrons-down"});var ht=_(nt,2),dt=g(ht);Le(dt,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(gt,Tt)=>{var mt=se("Load more branches");r(gt,mt)},$$slots:{default:!0}}),Nt("click",st,async()=>{T(w,!0),T(P,await t(A).loadMoreBranches()),T(w,!1)}),r(Je,st)},$$slots:{default:!0}})}},Ve=rt=>{var ve=ee(),Pe=S(ve),Je=Xe=>{var st=Rm(),nt=g(st),et=g(nt);Dn(et,{size:1});var ht=_(nt,2),dt=g(ht);Le(dt,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(gt,Tt)=>{var mt=se("Loading branches...");r(gt,mt)},$$slots:{default:!0}}),r(Xe,st)};b(Pe,Xe=>{t(w)&&Xe(Je)},!0),r(rt,ve)};b(it,rt=>{t(P)&&!t(w)?rt(lt):rt(Ve,!1)}),r(qe,Ye)}},$$legacy:!0})}r(ye,de)},be=ye=>{var de=ee(),xe=S(de),Oe=De=>{var Ue=Dm(),Ie=g(Ue);ns(Ie,{get color(){return t(M)},variant:"soft",size:2,children:(Ke,qe)=>{var Te=zm(),Ye=g(Te),it=g(Ye),lt=_(Ye,2),Ve=ve=>{vm(ve,{$$events:{authStateChange:async Pe=>{const{isAuthenticated:Je}=Pe.detail;Je!==t(re)&&(T(re,Je),Je&&await me())}}})},rt=ve=>{Mt(ve,{variant:"ghost",color:"warning",size:1,get loading(){return $()},class:"c-commit-ref-selector__fetch-button",$$events:{click:me},children:(Pe,Je)=>{var Xe=se("Reload available repos and branches");r(Pe,Xe)},$$slots:{default:!0,iconLeft:(Pe,Je)=>{var Xe=Im(),st=g(Xe);oe(st,{name:"refresh-ccw"}),r(Pe,Xe)}}})};b(lt,ve=>{t(re)?ve(rt,!1):ve(Ve)}),pe(()=>ze(it,f())),r(Ke,Te)},$$slots:{default:!0}}),r(De,Ue)};b(xe,De=>{t(d)&&De(Oe)},!0),r(ye,de)};b(Me,ye=>{t(d)?ye(be,!1):ye(ue)}),r(i,Ce),Ae(),c()}var Om=v('<div class="c-setup-script-selector__icon svelte-1fvykqe"><!></div>'),Nm=v('<span class="c-setup-script-selector__extension svelte-1fvykqe"> </span>'),Fm=v('<div class="c-setup-script-selector__rename-input svelte-1fvykqe" role="presentation"><div class="c-setup-script-selector__rename-input-container svelte-1fvykqe" role="presentation"><!> <!></div></div>'),qm=v('<span class="c-setup-script-selector__script-path svelte-1fvykqe"> </span>'),Bm=v('<span class="c-setup-script-selector__script-name svelte-1fvykqe"> </span> <!>',1),Um=v('<div role="presentation"><!> <div class="c-setup-script-selector__script-info svelte-1fvykqe"><!></div> <div class="c-setup-script-selector__script-actions svelte-1fvykqe"><!></div></div>'),Hm=v("<!> <!>",1),Gm=v('<span slot="text"> </span>'),Wm=v('<span slot="grayText"> </span>'),jm=v('<span slot="text"> </span>'),Vm=v('<div slot="title"><!></div>'),Km=v('<div class="c-action-selector svelte-g45zi9"><!> <!></div>'),Xm=v("<!> <!> <!>",1),Jm=v('<div class="c-setup-script-selector__script-line-container svelte-g45zi9"><div class="c-setup-script-selector__script-line svelte-g45zi9"><!></div></div>'),Ym=v('<span slot="iconLeft"><!></span>'),Qm=v('<div class="c-setup-script-selector__error-content svelte-g45zi9"><div class="c-setup-script-selector__error-message svelte-g45zi9"> </div> <!></div>'),Zm=v('<div class="c-setup-script-selector__error svelte-g45zi9"><!></div>'),ef=v('<div class="c-setup-script-selector svelte-g45zi9"><div class="c-setup-script-selector__content svelte-g45zi9"><!> <!></div></div>');function tf(i,e){ke(e,!1);const n=()=>Y(C,"$remoteAgentsModel",s),[s,a]=at(),o=_e(),l=_e(),c=_e(),d=_e(),u=_e(),h=_e(),y=_e();let m=k(e,"errorMessage",12,""),f=k(e,"isLoading",8,!1),$=k(e,"lastUsedScriptPath",8,null),R=k(e,"disableNewAgentCreation",8,!1);const C=Fe(an.key),x=Js(),G=Xn(),L=j=>{G(ws({repoRoot:"",pathName:j.path,allowOutOfWorkspace:!0,openLocalUri:j.location==="home"}))};let A=_e([]),E=_e(""),F=_e(null),z=_e(t(A)),D=!0,M=_e(null);const w=[{type:"basic",name:"Use basic environment",icon:"square-terminal"},{type:"auto",name:"Auto-generate setup script",icon:"wand-sparkles",disabled:R()},{type:"manual",name:"Write a script by hand",icon:"pencil"}],W={noScriptsFound:"No setup scripts found. You can create one in ~/.augment/env/, <git root>/.augment/env/, or <workspace root>/.augment/env/.",failedToFetchScripts:"Failed to fetch setup scripts. Please try again."};async function P(){m("");try{const j=t(o)?.path;if(T(A,await C.listSetupScripts()),D)if($()&&t(A).length>0){const H=t(A).find(O=>O.path===$());H&&(T(o,H),T(M,null),N())}else $()===null&&(T(o,null),N());else if(j){const H=t(A).find(O=>O.path===j);H&&(T(o,H),T(M,null))}D=!1,t(A).length===0?m(W.noScriptsFound):m("")}catch(j){console.error("Error fetching setup scripts:",j),m(W.failedToFetchScripts)}}function K(){T(F,null)}function X(j){m(j)}function q(j){if(T(M,j),T(o,null),j==="basic")V(null);else{if(j==="auto")return void C.setGenerateSetupScriptSelected(!0);j==="manual"&&(async()=>{try{await C.reportRemoteAgentSetupWindowEvent($s.manuallyCreateSetupScript)}catch(H){console.error("Failed to report manually create setup script event:",H)}try{const H="setup.sh",O=`#!/bin/bash

# Setup Script for Remote Agent Environment
#
# This script installs dependencies and configures the environment for your project.
# It runs with sudo privileges when needed.
#
# Examples:
# sudo apt-get update && sudo apt-get install -y package-name
# pip install package-name
# npm install -g package-name
# export ENV_VAR=value

# Add your commands below:

`,J=await C.saveSetupScript(H,O,"home");if(J.success&&J.path){await P();const te=t(A).find(ne=>ne.path===J.path);te&&(V(te),L(te))}else console.error("Failed to create manual setup script:",J.error),m(`Failed to create manual setup script: ${J.error||"Unknown error"}`)}catch(H){console.error("Error creating manual setup script:",H),m(`Error creating manual setup script: ${H instanceof Error?H.message:String(H)}`)}})()}C.setGenerateSetupScriptSelected(!1)}async function V(j){if(T(o,j),N(),C.saveLastRemoteAgentSetup(null,null,t(o)?.path||null),j)try{await C.reportRemoteAgentSetupWindowEvent($s.selectSetupScript)}catch(H){console.error("Failed to report setup script selection event:",H)}}function N(){x("setupScriptChange",{script:t(o)})}mn(async()=>{await P(),$()===null?V(null):n().newAgentDraft?.setupScript&&!t(o)&&V(n().newAgentDraft.setupScript)}),As(()=>{C.setGenerateSetupScriptSelected(!1)}),Ne(()=>n(),()=>{T(o,n().newAgentDraft?.setupScript??null)}),Ne(()=>Ee(m()),()=>{T(l,m()!=="")}),Ne(()=>(t(E),t(A)),()=>{if(t(E).trim()!==""){const j=t(A).filter(H=>H.name.toLowerCase().includes(t(E).toLowerCase())||H.path.toLowerCase().includes(t(E).toLowerCase()));T(z,j)}else T(z,t(A))}),Ne(()=>(Ee(f()),t(o),t(M)),()=>{T(c,()=>f()?"...":t(o)?t(o).isGenerateOption?t(o).name:t(o).location==="home"?"~/.augment/env/"+t(o).name:t(o).path:t(M)?w.find(H=>H.type===t(M))?.name||t(M):"Use basic environment")}),Ne(()=>t(c),()=>{T(d,t(c)())}),Ne(()=>t(o),()=>{T(u,!!t(o)?.path)}),Ne(()=>(t(u),t(d)),()=>{T(h,t(u)?t(d).split("/").pop():t(d))}),Ne(()=>(t(u),t(d)),()=>{T(y,t(u)?t(d).slice(0,t(d).lastIndexOf("/")):"")}),hn(),wt();var U=ef(),I=g(U),B=g(I),Q=j=>{var H=Jm(),O=g(H);Go(g(O),{placeholder:"Search scripts...",get isLoading(){return f()},disabled:!1,get actions(){return w},actionLabelFn:J=>J?.name||"",get items(){return t(z)},get selectedItem(){return t(o)},itemTitle:"Available scripts",itemLabelFn:J=>J?.name||"",itemKeyFn:J=>`${J?.path}-${J?.location}-${J?.name}`,isItemSelected:(J,te)=>J===null&&te===null||!(!J||!te)&&J.path===te.path,noItemsLabel:"No scripts found",loadingLabel:"Loading scripts...",get searchValue(){return t(E)},set searchValue(J){T(E,J)},$$events:{openChange:J=>{J.detail&&(P(),T(E,""))},search:J=>{return te=J.detail,void T(E,te);var te},select:J=>{V(J.detail)},action:J=>q(J.detail)},children:(J,te)=>{var ne=Hm(),re=S(ne);oe(re,{name:"terminal"});var he=_(re,2);oe(he,{name:"search"}),r(J,ne)},$$slots:{default:!0,title:(J,te)=>{var ne=Vm(),re=g(ne),he=me=>{Br(me,{$$slots:{text:(fe,ge)=>{var ce=Gm(),we=g(ce);pe(()=>ze(we,t(h))),r(fe,ce)},grayText:(fe,ge)=>{var ce=Wm(),we=g(ce);pe(()=>ze(we,t(y))),r(fe,ce)}}})},$e=me=>{Br(me,{$$slots:{text:(fe,ge)=>{var ce=jm(),we=g(ce);pe(()=>ze(we,t(d))),r(fe,ce)}}})};b(re,me=>{t(u)?me(he):me($e,!1)}),r(J,ne)},action:(J,te)=>{const ne=Ge(()=>te.action);var re=ee(),he=S(re),$e=me=>{var fe=Km(),ge=g(fe);oe(ge,{get name(){return Ee(t(ne)),Re(()=>t(ne).icon)}});var ce=_(ge,2);Le(ce,{size:1,children:(we,Se)=>{var ie=se();pe(()=>ze(ie,(Ee(t(ne)),Re(()=>t(ne).name)))),r(we,ie)},$$slots:{default:!0}}),r(me,fe)};b(he,me=>{t(ne)&&me($e)}),r(J,re)},item:(J,te)=>{const ne=Ge(()=>te.item);var re=ee(),he=S(re),$e=me=>{{let fe=Ge(()=>(t(F),Ee(t(ne)),Re(()=>t(F)?.path===t(ne).path)));(function(ge,ce){const we=Ws(ce);ke(ce,!1);let Se=k(ce,"name",8),ie=k(ce,"path",8),Ce=k(ce,"isPath",8,!1),le=k(ce,"isRenaming",8,!1),Me=k(ce,"showPath",8,!0);const ue=Js(),{baseName:be,extension:ye}=function(ve){const Pe=ve.lastIndexOf(".");return Pe===-1?{baseName:ve,extension:""}:{baseName:ve.substring(0,Pe),extension:ve.substring(Pe)}}(Se());let de=_e(be),xe=_e(void 0);function Oe(ve){if(ve.key!=="ArrowLeft"&&ve.key!=="ArrowRight"&&ve.key!=="ArrowUp"&&ve.key!=="ArrowDown")if(ve.key==="Enter")if(ve.preventDefault(),t(de).trim()&&t(de)!==be){const Pe=t(de).trim()+ye;ue("rename",{oldName:Se(),newName:Pe})}else ue("cancelRename");else ve.key==="Escape"&&(ve.preventDefault(),ve.stopPropagation(),ue("cancelRename"));else ve.stopPropagation()}function De(){ue("cancelRename")}Ne(()=>(Ee(le()),t(xe)),()=>{le()&&t(xe)&&setTimeout(()=>{t(xe)?.focus(),t(xe)?.select()},0)}),hn(),wt();var Ue=Um();let Ie;var Ke=g(Ue),qe=ve=>{var Pe=Om(),Je=g(Pe);Et(Je,ce,"icon",{},null),r(ve,Pe)};b(Ke,ve=>{Re(()=>we.icon)&&ve(qe)});var Te=_(Ke,2),Ye=g(Te),it=ve=>{var Pe=Fm(),Je=g(Pe),Xe=g(Je);Nr(Xe,{size:1,variant:"surface",get value(){return t(de)},set value(et){T(de,et)},get textInput(){return t(xe)},set textInput(et){T(xe,et)},$$events:{keydown:Oe,blur:De},$$legacy:!0});var st=_(Xe,2),nt=et=>{var ht=Nm(),dt=g(ht);pe(()=>ze(dt,ye)),r(et,ht)};b(st,et=>{ye&&et(nt)}),Nt("click",Pe,Xs(function(et){vn.call(this,ce,et)})),Nt("mousedown",Pe,Xs(function(et){vn.call(this,ce,et)})),r(ve,Pe)},lt=ve=>{var Pe=Bm(),Je=S(Pe),Xe=g(Je),st=_(Je,2),nt=et=>{var ht=qm(),dt=g(ht);pe(()=>ze(dt,ie())),r(et,ht)};b(st,et=>{Me()&&et(nt)}),pe(()=>ze(Xe,Se())),r(ve,Pe)};b(Ye,ve=>{le()?ve(it):ve(lt,!1)});var Ve=_(Te,2),rt=g(Ve);Et(rt,ce,"default",{},null),pe(ve=>Ie=Lt(Ue,1,"c-setup-script-selector__script-item-content svelte-1fvykqe",null,Ie,ve),[()=>({"c-setup-script-selector__script-item-content--renaming":le(),"c-setup-script-selector__script-item-content--is-path":Ce()})]),r(ge,Ue),Ae()})(me,{get name(){return Ee(t(ne)),Re(()=>t(ne).name)},get path(){return Ee(t(ne)),Re(()=>t(ne).path)},isPath:!0,showPath:!1,get isRenaming(){return t(fe)},$$events:{rename:ge=>async function(ce,we){const{oldName:Se,newName:ie}=we.detail;try{const Ce=await C.renameSetupScript(Se,ie,ce.location);if(Ce.success){await P();const le=t(A).find(Me=>Me.path===Ce.path);le&&V(le)}else console.error("Failed to rename script:",Ce.error),X(`Failed to rename script: ${Ce.error||"Unknown error"}`)}catch(Ce){console.error("Error renaming script:",Ce),X(`Error renaming script: ${Ce instanceof Error?Ce.message:String(Ce)}`)}finally{K()}}(t(ne),ge),cancelRename:K},children:(ge,ce)=>{var we=Xm(),Se=S(we);je(Se,{content:"Open script in editor",nested:!1,children:(le,Me)=>{vt(le,{size:1,variant:"ghost-block",class:"c-setup-script-selector__action-button",$$events:{click:ue=>{ue.stopPropagation(),L(t(ne)),V(t(ne))}},children:(ue,be)=>{oe(ue,{name:"external-link"})},$$slots:{default:!0}})},$$slots:{default:!0}});var ie=_(Se,2);je(ie,{content:"Rename script",nested:!1,children:(le,Me)=>{vt(le,{size:1,variant:"ghost-block",class:"c-setup-script-selector__action-button",$$events:{click:ue=>{ue.stopPropagation(),async function(be,ye){T(F,be)}(t(ne))}},children:(ue,be)=>{oe(ue,{name:"pen"})},$$slots:{default:!0}})},$$slots:{default:!0}});var Ce=_(ie,2);je(Ce,{content:"Delete script",nested:!1,children:(le,Me)=>{vt(le,{variant:"ghost-block",class:"c-setup-script-selector__action-button",$$events:{click:ue=>{ue.stopPropagation(),async function(be,ye){try{const de=await C.deleteSetupScript(be.name,be.location);de.success?(t(o)?.path===be.path&&V(null),await P()):(console.error("Failed to delete script:",de.error),X(`Failed to delete script: ${de.error||"Unknown error"}`))}catch(de){console.error("Error deleting script:",de),X(`Error deleting script: ${de instanceof Error?de.message:String(de)}`)}}(t(ne))}},children:(ue,be)=>{oe(ue,{name:"trash-2"})},$$slots:{default:!0}})},$$slots:{default:!0}}),r(ge,we)},$$slots:{default:!0}})}};b(he,me=>{t(ne)&&me($e)}),r(J,re)}},$$legacy:!0}),r(j,H)};b(B,j=>{t(l),Ee(m()),Re(()=>!t(l)||m()===W.noScriptsFound)&&j(Q)});var Z=_(B,2),ae=j=>{var H=Zm(),O=g(H);ns(O,{color:"warning",variant:"soft",size:2,children:(J,te)=>{var ne=Qm(),re=g(ne),he=g(re),$e=_(re,2);Mt($e,{variant:"ghost",color:"warning",size:1,get loading(){return f()},$$events:{click:P},children:(me,fe)=>{var ge=se("Refresh");r(me,ge)},$$slots:{default:!0,iconLeft:(me,fe)=>{var ge=Ym(),ce=g(ge);oe(ce,{name:"refresh-ccw"}),r(me,ge)}}}),pe(()=>ze(he,m())),r(J,ne)},$$slots:{default:!0}}),r(j,H)};b(Z,j=>{t(l),Ee(m()),Re(()=>t(l)&&m()!==W.noScriptsFound)&&j(ae)}),r(i,U),Ae(),a()}const za="You can only have %MAX_AGENTS% agents at a time. Please delete some before creating a new one.",Ca="You can only have %MAX_AGENTS% active agents at a time. Please pause some before creating a new one.";var nf=v('<div slot="iconLeft"><!></div>'),sf=v('<div class="agent-limit-message svelte-14aml4z"><p class="svelte-14aml4z"> </p> <!></div>');function rf(i,e){ke(e,!1);const n=()=>Y(d,"$remoteAgentsModel",s),[s,a]=at(),o=_e(),l=_e();let c=k(e,"agentLimitErrorMessage",28,()=>{});const d=Fe(an.key);let u=!1,h=_e(),y=_e(),m=_e(),f=_e([]);function $(){return n().agentOverviews.sort((A,E)=>new Date(A.started_at).getTime()-new Date(E.started_at).getTime())}function R(A){if(!A)return;const E=A.is_setup_script_agent?"Setup script generation":A.session_summary||"";return{id:A.remote_agent_id,title:E.length>30?E.substring(0,27)+"...":E}}function C(A,E){return A.replace("%MAX_AGENTS%",E.toString())}Ne(()=>n(),()=>{T(o,!!n().maxRemoteAgents&&n().agentOverviews.length>=n().maxRemoteAgents)}),Ne(()=>(n(),yr),()=>{T(l,!!n().maxActiveRemoteAgents&&n().agentOverviews.filter(A=>A.workspace_status===yr.workspaceRunning).length>=n().maxActiveRemoteAgents)}),Ne(()=>(t(o),t(f),t(h),n(),t(l),t(y),Ca),()=>{if(t(o))T(f,$()),T(h,R(t(f)[0])),c(C(za,n().maxRemoteAgents)),T(m,"Delete Oldest Agent"+(t(h)?`: ${t(h).title}`:""));else if(t(l)){T(f,$());const A=t(f).filter(E=>E.workspace_status===yr.workspaceRunning);T(y,R(A[0])),c(C(Ca,n().maxActiveRemoteAgents)),T(m,"Pause Oldest Agent"+(t(y)?`: ${t(y).title}`:""))}else T(h,void 0),c(void 0)}),hn(),wt();var x=ee(),G=S(x),L=A=>{ns(A,{color:"info",variant:"soft",size:2,icon:F=>{oe(F,{name:"circle-alert"})},children:(F,z)=>{var D=sf(),M=g(D),w=g(M),W=_(M,2);Mt(W,{variant:"soft",color:"neutral",size:1,$$events:{click:()=>{t(l)?async function(){if(!u&&t(y)?.id)try{u=!0,await d.pauseRemoteAgentWorkspace(t(y).id)}catch(P){console.error("Failed to pause oldest active agent:",P)}finally{u=!1}}():async function(){if(!u&&t(h)?.id)try{u=!0,await d.deleteAgent(t(h).id)}catch(P){console.error("Failed to delete oldest agent:",P)}finally{u=!1}}()}},children:(P,K)=>{var X=se();pe(()=>ze(X,t(m))),r(P,X)},$$slots:{default:!0,iconLeft:(P,K)=>{var X=nf(),q=g(X),V=U=>{oe(U,{name:"pause"})},N=U=>{oe(U,{name:"trash-2"})};b(q,U=>{t(l)?U(V):U(N,!1)}),r(P,X)}}}),pe(P=>ze(w,P),[()=>(t(o),Ee(za),Ee(Ca),n(),Re(()=>(t(o)?za:Ca).replace("%MAX_AGENTS%",(t(o)?n().maxRemoteAgents:n().maxActiveRemoteAgents).toString())))]),r(F,D)},$$slots:{icon:!0,default:!0}})};b(G,A=>{c()&&A(L)}),r(i,x),Ae(),a()}var af=v('<div class="error-message svelte-1r7cchd"><!></div>'),of=v('<div class="remote-agent-setup svelte-1r7cchd"><div class="content svelte-1r7cchd"><div class="form-fields"><div class="error-message svelte-1r7cchd"><!></div> <!> <div class="commit-ref-selector svelte-1r7cchd"><!></div> <div class="setup-script svelte-1r7cchd"><!> <!></div></div></div></div>'),lf=v('<div class="c-toggle-mode-button__text svelte-587d52"> </div>'),cf=v('<div class="c-toggle-mode-button__icon" slot="iconLeft"><!></div>');const df="new-thread-button";var uf=v('<div class="c-mode-display-dropdown"><!> <!> <!></div>'),hf=v("<!> <!>",1),gf=v("<!> <!>",1),vf=v('<div slot="content" class="c-select-mode-dropdown__tooltip svelte-dwgejw"> <!></div>'),pf=v('<div class="c-select-mode-dropdown svelte-dwgejw"><!> <!></div>');function mf(i,e){ke(e,!0);const n=()=>Y(t(R),"$isCurrConversationAgentic",c),s=()=>Y(t(C),"$agentExecutionMode",c),a=()=>Y(u,"$remoteAgentsModel",c),o=()=>Y($,"$enableAgentMode",c),l=()=>Y(f,"$enableBackgroundAgents",c),[c,d]=at(),u=Fe(an.key),h=Fe(Ys.key),y=Fe("chatModel"),m=Fe("agentConversationModel"),f=_t("enableBackgroundAgents"),$=_t("enableAgentMode");let R=p(()=>m?.isCurrConversationAgentic),C=p(()=>y?.agentExecutionMode),x=p(()=>Ya({isConversationAgentic:!!t(R)&&n(),agentExecutionMode:t(C)?s():void 0,isBackgroundAgent:!!u&&a().isActive})),G=p(()=>t(x).type==="remoteAgent"?"New Remote Agent":t(x).type==="localAgent"?"New Agent":"New Chat");async function L(){const N=qo(t(x).type);await u.reportRemoteAgentNewThreadButtonEvent(Eo.click,N),h.createThreadOfCurrentType(),y.eventTracker?.trackEvent(us.THREAD_CREATION_ATTEMPTED,{source:"button"})}async function A(){const N=qo(t(x).type);await u.reportRemoteAgentNewThreadButtonEvent(Eo.click,N),h.createThreadOfCurrentType()}let E=p(()=>m.hasEverUsedAgent),F=p(()=>u?.hasEverUsedRemoteAgent),z=ct(void 0);function D(N){N?h.reportModeSelectorOpen():h.reportModeSelectorClose()}function M(){h.reportModeSelectorEvent(Lr.select,Dr.chat),h.handleSetToChat(),t(z)?.requestClose()}async function w(){await h.reportModeSelectorEvent(Lr.select,Dr.agent),h.handleSetToAgent(s()),Y(t(E),"$hasEverUsedAgent",c)===!1&&m.setHasEverUsedAgent(!0),t(z)?.requestClose()}function W(){h.reportModeSelectorEvent(Lr.select,Dr.remoteAgent),h.handleSetToBackgroundAgent(),Y(t(F),"$hasEverUsedRemoteAgent",c)===!1&&u?.setHasEverUsedRemoteAgent(!0),t(z)?.requestClose()}const P="neutral";var K=pf(),X=g(K),q=N=>{var U=gf(),I=S(U);Wn(I,{name:"newConversation",handler:A});var B=_(I,2);Qe(B,()=>He.Root,(Q,Z)=>{pn(Z(Q,{onOpenChange:D,nested:!1,children:(ae,j)=>{var H=hf(),O=S(H);Qe(O,()=>He.Trigger,(te,ne)=>{ne(te,{$$events:{click:re=>{re.stopPropagation()}},children:(re,he)=>{{let $e=p(()=>a()?.isActive);(function(me,fe){ke(fe,!0);const ge=k(fe,"variant",3,"ghost"),ce=k(fe,"color",3,"neutral"),we=k(fe,"disabled",3,!1),Se=k(fe,"hideText",3,!1),ie=p(()=>Ya({isConversationAgentic:fe.isCurrConversationAgentic,agentExecutionMode:fe.agentExecutionMode,isBackgroundAgent:!!fe.isBackgroundAgent}));Mt(me,{size:.5,get variant(){return ge()},get color(){return ce()},get disabled(){return we()},children:(Ce,le)=>{var Me=ee(),ue=S(Me),be=ye=>{var de=lf(),xe=g(de);pe(()=>ze(xe,t(ie).primaryText)),r(ye,de)};b(ue,ye=>{Se()||ye(be)}),r(Ce,Me)},$$slots:{default:!0,iconLeft:(Ce,le)=>{var Me=cf(),ue=g(Me);oe(ue,{get name(){return t(ie).icon},size:1}),r(Ce,Me)},iconRight:(Ce,le)=>{Gd(Ce,{slot:"iconRight"})}}}),Ae()})(re,{hideText:!0,get isCurrConversationAgentic(){return n()},get agentExecutionMode(){return s()},get isBackgroundAgent(){return t($e)},variant:"ghost",color:P})}},$$slots:{default:!0}})});var J=_(O,2);Qe(J,()=>He.Content,(te,ne)=>{ne(te,{size:1,side:"bottom",align:"start",children:(re,he)=>{var $e=uf(),me=g($e),fe=Se=>{{let ie=p(()=>t(x).type==="localAgent");Or(Se,{onSelect:w,isConversationAgentic:!0,get selected(){return t(ie)}})}};b(me,Se=>{o()&&Se(fe)});var ge=_(me,2);{let Se=p(()=>t(x).type==="chat");Or(ge,{onSelect:M,isConversationAgentic:!1,get selected(){return t(Se)}})}var ce=_(ge,2),we=Se=>{{let ie=p(()=>t(x).type==="remoteAgent");Or(Se,{onSelect:W,isBackgroundAgent:!0,get selected(){return t(ie)}})}};b(ce,Se=>{l()&&Se(we)}),r(re,$e)},$$slots:{default:!0}})}),r(ae,H)},$$slots:{default:!0}}),ae=>T(z,ae,!0),()=>t(z))}),r(N,U)};b(X,N=>{(o()||l())&&N(q)});var V=_(X,2);je(V,{side:"top",nested:!1,children:(N,U)=>{vt(N,{size:.5,variant:"ghost-block",color:P,class:"c-select-mode-dropdown__new-thread-button","data-testid":df,$$events:{click:L},children:(I,B)=>{oe(I,{name:"plus"})},$$slots:{default:!0}})},$$slots:{default:!0,content:(N,U)=>{var I=vf(),B=g(I),Q=_(B);hs(Q,{commandName:"newConversation",keysOnly:!0}),pe(()=>ze(B,`${t(G)??""} `)),r(N,I)}}}),r(i,K),Ae(),d()}var ff=v('<div class="c-notification-content svelte-16xyaeg"><!></div>'),_f=v('<div class="c-notification-badge svelte-16xyaeg"></div>'),yf=v("<div><!> <!></div>");function to(i,{delay:e=0,duration:n=400,easing:s=Eg,axis:a="y",scale:o=0}={}){const l=getComputedStyle(i),c=+l.opacity,d=a==="y"?"height":"width",u=parseFloat(l[d]),h=a==="y"?"scaleY":"scaleX",y=a==="y"?["top","bottom"]:["left","right"],m=y.map(L=>`${L[0].toUpperCase()}${L.slice(1)}`),f=parseFloat(l[`padding${m[0]}`]||"0"),$=parseFloat(l[`padding${m[1]}`]||"0"),R=parseFloat(l[`margin${m[0]}`]||"0"),C=parseFloat(l[`margin${m[1]}`]||"0"),x=parseFloat(l[`border${m[0]}Width`]||"0"),G=parseFloat(l[`border${m[1]}Width`]||"0");return{delay:e,duration:n,easing:s,css:L=>{const A=o+(1-o)*L;return`overflow: hidden;opacity: ${L*c};${d}: ${L*u}px;padding-${y[0]}: ${L*f}px;padding-${y[1]}: ${L*$}px;margin-${y[0]}: ${L*R}px;margin-${y[1]}: ${L*C}px;border-${y[0]}-width: ${L*x}px;border-${y[1]}-width: ${L*G}px;transform: ${h}(${A});transform-origin: center;`}}}function fl(i,e,n,s,a,o){e()&&i.key==="Enter"?n()&&s()&&(i.ctrlKey||i.metaKey||i.altKey||i.shiftKey)||(i.preventDefault(),a()):i.key==="Escape"&&(i.preventDefault(),o())}function $f(i,e,n,s){(e()||s()&&i.detail===2)&&n()}var bf=v('<textarea style="field-sizing: content;" class="c-inline-edit-text-augment__input-field svelte-1grfd3z" rows="1"></textarea>'),wf=v('<input style="field-sizing: content;" class="c-inline-edit-text-augment__input-field svelte-1grfd3z" type="text"/>'),Cf=v('<div class="c-inline-edit-text-augment__input svelte-1grfd3z"><!> <!></div>'),kf=(i,e)=>{i.key==="Enter"&&e()},Af=v('<div role="button"><!></div>'),Sf=v("<div><!> <!></div>");function Fc(i,e){ke(e,!0);let n=k(e,"isEditable",3,!0),s=k(e,"isEditing",15,!1);je(i,{content:"Rename",nested:!1,hasPointerEvents:!1,children:(a,o)=>{(function(l,c){ke(c,!0);let d=k(c,"value",15,""),u=k(c,"placeholder",3,""),h=k(c,"disabled",3,!1),y=k(c,"size",3,2),m=k(c,"class",3,""),f=k(c,"isEditing",15,!1),$=k(c,"isEditable",3,!0),R=k(c,"multiline",3,!0),C=k(c,"showCommitButton",3,!0),x=k(c,"commitOnBlur",3,!0),G=k(c,"commitOnEnter",3,!0),L=k(c,"allowCtrlEnterForNewline",3,!0),A=k(c,"doubleClickToEdit",3,!0),E=k(c,"singleClickToEdit",3,!1),F=k(c,"onCancelEdit",3,j=>{}),z=k(c,"onStartEdit",3,()=>{}),D=k(c,"onChange",3,(j,H)=>{}),M=k(c,"commitButtonVariant",3,"classic"),w=k(c,"commitButtonColor",3,"accent"),W=ct(void 0),P=ct(void 0),K=ct(Cr(d()));function X(){T(K,d(),!0),f(!1),F()(d())}function q(){$()&&!h()&&(f()||(z()(),f(!0)),setTimeout(()=>{t(W)?.focus()},0))}function V(){const j=t(K).trim(),H=d();j!==H&&(d(j),D()(j,H)),setTimeout(()=>{t(W)?.blur()},0),f(!1)}function N(){x()&&f()&&V()}zt(()=>{f()||T(K,d(),!0)}),zt(()=>{f()&&q()}),mn(()=>{const j=H=>{f()&&(c.outsideNode||t(P))?.contains(H.target)===!1&&(x()?V():X())};return document.addEventListener("click",j),()=>{document.removeEventListener("click",j)}});var U=Sf();let I;var B=g(U),Q=j=>{var H=Cf(),O=g(H);Le(O,{get size(){return y()},get weight(){return c.weight},get color(){return c.color},children:(ne,re)=>{var he=ee(),$e=S(he),me=ge=>{var ce=bf();ce.__keydown=[fl,G,R,L,V,X],pn(ce,we=>T(W,we),()=>t(W)),pe(()=>{en(ce,"placeholder",u()),ce.disabled=h()}),Nt("blur",ce,N),Xa(ce,()=>t(K),we=>T(K,we)),r(ge,ce)},fe=ge=>{var ce=wf();ce.__keydown=[fl,G,R,L,V,X],pn(ce,we=>T(W,we),()=>t(W)),pe(()=>{en(ce,"placeholder",u()),ce.disabled=h()}),Nt("blur",ce,N),Xa(ce,()=>t(K),we=>T(K,we)),r(ge,ce)};b($e,ge=>{R()?ge(me):ge(fe,!1)}),r(ne,he)},$$slots:{default:!0}});var J=_(O,2),te=ne=>{vt(ne,{size:1,get variant(){return M()},get color(){return w()},get disabled(){return h()},$$events:{click:V},children:(re,he)=>{oe(re,{name:"check"})},$$slots:{default:!0}})};b(J,ne=>{C()&&ne(te)}),Mn(3,H,()=>to,()=>({axis:"y",duration:150,scale:.9})),r(j,H)};b(B,j=>{$()&&!h()&&f()&&j(Q)});var Z=_(B,2),ae=j=>{var H=Af();let O;H.__click=[$f,E,q,A],H.__keydown=[kf,q];var J=g(H),te=re=>{var he=ee(),$e=S(he);Rt($e,()=>c.children),r(re,he)},ne=re=>{Le(re,{get size(){return y()},get weight(){return c.weight},get color(){return c.color},get value(){return d()},get placeholder(){return u()},children:(he,$e)=>{var me=se();pe(()=>ze(me,d()||u())),r(he,me)},$$slots:{default:!0}})};b(J,re=>{c.children?re(te):re(ne,!1)}),pe(re=>{O=Lt(H,1,"c-inline-edit-text-augment__text svelte-1grfd3z",null,O,re),en(H,"tabindex",$()&&!h()?0:void 0),en(H,"aria-label",d()||u())},[()=>({"c-inline-edit-text-augment__text--editable":$()&&!h()})]),Mn(3,H,()=>to,()=>({axis:"y",duration:150,scale:.9})),r(j,H)};b(Z,j=>{f()||j(ae)}),pn(U,j=>T(P,j),()=>t(P)),pe(j=>I=Lt(U,1,`c-inline-edit-text-augment ${m()??""}`,"svelte-1grfd3z",I,j),[()=>({"c-inline-edit-text-augment--is-editing":f(),"c-inline-edit-text-augment--disabled":h(),"c-inline-edit-text-augment--is-editable":$()})]),r(l,U),Ae()})(a,{size:1,weight:"bold",get value(){return e.title},color:"primary",get isEditable(){return n()},showCommitButton:!1,singleClickToEdit:!0,get onChange(){return e.onRename},get isEditing(){return s()},set isEditing(l){s(l)}})},$$slots:{default:!0}}),Ae()}function Mf(i,e){ke(e,!0);const[n,s]=at();let a=k(e,"isEditing",15,!1);const o=Fe(an.key),l=p(()=>Y(o,"$remoteAgentsModel",n).currentAgent),c=p(()=>t(l)?.remote_agent_id),d=p(()=>rc(t(l))),u=p(()=>t(l)?.is_setup_script_agent||!1);{let h=p(()=>t(u)?"Generate a setup script":t(d)),y=p(()=>!t(u));Fc(i,{get title(){return t(h)},get isEditable(){return t(y)},onRename:async function(m){if(m.trim()&&m!==t(d)&&t(c))try{o&&await o.updateRemoteAgentTitle(t(c),m)}catch(f){console.error("Failed to update remote agent title:",f)}},get isEditing(){return a()},set isEditing(m){a(m)}})}Ae(),s()}function xf(i,e){ke(e,!0);const[n,s]=at();let a=k(e,"isEditing",15,!1);const o=Fe(an.key),l=la();var c=ee(),d=S(c),u=y=>{Mf(y,{get isEditing(){return a()},set isEditing(m){a(m)}})},h=y=>{var m=ee(),f=S(m),$=R=>{(function(C,x){ke(x,!0);const G=()=>Y(z,"$chatModel",A),L=()=>Y(M,"$conversationId",A),[A,E]=at();let F=k(x,"isEditing",15,!1);const z=Fe("chatModel"),D=p(()=>G().currentConversationModel),M=la(),w=p(()=>G().conversations[L()||""]),W=p(()=>t(w)?{...t(w),extraData:t(D)?.extraData||t(w).extraData}:void 0),P=p(()=>Ka(t(W)));Fc(C,{onRename:function(K){z.renameConversation(L()||"",K)},get title(){return t(P)},get isEditing(){return F()},set isEditing(K){F(K)}}),Ae(),E()})(R,{get isEditing(){return a()},set isEditing(C){a(C)}})};b(f,R=>{Y(l,"$conversationId",n)&&R($)},!0),r(y,m)};b(d,y=>{Y(o,"$remoteAgentsModel",n)?.isActive?y(u):y(h,!1)}),r(i,c),Ae(),s()}Os(["keydown","click"]);var Tf=v('<div slot="content" class="c-chat-header__tooltip svelte-1aejsn9">Toggle threads menu <!></div>'),Rf=v('<div class="c-chat-header__left svelte-1aejsn9"><!></div>'),Ef=v('<div class="c-chat-header__right-actions svelte-1aejsn9"><!></div>'),If=v('<div class="c-chat-header svelte-1aejsn9"><!> <div class="c-chat-header__title svelte-1aejsn9"><!></div> <!></div>');function zf(i,e){const n=k(e,"shouldShowThreadsList",3,!1),s=k(e,"onOpenThreads",3,()=>{});let a=ct(!1);var o=If(),l=g(o),c=y=>{var m=Rf(),f=g(m);je(f,{side:"bottom",nested:!1,children:($,R)=>{vt($,{class:"c-chat-header__menu-btn",variant:"ghost-block",color:"neutral",size:.5,get onclick(){return s()},children:(C,x)=>{(function(G,L){ke(L,!0);const A=()=>Y(z,"$remoteAgentsModel",E),[E,F]=at(),z=Fe(an.key);let D=p(()=>A().isActive?A().currentAgentId:null),M=p(()=>(A().agentOverviews||[]).filter(N=>!!N.has_updates&&N.remote_agent_id!==t(D)&&N.status===In.agentIdle).length),w=p(()=>t(M)>0);var W=yf();let P;var K=g(W),X=N=>{var U=ff(),I=g(U);Rt(I,()=>L.children),r(N,U)};b(K,N=>{L.children&&N(X)});var q=_(K,2),V=N=>{var U=_f();Mn(3,U,()=>Ja,()=>({duration:200,start:0})),r(N,U)};b(q,N=>{t(w)&&N(V)}),pe(N=>P=Lt(W,1,"c-notification-wrapper svelte-16xyaeg",null,P,N),[()=>({"has-notification":t(w)})]),r(G,W),Ae(),F()})(C,{children:(G,L)=>{oe(G,{name:"menu",size:2})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0,content:($,R)=>{var C=Tf(),x=_(g(C));hs(x,{commandName:"toggleThreadsPanel",keysOnly:!0}),r($,C)}}}),r(y,m)};b(l,y=>{n()&&!t(a)&&y(c)});var d=_(l,2);xf(g(d),{get isEditing(){return t(a)},set isEditing(y){T(a,y,!0)}});var u=_(d,2),h=y=>{var m=Ef();mf(g(m),{}),r(y,m)};b(u,y=>{t(a)||y(h)}),r(i,o)}function qc(i,e){ke(e,!0);let n=k(e,"isAskMode",3,!1),s=k(e,"onAskModeChange",19,()=>{}),a=k(e,"onAskModeToggleComplete",19,()=>{});const o=new ac;mn(()=>{s()&&o.setOnAskModeChange(s()),o.setAskMode(n(),a())}),zt(()=>{o.setAskMode(n(),a())});const l=Fe(ua.CONTEXT_KEY).pluginManager.registerPlugin(o);return As(()=>{o.setAskMode(!1,a()),l()}),Ae({getAskModePrompt:()=>o.askModePrompt,getIsAskMode:()=>o.isAskMode})}const Df=Dt(!1),Lf="application/x-augment/drag-origin/{}";function _l(i){return Lf.replace("{}",i.instanceId)}var Pf=v("<!> <!> <!>",1),Of=v('<div role="button" tabindex="-1"><div class="c-rich-text-editor-dropzone__content svelte-kc9dup"><!></div></div>');function Bc(i,e){ke(e,!1);const[n,s]=at();let a=k(e,"draggingStore",8,Df);const o=_t("enableDebugFeatures"),l=Fe(ua.CONTEXT_KEY);let c=_e();a().subscribe(f=>T(c,f));const d=()=>a().set(!1);wt();var u=Of();let h;Nt("dragstart",ts,f=>function($,R){R.rootNode&&$.composedPath().includes(R.rootNode)&&$.dataTransfer?.setData(_l(R),R.instanceId)}(f,l)),Nt("dragenter",ts,f=>{(function($,R){return $.dataTransfer?.types.includes(_l(R))??!1})(f,l)||f.dataTransfer?.types.includes("Files")&&a().set(!0)}),Nt("dragleave",ts,function(f){f.relatedTarget&&f.relatedTarget!==document.body||a().set(!1)}),Nt("drop",ts,d),Nt("blur",ts,d);var y=g(u),m=g(y);Et(m,e,"default",{},f=>{var $=Pf(),R=S($);wg(R);var C=_(R,2);Le(C,{class:"c-rich-text-editor-dropzone__text",size:2,children:(G,L)=>{var A=se("Drop files to attach as context");r(G,A)},$$slots:{default:!0}});var x=_(C,2);Le(x,{class:"c-rich-text-editor-dropzone__text",size:1,children:(G,L)=>{var A=se();pe(()=>ze(A,Y(o,"$enableDebugFeatures",n)?"images (png, jpg, jpeg) and text-based files":"images (png, jpg, jpeg)")),r(G,A)},$$slots:{default:!0}}),r(f,$)}),pe(f=>h=Lt(u,1,"c-rich-text-editor-dropzone svelte-kc9dup",null,h,f),[()=>({"is-active":t(c)})]),Nt("dragover",u,or(Xs(function(f){vn.call(this,e,f)}))),Nt("dragenter",u,or(Xs(function(f){vn.call(this,e,f)}))),Nt("drop",u,or(Xs(function(f){a().set(!1),f.dataTransfer?.files&&l?.commandManager.chain()?.command(({view:$,tr:R})=>{if(!$)return!0;const C=$.posAtCoords({left:f.clientX,top:f.clientY});if(C){const x=R.doc.resolve(C.pos);R.setSelection(Fh.create(R.doc,x.pos))}return!0}).insertFilesIntoEditor?.([...f.dataTransfer?.files??[]])}))),r(i,u),Ae(),s()}const Nf=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Ff=qh.create({name:"image",addOptions:()=>({inline:!1,allowBase64:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:i}){return["img",Uh(this.options.HTMLAttributes,i)]},addCommands(){return{setImage:i=>({commands:e})=>e.insertContent({type:this.name,attrs:i})}},addInputRules(){return[Bh({find:Nf,type:this.type,getAttributes:i=>{const[,,e,n,s]=i;return{src:n,alt:e,title:s}}})]}}),Da=10,La=1024,Pa=24,Uc=[".png",".jpg",".jpeg",".gif",".webp",".svg",".bmp",".js",".jsx",".ts",".tsx",".py",".java",".c",".cpp",".h",".hpp",".cs",".go",".rs",".swift",".kt",".scala",".rb",".php",".html",".css",".scss",".sass",".less",".svelte",".vue",".json",".yaml",".yml",".toml",".ini",".cfg",".conf",".xml",".plist",".properties",".env",".md",".txt",".rst",".tex",".sh",".bash",".zsh",".fish",".sql",".graphql",".gradle",".pom",".bazel",".bzl",".dockerfile",".makefile",".proto",".mod",".hs",".lua",".dart",".r",".m",".pl",".ps1",".csv",".tsv"];function qf(i){const e=function(s){if(!s)return[];const a=[],o=l=>{if(l&&(l.type==="file"&&l.attrs&&a.push({src:l.attrs.src||"",title:l.attrs.title||"",fileSizeBytes:Number(l.attrs.fileSizeBytes)||0,isLoading:!!l.attrs.isLoading}),l.content&&Array.isArray(l.content)))for(const c of l.content)o(c)};return o(s),a}(i),n=e.filter(s=>!s.isLoading);return{imageCount:n.length,imageSizeSumKb:Math.round(n.reduce((s,a)=>s+a.fileSizeBytes,0)/1024)}}function Bf(i){const e=function(s){if(!s)return[];const a=[],o=l=>{if(l&&(l.type==="file"&&l.attrs&&((l.attrs.mimeType||"").startsWith("image/")||a.push({src:l.attrs.src||"",title:l.attrs.title||"",fileSizeBytes:Number(l.attrs.fileSizeBytes)||0,isLoading:!!l.attrs.isLoading})),l.content&&Array.isArray(l.content)))for(const c of l.content)o(c)};return o(s),a}(i),n=e.filter(s=>!s.isLoading);return{textSizeSumKb:Math.round(n.reduce((s,a)=>s+a.fileSizeBytes,0)/1024)}}function Hc(i){const e=qf(i),n=Bf(i),{imageCount:s,imageSizeSumKb:a}=e,{textSizeSumKb:o}=n,l=s>Da&&Da>0,c=a>La&&La>0,d=o>Pa&&Pa>0,u=l||c||d,h=[l?`Up to ${Da} images are supported.`:null,c?`Total image size exceeds the ${La}KB limit. Current size: ${a}KB`:null,d?`Total text file size exceeds the ${Pa}KB limit. Current size: ${o}KB`:null].filter(Boolean);return{hasWarning:u,warningMessage:h.length>0?h[0]:"",warningMessages:h}}class Wo extends Error{files;constructor(e,n){super(n),this.files=e,this.name="FileError"}}class Uf extends Wo{constructor(e,n){const s=n.join(" and ");super([e],`File "${e.name}" not supported, only attach ${s} files.`)}}function Hf(i,e){return function(n,s){if(s.includes("image")&&n.type.startsWith("image/"))return!0;if(!s.includes("text"))return!1;if(n.type.startsWith("text/")||["application/json","application/xml","application/javascript","application/typescript","application/x-sh","application/x-shellscript","application/x-yaml","application/yaml"].includes(n.type))return!0;const a=n.name.toLowerCase(),o=function(){const l=[".png",".jpg",".jpeg",".gif",".webp",".svg",".bmp"];return Uc.filter(c=>!l.includes(c))}();for(const l of o)if(a.endsWith(l.toLowerCase()))return!0;return!!["dockerfile",".gitignore",".gitattributes","makefile","readme","license","changelog","authors","contributors","copying","install","news","todo",".env.example",".env.local",".env.development",".env.production"].includes(a)}(i,e.supportedFileTypes)?i:new Uf(i,e.supportedFileTypes)}function yl(i){return i.type.startsWith("image/")}var Gf=i=>{i.preventDefault()},Wf=(i,e)=>{e(i)},jf=v('<button class="c-image-chip__close svelte-ttks0w" aria-label="Remove image"></button>'),Vf=v('<div class="c-image-chip__loading svelte-ttks0w"><!></div>'),Kf=v('<div class="c-image-chip__file-extension svelte-ttks0w"> </div>'),Xf=v('<div class="c-image-chip__image-modal-container svelte-ttks0w"><img alt="" class="c-image-chip__image svelte-ttks0w"/></div>'),Jf=v('<div class="c-image-chip__image-container svelte-ttks0w" role="button" tabindex="0"><img alt="" class="c-image-chip__image svelte-ttks0w"/></div> <!>',1),Yf=v('<div class="c-image-chip__file-icon svelte-ttks0w"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"></path></svg></div>'),Qf=v('<div class="c-image-chip__loading svelte-ttks0w"><!></div>'),Zf=v('<div class="c-image-chip__size-loading svelte-ttks0w"><!></div>'),e_=v('<span class="c-image-chip__warning-icon svelte-ttks0w"></span>'),t_=v("<!> ",1),n_=v('<div role="button" tabindex="0"><!> <div class="c-image-render__chip-preview svelte-ttks0w"><!></div> <div class="c-image-chip__info svelte-ttks0w"><div class="c-image-chip__filename svelte-ttks0w"> </div> <div class="c-image-chip__size svelte-ttks0w"><!></div></div></div>');function s_(i,e){ke(e,!0);let n=k(e,"isLoading",3,!1),s=k(e,"isOverLimit",3,!1),a=k(e,"fileSizeBytes",3,0),o=ct(!1);function l(){t(c)&&T(o,!t(o))}let c=ct(void 0);var d=n_();let u;d.__click=[Gf],d.__keydown=[Wf,function(z){z.key!=="ArrowUp"&&z.key!=="ArrowDown"&&z.key!=="ArrowLeft"&&z.key!=="ArrowRight"||(z.preventDefault(),z.stopPropagation())}];var h=g(d),y=z=>{var D=jf(),M=p(()=>Xs(e.removeImage));D.__click=function(...w){t(M)?.apply(this,w)},r(z,D)};b(h,z=>{e.isEditable()&&z(y)});var m=_(h,2),f=g(m),$=z=>{var D=Vf(),M=g(D);Dn(M,{size:1}),r(z,D)},R=z=>{var D=ee(),M=S(D),w=P=>{var K=Kf(),X=g(K);pe(q=>ze(X,q),[()=>Fg(e.title)||e.title]),r(P,K)},W=P=>{var K=ee(),X=S(K);mc(X,()=>e.loadImage(e.src),q=>{var V=Qf(),N=g(V);Dn(N,{size:1}),r(q,V)},(q,V)=>{var N=ee(),U=S(N),I=Q=>{var Z=Jf(),ae=S(Z);ae.__click=l,ae.__keydown=l;var j=g(ae);pn(j,O=>T(c,O),()=>t(c));var H=_(ae,2);fc(H,{get show(){return t(o)},$$events:{click:l,backdropClick:l},children:(O,J)=>{var te=Xf(),ne=g(te);pe(()=>en(ne,"src",t(V))),r(O,te)},$$slots:{default:!0}}),pe(()=>en(j,"src",t(V))),r(Q,Z)},B=Q=>{var Z=Yf();r(Q,Z)};b(U,Q=>{t(V)?Q(I):Q(B,!1)}),r(q,N)}),r(P,K)};b(M,P=>{Ng(e.title)?P(W,!1):P(w)},!0),r(z,D)};b(f,z=>{n()?z($):z(R,!1)});var C=_(m,2),x=g(C),G=g(x),L=_(x,2),A=g(L),E=z=>{var D=Zf(),M=g(D);Dn(M,{size:1}),r(z,D)},F=z=>{var D=t_(),M=S(D),w=P=>{var K=e_();r(P,K)};b(M,P=>{s()&&P(w)});var W=_(M);pe(P=>ze(W,` ${P??""}`),[()=>a()?`${Math.round(a()/1024)}KB`:""]),r(z,D)};b(A,z=>{n()?z(E):z(F,!1)}),pe(z=>{u=Lt(d,1,"c-image-chip svelte-ttks0w",null,u,z),en(x,"title",e.title),ze(G,e.title)},[()=>({"is-over-limit":s()})]),r(i,d),Ae()}Os(["click","keydown"]);var Oa=(i=>(i.collapsed="collapsed",i.preview="preview",i.full="full",i))(Oa||{});class Hr{constructor(e){this._options=e,this._tipTapExtension=this._createTipTapExtension()}static IMAGE_PASTE_HANDLER_PLUGIN_KEY=new oc("augment-prosemirror-image-paste-handler");_tipTapExtension;_editor;_createTipTapExtension=()=>{const e=this.registerEditor,n=this.unregisterEditor,s=this.insertFilesIntoEditor;return Ff.extend({name:"file",addOptions(){return{...this.parent?.(),allowBase64:!0,preserveOnSplit:!1,defaultRenderMode:Oa.collapsed}},addAttributes(){return{...this.parent?.(),renderMode:{default:Oa.collapsed},title:{default:""},isLoading:{default:!1},fileSizeBytes:{default:0},mimeType:{default:""}}},onCreate(){this.parent?.(),e(this.editor)},onDestroy(){this.parent?.(),n()},addCommands(){return{...this.parent?.(),insertFilesIntoEditor:a=>({chain:o})=>o().command(()=>!!s(a)).focus("end").run()}},addNodeView:()=>this._createNodeView(),addProseMirrorPlugins(){return[...this.parent?.()??[],new ic({key:Hr.IMAGE_PASTE_HANDLER_PLUGIN_KEY,props:{handlePaste:(a,o)=>o.clipboardData?.files?.length?s([...o.clipboardData.files]).okFiles.length>0&&(o.preventDefault(),!0):!1}})]}})};_createNodeView=()=>({node:e})=>{const n=document.createElement("div"),s=(o,l)=>(l&&Ti(l),Rl(s_,{target:n,props:{title:String(o.attrs.title),src:String(o.attrs.src),loadImage:this._options?.renderImage??(()=>Promise.resolve(void 0)),isLoading:!!o.attrs.isLoading,fileSizeBytes:Number(o.attrs.fileSizeBytes)||0,isOverLimit:this._calculateIsOverLimit(Number(o.attrs.fileSizeBytes)||0,String(o.attrs.mimeType||"").startsWith("image/")),removeImage:async()=>{if(this._editor){try{this._options?.deleteImage&&await this._options.deleteImage(String(o.attrs.src))}catch(c){console.error("Failed to delete image:",c)}this._editor.chain().command(({tr:c,state:d})=>(d.doc.descendants((u,h)=>{if(o===u)return c.delete(h,h+u.nodeSize),!1}),!0)).focus("end").run()}},isEditable:this._options?.isEditable??(()=>!0)}}));let a=s(e,void 0);return{dom:n,destroy:()=>{Ti(a)},update:o=>o.type.name==="file"&&(e=o,a=s(o,a),!0)}};registerEditor=e=>{this._editor=e};unregisterEditor=()=>{this._editor=void 0};_getImageNodeCount=()=>{if(!this._editor)return;let e=0;return this._editor.state.doc.descendants(n=>{n.type.name==="file"&&e++}),e};_calculateIsOverLimit=(e,n=!0)=>{if(e===0)return!1;const s=n?this._options?.maxImageSizeKb:this._options?.maxTextSizeKb;return s?e>1024*s:!1};updateOptions=e=>{this._options={...e}};validateFiles(e){const n=[],s=[];for(const a of e){const o=Hf(a,this._options);o instanceof Wo?n.push(o):s.push(o)}return{validFiles:s,errors:n}}async _processImage(e,n){try{let s,a;if(yl(e)){const o=await rh(e);if(!o||!this._editor)return;s=new File([o],e.name,{type:e.type})}else s=e;a=yl(e)?await this._options?.saveImage?.(s)??s.name:await this._options?.saveAttachment?.(s)??s.name,this._updateImageNode(n,{src:a,title:s.name,isLoading:!1,fileSizeBytes:s.size,mimeType:s.type})}catch(s){throw console.error("Could not process image: ",s),this._editor&&this._removeImageNode(n),s}}insertFilesIntoEditor=e=>{const{validFiles:n,errors:s}=this.validateFiles(e),a=[];if(s.length>0&&this._options?.onValidationError)if(s.length===1)this._options.onValidationError(s[0].message);else{const o=s.map(l=>l.files.map(c=>c.name)).flatMap(l=>l);this._options.onValidationError(`Errors when attaching files: ${o.toString()}`)}for(const o of n){if(!this._editor)continue;const l=this._insertLoadingImage(this._editor,o.name);this._processImage(o,l).catch(c=>{const d=new Wo([o],String(c));a.push(d),this._options?.onValidationError&&this._options.onValidationError(d.message)})}return{errors:[...s,...a],okFiles:n}};get tipTapExtension(){return this._tipTapExtension}_findImageNodeBySrc(e){if(!this._editor||!e)return null;let n=null;return this._editor.state.doc.descendants((s,a)=>s.type.name!=="file"||s.attrs.src!==e||(n={node:s,pos:a},!1)),n}_insertLoadingImage(e,n){const{from:s}=e.state.selection,a=`${n}-${Date.now()}-${Math.random().toString(36).substring(2)}`;return e.chain().command(({tr:o})=>(o.insert(s,[e.schema.nodes.file.create({src:a,originalName:n,title:n,renderMode:Oa.collapsed,isLoading:!0}),e.schema.nodes.paragraph.create({text:""})]),!0)).run(),a}_updateImageNode(e,n){if(!this._editor)return;const s=this._findImageNodeBySrc(e);s&&this._editor.chain().command(({tr:a})=>(a.setNodeMarkup(s.pos,void 0,{...s.node.attrs,...n}),!0)).run()}_removeImageNode(e){if(!this._editor)return;const n=this._findImageNodeBySrc(e);n&&this._editor.chain().command(({tr:s})=>(s.delete(n.pos,n.pos+n.node.nodeSize),!0)).run()}static hasLoadingImages(e){if(!e)return!1;const n=s=>{if(!s)return!1;if(s.type==="file"&&s.attrs?.isLoading)return!0;if(s.content){if(!Array.isArray(s.content))return!1;for(const a of s.content)if(n(a))return!0}return!1};return n(e)}}function Gc(i,e){ke(e,!0);let n=k(e,"maxImages",19,()=>{}),s=k(e,"saveImage",19,()=>{}),a=k(e,"saveAttachment",19,()=>{}),o=k(e,"deleteImage",19,()=>{}),l=k(e,"renderImage",19,()=>{}),c=k(e,"isEditable",3,()=>!0),d=k(e,"changeImageMode",19,()=>{}),u=k(e,"supportedFileTypes",19,()=>["image"]),h=k(e,"onValidationError",19,()=>{});const y=new Hr({changeImageMode:d(),maxImages:n(),saveImage:s(),saveAttachment:a(),deleteImage:o(),renderImage:l(),isEditable:c(),onValidationError:h(),maxImageSizeKb:La,maxTextSizeKb:Pa,supportedFileTypes:u()}),m=Fe(ua.CONTEXT_KEY).pluginManager.registerPlugin(y);As(m),Ae()}var r_=v('<div class="c-text-tooltip-content__shortcut svelte-1cimtn4"><!></div>'),a_=v('<div class="c-text-tooltip-content svelte-1cimtn4"><!> <!> <!></div>');function ha(i,e){var n=a_(),s=g(n);Le(s,{size:1,weight:"medium",block:!0,children:(c,d)=>{var u=se();pe(()=>ze(u,e.heading)),r(c,u)},$$slots:{default:!0}});var a=_(s,2);Le(a,{size:0,block:!0,noHyphens:!0,muted:!0,children:(c,d)=>{var u=se();pe(()=>ze(u,e.description)),r(c,u)},$$slots:{default:!0}});var o=_(a,2),l=c=>{var d=r_(),u=g(d);hs(u,{get commandName(){return e.shortcutCommandName},keysOnly:!0}),r(c,d)};b(o,c=>{e.shortcutCommandName&&c(l)}),r(i,n)}class Qr{static async classifyAndDistillMemories(e,n,s,a){if(!xs(n)||!Hh(s)||!s?.request_message)return;const o=Wd.create();o.setFlag(Zn.start);try{await this._classifyAndDistillMemories(e,n,s,o,a)}catch(l){o.setFlag(Zn.exceptionThrown),console.error("Failed to classify and distill memories",l),n.extensionClient.reportError({originalRequestId:null,sanitizedMessage:"Memory classification and distillation failed",stackTrace:l instanceof Error&&l.stack||"",diagnostics:[{key:"error_message",value:l instanceof Error?l.message:String(l)},{key:"conversation_id",value:n.id},{key:"exchange_request_message_length",value:String(s?.request_message?.length||0)}]})}finally{o.setFlag(Zn.end),n.extensionClient.reportAgentSessionEvent({eventName:Rs.classifyAndDistill,conversationId:n.id,eventData:{classifyAndDistillData:o}})}}static async _parseClassifyAndDistillResponse(e,n,s,a){const o=Ze(e).id;s.setFlag(Zn.startSendSilentExchange);let l=n.request_message;a.promptKey==="classify_and_distill_success_prompt"&&n.response_text&&(l=`User: ${n.request_message}

Assistant: ${n.response_text}`);const{responseText:c,requestId:d}=await e.sendSilentExchange({model_id:e.selectedModelId??void 0,request_message:l,disableRetrieval:!0,disableSelectedCodeDetails:!0,memoriesInfo:a});if(s.setStringStats(Zn.sendSilentExchangeResponseStats,c),d?s.setRequestId(Zn.sendSilentExchangeRequestId,d):s.setFlag(Zn.noRequestId),Ze(e).id!==o)return s.setFlag(Zn.conversationChanged),{requestId:d};let u;try{let h=c;try{const y=Bg.lexer(c);y.length===1&&y[0].type==="code"&&y[0].text&&(h=y[0].text)}catch(y){console.warn("Markdown lexing failed during response parsing, attempting to parse as raw string:",y)}u=JSON.parse(h)}catch(h){throw s.setFlag(Zn.invalidResponse),new Error(`Invalid response from classify and distill: ${h}`)}if(typeof u.explanation!="string"||typeof u.content!="string"||typeof u.worthRemembering!="boolean")throw s.setFlag(Zn.invalidResponse),new Error(`Invalid response from classify and distill JSON: ${u}`);return s.setStringStats(Zn.explanationStats,u.explanation),s.setStringStats(Zn.contentStats,u.content),s.setFlag(Zn.worthRemembering,u.worthRemembering),{requestId:d,content:u.worthRemembering?u.content:void 0}}static async _classifyAndDistillMemories(e,n,s,a,o){const l=crypto.randomUUID();a.setRequestId(Zn.memoriesRequestId,l);const{content:c,requestId:d}=await this._parseClassifyAndDistillResponse(n,s,a,{isClassifyAndDistill:!0});o&&c&&d&&this._sendMemoryCreationMessage(e,n,c,l,d,"default"),c&&this.updateUserExchangeWithMemory(n,c,l,a,o)}static updateUserExchangeWithMemory(e,n,s,a,o=!1){const l=JSON.stringify({memoriesRequestId:s,memory:n}),c=Ma(e);if(c?.request_id){a.setRequestId(Zn.lastUserExchangeRequestId,c.request_id);const d={id:0,type:Tr.AGENT_MEMORY,content:l,agent_memory:{content:l,isFlushed:o}};e.updateChatItem(c.request_id,{...c,structured_output_nodes:[...c.structured_output_nodes??[],d]})}else a.setFlag(Zn.noLastUserExchangeRequestId)}static async _sendMemoryCreationMessage(e,n,s,a,o,l){try{const c={id:o,content:s,version:l},d={conversationId:n.id,requestId:o,memoriesRequestId:a,timestamp:Date.now()},u={type:jd.memoryCreated,data:{memory:c,metadata:d}};await n.extensionClient.sendMemoryCreated(u),e.dispatch(Vd());const h={action:Xd.createMemory,memoryId:o,triggeredBy:Kd.agent,memoryState:"pending",memoryVersion:l};e.dispatch(Jd({eventName:Rs.memoryUsage,conversationId:n.id,eventData:{memoryUsageData:h}}))}catch(c){console.warn("Error creating memory creation message:",c)}}static parseMemoryNode(e){try{const{memoriesRequestId:n,memory:s}=JSON.parse(e.content);return{memoriesRequestId:n,memory:s,isFlushed:e.agent_memory?.isFlushed??!1}}catch(n){return void console.error("Failed to parse JSON from agent memory node",n)}}static getLastUserExchangeMemory(e){const n=Ma(e);if(n?.structured_output_nodes){const s=n.structured_output_nodes.find(a=>a.type===Tr.AGENT_MEMORY);if(s)return this.parseMemoryNode(s)}}static currentAgenticTurnHasRemember(e){return Gh(e,n=>!!n.structured_output_nodes?.some(s=>s.type===Tr.TOOL_USE&&s.tool_use?.tool_name==="remember")).length>0}static markUserExchangeMemoryComplete(e,n){const s=Ma(e);if(!s?.request_id||s.request_id!==n)return!1;const a=(s.structured_output_nodes||[]).map(o=>o.type===Tr.AGENT_MEMORY?{...o,agent_memory:{...o.agent_memory,content:o.agent_memory?.content||o.content,isFlushed:!0}}:o);return!!(s.structured_output_nodes||[]).some(o=>o.type===Tr.AGENT_MEMORY)&&(e.updateChatItem(n,{...s,structured_output_nodes:a}),!0)}}class Wc{constructor(e,n,s,a,o){this._chatModel=e,this._toolsModel=n,this._checkpointStore=s,this._soundModel=a,this._config=o,this._checkpointStore.registerAgentConversationModel(this),this._toolsModel.addOnToolSkippedCallback(()=>{this._wasInterrupted.set(!0)});const l=Object.values(this._chatModel.conversations).some(d=>d.extraData?.isAgentConversation),c=this._chatModel.currentConversationModel.extraData?.isAgentConversation===!0;(l||c)&&this.setHasEverUsedAgent(!0),this.refreshHasEverUsedAgent(),this._disposers.push(this._chatModel.currentConversationModel.subscribe(()=>{const d=this._chatModel.currentConversationModel,u=xs(d);this._isCurrConversationAgentic.set(u)})),this._disposers.push(this._chatModel.currentConversationModel.subscribe(_r(()=>{const d=Wh(this._chatModel.currentConversationModel);this._agenticExchangeStatus.set(d)},1e3,{leading:!0,trailing:!0}))),this._disposers.push(this._agenticExchangeStatus.subscribe(d=>{d===Is.running&&this._wasInterrupted.set(!1)})),this._disposers.push(this._isCurrConversationAgentic.subscribe(d=>{d?this._chatModel.extensionClient.setChatMode(Ks.agent):this._chatModel.extensionClient.setChatMode(Ks.chat),this._agenticExchangeStatus.set(Is.notRunning)})),this._disposers.push(this._chatModel.agentExecutionMode.subscribe(d=>{Ze(this._isCurrConversationAgentic)&&this._chatModel.extensionClient.setChatMode(Ks.agent)})),this._disposers.push(this._chatModel.currentConversationModel.onBeforeChangeConversation((d,u)=>{if(xs(d))return Ds.isEmpty(u)&&u.extraData?.isAgentConversation!==!1&&this._chatModel.conversations[u.id]===void 0&&(u={...u,extraData:{...u.extraData,isAgentConversation:!0}}),u})),this._disposers.push(this._chatModel.currentConversationModel.subscribe(d=>{const u=d.lastExchange,h=this._config.memoryClassificationOnFirstToken;u&&u.request_id&&h&&(u.status===zn.sent&&u.response_text&&u.response_text.length>0&&!this._classifiedMemoriesMap.has(u.request_id)&&(this._classifiedMemoriesMap.set(u.request_id,!0),Qr.classifyAndDistillMemories(this._chatModel.reduxStore,d,u,this._config.enableMemoryRetrieval)),!u.request_id||u.status!==zn.success&&u.status!==zn.failed&&u.status!==zn.cancelled||this._classifiedMemoriesMap.delete(u.request_id))})),this._disposers.push(this._chatModel.currentConversationModel.onSendExchange(d=>{this._config.memoryClassificationOnFirstToken||Qr.classifyAndDistillMemories(this._chatModel.reduxStore,this._chatModel.currentConversationModel,d,this._config.enableMemoryRetrieval)})),this._disposers.push(this._chatModel.currentConversationModel.onNewConversation(()=>{const d=this._chatModel.currentConversationModel.id;this._chatModel.extensionClient.setCurrentConversation(d),this._checkpointStore.maybeCreateOriginalCheckpoint()})),this._chatModel.extensionClient.setCurrentConversation(this._chatModel.currentConversationModel.id),this._disposers.push(this.isAgenticTurnComplete.subscribe(async d=>{if(!d||!xs(this._chatModel.currentConversationModel))return;const u=this._chatModel.currentConversationModel;if(!Ze(this._wasInterrupted)&&!this._isInitializing)try{await this._soundModel.refreshSettings(),await this._soundModel.playAgentComplete()}catch(m){console.warn("Failed to play agent complete sound:",m)}this._wasInterrupted.set(!1);const h=Qr.getLastUserExchangeMemory(u);if(!h)return;const y=Yd.create();y.setFlag(sr.start);try{const m=Ma(u)?.request_id;m&&y.setRequestId(sr.lastUserExchangeRequestId,m);const{memoriesRequestId:f,memory:$,isFlushed:R}=h;if(y.setRequestId(sr.memoriesRequestId,f),!$||R)return void y.setFlag(sr.emptyMemory);if(Qr.currentAgenticTurnHasRemember(u))return void y.setFlag(sr.agenticTurnHasRememberToolCall);if(this._chatModel.extensionClient.callTool(u.lastExchange?.request_id??"","remember","remember",{memory:$,caller:Ii.classify_and_distill,isComplexNewMemory:!1,memoriesRequestId:f},u.chatHistory.filter(C=>qi(C)).map(Ui),u.id),m){const C=Qr.markUserExchangeMemoryComplete(u,m);y.setFlag(sr.removeUserExchangeMemoryFailed,!C)}}catch{y.setFlag(sr.exceptionThrown)}finally{y.setFlag(sr.end),this._chatModel.extensionClient.reportAgentSessionEvent({eventName:Rs.flushMemories,conversationId:this._chatModel.currentConversationModel.id,eventData:{flushMemoriesData:y}})}})),this._disposers.push(this.isAgenticTurnComplete.subscribe(async d=>{if(d){const u=Ze(this._checkpointStore.currentCheckpoint),h=Ze(this._chatModel.currentConversationModel).id;await this._chatModel.extensionClient.hasChangesSince(u?.fromTimestamp??this.getBaselineTimestamp())&&h===Ze(this._chatModel.currentConversationModel).id&&this._checkpointStore.createNewCheckpoint()}})),this._disposers.push(this.isAgenticTurnComplete.subscribe(d=>{d&&this._chatModel.currentConversationModel.checkAndGenerateAgentTitle()})),this._disposers.push(this._checkpointStore.targetCheckpointSummary.subscribe(()=>{Ze(this._checkpointStore.targetCheckpointHasChanges)?this.markDirty():this.markClean()})),this._isInitializing=!1}static key="agentConversationModel";_agenticExchangeStatus=Dt(Is.notRunning);_isCurrConversationAgentic=Dt(!1);_hasEverUsedAgent=Dt(void 0);_classifiedMemoriesMap=new Map;_wasInterrupted=Dt(!1);_isInitializing=!0;_disposers=[];isAgenticTurnComplete=Ct(this._agenticExchangeStatus,e=>e===Is.notRunning);_maybeTriggerWelcomeMessage=async e=>{const n=this._chatModel.currentConversationModel;if(n.id!==e)return!1;if(await this.refreshHasEverUsedAgent(),!Ds.isEmpty(n)||Ds.isNamed(n)||n.extraData?.hasAgentOnboarded||Ze(this._hasEverUsedAgent)||(this.setHasEverUsedAgent(!0),n.setName("Welcome to the Augment Agent"),n.extraData={isAgentConversation:!0,hasAgentOnboarded:!0},!El()))return!0;const s=await this._chatModel.extensionClient.getAgentOnboardingPrompt();return await n.sendExchange({chatItemType:ja.agentOnboarding,request_message:s,status:zn.draft}),!0};markDirty=()=>{const e=this._chatModel.currentConversationModel;e.extraData={...e.extraData,hasDirtyEdits:!0}};markClean=()=>{const e=this._chatModel.currentConversationModel;e.extraData={...e.extraData,hasDirtyEdits:!1}};updateBaselineTimestamp=e=>{const n=Math.min(e,Date.now()),s=this._chatModel.currentConversationModel;xs(s)&&(s.extraData={...s.extraData,baselineTimestamp:n})};getBaselineTimestamp=()=>{const e=this._chatModel.currentConversationModel;return xs(e)?e.extraData.baselineTimestamp??0:0};getConversationId=()=>this._chatModel.currentConversationModel.id;get isCurrConversationAgentic(){return this._isCurrConversationAgentic}get agentExchangeStatus(){return this._agenticExchangeStatus}interruptAgent=async()=>{if(Ze(this._agenticExchangeStatus)===Is.notRunning)return;this._wasInterrupted.set(!0),await this._toolsModel.interruptAllTools(),await this._chatModel.currentConversationModel.cancelMessage();const e=this._chatModel.currentConversationModel.lastExchange;e?.request_id&&this._classifiedMemoriesMap.delete(e.request_id)};async distillMemory(e){const n=this._chatModel.currentConversationModel.chatHistory.find(a=>Gr(a)&&a.request_id===e);if(!n?.request_message)return;const{responseText:s}=await this._chatModel.currentConversationModel.sendSilentExchange({request_message:n.request_message,disableRetrieval:!0,disableSelectedCodeDetails:!0,memoriesInfo:{isDistill:!0}});try{const a=JSON.parse(s);a.content&&await this._chatModel.extensionClient.callTool(e,"remember","remember",{memory:a.content,caller:Ii.classify_and_distill,isComplexNewMemory:!1},this._chatModel.currentConversationModel.chatHistory.filter(qi).map(Ui),this._chatModel.currentConversationModel.id)}catch(a){console.warn("Failed to parse JSON from distill memory response",a)}}_resetStateToDefaultValues=()=>{this.setHasEverUsedAgent(!1),this._chatModel.extensionClient.setHasEverUsedRemoteAgent(!1),this._chatModel.agentExecutionMode.set(bs.manual)};async resetOnboarding(){this._resetStateToDefaultValues();const e=this._chatModel.currentConversationModel;xs(e)&&(e.extraData={...e.extraData,hasAgentOnboarded:!1},await this._maybeTriggerWelcomeMessage(e.id))}setHasEverUsedAgent=e=>{this._chatModel.extensionClient.setHasEverUsedAgent(e),this._hasEverUsedAgent.set(e)};get hasEverUsedAgent(){return this._hasEverUsedAgent}refreshHasEverUsedAgent=async()=>{if(Ze(this.hasEverUsedAgent)!==void 0)return;const e=await this._chatModel.extensionClient.checkHasEverUsedAgent();Ze(this.hasEverUsedAgent)===void 0&&this._hasEverUsedAgent.set(e)};dispose(){this._disposers.forEach(e=>e()),this._disposers=[],this._classifiedMemoriesMap.clear()}}function jc(){return Fe(Wc.key)}const Na={id:null,displayName:"Default Model",modelGroup:"Default",modelGroupPriority:0,priority:0};class o_{constructor(e,n){this._chatModel=e,this._enableDebugFeatures=n}_store=Dt([]);get defaultModel(){return Ct(this._store,e=>{const n=e.filter(s=>s.isDefault===!0);if(n.length!==0)return n[0]})}get formattedModels(){return Ct([this._store],([e])=>e.filter(n=>!n.disabled))}get selectedModel(){return Ct([this._store,this._chatModel],([e,n])=>{const s=n.currentConversationModel?.selectedModelId;return e.find(o=>o.id===s)})}getModelStore(e){return Ct(this._store,n=>e===null?n[0]??Na:n.find(s=>s.id===e)??Na)}subscribe=this._store.subscribe;registerModels(e){Ze(this._enableDebugFeatures)&&(e=[Na,...e]),this._store.set(e)}}class i_{constructor(e,n,s,a,o,l){this._conversationModel=e,this._extensionClient=n,this._chatModel=s,this._config=a,this._soundModel=o,this._remoteAgentsModel=l,this._currToolsWebviewModel=new ah(this._conversationModel,this._extensionClient,this._chatModel,this._config,this._soundModel,this._remoteAgentsModel)}_currToolsWebviewModel;_onToolSkippedCallbacks=[];addOnToolSkippedCallback=e=>{this._onToolSkippedCallbacks.push(e)};approveTool=async(e,n,s,a,o,l)=>this._currToolsWebviewModel.approveTool(e,n,s,a,o,l);callTool=async(e,n,s,a,o,l)=>this._currToolsWebviewModel.callTool(e,n,s,a,o,l);cancelToolRun=async(e,n)=>this._currToolsWebviewModel.cancelToolRun(e,n);skipToolRun=async(e,n)=>(this._onToolSkippedCallbacks.forEach(s=>s()),this._currToolsWebviewModel.skipToolRun(e,n));cancelActiveToolRun=async()=>this._currToolsWebviewModel.cancelActiveToolRun();interruptAllTools=async()=>this._currToolsWebviewModel.interruptAllTools();interruptToolsConversation=async()=>this._currToolsWebviewModel.interruptToolsConversation();allToolsUsesResolved=e=>this._currToolsWebviewModel.allToolUsesResolved(e);dispose=()=>{this._currToolsWebviewModel.dispose()}}const l_=(i,e,n,s,a)=>()=>{if(a)return!1;const o=e.draftExchange?.request_message??"",l=e.draftExchange?.rich_text_json_repr,c=()=>{e.draftExchange||e.saveDraftExchange(o,l)};if(!i.currentAgentId){if(i.isCreatingAgent)return!1;i.setIsCreatingAgent(!0),e.clearDraftExchange();const u=async()=>{try{await i.reportRemoteAgentSetupWindowEvent($s.clickCreateAgent)}catch(y){console.error("Failed to report click create agent event:",y)}},h=async()=>{try{u();const y=await i.createRemoteAgentFromDraft(o,e.selectedModelId??void 0);y?i?.setCurrentAgent(y):c()}catch(y){console.error("Failed to create remote agent: ",y),c()}finally{i.setIsCreatingAgent(!1)}};return n?(n?.isGithubAuthenticated().then(y=>{if(!y)return i.setIsCreatingAgent(!1),void c();h()}).catch(y=>{console.error("Failed to check GitHub authentication status:",y),i.setIsCreatingAgent(!1),c()}),!0):(h(),!0)}const d=e.draftExchange;if(d&&i){e.clearDraftExchange();const u=e.selectedModelId;i.sendMessage(d.request_message,u??void 0).then(h=>{h||c()}).catch(()=>{c()})}return setTimeout(()=>s?.blur(),50),!0};async function ka(i,e){await i.interruptAgent(),await e.sendDraftExchange()}async function c_(i,e,n,s,a){switch(i){case js.send:return void await ka(n,e);case js.addTask:{if(!s||!a||!e.rootTaskUuid)return void await ka(n,e);const o=e.draftExchange?.request_message?.trim()||"";if(!o)return;try{const l=await async function(c,d,u){if(!u)throw new Error("No root task found for current conversation");const h=function(f){if(f=f.trim(),!f)return;const $=f.indexOf(`
`);if($===-1)return{name:f,description:""};const R=f.substring(0,$),C=f.substring($).trim().replace(/\n/g," ");return{name:R,description:C}}(d);if(!h)return;const{name:y,description:m}=h;return await c.createTask(y,m,u)}(a,o,e.rootTaskUuid);l&&(e.clearDraftExchange(),oh(l))}catch(l){console.error("Task creation failed, falling back to regular send:",l),await ka(n,e)}return}default:return void await ka(n,e)}}function d_(i,e,n,s,a,o,l,c,d,u,h){if(!i)return{stateName:"noConversation",showCancelButton:!1,isDisabled:!0,disabledReason:"No active conversation",action:()=>!1,cancelAction:()=>!1};const y=Ze(e.isCurrConversationAgentic),m=(i.draftExchange?.request_message?.length||0)>Fr,f=(()=>{if(a){const C=i.draftExchange?.rich_text_json_repr;return!!C&&Hr.hasLoadingImages(C)}return!1})(),{hasFileWarning:$,fileWarningMessage:R}=(()=>{if(a){const C=i.draftExchange?.rich_text_json_repr;if(!C)return{hasFileWarning:!1,fileWarningMessage:""};const{hasWarning:x,warningMessage:G}=Hc(C);return{hasFileWarning:x,fileWarningMessage:G}}return{hasFileWarning:!1,fileWarningMessage:""}})();if(m)return{stateName:"overCharLimit",showCancelButton:!1,isDisabled:!0,disabledReason:`Message exceeds the ${Fr} character limit`,action:()=>!1,cancelAction:()=>!1};if($)return{stateName:"overImageLimit",showCancelButton:!1,isDisabled:!0,disabledReason:R,action:()=>!1,cancelAction:()=>!1};if(c?.isActive)return function(C,x,G,L){let A=!1;C.agentOverviews&&(A=!!C.maxRemoteAgents&&C.agentOverviews.length>=C.maxRemoteAgents);let E=!1;const F=C.isCreatingAgent||C?.isActive&&C?.currentAgent?.status===In.agentStarting,z=C?.currentAgent?.status===In.agentFailed;if(C.currentAgentId)E=!x.draftExchange?.request_message||F||z;else{const w=C.newAgentDraft;E=!x.draftExchange?.request_message||C.isCreatingAgent||A||!w?.commitRef?.github_commit_ref?.repository_url||!w.selectedBranch?.name}const D=C.isCurrentAgentRunning&&!F;let M;return E&&(x.draftExchange?.request_message?C.isCreatingAgent?M="Creating agent...":F?M="Agent is starting...":z?M="Agent has failed and cannot accept messages":A&&(M=za.replace("%MAX_AGENTS%",C.maxRemoteAgents.toString())):M="Please enter a message"),{stateName:"remoteAgentMode",showCancelButton:D,isDisabled:E,disabledReason:M,action:l_(C,x,G,L,E),cancelAction:()=>(C.interruptAgent(),!0)}}(c,i,d,u);if(f)return{stateName:"imagesLoading",showCancelButton:!1,isDisabled:!0,action:()=>!1,cancelAction:()=>(y?e.interruptAgent().catch(C=>{console.error("Failed to interrupt agent:",C)}):n.interruptToolsConversation(),!0)};if(h){const C=Ze(h.selectedModel);if(C?.disabled)return{stateName:"modelDisabled",showCancelButton:!1,isDisabled:!0,disabledReason:C.disabled_reason||"Selected model is disabled",action:()=>!1,cancelAction:()=>!1}}return y?{stateName:"agentMode",showCancelButton:!1,isDisabled:!i.hasDraft,action:()=>(c_(s,i,e,o,l),!0),cancelAction:()=>(e.interruptAgent().catch(C=>{console.error("Failed to interrupt agent:",C)}),!0)}:{stateName:"chatMode",showCancelButton:i.canCancelMessage,isDisabled:!i.canSendDraft,action:()=>(i.sendDraftExchange(),!0),cancelAction:u_(e,n)}}function u_(i,e){return()=>(Ze(i.isCurrConversationAgentic)?i.interruptAgent().catch(n=>{console.error("Failed to interrupt agent:",n)}):e.interruptToolsConversation(),!0)}function Vc(i,e,n){if(n)return{isDisabled:!0,isHidden:!1,disabledReason:void 0};if(!i?.isActive)return{isDisabled:!1,isHidden:!1,disabledReason:void 0};const s=i.newAgentDraft?.commitRef?.github_commit_ref?.repository_url;if(!s)return{isDisabled:!1,isHidden:!1,disabledReason:void 0};const a=e||"";return a&&s!==a?{isDisabled:!0,isHidden:!1,disabledReason:"Prompt enhancer is only available when the current repository is selected"}:{isDisabled:!1,isHidden:!1,disabledReason:void 0}}const Kc=i=>` NO TOOLS ALLOWED 

Here is an instruction that I'd like to give you, but it needs to be improved. Rewrite and enhance this instruction to make it clearer, more specific, less ambiguous, and correct any mistakes. Do not use any tools: reply immediately with your answer, even if you're not sure. Consider the context of our conversation history when enhancing the prompt. If there is code in triple backticks (\`\`\`) consider whether it is a code sample and should remain unchanged.Reply with the following format:

### BEGIN RESPONSE ###
Here is an enhanced version of the original instruction that is more specific and clear:
<augment-enhanced-prompt>enhanced prompt goes here</augment-enhanced-prompt>

### END RESPONSE ###

Here is my original instruction:

`+i;var h_=v('<div class="c-input-action-bar svelte-77a9b0"><div class="c-input-action-bar__left-align svelte-77a9b0"><!></div> <div class="c-input-action-bar__right-align svelte-77a9b0"><!></div></div>'),g_=v(" <!>",1),v_=v('<div class="c-send-button svelte-1nzt1wu"><!></div>'),p_=v('<span class="c-input-action-bar-command svelte-1wt8dwe"><!></span>');function jo(i,e){var n=p_(),s=g(n);Et(s,e,"default",{},null),r(i,n)}var m_=v("<!> <!>",1),f_=v('<div class="c-context-menu__items svelte-1pg7ih0"></div> <!> <!> <!>',1),__=v("<!> <!>",1),y_=v('<label class="c-input-action-bar__label svelte-nmvtej"><!></label> <input type="file" multiple hidden=""/>',1),$_=v('<div slot="content" class="c-add-file-button-tooltip svelte-nmvtej">Attach images (up to 10)<br/> Hold <!> to select multiple</div>'),b_=v('<div class="c-cancel-button svelte-10vhx4q"><!></div>'),w_=v('<div class="c-resend-button svelte-1duuxf"><!></div>'),C_=v('<div class="c-rewrite-prompt-button svelte-71xd9m"><!> <!></div>'),k_=Jo('<svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z" fill="currentColor"></path></svg>'),A_=v('<div class="c-split-button__separator svelte-nhfe39"><!></div>'),S_=v('<div class="c-split-button__dropdown-contents svelte-nhfe39"><!></div>'),M_=v("<!> <!>",1),x_=v('<div><div class="c-split-button__main svelte-nhfe39"><!></div> <!> <!></div>');const T_={Root:function(i,e){const n=qa(e,["children","$$slots","$$events","$$legacy"]),s=qa(n,["requestCloseDropdown","requestOpenDropdown","size","variant","color","radius","disabled","highContrast","class","showDropdown","dropdownSide","dropdownAlign","onDropdownOpenChange","onDropdownClickOutside","onDropdownEscapeKeyDown","dropdownIcon","dropdownIconSize"]);ke(e,!1);const a=_e(),o=_e(),l=_e();let c=k(e,"size",8,2),d=k(e,"variant",8,"solid"),u=k(e,"color",8,"neutral"),h=k(e,"radius",8,"medium"),y=k(e,"disabled",24,()=>({primaryDisabled:!1,dropdownDisabled:!1})),m=k(e,"highContrast",8,!1),f=k(e,"class",8,""),$=k(e,"showDropdown",8,!0),R=k(e,"dropdownSide",8,"bottom"),C=k(e,"dropdownAlign",8,"end"),x=k(e,"onDropdownOpenChange",24,()=>{}),G=k(e,"onDropdownClickOutside",24,()=>{}),L=k(e,"onDropdownEscapeKeyDown",24,()=>{}),A=k(e,"dropdownIcon",8,"chevron"),E=k(e,"dropdownIconSize",24,c),F=_e();const z=()=>t(F)?.requestClose(),D=()=>t(F)?.requestOpen();function M(Z){x()&&x()(Z)}function w(){G()&&G()()}function W(){L()&&L()()}function P(){z()}Ne(()=>Ee(y()),()=>{T(a,typeof y()=="boolean"?y():y().primaryDisabled)}),Ne(()=>Ee(y()),()=>{T(o,typeof y()=="boolean"?y():y().dropdownDisabled)}),Ne(()=>Ee(E()),()=>{T(l,Math.min(2,Math.max(1,E())))}),hn();var K={requestCloseDropdown:z,requestOpenDropdown:D};wt();var X=x_();let q;var V=g(X),N=g(V);Et(N,e,"button",{mainButtonDataAttr:"data-split-button-main",get size(){return c()},get variant(){return d()},get color(){return u()},get radius(){return h()},get disabled(){return t(a)},get highContrast(){return m()}},Z=>{{let ae=Ge(()=>$()?"true":void 0);Mt(Z,Vs({get size(){return c()},get variant(){return d()},get color(){return u()},get radius(){return h()},get disabled(){return t(a)},get highContrast(){return m()},get"data-split-button-main"(){return t(ae)}},()=>s,{$$events:{click(j){vn.call(this,e,j)},keyup(j){vn.call(this,e,j)},keydown(j){vn.call(this,e,j)},mousedown(j){vn.call(this,e,j)},mouseover(j){vn.call(this,e,j)},focus(j){vn.call(this,e,j)},mouseleave(j){vn.call(this,e,j)},blur(j){vn.call(this,e,j)},contextmenu(j){vn.call(this,e,j)}},children:(j,H)=>{var O=ee(),J=S(O);Et(J,e,"default",{},null),r(j,O)},$$slots:{default:!0,iconLeft:(j,H)=>{var O=ee(),J=S(O);Et(J,e,"iconLeft",{},null),r(j,O)}}}))}});var U=_(V,2),I=Z=>{var ae=A_(),j=g(ae);da(j,{size:4,orientation:"vertical"}),r(Z,ae)};b(U,Z=>{$()&&Z(I)});var B=_(U,2),Q=Z=>{pn(He.Root(Z,{onOpenChange:M,children:(ae,j)=>{var H=M_(),O=S(H);He.Trigger(O,{children:(te,ne)=>{var re=ee(),he=S(re);Et(he,e,"dropdown-trigger",{dropdownButtonDataAttr:"data-split-button-dropdown",get dropdownIconSize(){return E()},get variant(){return d()},get color(){return u()},get disabled(){return t(o)},get radius(){return h()}},$e=>{{let me=Ge(()=>t(a)?"soft":d());vt($e,{get size(){return E()},get variant(){return t(me)},get color(){return u()},get disabled(){return t(o)},get radius(){return h()},"data-split-button-dropdown":"true",children:(fe,ge)=>{var ce=ee(),we=S(ce);Et(we,e,"dropdown-icon",{},Se=>{var ie=ee(),Ce=S(ie),le=ue=>{(function(be){var ye=k_();r(be,ye)})(ue)},Me=ue=>{var be=ee(),ye=S(be);Et(ye,e,"custom-dropdown-icon",{},null),r(ue,be)};b(Ce,ue=>{A()==="chevron"?ue(le):ue(Me,!1)}),r(Se,ie)}),r(fe,ce)},$$slots:{default:!0}})}}),r(te,re)},$$slots:{default:!0}});var J=_(O,2);He.Content(J,{get size(){return t(l)},get side(){return R()},get align(){return C()},onClickOutside:w,onEscapeKeyDown:W,children:(te,ne)=>{var re=S_(),he=g(re);Et(he,e,"dropdown-content",{closeDropdown:z},null),Nt("click",re,P),r(te,re)},$$slots:{default:!0}}),r(ae,H)},$$slots:{default:!0},$$legacy:!0}),ae=>T(F,ae),()=>t(F))};return b(B,Z=>{$()&&Z(Q)}),pe(Z=>q=Lt(X,1,`c-split-button c-split-button--size-${c()??""} ${f()??""}`,"svelte-nhfe39",q,Z),[()=>({"c-split-button--has-dropdown":$()})]),r(i,X),Gn(e,"requestCloseDropdown",z),Gn(e,"requestOpenDropdown",D),Ae(K)}};var R_=v("<!> <!>",1),E_=v("<!> <!>",1),I_=v("<!> <!>",1),z_=v(" <!>",1),D_=v('<div class="c-send-button svelte-atd2nv"><!></div>');const os={Root:function(i,e){ke(e,!1);const n=void 0,s=void 0;var a={leftAlign:n,rightAlign:s},o=h_(),l=g(o),c=g(l);Et(c,e,"leftAlign",{},null);var d=_(l,2),u=g(d);return Et(u,e,"rightAlign",{},null),r(i,o),Gn(e,"leftAlign",n),Gn(e,"rightAlign",s),Ae(a)},SendButton:function(i,e){const n=Ws(e);ke(e,!1);const s=()=>Y(m,"$chatModel",l),a=()=>Y(t(d),"$currentSendMode",l),o=()=>Y(t(y),"$isCurrConversationAgentic",l),[l,c]=at(),d=_e(),u=_e(),h=_e(),y=_e(),m=Fe("chatModel"),f=Fe("agentConversationModel");if(!m)throw new Error("ChatModel not found in context");if(!f)throw new Error("AgentConversationModel not found in context");let $=k(e,"primaryAction",8),R=k(e,"isDisabled",8,!1),C=k(e,"disabledReason",8,"");const x=void 0;Ne(()=>s(),()=>{ds(T(d,s().sendModeModel.mode),"$currentSendMode",l)}),Ne(()=>(a(),Hi),()=>{T(u,a()===js.send?_a:Hi)}),Ne(()=>(Ee(R()),Ee(C()),a(),o(),t(u)),()=>{T(h,R()?C():a()===js.send?o()?t(u)?.label:"Send Message":t(u).label)}),Ne(()=>{},()=>{ds(T(y,f.isCurrConversationAgentic),"$isCurrConversationAgentic",l)}),hn();var G={tooltipContent:x};wt();var L=v_(),A=g(L);Mt(A,{size:.5,variant:"solid",color:"accent",get disabled(){return R()},$$events:{click:function(){return s().eventTracker?.trackEvent(us.SEND_ACTION_TRIGGERED,{source:"button"}),$()()}},children:(F,z)=>{{let D=Ge(()=>(t(h),Re(()=>n.tooltipContent?void 0:t(h)))),M=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(F,{get content(){return t(D)},get triggerOn(){return t(M)},side:"top",delayDurationMs:500,children:(w,W)=>{oe(w,{get name(){return t(u),Re(()=>t(u).lucideIcon)}})},$$slots:{default:!0,content:(w,W)=>{var P=ee(),K=S(P),X=V=>{var N=g_(),U=S(N),I=_(U);Et(I,e,"tooltipContent",{},null),pe(()=>ze(U,`${t(h)??""} `)),r(V,N)},q=V=>{var N=se();pe(()=>ze(N,t(h))),r(V,N)};b(K,V=>{Re(()=>n.tooltipContent)?V(X):V(q,!1)}),r(w,P)}}})}},$$slots:{default:!0}}),r(i,L),Gn(e,"tooltipContent",x);var E=Ae(G);return c(),E},SendButtonDropdown:function(i,e){const n=Ws(e);ke(e,!1);const s=()=>Y(x,"$chatModel",d),a=()=>Y(t(y),"$currentSendMode",d),o=()=>Y(D,"$enableTaskList",d),l=()=>Y(t(R),"$isCurrConversationAgentic",d),c=()=>Y(w,"$modelDisplayNameToId",d),[d,u]=at(),h=_e(),y=_e(),m=_e(),f=_e(),$=_e(),R=_e(),C=_e(),x=Fe("chatModel"),G=Fe("agentConversationModel");if(!x)throw new Error("ChatModel not found in context");if(!G)throw new Error("AgentConversationModel not found in context");let L=k(e,"primaryAction",8),A=k(e,"isDisabled",8,!1),E=k(e,"disabledReason",8,""),F=k(e,"showOnlySend",8,!1);const z=void 0,D=_t("enableTaskList");let M=_e({});const w=Ol();Ne(()=>s(),()=>{T(h,s().currentConversationModel)}),Ne(()=>s(),()=>{ds(T(y,s().sendModeModel.mode),"$currentSendMode",d)}),Ne(()=>(Ee(F()),a()),()=>{T(m,F()?_a:yo.find(q=>q.id===a()))}),Ne(()=>{},()=>{ds(T(R,G.isCurrConversationAgentic),"$isCurrConversationAgentic",d)}),Ne(()=>(t(R),o(),t(m),_a),()=>{T(f,t(R)&&o()&&t(m)?.lucideIcon||_a.lucideIcon)}),Ne(()=>(Ee(A()),Ee(E()),l(),o(),t(m)),()=>{T($,A()?E():l()&&o()?t(m)?.label||"Send to Agent":"Send message")}),Ne(()=>(l(),o(),Ee(F()),yo),()=>{T(C,l()&&o()&&!F()?yo:[])}),Ne(()=>(l(),o(),a(),s()),()=>{l()&&o()||a()!==js.addTask||(s().sendModeModel.setMode(js.send),s().save())}),Ne(()=>c(),()=>{T(M,Object.fromEntries(Object.entries(c()).map(([q,V])=>[V,q])))}),hn();var W={tooltipContent:z};wt();var P=D_(),K=g(P);{let q=Ge(()=>({primaryDisabled:A(),dropdownDisabled:!1}));(function(V,N){ke(N,!1);const U=()=>Y(ce,"$canShowTaskList",B),I=()=>Y(fe,"$remoteAgentsModel",B),[B,Q]=at(),Z=_e(),ae=_e(),j=_e(),H=_e();let O=k(N,"disabled",8,!1),J=k(N,"onSelectModel",8),te=k(N,"modelIdToDisplayName",8),ne=k(N,"onSend",8),re=k(N,"modeOptions",24,()=>[]),he=k(N,"currentMode",8),$e=k(N,"onSelectMode",8);const me=Fe("chatModel");if(!me)throw new Error("ChatModel not found in context");const fe=Fe(an.key),ge=Fe(ks.key),{canShowTaskList:ce}=ge;Ne(()=>Ee(te()),()=>{T(Z,Object.keys(te()).length>1)}),Ne(()=>Ee(re()),()=>{T(ae,re().length>1)}),Ne(()=>(t(Z),U(),t(ae),I()),()=>{T(j,t(Z)||U()&&t(ae)&&!I()?.isActive)}),Ne(()=>Ee(O()),()=>{T(H,typeof O()=="boolean"?O():O().primaryDisabled)}),hn(),wt();var we=p(()=>yc("Enter",ne()));{let Se=Ge(()=>t(H)?"neutral":"accent");T_.Root(V,{size:.5,variant:"solid",get color(){return t(Se)},get disabled(){return O()},get showDropdown(){return t(j)},dropdownSide:"top",dropdownAlign:"end",$$events:{click(...ie){ne()?.apply(this,ie)},keyup(...ie){t(we)?.apply(this,ie)}},children:(ie,Ce)=>{var le=ee(),Me=S(le);Et(Me,N,"default",{},null),r(ie,le)},$$slots:{default:!0,"dropdown-content":(ie,Ce)=>{var le=I_(),Me=S(le),ue=de=>{var xe=R_(),Oe=S(xe);ln(Oe,1,re,ls,(Ie,Ke)=>{const qe=Ge(()=>(t(Ke),Ee(he()),Re(()=>t(Ke).id===he())));He.Item(Ie,{get highlight(){return t(qe)},onSelect:()=>{$e()(t(Ke).id)},children:(Te,Ye)=>{var it=se();pe(()=>ze(it,(t(Ke),Re(()=>t(Ke).label)))),r(Te,it)},$$slots:{default:!0}})});var De=_(Oe,2),Ue=Ie=>{He.Separator(Ie,{})};b(De,Ie=>{t(Z)&&Ie(Ue)}),r(de,xe)};b(Me,de=>{t(ae)&&de(ue)});var be=_(Me,2),ye=de=>{var xe=E_(),Oe=S(xe);He.Label(Oe,{children:(Ue,Ie)=>{var Ke=se("Models");r(Ue,Ke)},$$slots:{default:!0}});var De=_(Oe,2);ln(De,1,()=>(Ee(te()),Re(()=>Object.keys(te()))),ls,(Ue,Ie)=>{const Ke=Ge(()=>(Ee(te()),t(Ie),Re(()=>te()[t(Ie)]))),qe=Ge(()=>(t(Ie),Re(()=>t(Ie)===me.currentConversationModel.selectedModelId)));He.Item(Ue,{get highlight(){return t(qe)},onSelect:()=>{J()(t(Ie))},children:(Te,Ye)=>{var it=se();pe(()=>ze(it,t(Ke))),r(Te,it)},$$slots:{default:!0}})}),r(de,xe)};b(be,de=>{t(Z)&&de(ye)}),r(ie,le)}}})}Ae(),Q()})(K,{get disabled(){return t(q)},onSelectModel:V=>t(h).setSelectedModelId(V),onSend:function(){return s().eventTracker?.trackEvent(us.SEND_ACTION_TRIGGERED,{source:"button"}),L()()},get modelIdToDisplayName(){return t(M)},get modeOptions(){return t(C)},get currentMode(){return a()},onSelectMode:function(V){s().sendModeModel.setMode(V),s().save()},children:(V,N)=>{{let U=Ge(()=>(t($),Re(()=>n.tooltipContent?void 0:t($)))),I=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(V,{get content(){return t(U)},get triggerOn(){return t(I)},side:"top",delayDurationMs:500,offset:[0,10],children:(B,Q)=>{oe(B,{get name(){return t(f)}})},$$slots:{default:!0,content:(B,Q)=>{var Z=ee(),ae=S(Z),j=H=>{var O=z_(),J=S(O),te=_(J);Et(te,e,"tooltipContent",{},null),pe(()=>ze(J,`${t($)??""} `)),r(H,O)};b(ae,H=>{Re(()=>n.tooltipContent)&&H(j)}),r(B,Z)}}})}},$$slots:{default:!0}})}r(i,P),Gn(e,"tooltipContent",z);var X=Ae(W);return u(),X},ContextMenu:function(i,e){ke(e,!0);const n=()=>Y(x,"$userQuery",a),s=()=>Y(G,"$displayItems",a),[a,o]=at(),l=k(e,"onCloseDropdown",3,()=>{}),c=k(e,"onInsertMentionable",19,()=>{});let d;const u=Fe("chatModel");if(!u)throw new Error("ChatModel not found in context");const h=async()=>{R.closeDropdown()},y=async()=>{R.openDropdown(),await Kn(),$()},m=async()=>{R.toggleDropdown()&&(await Kn(),$())},f=async D=>{switch(D.key){case"ArrowLeft":D.preventDefault(),R.popBreadcrumb(),await Kn(),d?.focusIdx(0);break;case"ArrowRight":case"ArrowDown":case"ArrowUp":case"Enter":break;default:D.defaultPrevented||$()}},$=()=>{d?.focusIdx(-1)},R=new zg(u,D=>!!c()&&c()(D)),{active:C,userQuery:x,displayItems:G}=R,L=Xn();zt(()=>{L(Qd(n()))});var A={closeDropdown:h,openDropdown:y,toggleDropdown:m},E=ee(),F=S(E);Qe(F,()=>He.Root,(D,M)=>{pn(M(D,{get open(){return Y(C,"$active",a)},onOpenChange:w=>{w||l()()},nested:!1,children:(w,W)=>{var P=__(),K=S(P);Qe(K,()=>He.Trigger,(q,V)=>{V(q,{children:(N,U)=>{jo(N,{children:(I,B)=>{{let Q=p(()=>[Be.Hover]);je(I,{get triggerOn(){return t(Q)},side:"top",delayDurationMs:500,children:(Z,ae)=>{var j=m_(),H=S(j);Wn(H,{name:"openContextMenu",handler:y});var O=_(H,2);vt(O,{size:.5,variant:"ghost-block",color:"neutral",$$events:{click:m},children:(J,te)=>{oe(J,{name:"at-sign"})},$$slots:{default:!0}}),r(Z,j)},$$slots:{default:!0,content:(Z,ae)=>{var j=ee(),H=S(j),O=J=>{var te=ee(),ne=S(te);Rt(ne,()=>e.tooltipContent),r(J,te)};b(H,J=>{e.tooltipContent&&J(O)}),r(Z,j)}}})}},$$slots:{default:!0}})},$$slots:{default:!0}})});var X=_(K,2);Qe(X,()=>He.Content,(q,V)=>{V(q,{size:1,side:"top",align:"start",onClickOutside:h,onEscapeKeyDown:h,onRequestClose:h,$$events:{keydown:f},children:(N,U)=>{var I=f_(),B=S(I);ln(B,5,s,ls,(H,O)=>{Dg(H,{get item(){return t(O)},onSelect:async()=>{R.selectMentionable(t(O)),await Kn(),d?.focusIdx(0)}})});var Q=_(B,2),Z=H=>{var O=ee(),J=S(O);Qe(J,()=>He.Label,(te,ne)=>{ne(te,{children:(re,he)=>{var $e=se("No results found");r(re,$e)},$$slots:{default:!0}})}),r(H,O)};b(Q,H=>{n().length>0&&s().length===0&&H(Z)});var ae=_(Q,2);Qe(ae,()=>He.Separator,(H,O)=>{O(H,{})});var j=_(ae,2);Qe(j,()=>He.TextFieldItem,(H,O)=>{O(H,{placeholder:"Focus context",get value(){return Ba(),n()},set value(J){zs(x,J)}})}),r(N,I)},$$slots:{default:!0}})}),r(w,P)},$$slots:{default:!0}}),w=>d=w,()=>d)}),r(i,E);var z=Ae(A);return o(),z},AddFileButton:function(i,e){ke(e,!1);let n=k(e,"accept",8,"*"),s=k(e,"disabled",8,!1),a=k(e,"onAddFiles",8,function(c){l.commandManager?.chain()?.insertFilesIntoEditor?.(c)});const o=`file-${Date.now()}-${Math.floor(1e4*Math.random())}`,l=Lg();wt(),jo(i,{children:(c,d)=>{{let u=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(c,{get triggerOn(){return t(u)},delayDurationMs:300,children:(h,y)=>{vt(h,{size:1,variant:"ghost-block",color:"neutral",get disabled(){return s()},class:"c-input-action-bar__add-file-btn",children:(m,f)=>{var $=y_(),R=S($),C=g(R);oe(C,{name:"paperclip"});var x=_(R,2);pe(()=>{en(R,"for",o),en(x,"id",o),en(x,"accept",n())}),Nt("click",x,function(){this.value=null}),Nt("input",x,function(G){a()([...G.currentTarget?.files??[]])}),r(m,$)},$$slots:{default:!0}})},$$slots:{default:!0,content:(h,y)=>{var m=$_(),f=_(g(m),3);hs(f,{keybinding:"command"}),r(h,m)}}})}},$$slots:{default:!0}}),Ae()},ResendButton:function(i,e){const n=Ws(e);ke(e,!1);let s=k(e,"resendAction",8),a=k(e,"onAnalyticsTrack",8);const o=void 0;function l(){a()(),s()()}var c={tooltipContent:o};wt();var d=w_(),u=g(d);return je(u,{content:Re(()=>n.tooltipContent?void 0:"Resend"),children:(h,y)=>{Mt(h,{size:1,variant:"soft",color:"neutral",$$events:{click:l,keyup:l},$$slots:{iconLeft:(m,f)=>{oe(m,{slot:"iconLeft",name:"rotate-cw"})}}})},$$slots:{default:!0,content:(h,y)=>{var m=ee(),f=S(m),$=R=>{var C=ee(),x=S(C);Et(x,e,"tooltipContent",{},null),r(R,C)};b(f,R=>{Re(()=>n.tooltipContent)&&R($)}),r(h,m)}}}),r(i,d),Gn(e,"tooltipContent",o),Ae(c)},CancelButton:function(i,e){const n=Ws(e);ke(e,!1);let s=k(e,"cancelAction",8),a=k(e,"onAnalyticsTrack",8);const o=void 0;function l(h){h.stopPropagation(),a()("button"),s()()}var c={tooltipContent:o};wt();var d=b_(),u=g(d);return je(u,{content:Re(()=>n.tooltipContent?void 0:"Cancel"),children:(h,y)=>{Mt(h,{size:1,variant:"soft",color:"error",$$events:{click:l},children:(m,f)=>{oe(m,{name:"square"})},$$slots:{default:!0}})},$$slots:{default:!0,content:(h,y)=>{var m=ee(),f=S(m),$=R=>{var C=ee(),x=S(C);Et(x,e,"tooltipContent",{},null),r(R,C)};b(f,R=>{Re(()=>n.tooltipContent)&&R($)}),r(h,m)}}}),r(i,d),Gn(e,"tooltipContent",o),Ae(c)},RewritePromptButton:function(i,e){ke(e,!0);const n=()=>Y(c,"$remoteAgentsModel",s),[s,a]=at();let o=k(e,"isDisabled",3,!1),l=k(e,"disabledReason",19,()=>{});if(!Fe("chatModel"))throw new Error("ChatModel not found in context");const c=Fe(an.key),d=_t("enablePromptEnhancer"),u=Dt(!1);let h=p(()=>n()?.isActive&&!n()?.currentAgentId);async function y(){if(zs(u,!0),t(h)&&c)try{await c.reportRemoteAgentSetupWindowEvent($s.clickRewritePrompt)}catch(R){console.error("Failed to report rewrite prompt button click event:",R)}try{Promise.resolve(e.onRewrite()).finally(()=>{zs(u,!1)})}catch{zs(u,!1)}}var m=ee(),f=S(m),$=R=>{var C=C_(),x=g(C);Wn(x,{name:"enhancePrompt",handler:y});var G=_(x,2);{let L=p(()=>[Be.Hover]);je(G,{get triggerOn(){return t(L)},delayDurationMs:300,maxWidth:"200px",children:(A,E)=>{vt(A,{get disabled(){return o()},size:1,variant:"ghost-block",color:"neutral",onclick:y,children:(F,z)=>{var D=ee(),M=S(D),w=P=>{Dn(P,{size:1,useCurrentColor:!0})},W=P=>{oe(P,{name:"sparkles"})};b(M,P=>{Y(u,"$isEnhancing",s)?P(w):P(W,!1)}),r(F,D)},$$slots:{default:!0}})},$$slots:{default:!0,content:(A,E)=>{var F=ee(),z=S(F),D=w=>{var W=se();pe(()=>ze(W,l())),r(w,W)},M=w=>{ha(w,{heading:"Enhance prompt",description:"Rewrite prompt to provide more context and improve agent responses",shortcutCommandName:"enhancePrompt"})};b(z,w=>{o()&&l()?w(D):w(M,!1)}),r(A,F)}}})}r(R,C)};b(f,R=>{Y(d,"$enablePromptEnhancer",s)&&R($)}),r(i,m),Ae(),a()},NotifyButton:wc};var L_=v('<div class="c-model-picker__tooltip-content svelte-1xlmyl8"><div><!></div> <!> <a href="https://docs.augmentcode.com/models/available-models" class="c-model-picker__learn-more svelte-1xlmyl8" rel="noopener noreferrer">Learn more</a></div>'),P_=v('<div class="c-model-picker__tooltip-card svelte-1xlmyl8"><!></div>'),O_=v("<!> <!>",1);function Xc(i,e){return(i.priority??Number.MAX_SAFE_INTEGER)-(e.priority??Number.MAX_SAFE_INTEGER)}function Vo(i,e){return Xc(i,e)}var N_=v('<div class="c-model-picker__item-badges svelte-g8qo8f"><!> <!></div>'),F_=v("<div> </div>"),q_=v('<div class="c-model-picker__item-content svelte-g8qo8f"><div class="c-model-picker__item-name svelte-g8qo8f"><!> <!></div> <!></div>'),B_=v('<span class="c-model-picker__text-wrapper svelte-g8qo8f"><!> <span class="c-model-picker__disabled-indicator svelte-g8qo8f"></span></span>'),U_=v('<span class="c-model-picker__text-wrapper svelte-g8qo8f"><!></span>'),H_=v('<div class="c-model-picker__group-header svelte-g8qo8f"><!></div>'),G_=v("<!> <!> <!>",1),W_=v('<div class="c-model-picker__scroll svelte-g8qo8f"></div>'),j_=v("<!> <!>",1),V_=v('<div class="c-model-picker svelte-g8qo8f"><!> <!></div>');function Jc(i,e){ke(e,!1);const n=()=>Y(m,"$chatModel",l),s=()=>Y(L,"$selectedModel",l),a=()=>Y(G,"$formattedModels",l),o=()=>Y(A,"$defaultModel",l),[l,c]=at(),d=_e(),u=(M,w=Kt)=>{const W=Ge(()=>(s(),w(),Re(()=>s()?.id===w().id)));He.Item(M,{get highlight(){return t(W)},get disabled(){return w(),Re(()=>w().disabled)},onSelect:()=>{(function(P){if(!P.disabled){if(t(d)){const K=s()?.id??null,X=y.getModelStore(K);if(K!==P.id){t(d).setSelectedModelId(P.id);const q={previousModelId:K||"",previousModelName:Ze(X)?.displayName||"",newModelId:P.id||"",newModelName:P.displayName||""};t(d).extensionClient.reportAgentSessionEvent({eventName:Rs.modelSelectionChange,conversationId:t(d).id,eventData:{modelSelectionChangeData:q}})}}t(C)?.requestClose()}})(w())},children:(P,K)=>{var X=q_(),q=g(X),V=g(q);Le(V,{size:1,children:(Q,Z)=>{var ae=se();pe(()=>ze(ae,(w(),Re(()=>w().displayName)))),r(Q,ae)},$$slots:{default:!0}});var N=_(V,2),U=Q=>{var Z=N_(),ae=g(Z),j=J=>{(function(te,ne){ke(ne,!1);let re=k(ne,"name",8),he=k(ne,"description",8);wt();{let $e=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));$o.Root(te,{get triggerOn(){return t($e)},nested:!0,children:(me,fe)=>{var ge=O_(),ce=S(ge);$o.Trigger(ce,{children:(Se,ie)=>{th(Se,{class:"c-icon c-icon-size--size-1 c-model-picker__coin-icon"})},$$slots:{default:!0}});var we=_(ce,2);$o.Content(we,{side:"right",align:"center",children:(Se,ie)=>{var Ce=P_(),le=g(Ce);uc(le,{size:2,insetContent:!0,variant:"surface",children:(Me,ue)=>{var be=L_(),ye=g(be),de=g(ye);Le(de,{size:1,children:(Ue,Ie)=>{var Ke=se();pe(()=>ze(Ke,re())),r(Ue,Ke)},$$slots:{default:!0}});var xe=_(ye,2),Oe=Ue=>{Le(Ue,{size:1,color:"secondary",children:(Ie,Ke)=>{var qe=se();pe(()=>ze(qe,he())),r(Ie,qe)},$$slots:{default:!0}})};b(xe,Ue=>{he()&&Ue(Oe)});var De=_(xe,2);Nt("click",De,Ue=>{Ue.preventDefault(),Rn.postMessage({type:Sn.augmentLink,data:"https://docs.augmentcode.com/models/available-models"})}),r(Me,be)},$$slots:{default:!0}}),r(Se,Ce)},$$slots:{default:!0}}),r(me,ge)},$$slots:{default:!0}})}Ae()})(J,{get name(){return w(),Re(()=>w().tooltipName)},get description(){return w(),Re(()=>w().tooltipDescription)}})};b(ae,J=>{w(),Re(()=>w().tooltipName)&&J(j)});var H=_(ae,2),O=J=>{Jt.Root(J,{color:"neutral",size:0,variant:"soft",children:(te,ne)=>{var re=se("New");r(te,re)},$$slots:{default:!0}})};b(H,J=>{w(),Re(()=>w().isNew)&&J(O)}),r(Q,Z)};b(N,Q=>{w(),Re(()=>w().tooltipName||w().isNew)&&Q(U)});var I=_(q,2),B=Q=>{Le(Q,{size:0,color:"secondary",children:(Z,ae)=>{var j=F_(),H=g(j);pe(()=>ze(H,(w(),Re(()=>w().description)))),r(Z,j)},$$slots:{default:!0}})};b(I,Q=>{w(),Re(()=>w().description)&&Q(B)}),pe(()=>en(X,"data-highlighted",t(W))),r(P,X)},$$slots:{default:!0}})},h=M=>{Le(M,{size:0,truncate:!0,children:(w,W)=>{var P=se();pe(()=>ze(P,(s(),Re(()=>s()?.displayName||"")))),r(w,P)},$$slots:{default:!0}})},y=Fe("modelRegistry"),m=Fe("chatModel");let f=k(e,"open",24,()=>{}),$=k(e,"defaultOpen",24,()=>{}),R=k(e,"onOpenChange",24,()=>{}),C=_e(),x=_e();const{formattedModels:G,selectedModel:L,defaultModel:A}=y;let E=_e([]);Ne(()=>n(),()=>{T(d,n().currentConversationModel)}),Ne(()=>(s(),t(d),a(),o()),()=>{!s()&&t(d)&&t(d).selectedModelId==null&&a().length>0&&o()&&t(d).setSelectedModelId(o().id)}),Ne(()=>a(),()=>{T(E,function(M){const w=new Map,W=[];for(const X of M){const q=X.modelGroup;if(q&&q.length>0){const V=w.get(q)??[];V.push(X),w.set(q,V)}else W.push(X)}const P=[],K=[];for(const[X,q]of w.entries()){const V=q.sort(Vo),N=q.find(B=>B.modelGroupPriority!==void 0),U=N?.modelGroupPriority,I={name:X,priority:U,models:V};K.push(I)}if(K.sort(Xc),P.push(...K),W.length>0){const X=W.sort(Vo);P.push({name:null,models:X})}return P}(a()))}),hn(),wt();var F=V_(),z=g(F);Wn(z,{name:"toggleModelPicker",handler:function(){f()?t(C)?.requestClose():t(C)?.requestOpen()}});var D=_(z,2);pn(He.Root(D,{nested:!1,get open(){return f()},get defaultOpen(){return $()},onOpenChange:async function(M){M&&(t(d)&&s()&&t(d).extensionClient.track(us.MODEL_PICKER_OPENED,{currentModelId:s().id||"",currentModelName:s().displayName||""}),await Kn(),function(){if(!t(x))return;const w=t(x).querySelector('[data-highlighted="true"]');w&&Gl(t(x),w,{smooth:!1,topBuffer:-(t(x).clientHeight-w.offsetHeight)/2})}(),t(x)?.focus()),R()?.(M)},children:(M,w)=>{var W=j_(),P=S(W);He.Trigger(P,{children:(X,q)=>{jo(X,{children:(V,N)=>{Mt(V,{size:1,variant:"ghost-block",color:"neutral",class:"c-model-picker__button",children:(U,I)=>{var B=ee(),Q=S(B),Z=j=>{{let H=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(j,{get content(){return s(),Re(()=>s().disabled_reason)},get triggerOn(){return t(H)},side:"right",nested:!0,children:(O,J)=>{var te=B_(),ne=g(te);h(ne),r(O,te)},$$slots:{default:!0}})}},ae=j=>{var H=U_(),O=g(H);h(O),r(j,H)};b(Q,j=>{s(),Re(()=>s()?.disabled)?j(Z):j(ae,!1)}),r(U,B)},$$slots:{default:!0,iconLeft:(U,I)=>{oe(U,{slot:"iconLeft",name:"settings-2"})}}})},$$slots:{default:!0}})},$$slots:{default:!0}});var K=_(P,2);He.Content(K,{size:1,side:"top",align:"start",children:(X,q)=>{var V=W_();ln(V,5,()=>t(E),ls,(N,U,I)=>{var B=G_(),Q=S(B),Z=O=>{var J=H_(),te=g(J);Le(te,{size:0,color:"secondary",children:(ne,re)=>{var he=se();pe(()=>ze(he,(t(U),Re(()=>t(U).name)))),r(ne,he)},$$slots:{default:!0}}),r(O,J)};b(Q,O=>{t(U),Re(()=>t(U).name)&&O(Z)});var ae=_(Q,2);ln(ae,1,()=>(t(U),Re(()=>t(U).models)),ls,(O,J)=>{var te=ee(),ne=S(te),re=$e=>{{let me=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je($e,{get content(){return t(J),Re(()=>t(J).disabled_reason)},get triggerOn(){return t(me)},side:"top",nested:!0,children:(fe,ge)=>{u(fe,()=>t(J))},$$slots:{default:!0}})}},he=$e=>{u($e,()=>t(J))};b(ne,$e=>{t(J),Re(()=>t(J).disabled&&t(J).disabled_reason)?$e(re):$e(he,!1)}),r(O,te)});var j=_(ae,2),H=O=>{He.Separator(O,{})};b(j,O=>{t(E),Re(()=>I<t(E).length-1)&&O(H)}),r(N,B)}),pn(V,N=>T(x,N),()=>t(x)),r(X,V)},$$slots:{default:!0}}),r(M,W)},$$slots:{default:!0},$$legacy:!0}),M=>T(C,M),()=>t(C)),r(i,F),Ae(),c()}var K_=v("<!> <!>",1),X_=v('<div slot="content" class="c-toggle-mode-button-tooltip svelte-v9wytb">Toggle agent mode <!> <div class="c-toggle-mode-button-tooltip__content svelte-v9wytb"> </div></div>');function Yc(i,e){ke(e,!1);const n=()=>Y(A,"$enableAgentAutoModeReadable",c),s=()=>Y(R(),"$chatModel",c),a=()=>Y(t(h),"$isCurrConversationAgentic",c),o=()=>Y(G,"$remoteAgentsModel",c),l=()=>Y(t(y),"$agentExecutionMode",c),[c,d]=at(),u=_e(),h=_e(),y=_e(),m=_e(),f=_e(),$=_e();let R=k(e,"chatModel",24,()=>Fe("chatModel")),C=k(e,"agentConversationModel",24,()=>Fe("agentConversationModel")),x=k(e,"disabled",8,!1);const G=Fe(an.key),L=Fe(Ys.key),A=_t("enableAgentAutoMode");async function E(){await L.toggleChatAgentAutoMode("button")}mn(()=>{L.reportModeSelectorInit()}),Ne(()=>n(),()=>{T(u,n())}),Ne(()=>Ee(C()),()=>{ds(T(h,C().isCurrConversationAgentic),"$isCurrConversationAgentic",c)}),Ne(()=>s(),()=>{ds(T(y,s().agentExecutionMode),"$agentExecutionMode",c)}),Ne(()=>(a(),o(),t(u)),()=>{T(m,a()&&!o().isActive&&t(u))}),Ne(()=>(l(),bs),()=>{T(f,l()===bs.auto)}),Ne(()=>t(f),()=>{T($,t(f)?`Auto ON
  Run most commands automatically`:`Auto OFF
  Require approval for most commands`)}),hn(),wt();var F=ee(),z=S(F),D=M=>{{let w=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(M,{class:"c-toggle-mode-button",get triggerOn(){return t(w)},delayDurationMs:300,maxWidth:"auto",children:(W,P)=>{var K=K_(),X=S(K);Wn(X,{name:"toggleAgentMode",handler:E});var q=_(X,2);Cg(q,{get checked(){return t(f)},get disabled(){return x()},size:2,onText:"Auto",offText:"Auto",ariaLabel:"Toggle between manual and auto agent mode",onchange:E}),r(W,K)},$$slots:{default:!0,content:(W,P)=>{var K=X_(),X=_(g(K));hs(X,{commandName:"toggleAgentMode",keysOnly:!0});var q=_(X,2),V=g(q);pe(()=>ze(V,t($))),r(W,K)}}})}};b(z,M=>{t(m)&&M(D)}),r(i,F),Ae(),d()}var J_=v("<div><!></div>"),Y_=v('<div class="c-expandable-box svelte-951e4z"><!> <!></div>');function Q_(i,e){ke(e,!0);let n,s=ct(!1),a=ct(!1),o=ct(0);function l(){T(s,!t(s))}function c(){(function(){t(s)&&n&&n.firstElementChild instanceof HTMLElement&&n.lastElementChild instanceof HTMLElement&&n.firstElementChild.offsetTop>=n.lastElementChild.offsetTop&&T(s,!1)})(),function(){n&&T(o,n.clientHeight,!0)}()}mn(()=>{c();const f=new ResizeObserver(c);return f.observe(n),()=>{f.disconnect()}});var d=Y_();let u;var h=g(d);Hl(h,{get hasOverflow(){return t(a)},set hasOverflow(f){T(a,f,!0)},children:(f,$)=>{var R=J_();let C;var x=g(R);Rt(x,()=>e.children??Kt),pn(R,G=>n=G,()=>n),pe(G=>C=Lt(R,1,"c-expandable-box__contents svelte-951e4z",null,C,G),[()=>({"is-expanded":t(s)})]),r(f,R)},$$slots:{default:!0}});var y=_(h,2),m=f=>{{let $=p(()=>t(s)?"Collapse context":"Expand context");vt(f,{variant:"ghost-block",color:"neutral",size:.5,get title(){return t($)},$$events:{click:l},children:(R,C)=>{oe(R,{name:"chevrons-up-down"})},$$slots:{default:!0}})}};b(y,f=>{(t(a)||t(s))&&f(m)}),pe(f=>u=kr(d,"",u,f),[()=>({"--container-height":t(o)?t(o)+"px":"auto"})]),r(i,d),Ae()}var Z_=v('<span class="c-pin-button"><!></span>'),ey=v('<button class="c-context-badge__button svelte-1c0qk5u" type="button"><div class="c-context-badge__content svelte-1c0qk5u"><!> <!></div></button>'),ty=v('<div class="c-context-badge__content svelte-1c0qk5u"><!> <!></div>'),ny=v('<div class="c-context-badge__left-icon svelte-1c0qk5u"><!></div>'),sy=v("<!><!>",1),ry=v('<div class="c-context-badge svelte-1c0qk5u"><!></div>');function oa(i,e){const n=Ws(e);ke(e,!1);let s=k(e,"color",8,"neutral"),a=k(e,"size",8,1),o=k(e,"removeBtn",24,()=>{}),l=k(e,"showWarning",24,()=>{}),c=k(e,"hideLeftIcon",8,!1),d=k(e,"variant",8,"soft"),u=k(e,"asButton",8,!0);const h=void 0,y=void 0,m=void 0,f=void 0,$=G=>{if(G.stopPropagation(),o()===void 0)throw new Error("No remove button provided");o().onRemove()};var R={leftIcon:h,rightButtons:y,chaser:m,leftButtons:f};wt();var C=ry(),x=g(C);return Jt.Root(x,{get color(){return s()},get size(){return a()},get variant(){return d()},children:(G,L)=>{var A=ee(),E=S(A),F=z=>{var D=ee(),M=S(D),w=P=>{var K=ey(),X=g(K),q=g(X);Et(q,e,"default",{},null);var V=_(q,2),N=U=>{oe(U,{name:"circle-alert"})};b(V,U=>{l()&&U(N)}),Nt("click",K,function(U){vn.call(this,e,U)}),r(P,K)},W=P=>{var K=ty(),X=g(K);Et(X,e,"default",{},null);var q=_(X,2),V=N=>{oe(N,{name:"circle-alert"})};b(q,N=>{l()&&N(V)}),r(P,K)};b(M,P=>{u()?P(w):P(W,!1)}),r(z,D)};b(E,z=>{Ee(l()),Re(()=>n.default||l())&&z(F)}),r(G,A)},$$slots:{default:!0,chaser:(G,L)=>{var A=ee(),E=S(A);Et(E,e,"chaser",{},null),r(G,A)},leftButtons:(G,L)=>{var A=ee(),E=S(A);Et(E,e,"leftButtons",{},F=>{var z=ee(),D=S(z),M=w=>{var W=ny(),P=g(W);Jt.IconButton(P,{disabled:!0,children:(K,X)=>{var q=ee(),V=S(q);Et(V,e,"leftIcon",{},N=>{oe(N,{name:"file"})}),r(K,q)},$$slots:{default:!0}}),r(w,W)};b(D,w=>{c()||w(M)}),r(F,z)}),r(G,A)},rightButtons:(G,L)=>{var A=sy(),E=S(A),F=M=>{var w=ee(),W=S(w);Et(W,e,"rightButtons",{},null),r(M,w)};b(E,M=>{Re(()=>n.rightButtons)&&M(F)});var z=_(E),D=M=>{Jt.IconButton(M,{class:"c-context-badge__remove-btn",get title(){return Ee(o()),Re(()=>o().title)},get size(){return a()},variant:"ghost",color:"neutral",$$events:{click:$},children:(w,W)=>{oe(w,{name:"x"})},$$slots:{default:!0}})};b(z,M=>{o()&&M(D)}),r(G,A)}}}),r(i,C),Gn(e,"leftIcon",h),Gn(e,"rightButtons",y),Gn(e,"chaser",m),Gn(e,"leftButtons",f),Ae(R)}var ay=v("<div><!></div>"),oy=v("<div><!> <!></div>"),iy=v("<!> <!>",1),ly=v("<!> <!>",1);function cy(i,e){ke(e,!0);const n=Xn(),s={size:1,variant:"ghost-block",color:"neutral"};let a=p(()=>e.item.sourceFolderGroup.map(l=>({filePath:l.sourceFolder.folderRoot,name:li(l.sourceFolder.folderRoot),onRemove:()=>{return n(Nl([(c=l).id])),void n(Fl(c.id));var c},onEditGuideline:()=>{return c=l.sourceFolder.folderRoot,void e.chatModel?.extensionClient.openGuidelines(c);var c}}))),o=p(()=>t(a).some(l=>l.onEditGuideline));oa(i,{leftIcon:d=>{var u=ay();br(u,y=>({...y,class:"c-multi-repo-chip__count"}),[()=>Il("accent")],void 0,"svelte-15zo2zj");var h=g(u);Le(h,{size:1,children:(y,m)=>{var f=se();pe(()=>ze(f,e.item.sourceFolderGroup.length)),r(y,f)},$$slots:{default:!0}}),r(d,u)},rightButtons:d=>{var u=ee(),h=S(u);Qe(h,()=>He.Root,(y,m)=>{m(y,{nested:!1,offset:[0,5],children:(f,$)=>{var R=ly(),C=S(R);Qe(C,()=>He.Trigger,(G,L)=>{L(G,{children:(A,E)=>{var F=ee(),z=S(F);Qe(z,()=>Jt.IconButton,(D,M)=>{M(D,{title:"Open menu",variant:"ghost",color:"neutral",size:1,children:(w,W)=>{oe(w,{name:"ellipsis"})},$$slots:{default:!0}})}),r(A,F)},$$slots:{default:!0}})});var x=_(C,2);Qe(x,()=>He.Content,(G,L)=>{L(G,{size:1,children:(A,E)=>{var F=iy(),z=S(F);Qe(z,()=>He.Label,(M,w)=>{w(M,{children:(W,P)=>{var K=se("Repos");r(W,K)},$$slots:{default:!0}})});var D=_(z,2);ln(D,17,()=>t(a),ls,(M,w,W,P)=>{var K=ee(),X=S(K);{const q=V=>{var N=oy();let U;var I=g(N),B=Z=>{je(Z,{content:"Edit repo instructions",children:(ae,j)=>{vt(ae,Vs(()=>s,{$$events:{click(...H){t(w).onEditGuideline?.apply(this,H)}},children:(H,O)=>{oe(H,{name:"cog"})},$$slots:{default:!0}}))},$$slots:{default:!0}})};b(I,Z=>{t(w).onEditGuideline&&Z(B)});var Q=_(I,2);je(Q,{content:"Remove repo from context",children:(Z,ae)=>{vt(Z,Vs(()=>s,{$$events:{click(...j){t(w).onRemove?.apply(this,j)}},children:(j,H)=>{oe(j,{name:"x"})},$$slots:{default:!0}}))},$$slots:{default:!0}}),pe(Z=>U=Lt(N,1,"c-multi-repo-chip__dropdown-item__actions svelte-15zo2zj",null,U,Z),[()=>({"c-multi-repo-chip__dropdown-item__guideline-space":t(o)&&!t(w).onEditGuideline})]),r(V,N)};Qe(X,()=>He.Item,(V,N)=>{N(V,Vs(()=>t(w),{class:"c-multi-repo-chip__dropdown-item",highlight:!1,disabled:!0,iconRight:q,children:(U,I)=>{var B=se();pe(()=>ze(B,t(w).name)),r(U,B)},$$slots:{iconRight:!0,default:!0}}))})}r(M,K)}),r(A,F)},$$slots:{default:!0}})}),r(f,R)},$$slots:{default:!0}})}),r(d,u)},children:(d,u)=>{var h=se("Repos");r(d,h)},$$slots:{leftIcon:!0,rightButtons:!0,default:!0}}),Ae()}const Mo=new Map(Vg.flatMap(([i,e])=>(e??[i]).map(n=>[n,i]))),dy=i=>{if(!i)return;const e=i.split("/").at(-1);if(!e)return;const n=e.toLocaleLowerCase(),s=n.split("."),a=Mo.get(n)??Mo.get(s.at(-1)??"")??Mo.get(s.slice(-2).join("."))??void 0;return a?{javascriptreact:"javascript",typescriptreact:"typescript",shellscript:"shell","cuda-cpp":"cpp",jsonc:"json",jsonl:"json",properties:"ini","objective-c":"objective-c","objective-cpp":"objective-cpp",restructuredtext:"restructuredtext"}[a]??a:void 0};var uy=v('<span class="c-selection-hover-contents__directory svelte-p1gwc6"> </span>'),hy=v('<div class="c-selection-hover-contents__path svelte-p1gwc6"><!> <!></div>'),gy=v('<div class="c-selection-hover-contents__monaco svelte-p1gwc6"><!></div>'),vy=v('<pre class="c-selection-preview__code svelte-p1gwc6"><code> </code></pre>'),py=v('<pre class="c-selection-preview__code svelte-p1gwc6"><code> </code></pre>'),my=v('<div class="c-selection-hover-contents svelte-p1gwc6"><!> <!></div>'),fy=v('<span class="c-selection-chip__icon svelte-5u33zc"><!></span>'),_y=v("<div><!></div>");function yy(i,e){var n=_y(),s=g(n);{const a=l=>{var c=ee(),d=S(c),u=y=>{(function(m,f){ke(f,!0);let $=k(f,"pathName",19,()=>{});const R=jg(()=>import("./index-BuNY6jLF.js").then(K=>K.f),__vite__mapDeps([0,1,2,3]),import.meta.url);let C=p(()=>dy($()??"")),x=ct(void 0),G=ct(""),L=ct(!1);const A=async(K,X)=>{T(L,!0),T(G,`
         --editor-width: ${K}px;
         --editor-height: min(${X}px, 30vh);
    `)};zt(()=>{t(x)?.onDidContentSizeChange(K=>A(K.contentWidth,K.contentHeight))}),zt(()=>{t(x)&&!t(L)&&A(t(x)?.getContentWidth(),t(x)?.getContentHeight())});const E=Xn(),F=()=>{$()&&E(ws({repoRoot:"",pathName:$(),fullRange:f.range}))};let z=p(()=>({automaticLayout:!0,lineNumbers:f.range?K=>`${f.range.startLineNumber+K}`:"off",lineDecorationsWidth:0,wrappingIndent:"same",padding:{top:0,bottom:0},wordWrap:"off",contextmenu:!1,wordBasedSuggestions:"off",renderLineHighlight:"none",occurrencesHighlight:"off",selectionHighlight:!1,codeLens:!1,links:!1,hover:{enabled:!1},hideCursorInOverviewRuler:!0,stickyScroll:{enabled:!1},renderWhitespace:"none",renderFinalNewline:"on"}));var D=my(),M=g(D),w=K=>{var X=hy(),q=g(X);Mt(q,{variant:"ghost-block",color:"neutral",size:1,$$events:{click:F},children:(U,I)=>{{let B=p(()=>li($()));Ig(U,{value:[],get filepath(){return t(B)},onCodeAction:F})}},$$slots:{default:!0}});var V=_(q,2),N=U=>{var I=uy(),B=g(I);pe(Q=>ze(B,Q),[()=>No($())]),r(U,I)};b(V,U=>{No($())&&U(N)}),r(K,X)};b(M,K=>{$()&&K(w)});var W=_(M,2),P=K=>{var X=ee(),q=S(X);mc(q,()=>R,V=>{var N=py(),U=g(N),I=g(U);pe(()=>ze(I,f.originalCode??"")),r(V,N)},(V,N)=>{var U=gy(),I=g(U);{let B=p(()=>f.originalCode??"");Qe(I,()=>t(N).default,(Q,Z)=>{Z(Q,{get text(){return t(B)},get lang(){return t(C)},get pathName(){return $()},get options(){return t(z)},get editorInstance(){return t(x)},set editorInstance(ae){T(x,ae,!0)}})})}r(V,U)},V=>{var N=vy(),U=g(N),I=g(U);pe(()=>ze(I,f.originalCode??"")),r(V,N)}),r(K,X)};b(W,K=>{R&&K(P)}),pe(()=>kr(D,t(G))),r(m,D),Ae()})(y,{get originalCode(){return e.originalCode},get pathName(){return e.pathName},get range(){return e.range}})},h=y=>{ha(y,{heading:"No code selected",description:"Highlight code to add context"})};b(d,y=>{e.originalCode?y(u):y(h,!1)}),r(l,c)};let o=p(()=>e.originalCode?"selection-chip-code":void 0);je(s,{maxWidth:"100%",get theme(){return t(o)},content:a,children:(l,c)=>{{let d=p(()=>e.originalCode?"info":"neutral"),u=p(()=>e.originalCode?"soft":"ghost");oa(l,{get color(){return t(d)},get variant(){return t(u)},hideLeftIcon:!0,asButton:!1,children:(h,y)=>{var m=fy(),f=g(m);Qe(f,()=>Jt.IconButton,($,R)=>{R($,{disabled:!0,children:(C,x)=>{oe(C,{name:"text-cursor"})},$$slots:{default:!0}})}),r(h,m)},$$slots:{default:!0}})}},$$slots:{content:!0,default:!0}})}r(i,n)}var $y=v('<span slot="content"> <!></span>'),by=v("<!> <!>",1);function wy(i,e){ke(e,!0);const n=()=>Y(c,"$contextWorkspaceGuidelines",a),s=()=>Y(l,"$chatModel",a),[a,o]=at(),l=_c(),c=Zd(),d=eu();let u=p(()=>n()?n()[0]:void 0),h=p(()=>t(u)?.lengthLimit),y=p(()=>e.item.userGuidelines.lengthLimit);const m=tu();let f=p(()=>Y(d,"$activeRules",a).map(w=>w.rule)||[]),$=p(()=>kg({rules:Y(m,"$rules",a),workspaceGuidelinesContent:t(u)?.contents||"",contextRules:t(f),rulesAndGuidelinesLimit:t(h)})),R=p(()=>t($).isOverLimit),C=p(()=>t($).warningMessage);const x=_t("enableRules");let G=p(()=>e.item.userGuidelines.overLimit),L=p(()=>t(G)||t(R)),A=p(()=>Y(x,"$enableRules",a)?"Rules & Guidelines":"Guidelines");function E(){return t(R)?t(C):t(G)?`Guidelines exceeded length limit of ${t(y)} characters`:void 0}function F(){s()&&s().extensionClient.openSettingsPage("guidelines")}var z=by(),D=S(z);Wn(D,{name:"openRulesAndGuidelinesSettings",handler:F});var M=_(D,2);{let w=p(()=>t(L)?E():`${t(A)}`);je(M,{get content(){return t(w)},children:(W,P)=>{{let K=p(()=>t(L)?"warning":"neutral"),X=p(()=>yc("Enter",F));vt(W,{size:.5,variant:"ghost-block",get color(){return t(K)},onclick:F,get onkeyup(){return t(X)},children:(q,V)=>{var N=ee(),U=S(N),I=Q=>{oe(Q,{name:"circle-alert"})},B=Q=>{oe(Q,{name:"album"})};b(U,Q=>{t(L)?Q(I):Q(B,!1)}),r(q,N)},$$slots:{default:!0}})}},$$slots:{default:!0,content:(W,P)=>{var K=$y(),X=g(K),q=_(X);hs(q,{commandName:"openRulesAndGuidelinesSettings",keysOnly:!0}),pe(V=>ze(X,`${V??""} `),[()=>t(L)?E():`${t(A)}`]),r(W,K)}}})}r(i,z),Ae(),o()}var Cy=v("<!> <!>",1),ky=v("<div><!></div>");function Ay(i,e){ke(e,!0);const n=()=>Y(t(m),"$isPinned",a),s=()=>Y(t(f),"$showWarning",a),[a,o]=at();let l=ct(!1);const c=new cg({onHoverStart:()=>{T(l,!0)},onHoverEnd:()=>{T(l,!1)},hoverTriggerDuration:0}),d=Xn(),u=()=>{d(Nl([e.item.id])),d(Fl(e.item.id))},h=la(),y=nu("agentMemoriesFilePathName"),m=p(()=>uu(e.item.id)),f=p(()=>gu(e.item.id)),$=p(()=>((L,A,E)=>{const F={onClick:void 0,removeTitle:"",filepath:"",pinnable:!0,iconName:void 0};if(au(L))return{...F,onClick:()=>d(ws(L.file)),removeTitle:"Remove file from context",filepath:L.file.pathName};if(ou(L))return{...F,onClick:()=>d(ws(L.recentFile)),removeTitle:"Remove file from context",filepath:L.recentFile.pathName};if(iu(L))return{...F,onClick:()=>d(ws(L.folder)),removeTitle:"Remove folder from context",filepath:L.folder.pathName,iconName:"folder-opened"};if(lu(L))return{...F,removeTitle:"Remove external source from context",filepath:L.label,iconName:"book"};if(cu(L))return{...F,removeTitle:"Remove source folder from context",filepath:L.sourceFolder.folderRoot,iconName:"root-folder",pinnable:!1};if(zi(L))return{...F,iconName:"root-folder",pinnable:!1};if(du(L)){const z=L.rule.path;return{...F,onClick:()=>d(ws({repoRoot:"",pathName:z})),removeTitle:"Remove rule from context",filepath:z,iconName:"rule"}}return Di(L)?{...F,onClick:()=>{const z=A;E&&e.chatModel&&e.chatModel.extensionClient.reportAgentSessionEvent({eventName:Rs.openedMemoriesFile,conversationId:E,eventData:{memoriesFileOpenData:{memoriesPathUndefined:!z}}}),e.chatModel?.extensionClient.openMemoriesFile()},pinnable:!1}:F})(e.item,Y(y,"$agentMemoriesFilePathName",a),Y(h,"$currentConversationId",a))),R=p(()=>t($).pinnable&&(t(l)||n()));var C=ee(),x=S(C),G=L=>{var A=ee(),E=S(A),F=D=>{yy(D,{get originalCode(){return e.item.selection.originalCode},get range(){return e.item.selection.fullRange},get pathName(){return e.item.selection.pathName}})},z=D=>{var M=ee(),w=S(M),W=K=>{wy(K,{get item(){return e.item}})},P=K=>{var X=ee(),q=S(X),V=U=>{cy(U,{get item(){return e.item},get chatModel(){return e.chatModel}})},N=U=>{var I=ee(),B=S(I),Q=ae=>{{let j=p(()=>t($).onClick||Er);(function(H,O){let J=k(O,"onClick",3,()=>{});var te=Cy(),ne=S(te);Wn(ne,{name:"openAgentMemories",get handler(){return J()}});var re=_(ne,2);je(re,{content:$e=>{ha($e,{heading:"Agent memories",description:"Add preferences about your workspace",shortcutCommandName:"openAgentMemories"})},children:($e,me)=>{vt($e,{size:.5,variant:"ghost-block",color:"neutral",get onclick(){return J()},children:(fe,ge)=>{oe(fe,{name:"archive"})},$$slots:{default:!0}})},$$slots:{content:!0,default:!0}}),r(H,te)})(ae,{get onClick(){return t(j)}})}},Z=ae=>{var j=ky(),H=g(j),O=te=>{{let ne=p(()=>({title:t($).removeTitle,onRemove:u}));oa(te,{get removeBtn(){return t(ne)},get showWarning(){return s()},$$events:{click(...re){(t($).onClick||Er)?.apply(this,re)}},children:(re,he)=>{{let $e=p(()=>[Be.Hover]);je(re,{get triggerOn(){return t($e)},children:(me,fe)=>{Ra(me,{nopath:!0,get filepath(){return t($).filepath}})},$$slots:{default:!0,content:(me,fe)=>{bo(me,{get option(){return e.item},slot:"content"})}}})}},$$slots:{default:!0,leftButtons:(re,he)=>{{let $e=p(()=>n()?"Unpin":"Pin to context");(function(me,fe){ke(fe,!0);let ge=k(fe,"isPinned",3,!1),ce=k(fe,"title",19,()=>ge()?"Unpin":"Pin to context");je(me,{get content(){return ce()},children:(we,Se)=>{var ie=ee(),Ce=S(ie);Qe(Ce,()=>Jt.IconButton,(le,Me)=>{Me(le,{color:"neutral",$$events:{click:ue=>{ue.stopPropagation(),fe.onPin()}},children:(ue,be)=>{var ye=Z_(),de=g(ye),xe=De=>{oe(De,{name:"pin",size:0})},Oe=De=>{oe(De,{name:"pin",size:0})};b(de,De=>{ge()?De(xe):De(Oe,!1)}),r(ue,ye)},$$slots:{default:!0}})}),r(we,ie)},$$slots:{default:!0}}),Ae()})(re,{onPin:()=>d(hu(e.item.id)),get title(){return t($e)},get isPinned(){return n()},slot:"leftButtons"})}}}})}},J=te=>{var ne=ee(),re=S(ne),he=me=>{{let fe=p(()=>({title:t($).removeTitle,onRemove:u}));oa(me,{get removeBtn(){return t(fe)},get showWarning(){return s()},$$events:{click(...ge){(t($).onClick||Er)?.apply(this,ge)}},children:(ge,ce)=>{{let we=p(()=>[Be.Hover]);je(ge,{get triggerOn(){return t(we)},children:(Se,ie)=>{Ra(Se,{nopath:!0,get filepath(){return t($).filepath}})},$$slots:{default:!0,content:(Se,ie)=>{bo(Se,{get option(){return e.item},slot:"content"})}}})}},$$slots:{default:!0,leftIcon:(ge,ce)=>{(function(we,Se){var ie=ee(),Ce=S(ie),le=ue=>{oe(ue,{name:"file"})},Me=ue=>{var be=ee(),ye=S(be),de=Oe=>{oe(Oe,{name:"folder-open"})},xe=Oe=>{var De=ee(),Ue=S(De),Ie=qe=>{oe(qe,{name:"folder-cog"})},Ke=qe=>{var Te=ee(),Ye=S(Te),it=Ve=>{oe(Ve,{name:"book-open"})},lt=Ve=>{var rt=ee(),ve=S(rt),Pe=Je=>{oe(Je,{name:"ruler"})};b(ve,Je=>{Se.icon==="rule"&&Je(Pe)},!0),r(Ve,rt)};b(Ye,Ve=>{Se.icon==="book"?Ve(it):Ve(lt,!1)},!0),r(qe,Te)};b(Ue,qe=>{Se.icon==="root-folder"?qe(Ie):qe(Ke,!1)},!0),r(Oe,De)};b(ye,Oe=>{Se.icon==="folder-opened"?Oe(de):Oe(xe,!1)},!0),r(ue,be)};b(Ce,ue=>{Se.icon==="file"?ue(le):ue(Me,!1)}),r(we,ie)})(ge,{get icon(){return t($).iconName}})}}})}},$e=me=>{{let fe=p(()=>({title:t($).removeTitle,onRemove:u}));oa(me,{get removeBtn(){return t(fe)},get showWarning(){return s()},$$events:{click(...ge){(t($).onClick||Er)?.apply(this,ge)}},children:(ge,ce)=>{{let we=p(()=>[Be.Hover]);je(ge,{get triggerOn(){return t(we)},children:(Se,ie)=>{Ra(Se,{nopath:!0,get filepath(){return t($).filepath}})},$$slots:{default:!0,content:(Se,ie)=>{bo(Se,{get option(){return e.item},slot:"content"})}}})}},$$slots:{default:!0}})}};b(re,me=>{t($).iconName?me(he):me($e,!1)},!0),r(te,ne)};b(H,te=>{t(R)?te(O):te(J,!1)}),is(j,(te,ne)=>dg?.(te,ne),()=>c),r(ae,j)};b(B,ae=>{Di(e.item)?ae(Q):ae(Z,!1)},!0),r(U,I)};b(q,U=>{zi(e.item)?U(V):U(N,!1)},!0),r(K,X)};b(w,K=>{ru(e.item)?K(W):K(P,!1)},!0),r(D,M)};b(E,D=>{su(e.item)?D(F):D(z,!1)}),r(L,A)};b(x,L=>{e.item&&L(G)}),r(i,C),Ae(),o()}var Sy=v("<div><!></div>"),My=v("<!> <!>",1),xy=v('<div class="c-action-bar-context svelte-tdiwo0"><!></div>');function Qc(i,e){ke(e,!0);const n=()=>Y(o,"$recentActiveItems",s),[s,a]=at(),o=vu({includeItems:[pu,mu]});var l=xy();Q_(g(l),{children:(c,d)=>{var u=My(),h=S(u);Rt(h,()=>e.prepend??Kt);var y=_(h,2);ln(y,1,n,ls,(m,f)=>{var $=Sy();Ay(g($),{get item(){return t(f)},get chatModel(){return e.chatModel}}),Mn(3,$,()=>Oo,()=>({duration:100})),r(m,$)}),r(c,u)},$$slots:{default:!0}}),r(i,l),Ae(),a()}function Zc(i){const{message:e,referenceElement:n,placement:s="top",autoDismissMs:a=3e3,theme:o="error",className:l=""}=i,c=document.createElement("div");if(c.className=l,c.textContent=e,document.body.appendChild(c),!n)return void console.warn("ErrorTooltip: No reference element provided");const d=ug(c,{content:c,trigger:"manual",placement:s,theme:o,duration:[300,2e3],getReferenceClientRect:()=>n.getBoundingClientRect(),onHidden:()=>{c.remove()}});d.show(),setTimeout(()=>{d.hide()},a)}var Ty=v("<span><!></span>");function $l(i,e){ke(e,!0);const[n,s]=at(),a=_t("enableAgentTabs"),o=p(()=>Y(a,"$enableAgentTabs",n)?os.SendButton:os.SendButtonDropdown);var l=ee(),c=S(l);{const d=u=>{var h=Ty(),y=g(h);hs(y,{commandName:"sendChatAction",keysOnly:!0}),r(u,h)};Qe(c,()=>t(o),(u,h)=>{h(u,{get isDisabled(){return e.isDisabled},get disabledReason(){return e.disabledReason},get primaryAction(){return e.sendAction},tooltipContent:d,$$slots:{tooltipContent:!0}})})}r(i,l),Ae(),s()}class Ry{constructor(e,n,s){this.onBeforeCompletionAccepted=e,this.onCompletionAccepted=n,this.onCompletionRejected=s}_completionState=null;_pluginKey=new oc("inlineCompletion");_editor=null;createGhostDecoration(e,n){return jh.widget(e,()=>{const s=document.createElement("span");return s.textContent=n,s.className="inline-completion-ghost",s.style.opacity="0.5",s.style.color="var(--ds-color-neutral-a11)",s.style.pointerEvents="none",s.style.userSelect="none",s},{side:1})}get tipTapExtension(){const e=this;return lc.create({name:"inlineCompletion",onCreate(){e._editor=this.editor},addKeyboardShortcuts:()=>({Tab:()=>!!e._completionState&&(e.acceptCompletion(),!0),Escape:()=>!!e._completionState&&(e.clearCompletion(),!0)}),addProseMirrorPlugins:()=>[new ic({key:e._pluginKey,state:{init:()=>qs.empty,apply:(n,s,a,o)=>{if(!e._completionState)return qs.empty;const{from:l}=o.selection,c=e._completionState;if(!n.docChanged){const{from:m}=a.selection,{from:f}=o.selection;if(m!==f)return e.clearCompletion(),qs.empty;const $=e.createGhostDecoration(l,c.currentText);return qs.create(o.doc,[$])}const d=c.triggerPos-c.prefixWhenTriggered.length,u=o.doc.textBetween(Math.max(0,d),Math.min(l,o.doc.content.size));if(!u.startsWith(c.prefixWhenTriggered))return e.clearCompletion(),qs.empty;const h=u.slice(c.prefixWhenTriggered.length);if(h){if(!c.originalText.startsWith(h))return e.clearCompletion(),qs.empty;const m=c.originalText.slice(h.length);if(m){e._completionState={...c,currentText:m};const f=e.createGhostDecoration(l,m);return qs.create(o.doc,[f])}return e.onCompletionAccepted?.(),e._completionState=null,qs.empty}const y=e.createGhostDecoration(l,c.currentText);return qs.create(o.doc,[y])}},props:{decorations(n){return this.getState(n)},handleClick:()=>(e.clearCompletion(),!1),handleKeyDown:(n,s)=>(e._completionState&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(s.key)&&e.clearCompletion(),!1)}})]})}showCompletion(e,n){if(this._editor){const s=this._editor.state.selection.from,a=n||this._editor.state.doc.textBetween(0,s);this._completionState={originalText:e,currentText:e,triggerPos:s,prefixWhenTriggered:a},this._editor.view.dispatch(this._editor.state.tr)}}_getAtMentionWordPrefix(){if(!this._editor)return"";const{state:e}=this._editor,{from:n}=e.selection;let s=n-1,a="";for(;s>=0&&n-s<=100;){const o=e.doc.textBetween(s,s+1);if(o==="@"){a=e.doc.textBetween(s+1,n);break}if(o===" "||o===`
`)break;s--}return a}acceptCompletion(){if(this._completionState&&this._editor){const e=this._completionState.currentText,n=this._getAtMentionWordPrefix();this.onBeforeCompletionAccepted?.(e,n)||this._editor.commands.insertContent(e),this.onCompletionAccepted?.(),this.clearCompletion(!1)}}clearCompletion(e=!0){const n=this._completionState!==null;this._completionState=null,this._editor&&this._editor.view.dispatch(this._editor.state.tr),n&&e&&this.onCompletionRejected?.()}isActivelyMatching(){return!!(this._completionState&&this._completionState.currentText.length<this._completionState.originalText.length)}hasActiveCompletion(){return this._completionState!==null}}const Ey={Root:function(i,e){ke(e,!1);let n=k(e,"onBeforeCompletionAccepted",24,()=>{}),s=k(e,"onCompletionAccepted",24,()=>{}),a=k(e,"onCompletionRejected",24,()=>{});const o=new Ry(n(),s(),a()),l=(m,f)=>o.showCompletion(m,f),c=()=>o.clearCompletion(),d=()=>o.isActivelyMatching(),u=()=>o.hasActiveCompletion(),h=Fe(ua.CONTEXT_KEY).pluginManager.registerPlugin(o);As(h);var y={showCompletion:l,clearCompletion:c,isActivelyMatching:d,hasActiveCompletion:u};return wt(),Gn(e,"showCompletion",l),Gn(e,"clearCompletion",c),Gn(e,"isActivelyMatching",d),Gn(e,"hasActiveCompletion",u),Ae(y)}};class Iy{constructor(e,n){this.chatModel=e,this.extensionClient=n}currentCompletionRequestId=null;currentCompletionEmitTime=null;async getCompletion(e,n=""){if(e.length<3&&!e.startsWith("@"))return null;try{Vh();const s=this.getRecentMessages(),a=await this.extensionClient.getChatInputCompletion(e,n,s);if(!a||!a.completion)return null;const o=this.formatCompletion(a.completion,e,2);return o&&(this.currentCompletionRequestId=a.requestId,this.currentCompletionEmitTime=Date.now()),o}catch(s){return console.error("Failed to get chat input completion:",s),null}}getRecentMessages(){try{const e=this.chatModel.currentConversationModel;return e?(e.chatHistory||[]).filter(s=>Gr(s)).flatMap(s=>{const a=s.request_message?"USER_INPUT:"+s.request_message+`
`:"",o=s.response_text?"AGENT_RESPONSE:"+(s.response_text??"")+`
`:"";return a&&o||a||o?[a,o]:[]}).filter(s=>s&&s.trim().length>0).slice(-100):[]}catch(e){return console.error("Failed to get recent prompts:",e),[]}}handleInlineCompletionAccepted(e,n,s){if(!s)return!1;const a=s?.getDisplayItems();if(!a)return!1;const o=n+e,l=d=>d.label===o||d.name===o?d:d.group?d.group.items.find(l):void 0;let c;return a.some(d=>(c=l(d),c!==void 0)),!!c&&(s?.insertMentionNode(c),!0)}formatCompletion(e,n,s){const a=e.split(/\s+/);if(n.split(/\s+/).pop()?.startsWith("@")){const o=a[0];if(!o)return"";const l=o.replace(/[*_[\]#(){}`]/g,""),c=l.search(/[:,;!?#]/);return c!==-1?l.slice(0,c):l.endsWith(".")?l.slice(0,-1):o}return a[0].match(/[.,;:!?]$/)?a[0]:a.slice(0,s).join(" ")}reportCompletionAccepted(){this.currentCompletionRequestId&&this.currentCompletionEmitTime&&this.extensionClient.reportChatInputCompletionResolution(this.currentCompletionRequestId,this.currentCompletionEmitTime,Date.now(),!0),this.clearCurrentCompletion()}reportCompletionRejected(){this.currentCompletionRequestId&&this.currentCompletionEmitTime&&this.extensionClient.reportChatInputCompletionResolution(this.currentCompletionRequestId,this.currentCompletionEmitTime,Date.now(),!1),this.clearCurrentCompletion()}clearCurrentCompletion(){this.currentCompletionRequestId=null,this.currentCompletionEmitTime=null}}var zy=v("<span>Add context <!></span>"),Dy=v('<div class="c-chat-input__context-bar svelte-v2ozfj"><!></div>'),Ly=v("<!> <!> <!>",1),Py=v('<span class="character-counter svelte-v2ozfj"> </span>'),Oy=v("<!> <!> <!> <!> <!>",1),Ny=v("<div><!></div>"),Fy=v("<span>Cancel <!></span>"),qy=v("<span>Stop Agent <!></span>"),By=v("<span>Resend <!></span>"),Uy=v("<!> <!>",1),Hy=v("<!> <!> <!> <!> <!>",1),Gy=v("<div><!></div>"),Wy=v("<!> <!>",1),jy=v("<!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Vy=v('<div class="c-chat-input svelte-v2ozfj" data-testid="design-system-chat-input"><!></div>');function xo(i,e){ke(e,!0);const n=()=>Y(G,"$remoteAgentsModel",m),s=()=>Y($,"$chatModel",m),a=()=>Y(V,"$currentConversationModel",m),o=()=>Y(P,"$enableChatInputInlineCompletion",m),l=()=>Y(me,"$conversationType",m),c=()=>Y(t(Me),"$currentSendMode",m),d=()=>Y(M,"$enableChatMultimodal",m),u=()=>Y(Ce,"$isCurrConversationAgentic",m),h=()=>Y(t(ht),"$conversationModel",m),y=()=>Y(w,"$enableDebugFeatures",m),[m,f]=at(),$=Fe("chatModel"),R=Fe(Ys.key),C=Fe("toolsWebviewModel"),x=Fe("agentConversationModel"),G=Fe(an.key),L=Fe(ar.key),A=Fe(ks.key),E=Fe(xa.key),F=Fe("modelRegistry"),z=_t("enableModelRegistry"),D=_t("enableAgentMode"),M=_t("enableChatMultimodal"),w=_t("enableDebugFeatures"),W=_t("enableTaskList"),P=_t("enableChatInputInlineCompletion"),K=We=>{$.extensionClient.showNotification({message:We,type:"error"})},X=p(()=>!!n()?.isActive),q=p(()=>Qo(n())),{currentConversationModel:V}=$;let N=k(e,"editable",3,!0),U=k(e,"placeholder",3,"Ask or instruct Augment"),I=k(e,"hasSendButton",3,!0),B=k(e,"richTextEditorRoot",15),Q=ct(void 0),Z=ct(!1);const ae=p(()=>n()?.isActive&&!n()?.currentAgentId),j=ia(async()=>{if(!t(Z)&&t(ae)&&G)try{await G.reportRemoteAgentSetupWindowEvent($s.typeInPromptWindow),T(Z,!0)}catch(We){console.error("Failed to report type in prompt window event:",We)}},1500),H=p(()=>new Iy(s(),s().extensionClient));let O=ct(void 0);const J=ia(async()=>{const We=B()?.getEditor?.();if(!We)return;const tt=Vi(We.state),ut=Pg(We.state),yt=tt.prefix,kt=ut.suffix;if(!yt||yt.length<3)return;const Pt=await t(H).getCompletion(yt,kt),tn=Vi(We.state);tt.prefix===tn.prefix&&Pt&&t(O)?.showCompletion(Pt,yt)},200),te=p(()=>a().draftExchange||{rich_text_json_repr:void 0}),ne=p(()=>t(te).rich_text_json_repr||{type:"doc",content:[{type:"paragraph"}]});function re(We){a().saveDraftExchange(We.rawText,We.richTextJsonRepr),o()&&t(O)&&(t(O)?.hasActiveCompletion?.()||(J.cancel(),J())),We.rawText&&We.rawText.trim().length>0&&j()}function he(We){a().saveDraftMentions(We.current)}let $e;const me=R.chatModeType;let fe,ge=ct(!1);function ce(We){T(ge,We,!0)}function we(){ce(!t(ge))}zt(()=>{s().conversations[a().id]&&Ds.isNew(s().conversations[a().id])&&$e!==l()&&$e&&l()!=="remoteAgent"&&Kn().then(()=>nt()),$e=l()}),zt(()=>{fe!==a().id&&(fe&&l()!=="remoteAgent"&&Kn().then(()=>nt()),fe=a().id)});const Se=V.onNewConversation(()=>nt());let ie;As(Se),zt(()=>{const We=n()?.currentAgent?.status;ie!==In.agentStarting||We!==In.agentRunning&&We!==In.agentIdle||Kn().then(()=>nt()),ie=We});const{isCurrConversationAgentic:Ce,agentExchangeStatus:le}=x,Me=p(()=>s().sendModeModel.mode),ue=p(()=>d_(s().currentConversationModel,x,C,c(),d(),Y(W,"$enableTaskList",m),A,n(),L,B(),F)),be=p(()=>t(ue).showCancelButton),ye=p(()=>a().draftExchange?.request_message?.length||0),de=p(()=>t(ue).isDisabled),xe=p(()=>t(ue).disabledReason),Oe=p(()=>u()||n()?.isActive),De=p(()=>c()===js.addTask),Ue=p(()=>t(Oe)&&Y(z,"$enableModelRegistry",m)&&!t(De)),Ie=p(()=>l()==="localAgent"&&!t(De)),Ke=p(()=>l()==="chat"&&!t(De)),qe=p(()=>Y(D,"$enableAgentMode",m)&&!t(De)),Te=p(()=>{return We=t(ue).action,()=>{const tt=We();return tt&&l()==="localAgent"&&t(ge)&&Kn().then(()=>{ce(!0)}),tt&&E&&E.unlockSound(),tt};var We}),Ye=p(()=>t(ue).cancelAction),it=p(()=>`${u()}-${n()?.isActive}-${U()}`),lt=()=>{B()?.isFocused===void 0||Ze(B().isFocused())||al()||B().requestFocus()},Ve=async()=>t(be)||t(gt)?(await Kn(),void Je().then(async()=>{await Kn(),rt()})):t(Te)(),rt=async()=>!t(de)&&(s().eventTracker?.trackEvent(us.SEND_ACTION_TRIGGERED,{source:"keybinding"}),t(Te)()),ve=We=>{s().eventTracker?.trackEvent(us.CANCEL_ACTION_TRIGGERED,{source:We})},Pe=We=>{s().eventTracker?.trackEvent(us.RESEND_ACTION_TRIGGERED,{source:We})},Je=async()=>{if(t(be))return ve("keybinding"),t(Ye)();if(t(gt)){ve("keybinding");try{await x.interruptAgent()}catch(We){console.error("Failed to interrupt agent:",We)}return!0}return et()};let Xe=ct(void 0);const st=()=>B()?.requestFocus(),nt=()=>B()?.forceFocus?.(),et=()=>(B()?.blur(),!0),ht=p(()=>s().currentConversationModel);let dt=ct(!1);zt(()=>{const We=h()?.lastExchange?.status,tt=We===zn.cancelled,ut=h()?.getLastToolUseState().phase,yt=ut===$r.cancelled;T(dt,tt||yt,!0)});const gt=p(()=>!n()?.isActive&&u()&&Y(le,"$ideAgentExchangeStatus",m)!==Is.notRunning),Tt=p(()=>!n()?.isActive&&t(dt)&&a().draftExchange?.request_message==="");let mt=p(()=>t(De)?"Queue tasks for your agent":t(Tt)?"Resend to continue":U());const pt=L?.currentRepositoryUrl,ot=p(()=>Vc(n(),Y(pt,"$currentRepoUrl",m),t(de))),ft=p(()=>n()&&n().generateSetupScriptSelected);function Wt(){setTimeout(()=>{B()?.requestFocus()},100)}async function Ut(){try{const We=a().draftExchange?.request_message||"";if(!We||We.trim()==="")return;const tt=a().draftExchange?.rich_text_json_repr;try{let ut;n()?.isActive&&(ut=n().getCurrentChatHistory().map(Vt=>({request_id:Vt.request_id||"",request_message:Vt.request_message,response_text:Vt.response_text||""})));let{responseText:yt,requestId:kt}=await a().sendSilentExchange({request_message:Kc(We),disableRetrieval:!1,chatHistory:ut});a().extensionClient.reportAgentRequestEvent({eventName:fu.enhancedPrompt,conversationId:a().id,requestId:kt,chatHistoryLength:a().chatHistory.length}),a().extensionClient.reportAgentSessionEvent({eventName:Rs.enhancedPrompt,conversationId:a().id});let Pt="";const tn=/<augment-enhanced-prompt>([\s\S]*?)<\/augment-enhanced-prompt>/,cn=yt.match(tn);if(cn&&cn[1])Pt=cn[1].trim();else{Pt=We,console.warn("Enhanced prompt tags not found in response, using original prompt");const Vt=t(Q)?.querySelector(".c-rewrite-prompt-button");Vt&&Zc({className:"enhance-prompt-error-tooltip",message:"Failed to enhance prompt, sorry about that",referenceElement:Vt})}if(Pt?.trim()){const Vt=a().draftExchange?.rich_text_json_repr;let Yt;if(Vt&&typeof Vt=="object"){if(Yt={...Vt},Yt.content&&Array.isArray(Yt.content)){const nn=[];let fn=!1;for(const jt of Yt.content)if(jt.type!=="paragraph"||fn)jt.type!=="paragraph"&&nn.push(jt);else{const Ht=Pt.split(`
`),Xt={type:"paragraph",content:[]};Ht.forEach((At,xt)=>{At.length>0&&Xt.content?.push({type:"text",text:At}),xt<Ht.length-1&&Xt.content?.push({type:"hardBreak"})}),nn.push(Xt),fn=!0}Yt.content=nn}}else Yt={type:"doc",content:[{type:"paragraph",content:[{type:"text",text:Pt}]}]};a().saveDraftExchange(Pt,Yt),setTimeout(()=>{nt();try{const nn=t(Q)?.querySelector(".ProseMirror");if(nn){const fn=nn.querySelector("p");if(fn){const jt=document.createRange(),Ht=window.getSelection();jt.setStart(fn,0),jt.collapse(!0),Ht&&(Ht.removeAllRanges(),Ht.addRange(jt))}}}catch{}},200)}else a().saveDraftExchange(tt&&a().draftExchange?.request_message||"",tt||{type:"doc",content:[]})}catch{a().saveDraftExchange(tt&&a().draftExchange?.request_message||"",tt||{type:"doc",content:[]})}nt()}catch{}}var Ft=Vy();Nt("focus",ts,()=>{t(X)||al()||st()}),Nt("blur",ts,function(...We){s().saveImmediate?.apply(this,We)}),Nt("beforeunload",ts,function(...We){s().saveImmediate?.apply(this,We)});var $t=g(Ft);Yo($t,{scope:"chat-input",children:(We,tt)=>{var ut=ee(),yt=S(ut);qr(yt,()=>t(it),kt=>{var Pt=ee(),tn=S(Pt);{const cn=jt=>{var Ht=ee(),Xt=S(Ht);Rt(Xt,()=>e.banner??Kt),r(jt,Ht)},Vt=jt=>{var Ht=ee(),Xt=S(Ht);Rt(Xt,()=>e.activeButton??Kt),r(jt,Ht)},Yt=jt=>{var Ht=ee(),Xt=S(Ht),At=xt=>{var Bt=Dy();{const Gt=Zt=>{var _n=ee(),qn=S(_n),gn=Ln=>{var Jn=ee(),ss=S(Jn);{const fs=ys=>{var It=zy(),bt=_(g(It));hs(bt,{commandName:"openContextMenu",keysOnly:!0}),r(ys,It)};let _s=p(()=>t(Xe)?.insertMentionNode);Qe(ss,()=>os.ContextMenu,(ys,It)=>{It(ys,{onCloseDropdown:st,get onInsertMentionable(){return t(_s)},tooltipContent:fs,$$slots:{tooltipContent:!0}})})}r(Ln,Jn)};b(qn,Ln=>{t(q).doHideAtMentions||Ln(gn)}),r(Zt,_n)};Qc(g(Bt),{get chatModel(){return $},prepend:Gt,$$slots:{prepend:!0}})}r(xt,Bt)};b(Xt,xt=>{t(q).doHideContextBar||xt(At)}),r(jt,Ht)},nn=jt=>{var Ht=Gy(),Xt=g(Ht);{const At=Bt=>{var Gt=Oy(),Zt=S(Gt),_n=It=>{Yc(It,{get chatModel(){return $},get agentConversationModel(){return x}})};b(Zt,It=>{t(qe)&&It(_n)});var qn=_(Zt,2),gn=It=>{var bt=Ly(),St=S(bt);Wn(St,{name:"toggleAskMode",handler:we});var Qt=_(St,2);je(Qt,{maxWidth:"200px",content:qt=>{ha(qt,{heading:"Ask a question",description:"Get answers without modifying code",shortcutCommandName:"toggleAskMode"})},children:(qt,$n)=>{{let bn=p(()=>t(ge)?"soft":"ghost-block"),xn=p(()=>t(ge)?"accent":"neutral");vt(qt,{size:1,get variant(){return t(bn)},get color(){return t(xn)},class:"c-chat-input__ask-mode-btn",$$events:{click:we},children:(rn,un)=>{oe(rn,{name:"message-square-text"})},$$slots:{default:!0}})}},$$slots:{content:!0,default:!0}});var dn=_(Qt,2);da(dn,{orientation:"vertical",class:"c-chat-input__ask-separator"}),r(It,bt)};b(qn,It=>{t(Ie)&&It(gn)});var Ln=_(qn,2),Jn=It=>{Le(It,{class:"c-chat-indicator",color:"neutral",size:1,children:(bt,St)=>{var Qt=se("Chat Thread");r(bt,Qt)},$$slots:{default:!0}})};b(Ln,It=>{t(Ke)&&It(Jn)});var ss=_(Ln,2),fs=It=>{var bt=Py(),St=g(bt);pe(()=>ze(St,`${t(ye)??""}/${Fr}`)),r(It,bt)};b(ss,It=>{t(ye)>Fr&&It(fs)});var _s=_(ss,2),ys=It=>{Jc(It,{})};b(_s,It=>{t(Ue)&&It(ys)}),r(Bt,Gt)},xt=Bt=>{var Gt=Hy(),Zt=S(Gt),_n=It=>{var bt=ee(),St=S(bt);{let Qt=p(()=>function(dn){return dn?Uc.join(","):".png,.jpg,.jpeg"}(y()));Qe(St,()=>os.AddFileButton,(dn,on)=>{on(dn,{get accept(){return t(Qt)}})})}r(It,bt)};b(Zt,It=>{t(De)||!d()||t(q).doHideMultimodalActions||It(_n)});var qn=_(Zt,2),gn=It=>{var bt=Ny(),St=g(bt);Qe(St,()=>os.RewritePromptButton,(Qt,dn)=>{dn(Qt,{onRewrite:Ut,get isDisabled(){return t(ot).isDisabled},get disabledReason(){return t(ot).disabledReason}})}),Mn(3,bt,()=>to,()=>({axis:"x",duration:200,scale:.4})),r(It,bt)};b(qn,It=>{t(be)||t(gt)||t(Tt)||t(ot).isHidden||It(gn)});var Ln=_(qn,2),Jn=It=>{_g(It,{color:"premium",size:1,variant:"soft",children:(bt,St)=>{var Qt=se("Beta");r(bt,Qt)},$$slots:{default:!0}})};b(Ln,It=>{G?.isActive&&It(Jn)});var ss=_(Ln,2);{let It=p(()=>!t(be)&&!t(gt));Wn(ss,{get isDisabled(){return t(It)},name:"cancelGeneration",debounce:!0,handler:Je})}var fs=_(ss,2),_s=It=>{$l(It,{get isDisabled(){return t(de)},get disabledReason(){return t(xe)},get sendAction(){return t(Te)}})},ys=It=>{var bt=ee(),St=S(bt),Qt=on=>{var qt=ee(),$n=S(qt);{const bn=xn=>{var rn=Fy(),un=_(g(rn));hs(un,{commandName:"cancelGeneration",keysOnly:!0}),r(xn,rn)};Qe($n,()=>os.CancelButton,(xn,rn)=>{rn(xn,{get cancelAction(){return t(Ye)},onAnalyticsTrack:ve,tooltipContent:bn,$$slots:{tooltipContent:!0}})})}r(on,qt)},dn=on=>{var qt=ee(),$n=S(qt),bn=rn=>{var un=ee(),Tn=S(un);{const Yn=Pn=>{var Bn=qy(),On=_(g(Bn));hs(On,{commandName:"cancelGeneration",keysOnly:!0}),r(Pn,Bn)};Qe(Tn,()=>os.CancelButton,(Pn,Bn)=>{Bn(Pn,{get cancelAction(){return x.interruptAgent},onAnalyticsTrack:ve,tooltipContent:Yn,$$slots:{tooltipContent:!0}})})}r(rn,un)},xn=rn=>{var un=ee(),Tn=S(un),Yn=Bn=>{var On=Uy(),gs=S(On);Wn(gs,{name:"resendMessage",handler:()=>{h()?.resendLastExchange(),Pe("keybinding")}});var wn=_(gs,2);{const Ss=Qn=>{var vs=By(),Es=_(g(vs));hs(Es,{commandName:"resendMessage",keysOnly:!0}),r(Qn,vs)};let Ns=p(()=>h()?.resendLastExchange);Qe(wn,()=>os.ResendButton,(Qn,vs)=>{vs(Qn,{get resendAction(){return t(Ns)},onAnalyticsTrack:()=>Pe("button"),tooltipContent:Ss,$$slots:{tooltipContent:!0}})})}r(Bn,On)},Pn=Bn=>{var On=ee(),gs=S(On),wn=Ss=>{$l(Ss,{get isDisabled(){return t(de)},get disabledReason(){return t(xe)},get sendAction(){return t(Te)}})};b(gs,Ss=>{I()&&Ss(wn)},!0),r(Bn,On)};b(Tn,Bn=>{t(Tt)?Bn(Yn):Bn(Pn,!1)},!0),r(rn,un)};b($n,rn=>{t(gt)?rn(bn):rn(xn,!1)},!0),r(on,qt)};b(St,on=>{t(be)?on(Qt):on(dn,!1)},!0),r(It,bt)};b(fs,It=>{t(De)?It(_s):It(ys,!1)}),r(Bt,Gt)};Qe(Xt,()=>os.Root,(Bt,Gt)=>{Gt(Bt,{leftAlign:At,rightAlign:xt,$$slots:{leftAlign:!0,rightAlign:!0}})})}r(jt,Ht)};let fn=p(()=>t(ge)?"accent":"default");Qe(tn,()=>dr.Root,(jt,Ht)=>{pn(Ht(jt,{get editable(){return N()},get variant(){return t(fn)},get showActionButton(){return t(ft)},banner:cn,activeButton:Vt,header:Yt,footer:nn,children:(Xt,At)=>{var xt=jy(),Bt=S(xt);Wn(Bt,{name:"focusChatInput",handler:lt});var Gt=_(Bt,2);Wn(Gt,{name:"sendChatAction",debounce:!0,handler:Ve});var Zt=_(Gt,2);ai(Zt,{shortcuts:{Enter:(bt,St,Qt)=>(fr("enter"),!0),"Meta-Enter":(bt,St,Qt)=>(fr("command+enter"),!0),"Control-Enter":(bt,St,Qt)=>(fr("ctrl+enter"),!0),Escape:(bt,St,Qt)=>(fr("escape"),!0),"Alt-Enter":(bt,St,Qt)=>(fr("option+enter"),!0)}});var _n=_(Zt,2),qn=bt=>{pn(ii(bt,{requestEditorFocus:st,onMentionItemsUpdated:he}),St=>T(Xe,St,!0),()=>t(Xe))};b(_n,bt=>{t(q).doHideAtMentions||bt(qn)});var gn=_(_n,2),Ln=bt=>{qc(0,{get isAskMode(){return t(ge)},onAskModeChange:ce,onAskModeToggleComplete:Wt})};b(gn,bt=>{t(Ie)&&bt(Ln)});var Jn=_(gn,2),ss=bt=>{var St=ee(),Qt=S(St);Qe(Qt,()=>Ey.Root,(dn,on)=>{pn(on(dn,{onBeforeCompletionAccepted:(qt,$n)=>t(H).handleInlineCompletionAccepted(qt,$n,t(Xe)),onCompletionAccepted:()=>t(H).reportCompletionAccepted(),onCompletionRejected:()=>t(H).reportCompletionRejected()}),qt=>T(O,qt,!0),()=>t(O))}),r(bt,St)};b(Jn,bt=>{o()&&bt(ss)});var fs=_(Jn,2);oi(fs,{get placeholder(){return t(mt)}});var _s=_(fs,2);Qe(_s,()=>dr.Content,(bt,St)=>{St(bt,{get content(){return t(ne)},onContentChanged:re})});var ys=_(_s,2),It=bt=>{var St=Wy(),Qt=S(St);{let dn=p(()=>y()?["image","text"]:["image"]);Gc(0,{get saveImage(){return s().saveImage},get saveAttachment(){return s().saveAttachment},get deleteImage(){return s().deleteImage},get renderImage(){return s().renderImage},get maxImages(){return Da},get supportedFileTypes(){return t(dn)},onValidationError:K})}Bc(_(Qt,2),{}),r(bt,St)};b(ys,bt=>{d()&&!t(q).doHideMultimodalActions&&bt(It)}),r(Xt,xt)},$$slots:{banner:!0,activeButton:!0,header:!0,footer:!0,default:!0}}),Xt=>B(Xt),()=>B())})}r(kt,Pt)}),r(We,ut)},$$slots:{default:!0}}),pn(Ft,We=>T(Q,We),()=>t(Q)),r(i,Ft),Ae(),f()}var Ky=v('<div class="l-chat-wrapper svelte-13iycb0"><div class="l-chat svelte-13iycb0" data-testid="main-chat"><div class="l-chat__header svelte-13iycb0"><!></div> <div class="l-chat__floating svelte-13iycb0"><!></div> <div class="l-chat__msg_area svelte-13iycb0"><div class="l-chat__msg_area_body svelte-13iycb0"><!></div></div></div> <div><!></div> <div class="l-chat__input_hint svelte-13iycb0"><!></div> <div class="l-chat__divider_area svelte-13iycb0"><!></div> <div class="l-chat__input_area svelte-13iycb0"><!> <!> <!></div></div>'),Xy=v('<div data-ds-color="neutral" class="c-chat-input-dialog-hr-handle svelte-jhr7e3" role="separator"><div class="c-chat-input-dialog-hr svelte-jhr7e3"></div></div>');Os(["mousedown"]);var Jy=v("<!> Start Generating Setup Script",1),Yy=v('<div class="edit-item__controls-container svelte-10i0l58"><!> <!> <!></div>'),Qy=v('<button><div class="edit-item__info-container"><!></div> <!> <!></button>');function ho(i,e){ke(e,!0);let n=k(e,"isFocused",3,!1),s=k(e,"onClickReview",3,Er);var a=Qy();let o;a.__click=function(...m){s()?.apply(this,m)};var l=g(a),c=g(l);je(c,{delayDurationMs:1e3,get content(){return e.qualifiedPathName.relPath},children:(m,f)=>{Ra(m,{class:"edit-item__filespan",size:1,get filepath(){return e.qualifiedPathName.relPath}})},$$slots:{default:!0}});var d=_(l,2),u=m=>{var f=Yy(),$=g(f),R=A=>{var E=ee(),F=S(E);Rt(F,()=>e.actions),r(A,E)};b($,A=>{e.actions&&A(R)});var C=_($,2),x=A=>{je(A,{content:"Open File",children:(E,F)=>{vt(E,{size:.5,variant:"ghost-block",color:"neutral",$$events:{click:z=>{z.stopPropagation(),e.onClickFile()}},children:(z,D)=>{oe(z,{name:"external-link"})},$$slots:{default:!0}})},$$slots:{default:!0}})};b(C,A=>{e.onClickFile&&A(x)});var G=_(C,2),L=A=>{je(A,{content:"Undo Changes",children:(E,F)=>{vt(E,{size:.5,variant:"ghost-block",color:"neutral",$$events:{click:z=>{z.stopPropagation(),e.onClickRevert()}},children:(z,D)=>{oe(z,{name:"undo-2"})},$$slots:{default:!0}})},$$slots:{default:!0}})};b(G,A=>{e.onClickRevert&&A(L)}),r(m,f)};b(d,m=>{(e.onClickFile||e.onClickRevert||e.actions)&&m(u)});var h=_(d,2),y=m=>{je(m,{content:"View Diff",children:(f,$)=>{ao(f,{size:0,get totalAddedLines(){return e.lineChanges.totalAddedLines},get totalRemovedLines(){return e.lineChanges.totalRemovedLines}})},$$slots:{default:!0}})};b(h,m=>{e.lineChanges&&m(y)}),pe(m=>o=Lt(a,1,"edit-item__container svelte-10i0l58",null,o,m),[()=>({"edit-item__container--focused":n()})]),Mn(3,a,()=>si,()=>({duration:150,axis:"y"})),r(i,a),Ae()}Os(["click"]);class Zy{constructor(e,n,s,a){this._enableAgentMode=e,this._conversationModel=n,this._extensionClient=s,this._agentConversationModel=a,this._chatHistoryCheckpoints=Ct([this._conversationModel],([o],l)=>{const c=o.chatHistory.filter(ca);c?.length===Ze(this._chatHistoryCheckpoints)?.length&&c?.at(-1)?.uuid===Ze(this._chatHistoryCheckpoints)?.at(-1)?.uuid||(this._currentCheckpoint.update(d=>({...d,fromTimestamp:c.at(-1)?.toTimestamp??0,toTimestamp:Number.MAX_SAFE_INTEGER})),l(c))}),this.checkpoints=Ct([this._chatHistoryCheckpoints,this._currentCheckpoint],([o,l])=>[...o,l].filter(c=>c.status!==zn.draft)),this.totalCheckpointCount=Ct(this.checkpoints,o=>o.length),this.uuidToIdx=Ct(this.checkpoints,o=>new Map(o.map((l,c)=>[l.uuid,c]))),this.targetCheckpoint=Ct([this.targetCheckpointIdx,this.checkpoints],([o,l])=>l.at(o??-1)),this.isTargetCheckpointLatest=Ct([this.targetCheckpointIdx,this.checkpoints],([o,l])=>o===l.length-1||o===void 0),[this._conversationModel.onSendExchange(this._doNothingOnNotAgentConversation(()=>{Ze(this._currentCheckpoint).status===zn.draft&&this._currentCheckpoint.update(o=>({...o,status:zn.sent}))})),this.targetCheckpoint.subscribe(this._doNothingOnAgentDisabled(()=>{this._refreshAgentEdits()})),this.checkpoints.subscribe(this._doNothingOnAgentDisabled(()=>{Ze(this.isTargetCheckpointLatest)&&this._refreshAgentEdits()})),this._conversationModel.onNewConversation(()=>{this.targetCheckpointIdx.set(void 0),this._targetCheckpointSummary.set([]),this._refreshAgentEdits()}),this._conversationModel.onSendExchange(this._doNothingOnAgentDisabled(()=>this.targetCheckpointIdx.set(void 0)))].forEach(o=>{this._disposables.push({dispose:o})})}_disposables=[];_chatHistoryCheckpoints;_currentCheckpoint=Dt({request_id:crypto.randomUUID(),uuid:crypto.randomUUID(),chatItemType:ja.agenticCheckpointDelimiter,status:zn.draft,fromTimestamp:0,toTimestamp:Number.MAX_SAFE_INTEGER});checkpoints;uuidToIdx;_targetCheckpointIdx=Dt(void 0);targetCheckpoint;isTargetCheckpointLatest;totalCheckpointCount;_targetCheckpointSummary=Dt([]);targetCheckpointSummary=Hn(this._targetCheckpointSummary);targetCheckpointHasChanges=Ct(this.targetCheckpointSummary,e=>e.some(n=>(n.changesSummary?.totalAddedLines??!1)||(n.changesSummary?.totalRemovedLines??!1)));diffSummary=Ct(this.targetCheckpointSummary,e=>e.reduce((n,s)=>(n.totalAddedLines+=s.changesSummary?.totalAddedLines??0,n.totalRemovedLines+=s.changesSummary?.totalRemovedLines??0,n),{totalAddedLines:0,totalRemovedLines:0}));registerAgentConversationModel(e){this._agentConversationModel=e}_doNothingOnAgentDisabled=e=>(...n)=>{this._enableAgentMode&&e(...n)};_doNothingOnNotAgentConversation=e=>(...n)=>{if(this._enableAgentMode&&xs(Ze(this._conversationModel)))return e(...n)};get targetCheckpointIdx(){return{subscribe:this._targetCheckpointIdx.subscribe,set:()=>this._targetCheckpointIdx.set(void 0),update:()=>this._targetCheckpointIdx.set(void 0)}}get currentCheckpoint(){return this._currentCheckpoint}get _checkpoints(){return Ze(this.checkpoints)}get _targetCheckpoint(){return Ze(this.targetCheckpoint)}_refreshAgentEditsImmediate=async()=>{const e=this._targetCheckpoint;if(!e)return;const n=this._agentConversationModel?this._agentConversationModel.getBaselineTimestamp():0,s=await this.getCheckpointSummary({...e,fromTimestamp:n,toTimestamp:Number.MAX_SAFE_INTEGER});this._targetCheckpointSummary.set(s)};_refreshAgentEdits=_r(this._refreshAgentEditsImmediate,500,{leading:!0,trailing:!0});getCheckpointIdxForTimestamp(e){return this._checkpoints.findIndex(n=>n.fromTimestamp<=e&&n.toTimestamp>=e)}getCheckpointAtIdx(e){return this._checkpoints.at(e)}createNewCheckpoint(e={}){const n=Ze(this._currentCheckpoint),s=Date.now(),a={...n,status:zn.success,toTimestamp:s,...e};this._currentCheckpoint.set({request_id:crypto.randomUUID(),uuid:crypto.randomUUID(),chatItemType:ja.agenticCheckpointDelimiter,status:zn.draft,fromTimestamp:s,toTimestamp:Number.MAX_SAFE_INTEGER}),this._conversationModel.addChatItem(a)}async getCheckpointSummary(e){return(await this._extensionClient.getAgentEditList(e.fromTimestamp,e.toTimestamp)).edits}async getCheckpointIdxSummary(e){const n=this._checkpoints.at(e);return n?this.getCheckpointSummary(n):[]}async revertToCheckpoint(e){const n=Ze(this.uuidToIdx).get(e);if(n===void 0)return!1;const s=this._checkpoints.at(n);if(!s)return!1;const a=Ze(this._conversationModel).id,o=await this._extensionClient.revertToTimestamp(s.toTimestamp);return(o||Ze(this._conversationModel).id===a)&&this.createNewCheckpoint({revertTarget:{uuid:e}}),o}async revertDocumentToTimestamp(e,n){const s=Ze(this._conversationModel).id,a=await this._extensionClient.revertToTimestamp(n,[e]);return a&&Ze(this._conversationModel).id===s&&this.createNewCheckpoint({revertTarget:{filePath:e}}),a}_revertToTimestamp=this._doNothingOnNotAgentConversation(async e=>{await this._extensionClient.revertToTimestamp(e),this.createNewCheckpoint(),this._refreshAgentEdits()});async acceptAll(){const e=this._checkpoints.at(-1);if(e){const n=e.toTimestamp;return xs(Ze(this._conversationModel))&&this._agentConversationModel&&this._agentConversationModel.updateBaselineTimestamp(n),await this._extensionClient.acceptAllAgentEdits(),this._refreshAgentEdits(),!0}return!1}async rejectAll(){const e=await this._extensionClient.openConfirmationModal({title:"Discard All Changes",message:"Are you sure you want to discard all changes? This will apply to all changes whether made by the agent or yourself.",confirmButtonText:"Discard",cancelButtonText:"Cancel"});if(e){const n=this._agentConversationModel?.getBaselineTimestamp()??0;xs(Ze(this._conversationModel))&&this._agentConversationModel&&this._agentConversationModel.updateBaselineTimestamp(n),await this._revertToTimestamp(n),this._refreshAgentEdits()}return e}handleMessageFromExtension(e){return e.data.type===Sn.chatAgentEditListHasUpdates&&this._refreshAgentEdits(),!0}maybeCreateOriginalCheckpoint=this._doNothingOnNotAgentConversation(()=>{const e=Ze(this._conversationModel);e.chatHistory.some(ca)||(Ds.isEmpty(e)||Ds.isNew(e))&&Ze(this.checkpoints).length===0&&this.createNewCheckpoint()});async updateBaselineTimestamp(e){xs(Ze(this._conversationModel))&&this._agentConversationModel&&(this._agentConversationModel.updateBaselineTimestamp(e),this._refreshAgentEdits())}dispose=()=>{this._disposables.forEach(e=>e.dispose())}}const go=()=>Fe("checkpointStore"),e0=i=>{Nn("checkpointStore",i)};var t0=v("Discard All <!>",1),n0=v("<!> Keep All",1),s0=v('<div class="c-bottom-controls svelte-2q851l"><!> <!></div>');function ed(i,e){ke(e,!1);const n=()=>Y(l,"$targetCheckpointHasChanges",s),[s,a]=at(),o=go(),{targetCheckpointHasChanges:l}=o;wt();var c=s0(),d=g(c);{let h=Ge(()=>!n());Mt(d,{class:"c-bottom-controls__revert-btn",variant:"soft",color:"neutral",size:1,get disabled(){return t(h)},$$events:{click:async function(){await o.rejectAll()}},children:(y,m)=>{{let f=Ge(()=>[Be.Hover]),$=Ge(()=>n()?"Discard all changes":"No changes to undo");je(y,{get triggerOn(){return t(f)},get content(){return t($)},children:(R,C)=>{var x=t0(),G=_(S(x));oe(G,{name:"trash-2"}),r(R,x)},$$slots:{default:!0}})}},$$slots:{default:!0}})}var u=_(d,2);{let h=Ge(()=>!n());Mt(u,{class:"c-bottom-controls__accept-btn",variant:"soft",color:"accent",size:1,get disabled(){return t(h)},$$events:{click:async function(){await o.acceptAll()}},children:(y,m)=>{{let f=Ge(()=>[Be.Hover]),$=Ge(()=>n()?"Keep all changes and clear checkpoints":"No changes to keep");je(y,{get triggerOn(){return t(f)},get content(){return t($)},children:(R,C)=>{var x=n0(),G=S(x);oe(G,{name:"check-check"}),r(R,x)},$$slots:{default:!0}})}},$$slots:{default:!0}})}r(i,c),Ae(),a()}function td(i){if(!i)return"";if(i===Number.MAX_SAFE_INTEGER)return"Now";const e=new Date(i),n=new Date,s=e.getHours(),a=`${s%12||12}:${e.getMinutes().toString().padStart(2,"0")}${s>=12?"PM":"AM"}`,o=Math.floor((n.getTime()-e.getTime())/864e5);return o===0?a:o===1?`Yesterday at ${a}`:`${o} days ago at ${a}`}var r0=v('<div class="c-edits-list svelte-1qmq2xz"><div class="c-edits-section svelte-1qmq2xz"></div></div>'),a0=v('<div class="c-edits-list c-edits-list--empty svelte-1qmq2xz"><!></div>'),o0=v('<div class="c-agent-edits-container__footer svelte-1qmq2xz" slot="footer"><!></div>'),i0=v('<div class="c-agent-edits-container svelte-1qmq2xz"><!></div>');function l0(i,e){ke(e,!0);const[n,s]=at(),a=Fe("chatModel"),o=Fe("agentConversationModel"),l=go(),c=Fe(ks.key),d=Xn(),{targetCheckpointSummary:u,totalCheckpointCount:h,targetCheckpointHasChanges:y,diffSummary:m}=l,{isCurrConversationAgentic:f}=o,{canShowTaskList:$}=c;let R=p(()=>Y(u,"$targetCheckpointSummary",n).filter(z=>z.changesSummary&&(z.changesSummary.totalAddedLines>0||z.changesSummary.totalRemovedLines>0)));const C=a.isPanelCollapsed;let x=p(()=>Y(C,"$isPanelCollapsed",n));async function G(){await l.rejectAll()}async function L(){await l.acceptAll()}var A=ee(),E=S(A),F=z=>{var D=i0(),M=g(D);ur(M,{class:"c-agent-edits-container__block-container",get collapsed(){return t(x)},set collapsed(w){T(x,w)},children:(w,W)=>{var P=ee(),K=S(P),X=V=>{var N=r0(),U=g(N);ln(U,21,()=>t(R),I=>I.qualifiedPathName.relPath,(I,B)=>{ho(I,{get qualifiedPathName(){return t(B).qualifiedPathName},get lineChanges(){return t(B).changesSummary},onClickFile:()=>{return Q=t(B).qualifiedPathName,void d(ws({repoRoot:Q.rootPath,pathName:Q.relPath,allowOutOfWorkspace:!0}));var Q},onClickReview:()=>function(Q){const Z=o.getBaselineTimestamp();a.extensionClient.showAgentReview(Q,Z,void 0,!1,!0)}(t(B).qualifiedPathName),onClickRevert:()=>function(Q){const Z=o.getBaselineTimestamp();l.revertDocumentToTimestamp(Q,Z)}(t(B).qualifiedPathName)})}),r(V,N)},q=V=>{var N=a0(),U=g(N);Le(U,{size:1,color:"neutral",children:(I,B)=>{var Q=se("No changes to show");r(I,Q)},$$slots:{default:!0}}),r(V,N)};b(K,V=>{t(R).length>0?V(X):V(q,!1)}),r(w,P)},$$slots:{default:!0,header:(w,W)=>{od(w,{get filesCount(){return t(R).length},get diffSummary(){return Y(m,"$diffSummary",n)},get collapsed(){return t(x)},get hasChanges(){return Y(y,"$targetCheckpointHasChanges",n)},onRevert:G,onKeep:L,slot:"header"})},footer:(w,W)=>{var P=o0(),K=g(P),X=q=>{ed(q,{})};b(K,q=>{t(R).length>0&&q(X)}),r(w,P)}}}),r(z,D)};b(E,z=>{(Y(f,"$isCurrConversationAgentic",n)&&Y(h,"$totalCheckpointCount",n)>0||Y($,"$canShowTaskList",n))&&z(F)}),r(i,A),Ae(),s()}var c0=v("<!> <!> <!> <!>",1),d0=v("<!> <!>",1);function nd(i,e){ke(e,!1);const n=()=>Y(c,"$isImportingExporting",s),[s,a]=at();let o=k(e,"initiallyOpen",8,!1);const l=Fe(ks.key),{isImportingExporting:c,rootTask:d}=l,u=Fe("chatModel");let h=_e(void 0);async function y(){if(n())return;const $=Ze(d),R=Wa($),C={action:Ha.exportTaskList,totalTasksCount:R.total,triggeredBy:Ua.user},x=u.currentConversationModel.chatHistory,G=x.length>0&&x[x.length-1].request_id||u.currentConversationModel.id;u.currentConversationModel.extensionClient.reportAgentSessionEvent({eventName:Rs.taskListUsage,conversationId:G,eventData:{taskListUsageData:C}}),await l.exportTasksToMarkdown(),t(h)?.()}async function m(){if(n())return;const $=Ze(d),R=Wa($),C={action:Ha.importTaskList,totalTasksCount:R.total,triggeredBy:Ua.user},x=u.currentConversationModel.chatHistory,G=x.length>0&&x[x.length-1].request_id||u.currentConversationModel.id;u.currentConversationModel.extensionClient.reportAgentSessionEvent({eventName:Rs.taskListUsage,conversationId:G,eventData:{taskListUsageData:C}}),await l.importTasksFromMarkdown(),t(h)?.()}async function f(){const $=Ze(d);if(!$)return;const R=u.currentConversationId,C=await l.cloneHydratedTask($);R===u.currentConversationId&&C&&await u.setCurrentConversation(void 0,!0,{newTaskUuid:C.uuid}),t(h)?.()}wt(),He.Root(i,{get defaultOpen(){return o()},get requestClose(){return t(h)},set requestClose($){T(h,$)},children:($,R)=>{var C=d0(),x=S(C);He.Trigger(x,{children:(L,A)=>{{let E=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(L,{content:"More Actions",get triggerOn(){return t(E)},children:(F,z)=>{vt(F,{size:.5,variant:"ghost-block",color:"neutral",get disabled(){return n()},children:(D,M)=>{var w=ee(),W=S(w),P=X=>{Dn(X,{size:1})},K=X=>{oe(X,{name:"ellipsis-vertical"})};b(W,X=>{n()?X(P):X(K,!1)}),r(D,w)},$$slots:{default:!0}})},$$slots:{default:!0}})}},$$slots:{default:!0}});var G=_(x,2);He.Content(G,{size:1,side:"bottom",align:"end",children:(L,A)=>{var E=c0(),F=S(E);He.Label(F,{children:(w,W)=>{var P=se("Import/Export");r(w,P)},$$slots:{default:!0}});var z=_(F,2);He.Item(z,{onSelect:y,get disabled(){return n()},children:(w,W)=>{var P=se("Export to Markdown");r(w,P)},$$slots:{default:!0,iconLeft:(w,W)=>{oe(w,{slot:"iconLeft",name:"file-up"})}}});var D=_(z,2);He.Item(D,{onSelect:m,get disabled(){return n()},children:(w,W)=>{var P=se("Import from Markdown");r(w,P)},$$slots:{default:!0,iconLeft:(w,W)=>{oe(w,{slot:"iconLeft",name:"file-input"})}}});var M=_(D,2);He.Item(M,{onSelect:f,children:(w,W)=>{var P=se("Continue in New Chat");r(w,P)},$$slots:{default:!0,iconLeft:(w,W)=>{oe(w,{slot:"iconLeft",name:"message-square-plus"})}}}),r(L,E)},$$slots:{default:!0}}),r($,C)},$$slots:{default:!0},$$legacy:!0}),Ae(),a()}var u0=v('<span class="c-task-check-icon svelte-19cj43u"><!></span>'),h0=v("<!> <!> <!> <!>",1),g0=v("<!> <!>",1);function sd(i,e){ke(e,!1);const n=_e();let s=k(e,"taskFilters",24,()=>[]),a=k(e,"activeTaskFilter",28,()=>new Set),o=k(e,"initiallyOpen",8,!1),l=_e();Ne(()=>(Ee(a()),Ee(s())),()=>{T(n,a().size===0||a().size<s().length)}),hn(),wt(),He.Root(i,{get defaultOpen(){return o()},get requestClose(){return t(l)},set requestClose(c){T(l,c)},children:(c,d)=>{var u=g0(),h=S(u);He.Trigger(h,{children:(m,f)=>{{let $=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(m,{content:"Filter Tasks",get triggerOn(){return t($)},children:(R,C)=>{{let x=Ge(()=>t(n)?"soft":"ghost-block"),G=Ge(()=>t(n)?"accent":"neutral");vt(R,{size:.5,get variant(){return t(x)},get color(){return t(G)},children:(L,A)=>{oe(L,{name:"list-filter"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}},$$slots:{default:!0}});var y=_(h,2);He.Content(y,{side:"bottom",align:"start",size:1,children:(m,f)=>{var $=h0(),R=S($);He.Item(R,{onSelect:()=>function(){const L=s().map(A=>A.value);a(new Set(L))}(),children:(L,A)=>{var E=se("Select All");r(L,E)},$$slots:{default:!0}});var C=_(R,2);He.Item(C,{onSelect:()=>{a(new Set)},children:(L,A)=>{var E=se("Clear All");r(L,E)},$$slots:{default:!0}});var x=_(C,2);He.Separator(x,{});var G=_(x,2);ln(G,1,s,ls,(L,A)=>{const E=Ge(()=>(Ee(a()),t(A),Re(()=>a().has(t(A).value))));He.Item(L,{onSelect:()=>{(function(F){const z=new Set(a());z.has(F)?z.delete(F):z.add(F),a(z)})(t(A).value)},children:(F,z)=>{{let D=Ge(()=>t(E)?"neutral":"secondary");Le(F,{size:1,get color(){return t(D)},children:(M,w)=>{var W=se();pe(()=>ze(W,`${t(A),Re(()=>t(A).label)??""} (${t(A),Re(()=>t(A).count)??""})`)),r(M,W)},$$slots:{default:!0}})}},$$slots:{default:!0,iconLeft:(F,z)=>{var D=ee(),M=S(D),w=P=>{(function(K){var X=u0(),q=g(X);oe(q,{name:"check"}),r(K,X)})(P)},W=P=>{ih(P,{get taskState(){return t(A),Re(()=>t(A).value)},size:1})};b(M,P=>{t(E)?P(w):P(W,!1)}),r(F,D)}}})}),r(m,$)},$$slots:{default:!0}}),r(c,u)},$$slots:{default:!0},$$legacy:!0}),Ae()}var v0=v('<div class="c-task-list-header__status svelte-15ybizi"><!> <!></div>'),p0=v('<div class="c-task-list-header svelte-15ybizi"><div class="c-task-list-header__content svelte-15ybizi"><div class="c-task-list-header__collapse-btn svelte-15ybizi"><!></div> <div class="c-task-list-header__switch-btn svelte-15ybizi"><!></div> <!></div> <div class="c-task-list-header__actions svelte-15ybizi"><!> <!> <!> <!></div></div>'),m0=v('<div class="c-tasks-list svelte-5ij3i1"><!></div>'),f0=v('<div class="c-tasks-list c-tasks-list--empty svelte-5ij3i1"><!></div>'),_0=v('<div class="c-task-list-container svelte-5ij3i1"><!></div>');function y0(i,e){ke(e,!1);const n=()=>Y(C,"$rootTask",a),s=()=>Y(x,"$collapsedStore",a),[a,o]=at(),l=_e(),c=_e(),d=_e(),u=_e(),h=_e(),y=_e(),m=Fe("chatModel"),f=Fe("agentConversationModel"),$=Fe(ks.key),{isCurrConversationAgentic:R}=f,{rootTask:C}=$,x=m.isPanelCollapsed;let G=_e(new Set(Object.values(Fn)));const L=new Wl({chatModel:m,taskStore:$,version:jl.v1});Vl(L),mn(()=>{n()&&L.reportViewTaskList()}),Ne(()=>(n(),t(G)),()=>{T(l,n()?Zo(n(),t(G)):void 0)}),Ne(()=>n(),()=>{T(c,Kl(n()))}),Ne(()=>t(c),()=>{T(d,t(c).notStarted)}),Ne(()=>t(c),()=>{T(u,t(c).inProgress)}),Ne(()=>t(c),()=>{T(h,t(c).completed)}),Ne(()=>t(c),()=>{T(y,t(c).cancelled)}),hn(),wt();var A=ee(),E=S(A),F=z=>{var D=_0(),M=g(D);ur(M,{class:"c-task-list-container__block-container",get collapsed(){return Ba(),s()},set collapsed(w){zs(x,w)},children:(w,W)=>{var P=ee(),K=S(P),X=V=>{var N=m0(),U=g(N);Xl(U,{get task(){return t(l)},get taskStore(){return $},editable:!0}),r(V,N)},q=V=>{var N=f0(),U=g(N);Le(U,{size:1,color:"neutral",children:(I,B)=>{var Q=se("No tasks to show");r(I,Q)},$$slots:{default:!0}}),r(V,N)};b(K,V=>{t(l),Re(()=>t(l)?.isVisible&&t(l).subTasksData?.length)?V(X):V(q,!1)}),r(w,P)},$$slots:{default:!0,header:(w,W)=>{(function(P,K){ke(K,!0);const X=()=>Y(B,"$rootTask",N),q=()=>Y(Z,"$taskProgress",N),V=()=>Y(Q,"$activeTask",N),[N,U]=at(),I=Fe(ks.key),{rootTask:B,activeTask:Q,taskProgress:Z}=I,ae=Do(),j=Ar.tryGetFromContext();async function H(){if(X()){ae?.reportAddSubtask();const xe=await I.createTask("","",X().uuid);setTimeout(()=>{document.getElementById(`task-${xe}`)?.querySelector(".c-task-tree-item__name-editable")?.querySelector("input")?.focus()},100)}}let O=k(K,"notStartedTasksCount",3,0),J=k(K,"inProgressTasksCount",3,0),te=k(K,"completedTasksCount",3,0),ne=k(K,"cancelledTasksCount",3,0),re=k(K,"collapsed",3,!1),he=k(K,"initiallyOpenActions",3,!1),$e=k(K,"activeTaskFilter",31,()=>Cr(new Set)),me=p(()=>X()?.subTasksData&&X().subTasksData.length>0),fe=p(()=>[{value:Fn.NOT_STARTED,label:rr(Fn.NOT_STARTED),count:O()},{value:Fn.IN_PROGRESS,label:rr(Fn.IN_PROGRESS),count:J()},{value:Fn.COMPLETE,label:rr(Fn.COMPLETE),count:te()},{value:Fn.CANCELLED,label:rr(Fn.CANCELLED),count:ne()}]);var ge=p0(),ce=g(ge),we=g(ce),Se=g(we);Wr(Se,{});var ie=_(we,2);ad(g(ie),{});var Ce=_(ie,2),le=xe=>{var Oe=v0(),De=g(Oe),Ue=Te=>{{let Ye=p(()=>[Be.Hover]);je(Te,{get triggerOn(){return t(Ye)},get content(){return`Completed ${q().completed??""} of ${q().total??""} tasks`},children:(it,lt)=>{{let Ve=p(()=>q().completed===q().total?"success":"info");Lo(it,{get color(){return t(Ve)},children:(rt,ve)=>{var Pe=se();pe(()=>ze(Pe,`${q().completed??""}/${q().total??""}`)),r(rt,Pe)},$$slots:{default:!0}})}},$$slots:{default:!0}})}};b(De,Te=>{q()&&q().total>0&&Te(Ue)});var Ie=_(De,2),Ke=Te=>{Le(Te,{size:1,color:"primary",class:"c-task-list-header__task-name",truncate:!0,children:(Ye,it)=>{var lt=se();pe(()=>ze(lt,V().name||"Untitled Task")),r(Ye,lt)},$$slots:{default:!0}})},qe=Te=>{var Ye=ee(),it=S(Ye),lt=rt=>{Le(rt,{size:1,color:"primary",class:"c-task-list-header__task-name",truncate:!0,children:(ve,Pe)=>{var Je=se("All tasks complete");r(ve,Je)},$$slots:{default:!0}})},Ve=rt=>{var ve=ee(),Pe=S(ve),Je=Xe=>{Le(Xe,{size:1,color:"neutral",class:"c-task-list-header__task-name",truncate:!0,children:(st,nt)=>{var et=se();pe(()=>ze(et,X().name)),r(st,et)},$$slots:{default:!0}})};b(Pe,Xe=>{X()&&X().name&&Xe(Je)},!0),r(rt,ve)};b(it,rt=>{q()&&q().completed===q().total&&q().total>0?rt(lt):rt(Ve,!1)},!0),r(Te,Ye)};b(Ie,Te=>{V()?Te(Ke):Te(qe,!1)}),r(xe,Oe)};b(Ce,xe=>{re()&&xe(le)});var Me=_(ce,2),ue=g(Me),be=xe=>{{let Oe=p(()=>[Be.Hover]);je(xe,{content:"Run All Tasks",get triggerOn(){return t(Oe)},children:(De,Ue)=>{vt(De,{size:.5,variant:"ghost-block",color:"neutral",disabled:!1,onclick:()=>{j&&j.setActiveTab(An.messageHistory),ae?.reportRunAllTasks(),I.runAllTasks()},children:(Ie,Ke)=>{oe(Ie,{name:"play"})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(ue,xe=>{t(me)&&xe(be)});var ye=_(ue,2);{let xe=p(()=>[Be.Hover]);je(ye,{content:"Add New Task",get triggerOn(){return t(xe)},children:(Oe,De)=>{{let Ue=p(()=>!X());vt(Oe,{size:.5,variant:"ghost-block",color:"neutral",get disabled(){return t(Ue)},onclick:H,children:(Ie,Ke)=>{oe(Ie,{name:"plus"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}var de=_(ye,2);sd(de,{get taskFilters(){return t(fe)},get activeTaskFilter(){return $e()},set activeTaskFilter(xe){$e(xe)}}),nd(_(de,2),{get initiallyOpen(){return he()}}),r(P,ge),Ae(),U()})(w,{get notStartedTasksCount(){return t(d)},get inProgressTasksCount(){return t(u)},get completedTasksCount(){return t(h)},get cancelledTasksCount(){return t(y)},get collapsed(){return s()},slot:"header",get activeTaskFilter(){return t(G)},set activeTaskFilter(P){T(G,P)},$$legacy:!0})}},$$legacy:!0}),r(z,D)};b(E,z=>{Y(R,"$isCurrConversationAgentic",a)&&n()&&z(F)}),r(i,A),Ae(),o()}var To,Gs=((To=Gs||{}).agentEdits="agent_edits",To.tasks="tasks",To);const rd=Symbol("swappable-panel-context");var $0=v('<div class="c-swappable-panel svelte-13kwypr"><div class="c-swappable-panel__content svelte-13kwypr"><!></div></div>');function b0(i,e){ke(e,!1);const n=()=>Y(d,"$activePanelStore",s),[s,a]=at(),o=Fe(ks.key),{canShowTaskList:l}=o,c=Fe(an.key),d=Dt(Gs.agentEdits);Nn(rd,{activePanel:d,togglePanel:()=>{zs(d,n()===Gs.agentEdits?Gs.tasks:Gs.agentEdits)}}),wt();var u=$0(),h=g(u),y=g(h),m=$=>{l0($,{})},f=$=>{var R=ee(),C=S(R),x=G=>{y0(G,{})};b(C,G=>{n()===Gs.tasks&&G(x)},!0),r($,R)};b(y,$=>{n()===Gs.agentEdits||!Y(l,"$canShowTaskList",s)||Y(c,"$remoteAgentsModel",s).isActive?$(m):$(f,!1)}),r(i,u),Ae(),a()}var w0=v('<div class="c-switch-mode-button__content svelte-rz5l7f"><!></div>'),C0=v('<div class="c-switch-mode-button__content svelte-rz5l7f"><!></div>'),k0=v('<div class="c-switch-mode-button svelte-rz5l7f"><div class="c-switch-mode-button__group svelte-rz5l7f"><!> <!></div></div>');function ad(i,e){ke(e,!0);const n=()=>Y(t(y),"$activeTab",a),s=()=>Y(t(h),"$activePanel",a),[a,o]=at(),l=Fe(rd),c=co(),d=Fe(ks.key);let u=p(()=>!!c),h=p(()=>l?.activePanel),y=p(()=>c?.model.activeTab),m=p(()=>t(u)?n()==="tasks":s()===Gs.tasks),f=p(()=>t(u)?n()==="agent-edits":s()===Gs.agentEdits),$=p(()=>t(f)?"Switch to Tasks view":"Switch to Changes view");async function R(){t(u)&&c?n()==="agent-edits"?c.controller.setActiveTab("tasks"):c.controller.setActiveTab("agent-edits"):l&&l.togglePanel()}var C=ee(),x=S(C),G=L=>{{let A=p(()=>[Be.Hover]);je(L,{get content(){return t($)},get triggerOn(){return t(A)},side:"top",children:(E,F)=>{var z=k0(),D=g(z),M=g(D);{let W=p(()=>t(m)?"soft":"ghost"),P=p(()=>t(m)?"accent":"neutral");Mt(M,{get variant(){return t(W)},get color(){return t(P)},size:.5,class:"c-switch-mode-button__tasks-btn",$$events:{click:R},children:(K,X)=>{var q=w0(),V=g(q);oe(V,{name:"list-checks"}),r(K,q)},$$slots:{default:!0}})}var w=_(M,2);{let W=p(()=>t(f)?"soft":"ghost"),P=p(()=>t(f)?"accent":"neutral");Mt(w,{get variant(){return t(W)},get color(){return t(P)},size:.5,class:"c-switch-mode-button__changes-btn",$$events:{click:R},children:(K,X)=>{var q=C0(),V=g(q);oe(V,{name:"file-diff"}),r(K,q)},$$slots:{default:!0}})}r(E,z)},$$slots:{default:!0}})}};b(x,L=>{l&&d&&L(G)}),r(i,C),Ae(),o()}var A0=v('<div class="c-agent-edits-header__switch-btn"><!></div>'),S0=v('<div class="c-agent-edits-header__summary"><!></div>'),M0=v('<!> <span class="c-agent-edits-header__revert-btn__text">Discard All</span>',1),x0=v('<!> <span class="c-agent-edits-header__accept-btn__text">Keep All</span>',1),T0=v('<div class="c-agent-edits-header__actions"><!> <!> <!></div>'),R0=v('<div class="c-agent-edits-header svelte-14lt18i"><div class="c-agent-edits-header__content"><div class="c-agent-edits-header__collapse-btn"><!></div> <!> <div class="c-agent-edits-header__info-container"><!></div> <!></div> <!></div>');function od(i,e){ke(e,!0);const[n,s]=at();let a=k(e,"onRevert",19,()=>{}),o=k(e,"onKeep",19,()=>{});const l=_t("enableTaskList");var c=R0(),d=g(c),u=g(d),h=g(u);Wr(h,{});var y=_(u,2),m=E=>{var F=A0();ad(g(F),{}),r(E,F)};b(y,E=>{Y(l,"$enableTaskList",n)&&E(m)});var f=_(y,2),$=g(f),R=E=>{var F=ee(),z=S(F);Rt(z,()=>e.text),r(E,F)},C=E=>{Le(E,{size:1,color:"neutral",truncate:!0,children:(F,z)=>{var D=se();pe(M=>ze(D,`${M??""} changed`),[()=>cr(e.filesCount,"file")]),r(F,D)},$$slots:{default:!0}})};b($,E=>{e.text?E(R):E(C,!1)});var x=_(f,2),G=E=>{var F=S0(),z=g(F);ao(z,{size:0,get totalAddedLines(){return e.diffSummary.totalAddedLines},get totalRemovedLines(){return e.diffSummary.totalRemovedLines}}),r(E,F)};b(x,E=>{e.hasChanges&&E(G)});var L=_(d,2),A=E=>{var F=T0(),z=g(F),D=P=>{Mt(P,{class:"c-agent-edits-header__revert-btn",variant:"soft",color:"neutral",size:.5,$$events:{click(...K){a()?.apply(this,K)}},children:(K,X)=>{{let q=p(()=>[Be.Hover]);je(K,{get triggerOn(){return t(q)},content:"Discard all changes",children:(V,N)=>{var U=M0(),I=S(U);oe(I,{name:"undo-2"}),r(V,U)},$$slots:{default:!0}})}},$$slots:{default:!0}})};b(z,P=>{a()&&P(D)});var M=_(z,2),w=P=>{Mt(P,{class:"c-agent-edits-header__accept-btn",variant:"soft",color:"success",size:.5,$$events:{click(...K){o()?.apply(this,K)}},children:(K,X)=>{{let q=p(()=>[Be.Hover]);je(K,{get triggerOn(){return t(q)},content:"Keep all changes and clear checkpoints",children:(V,N)=>{var U=x0(),I=S(U);oe(I,{name:"check-check"}),r(V,U)},$$slots:{default:!0}})}},$$slots:{default:!0}})};b(M,P=>{o()&&P(w)});var W=_(M,2);Rt(W,()=>e.actions??Kt),r(E,F)};b(L,E=>{(e.collapsed&&e.hasChanges&&(a()||o())||e.actions)&&E(A)}),r(i,c),Ae(),s()}var E0=v('<div class="c-edit"><!></div>'),I0=v("<span>Show less</span> <!>",1),z0=v("<span> </span> <!>",1),D0=v('<div class="c-show-more-container svelte-12l0x3p"><!></div>'),L0=v('<div class="c-edits-list svelte-12l0x3p"><div class="c-edits-section svelte-12l0x3p"><!> <!></div></div>'),P0=v('<div class="c-agent-edits-header__buttons__text--long svelte-12l0x3p">See full diff</div> <div class="c-agent-edits-header__buttons__text--short svelte-12l0x3p"><!></div>',1),O0=v('<div class="c-agent-edits-header__actions svelte-12l0x3p"><div class="c-agent-edits-header__actions__count"> </div> <div class="c-agent-edits-header__buttons svelte-12l0x3p"><!></div></div>'),N0=v('<div class="c-agent-edits-container svelte-12l0x3p"><!></div>'),F0=v('<div class="c-edits-list c-edits-list--empty svelte-12l0x3p"><!></div>');function q0(i,e){ke(e,!0);let n=k(e,"changedFiles",19,()=>[]),s=k(e,"collapsed",7,!1),a=k(e,"focusedFilePath",3,null),o=k(e,"emptyMessage",3,"No changes to show");const l=Fe("chatModel");let c=ct(!1);function d(){T(c,!t(c))}let u=[],h=p(()=>{const L=n().map(A=>{const E=Ki.generateDiff(A.old_path,A.new_path,A.old_contents||"",A.new_contents||""),F=Ki.getDiffObjectStats(E),z={totalAddedLines:F.additions,totalRemovedLines:F.deletions};return{file:A,qualifiedPathName:{rootPath:"",relPath:A.new_path||A.old_path},changesSummary:z}}).filter(A=>A.changesSummary.totalAddedLines>0||A.changesSummary.totalRemovedLines>0);return Xi(L,u)?u:(u=L,L)}),y={totalAddedLines:0,totalRemovedLines:0},m=p(()=>{const L=t(h).reduce((A,E)=>(A.totalAddedLines+=E.changesSummary.totalAddedLines,A.totalRemovedLines+=E.changesSummary.totalRemovedLines,A),{totalAddedLines:0,totalRemovedLines:0});return Xi(L,y)?y:(y=L,L)}),f=p(()=>t(h).length>3),$=p(()=>n().length>Hg);var R=ee(),C=S(R),x=L=>{var A=N0(),E=g(A);ur(E,{class:"c-agent-edits-container__block-container",get collapsed(){return s()},set collapsed(F){s(F)},children:(F,z)=>{var D=L0(),M=g(D),w=g(M);ln(w,17,()=>t(c)?t(h):t(h).slice(0,3),ls,(K,X)=>{const q=p(()=>a()===t(X).file.new_path||a()===t(X).file.old_path);var V=E0(),N=g(V);{const U=Z=>{var ae=ee(),j=S(ae),H=O=>{je(O,{content:"Toggle collapse unchanged regions",children:(J,te)=>{vt(J,{color:"neutral",size:.5,variant:"ghost-block",$$events:{click:ne=>{ne.stopPropagation(),l.extensionClient.toggleCollapseUnchangedRegions()}},children:(ne,re)=>{oe(ne,{name:"layers-2",size:1})},$$slots:{default:!0}})},$$slots:{default:!0}})};b(j,O=>{t(q)&&O(H)}),r(Z,ae)};let I=p(()=>e.onFileClick?()=>e.onFileClick(t(X).file.new_path||t(X).file.old_path):void 0),B=p(()=>e.onReviewClick?()=>e.onReviewClick(t(X).file):void 0),Q=p(()=>e.onRevertClick?()=>e.onRevertClick(t(X).file):void 0);ho(N,{get qualifiedPathName(){return t(X).qualifiedPathName},get lineChanges(){return t(X).changesSummary},get isFocused(){return t(q)},get onClickFile(){return t(I)},get onClickReview(){return t(B)},get onClickRevert(){return t(Q)},actions:U,$$slots:{actions:!0}})}Mn(3,V,()=>si),r(K,V)});var W=_(w,2),P=K=>{var X=D0(),q=g(X);Mt(q,{color:"neutral",size:1,variant:"soft",$$events:{click:d},children:(V,N)=>{var U=ee(),I=S(U),B=Z=>{var ae=I0(),j=_(S(ae),2);oe(j,{name:"chevron-up",slot:"iconRight"}),r(Z,ae)},Q=Z=>{const ae=p(()=>t(h).length-3);var j=z0(),H=S(j),O=g(H),J=_(H,2);oe(J,{name:"chevron-down",slot:"iconRight"}),pe(te=>ze(O,`Show ${t(ae)??""} more ${te??""}`),[()=>Ga(t(ae),"file")]),r(Z,j)};b(I,Z=>{t(c)?Z(B):Z(Q,!1)}),r(V,U)},$$slots:{default:!0}}),r(K,X)};b(W,K=>{t(f)&&K(P)}),r(F,D)},$$slots:{default:!0,header:(F,z)=>{od(F,{get filesCount(){return t(h).length},get diffSummary(){return t(m)},get collapsed(){return s()},hasChanges:!0,slot:"header",text:M=>{var w=O0(),W=g(w),P=g(W),K=_(W,2),X=g(K);{let q=p(()=>t($)?Ug:void 0);je(X,{get content(){return t(q)},children:(V,N)=>{Mt(V,{color:"neutral",size:.5,variant:"soft",get disabled(){return t($)},$$events:{click(...U){(e.onOpenDiffView||Er)?.apply(this,U)}},children:(U,I)=>{var B=P0(),Q=_(S(B),2),Z=g(Q);oe(Z,{name:"file-diff",size:1}),r(U,B)},$$slots:{default:!0}})},$$slots:{default:!0}})}pe(q=>ze(P,`${q??""} changed`),[()=>cr(t(h).length,"file")]),r(M,w)},$$slots:{text:!0}})}}}),r(L,A)},G=L=>{var A=F0(),E=g(A);Le(E,{size:1,color:"neutral",children:(F,z)=>{var D=se();pe(()=>ze(D,o())),r(F,D)},$$slots:{default:!0}}),r(L,A)};b(C,L=>{t(h).length>0?L(x):L(G,!1)}),r(i,R),Ae()}var B0=v('<div class="c-agent-footer__button svelte-1q47rwy"><!></div>'),U0=v('<div class="c-agent-footer__button svelte-1q47rwy"><!></div>'),H0=v('<div class="c-agent-footer__buttons svelte-1q47rwy"><!> <!></div>'),G0=v('<div class="c-agent-footer svelte-1q47rwy"><div class="c-agent-footer__status svelte-1q47rwy"><!></div> <!></div>'),W0=v(`Augment needs to modify your SSH configuration at <code>~/.ssh/config</code> to connect to the
        remote workspace. This will:`,1),j0=v('<div class="c-ssh-permission-modal__body svelte-1q47rwy"><!> <!> <!> <!> <!></div>'),V0=v('<div class="c-ssh-permission-modal__footer svelte-1q47rwy"><!> <!></div>'),K0=v("<!> <!>",1);function X0(i,e){ke(e,!1);const n=()=>Y(f,"$remoteAgentsModel",s),[s,a]=at(),o=_e(),l=_e(),c=_e(),d=_e(),u=_e(),h=_e(),y=_e(),m=_e(),f=Fe(an.key),$=Fe("chatModel"),R=Fe(Jl),C=Fe(ar.key),x=Dt(""),G=ag(x);let L=!0,A=_e(!1);mn(async()=>{L=await f.getShouldShowSSHConfigPermissionPrompt();try{const{remoteUrl:I,error:B}=await C.getRemoteUrl();if(B)throw new Error(B);x.set(I)}catch(I){console.error("Failed to get current repository URL:",I)}});let E=_e(!1),F=_e(0);function z(){L?T(A,!0):D()}function D(){t(c)&&(T(W,!0),async function(I){if(!I)return;const B=f.agentOverviews.find(Q=>Q.remote_agent_id===I);B&&await f.sshToRemoteAgent(B)}(t(c)).then(()=>{T(W,!1)}))}async function M(){T(A,!1);try{await f.setPermissionToWriteToSSHConfig(!0)}catch(I){console.error("Failed to set SSH permission:",I)}D()}function w(){T(A,!1)}let W=_e(!1);const P=Xn();async function K(I){const B=I.new_path||I.old_path;n().openDiffInBuffer(I.old_contents||"",I.new_contents||"",B)}function X(){if(!n().currentAgent?.remote_agent_id)return void console.error("No current agent ID found");f.reportRemoteAgentEvent({eventName:Pl.createdPR,remoteAgentId:n().currentAgent.remote_agent_id,eventData:{createdPRData:{}}}),T(E,!0);const I=Y($,"$chatModel",s).currentConversationModel,B=I?.selectedModelId;n().sendMessage("Please create a pull request with the changes you've made.",B??void 0).then(()=>{T(E,!1)}).catch(Q=>{console.error("Error sending PR creation request:",Q),T(E,!1)})}Ne(()=>t(F),()=>{T(o,t(F)>660)}),Ne(()=>n(),()=>{T(l,n()?.currentAgent)}),Ne(()=>t(l),()=>{T(c,t(l)?.remote_agent_id)}),Ne(()=>n(),()=>{T(d,n()?.isCurrentAgentDetailsLoading)}),Ne(()=>n(),()=>{T(u,og(n().currentConversation?.exchanges??[]))}),Ne(()=>n(),()=>{T(h,n().focusedFilePath)}),Ne(()=>n(),()=>{T(y,n().isRemoteAgentSshWindow)}),Ne(()=>(t(y),ws),()=>{T(m,t(y)?I=>{P(ws({repoRoot:"",pathName:I}))}:void 0)}),hn(),wt();var q=K0(),V=S(q),N=I=>{var B=G0(),Q=g(B),Z=g(Q),ae=O=>{{let J=Ge(()=>!t(o)),te=Ge(()=>t(d)?"Loading...":"No changes to show");q0(O,{get changedFiles(){return t(u)},get collapsed(){return t(J)},get focusedFilePath(){return t(h)},get emptyMessage(){return t(te)},onReviewClick:K,onOpenDiffView:()=>{R.set(-1),n().showRemoteAgentDiffPanel({turnIdx:-1,changedFiles:t(u),userPrompt:"",sessionSummary:"",isShowingAggregateChanges:!0,isAgentFromDifferentRepo:Y(G,"$isAgentFromDifferentRepo",s)(t(l))})},get onFileClick(){return t(m)}})}};b(Z,O=>{t(u),Re(()=>t(u).length>0)&&O(ae)});var j=_(Q,2),H=O=>{var J=H0(),te=g(J),ne=$e=>{var me=B0(),fe=g(me);{let ge=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(fe,{get triggerOn(){return t(ge)},content:"Create a GitHub pull request with the changes",children:(ce,we)=>{{let Se=Ge(()=>(Ee(In),t(l),Re(()=>[In.agentUnspecified,In.agentPending,In.agentStarting].includes(t(l)?.status))));Mt(ce,{size:2,variant:"soft",color:"neutral",class:"c-agent-footer__open-btn",get disabled(){return t(Se)},$$events:{click:X},children:(ie,Ce)=>{var le=ee(),Me=S(le),ue=ye=>{var de=se("Creating a PR...");r(ye,de)},be=ye=>{var de=se("Create a PR");r(ye,de)};b(Me,ye=>{t(E)?ye(ue):ye(be,!1)}),r(ie,le)},$$slots:{default:!0,iconRight:(ie,Ce)=>{oe(ie,{slot:"iconRight",name:"git-pull-request"})}}})}},$$slots:{default:!0}})}r($e,me)};b(te,$e=>{t(u),Re(()=>t(u).length>0)&&$e(ne)});var re=_(te,2),he=$e=>{var me=U0(),fe=g(me);{let ge=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(fe,{get triggerOn(){return t(ge)},content:"SSH into the remote agent's workspace in a new VSCode window",children:(ce,we)=>{{const Se=Ce=>{var le=ee(),Me=S(le),ue=ye=>{Dn(ye,{size:1,useCurrentColor:!0})},be=ye=>{oe(ye,{name:"external-link"})};b(Me,ye=>{t(W)?ye(ue):ye(be,!1)}),r(Ce,le)};let ie=Ge(()=>(Ee(In),t(l),t(W),Re(()=>[In.agentUnspecified,In.agentPending,In.agentStarting].includes(t(l)?.status)||t(W))));Mt(ce,{size:2,variant:"soft",color:"accent",class:"c-agent-footer__open-btn",get disabled(){return t(ie)},$$events:{click:z},iconRight:Se,children:(Ce,le)=>{var Me=ee(),ue=S(Me),be=de=>{var xe=se("Connecting...");r(de,xe)},ye=de=>{var xe=se("Open remote workspace");r(de,xe)};b(ue,de=>{t(W)?de(be):de(ye,!1)}),r(Ce,Me)},$$slots:{iconRight:!0,default:!0}})}},$$slots:{default:!0}})}r($e,me)};b(re,$e=>{t(y)||$e(he)}),r(O,J)};b(j,O=>{t(c)&&!t(y)&&O(H)}),r(I,B)};b(V,I=>{t(l)&&I(N)});var U=_(V,2);fc(U,{get show(){return t(A)},title:"SSH Configuration Permission",$$events:{cancel:w},body:Q=>{var Z=j0(),ae=g(Z);Le(ae,{size:1,children:(te,ne)=>{var re=W0();r(te,re)},$$slots:{default:!0}});var j=_(ae,2);Le(j,{size:1,children:(te,ne)=>{var re=se(" Create or update SSH configuration files");r(te,re)},$$slots:{default:!0}});var H=_(j,2);Le(H,{size:1,children:(te,ne)=>{var re=se(" Add connection settings for the remote agent");r(te,re)},$$slots:{default:!0}});var O=_(H,2);Le(O,{size:1,children:(te,ne)=>{var re=se(" Enable secure access to your remote workspace");r(te,re)},$$slots:{default:!0}});var J=_(O,2);Le(J,{size:1,children:(te,ne)=>{var re=se(" Your existing SSH configuration will be preserved.");r(te,re)},$$slots:{default:!0}}),r(Q,Z)},footer:Q=>{var Z=V0(),ae=g(Z);Mt(ae,{variant:"solid",color:"neutral",$$events:{click:w},children:(H,O)=>{var J=se("Cancel");r(H,J)},$$slots:{default:!0}});var j=_(ae,2);Mt(j,{variant:"solid",color:"accent",$$events:{click:M},children:(H,O)=>{var J=se("Allow & Connect");r(H,J)},$$slots:{default:!0}}),r(Q,Z)},$$slots:{body:!0,footer:!0}}),function(I,B){Id(window,["resize"],()=>zd(()=>B(window[I])))}("innerHeight",I=>T(F,I)),r(i,q),Ae(),a()}var J0=v('<span class="view-icon svelte-l82b9o" slot="iconLeft"><!></span>'),Y0=v('<div class="version-navigation svelte-l82b9o"><!> <!> <!></div>'),Q0=v('<div class="header-content__actions"><!></div>'),Z0=v('<div class="dropdown-item-content svelte-l82b9o"><!> <!></div>'),e$=v('<div class="dropdown-item-content svelte-l82b9o"><!> <!></div>'),t$=v("<!> <!>",1),n$=v("<!> <!>",1),s$=v('<div class="error-message svelte-l82b9o"><!></div>'),r$=v('<div class="setup-script-save-bar svelte-l82b9o"><div class="header-content svelte-l82b9o"><div class="header-content__title svelte-l82b9o"><!> <!></div> <div class="header-content__title svelte-l82b9o"><!> <!></div></div> <div class="save-bar-content svelte-l82b9o"><!> <!> <!> <!> <div class="input-group location-buttons svelte-l82b9o"><!></div> <!></div></div>');function a$(i,e){ke(e,!1);const n=()=>Y(d,"$remoteAgentsModel",s),[s,a]=at(),o=_e(),l=_e(),c=_e(),d=Fe(an.key),u=Fe("chatModel");let h=_e("setup.sh"),y=_e("home"),m=_e(!1),f=_e(""),$=_e(0);const R=E=>{const F=document.querySelector(`[data-tool-id="${E}"]`);F&&F.scrollIntoView({behavior:"smooth",block:"start"})};function C(E=1){T($,Math.max(0,Math.min(t(o).length-1,t($)+E)));const F=t(o)[t($)];F?.id&&(R(F.id),setTimeout(()=>{R(F.id)},500))}async function x(E){if(t(h)&&E)if(t(c)?.content)try{T(m,!0),T(f,"");const F=t(h).endsWith(".sh")?t(h):`${t(h)}.sh`,z=await d.saveSetupScript(F,t(c).content,E);let D;if(!z.success||!z.path)return void T(f,z.error||"Failed to save setup script");if(D=(await d.listSetupScripts()).find(X=>X.path===z.path),!D)return void T(f,"Failed to save script");const M=n()?.currentAgent,w=M?.workspace_setup?.starting_files?.github_commit_ref?.git_ref,W=M?.workspace_setup?.starting_files?.github_commit_ref?.repository_url;await d.saveLastRemoteAgentSetup(W||null,w||null,z.path),lg||d.setCurrentAgent(void 0);const P=Y(u,"$chatModel",s).currentConversationModel,K=P.draftExchange?.request_message;if(K&&K.trim())try{if(M?.workspace_setup?.starting_files?.github_commit_ref&&w&&W){const X=M.workspace_setup.starting_files,q={commitRef:X,selectedBranch:{name:w,commit:{sha:"",url:""},protected:!1},setupScript:D,isDisabled:!1,enableNotification:!0,isSetupScriptAgent:!1};d.setNewAgentDraft(q);const V=await d.createRemoteAgentFromDraft(K,P.selectedModelId??void 0);V?await d.setCurrentAgent(V):T(f,"Script saved successfully, but failed to create remote agent")}else T(f,"Script saved successfully, but no workspace information available to create remote agent")}catch(X){console.error("Failed to create remote agent:",X),T(f,"Script saved successfully, but failed to create remote agent")}else d.setCurrentAgent(void 0)}catch(F){T(f,F instanceof Error?F.message:"Unknown error occurred")}finally{T(m,!1)}else T(f,"No script content to save");else T(f,"Please provide both script name and location")}Ne(()=>n(),()=>{var E;T(o,(E=n().currentConversation?.exchanges||[])&&Array.isArray(E)?E.flatMap(F=>(F.exchange.response_nodes||[]).filter(z=>z.type===Tr.TOOL_USE&&z.tool_use?.tool_name==="setup-script"&&z.tool_use?.input_json).map(z=>{try{const D=typeof z.tool_use.input_json=="string"?JSON.parse(z.tool_use.input_json):z.tool_use.input_json,M=n().getToolUseState(z.tool_use.tool_use_id),w=F.exchange?.request_id||F.request_id||"";return w||console.warn("SetupScriptSaveBar: Missing request_id for an exchange",F),{content:D.script_content||"",timestamp:z.timestamp,status:M.phase,requestId:w,id:z.tool_use.tool_use_id}}catch(D){return console.error("Failed to parse setup script JSON:",D),null}})).filter(F=>F!==null&&F.content!==""):[])}),Ne(()=>t(o),()=>{T(l,t(o).length)}),Ne(()=>t(l),()=>{t(l)&&T($,t(l)-1)}),Ne(()=>(t(o),t($)),()=>{T(c,t(o)[t($)])}),hn(),wt();var G=ee(),L=S(G),A=E=>{var F=r$(),z=g(F),D=g(z),M=g(D);Le(M,{size:1,weight:"medium",children:(O,J)=>{var te=se("Setup script");r(O,te)},$$slots:{default:!0}});var w=_(M,2);je(w,{content:"View full script in editor",side:"bottom",children:(O,J)=>{Mt(O,{variant:"ghost-block",color:"neutral",size:1,$$events:{click:()=>{u.extensionClient.openScratchFile(t(c)?.content,"shellscript")}},children:(te,ne)=>{var re=se("View");r(te,re)},$$slots:{default:!0,iconLeft:(te,ne)=>{var re=J0(),he=g(re);oe(he,{name:"external-link"}),r(te,re)}}})},$$slots:{default:!0}});var W=_(D,2),P=g(W),K=O=>{var J=Y0(),te=g(J);{let he=Ge(()=>t($)===0?"":"Switch to previous script"),$e=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(te,{get content(){return t(he)},get triggerOn(){return t($e)},children:(me,fe)=>{{let ge=Ge(()=>t($)===0);vt(me,{variant:"ghost-block",size:1,get disabled(){return t(ge)},title:"Previous version",$$events:{click:()=>C(-1)},children:(ce,we)=>{oe(ce,{name:"chevron-left"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}var ne=_(te,2);Le(ne,{size:1,color:"secondary",class:"header-content__version-count",children:(he,$e)=>{var me=se();pe(()=>ze(me,`${t($)+1} of ${t(o),Re(()=>t(o).length)??""}`)),r(he,me)},$$slots:{default:!0}});var re=_(ne,2);{let he=Ge(()=>(t($),t(o),Re(()=>t($)===t(o).length-1?"":"Switch to next script"))),$e=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(re,{get content(){return t(he)},get triggerOn(){return t($e)},children:(me,fe)=>{{let ge=Ge(()=>(t($),t(o),Re(()=>t($)===t(o).length-1)));vt(me,{variant:"ghost-block",size:1,get disabled(){return t(ge)},title:"Next version",$$events:{click:()=>C(1)},children:(ce,we)=>{oe(ce,{name:"chevron-right"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}r(O,J)},X=O=>{Le(O,{size:1,color:"secondary",class:"header-content__version-count",children:(J,te)=>{var ne=se("No versions");r(J,ne)},$$slots:{default:!0}})};b(P,O=>{t(o),Re(()=>t(o).length>0)?O(K):O(X,!1)});var q=_(P,2),V=O=>{var J=Q0(),te=g(J);{let ne=Ge(()=>(t(c),Ee($r),Re(()=>t(c).status===$r.completed?"success":t(c).status===$r.error?"error":"loading")));lh(te,{get commandResult(){return t(ne)}})}r(O,J)};b(q,O=>{t(c),Re(()=>t(c)?.status)&&O(V)});var N=_(z,2),U=g(N);Le(U,{size:1,weight:"medium",children:(O,J)=>{var te=se("File Name");r(O,te)},$$slots:{default:!0}});var I=_(U,2);Nr(I,{placeholder:"Script name",size:1,get value(){return t(h)},set value(O){T(h,O)},$$events:{blur:()=>{t(h)?t(h).endsWith(".sh")||T(h,t(h)+".sh"):T(h,"setup.sh")}},$$legacy:!0});var B=_(I,2);Le(B,{size:1,weight:"medium",children:(O,J)=>{var te=se("Path");r(O,te)},$$slots:{default:!0}});var Q=_(B,2);He.Root(Q,{children:(O,J)=>{var te=n$(),ne=S(te);He.Trigger(ne,{children:(he,$e)=>{{let me=Ge(()=>t(y)==="home"?"~/.augment/env/":".augment/env");Nr(he,{get value(){return t(me)},placeholder:"Script name",size:1,children:(fe,ge)=>{oe(fe,{name:"chevron-down"})},$$slots:{default:!0}})}},$$slots:{default:!0}});var re=_(ne,2);He.Content(re,{size:1,children:(he,$e)=>{var me=t$(),fe=S(me);He.Item(fe,{onSelect:()=>T(y,"home"),children:(ce,we)=>{{let Se=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(ce,{content:"Save the setup script in your machine's home directory",get triggerOn(){return t(Se)},children:(ie,Ce)=>{var le=Z0(),Me=g(le);Le(Me,{size:1,weight:"medium",children:(be,ye)=>{var de=se("~/.augment/env/");r(be,de)},$$slots:{default:!0}});var ue=_(Me,2);Jt.Root(ue,{variant:"soft",color:"info",size:1,children:(be,ye)=>{var de=se("Local");r(be,de)},$$slots:{default:!0}}),r(ie,le)},$$slots:{default:!0}})}},$$slots:{default:!0}});var ge=_(fe,2);He.Item(ge,{onSelect:()=>T(y,"git"),children:(ce,we)=>{{let Se=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(ce,{content:"Save the setup script in the Git repository, for your team to use when you push your changes",get triggerOn(){return t(Se)},children:(ie,Ce)=>{var le=e$(),Me=g(le);Le(Me,{size:1,weight:"medium",children:(be,ye)=>{var de=se(".augment/env");r(be,de)},$$slots:{default:!0}});var ue=_(Me,2);Jt.Root(ue,{variant:"soft",color:"info",size:1,children:(be,ye)=>{var de=se("Repo");r(be,de)},$$slots:{default:!0}}),r(ie,le)},$$slots:{default:!0}})}},$$slots:{default:!0}}),r(he,me)},$$slots:{default:!0}}),r(O,te)},$$slots:{default:!0}});var Z=_(Q,2),ae=g(Z);{let O=Ge(()=>t(m)||!t(h)||!t(y));Mt(ae,{variant:"soft",color:"neutral",size:2,get disabled(){return t(O)},$$events:{click:()=>x(t(y))},children:(J,te)=>{var ne=se();pe(()=>ze(ne,"Save Script")),r(J,ne)},$$slots:{default:!0}})}var j=_(Z,2),H=O=>{var J=s$(),te=g(J);Le(te,{size:1,color:"error",children:(ne,re)=>{var he=se();pe(()=>ze(he,t(f))),r(ne,he)},$$slots:{default:!0}}),r(O,J)};b(j,O=>{t(f)&&O(H)}),r(E,F)};b(L,E=>{t(o),Re(()=>t(o).length>0)&&E(A)}),r(i,G),Ae(),a()}var o$=v('<div class="trash-icon"><!></div>'),i$=v("<!> <!> <!>",1),l$=v("<!> <!> <!> <!> <!> <!>",1),c$=v("<!> <!>",1);function d$(i,e){ke(e,!1);const n=()=>Y($,"$agentIdCopyTextMap",a),s=()=>Y(R,"$shareLinkCopyTextMap",a),[a,o]=at();let l=k(e,"agentId",8),c=k(e,"selectedBranch",24,()=>{}),d=k(e,"isPinned",8,!1),u=k(e,"togglePinned",24,()=>{}),h=k(e,"enableRename",8,!1),y=k(e,"isEditing",12,!1),m=k(e,"onDelete",24,()=>{}),f=_e(()=>{});const $=Dt(new Map),R=Dt(new Map),C=Fe(an.key);wt(),He.Root(i,{nested:!1,get requestClose(){return t(f)},set requestClose(x){T(f,x)},children:(x,G)=>{var L=c$(),A=S(L);He.Trigger(A,{children:(F,z)=>{vt(F,{variant:"ghost-block",color:"neutral",size:1,title:"Agent options",children:(D,M)=>{oe(D,{name:"ellipsis"})},$$slots:{default:!0}})},$$slots:{default:!0}});var E=_(A,2);He.Content(E,{size:1,side:"bottom",align:"end",children:(F,z)=>{var D=l$(),M=S(D),w=I=>{He.Item(I,{onSelect:()=>{setTimeout(()=>{y(!0)},20)},children:(B,Q)=>{var Z=se("Rename");r(B,Z)},$$slots:{default:!0,iconLeft:(B,Q)=>{oe(B,{slot:"iconLeft",name:"square-pen"})}}})};b(M,I=>{h()&&I(w)});var W=_(M,2),P=I=>{He.Item(I,{title:"Pin or unpin agent",onSelect:()=>{u()()},children:(B,Q)=>{var Z=se();pe(()=>ze(Z,d()?"Unpin":"Pin")),r(B,Z)},$$slots:{default:!0,iconLeft:(B,Q)=>{oe(B,{name:"pin",class:"pin-icon",slot:"iconLeft"})}}})};b(W,I=>{u()&&I(P)});var K=_(W,2);He.Item(K,{onSelect:()=>{navigator.clipboard.writeText(l()),$.update(I=>(I.set(l(),"Copied!"),I)),setTimeout(()=>{$.update(I=>(I.delete(l()),I))},1e3)},children:(I,B)=>{var Q=ee(),Z=S(Q),ae=H=>{var O=se();pe(J=>ze(O,J),[()=>(n(),Ee(l()),Re(()=>n().get(l())))]),r(H,O)},j=H=>{var O=se("Copy ID");r(H,O)};b(Z,H=>{n(),Ee(l()),Re(()=>n().get(l()))?H(ae):H(j,!1)}),r(I,Q)},$$slots:{default:!0,iconLeft:(I,B)=>{oe(I,{name:"copy",slot:"iconLeft"})}}});var X=_(K,2);He.Item(X,{onSelect:()=>{(async function(){try{const I=await C?.getConversationUrl(l());I&&navigator.clipboard.writeText(I),R.update(B=>(B.set(l(),"Link copied!"),B)),setTimeout(()=>{R.update(B=>(B.delete(l()),B))},1e3)}catch(I){console.error("Failed to get conversation URL: ",I)}})(),t(f)()},children:(I,B)=>{var Q=ee(),Z=S(Q),ae=H=>{var O=se();pe(J=>ze(O,J),[()=>(s(),Ee(l()),Re(()=>s().get(l())))]),r(H,O)},j=H=>{var O=se("Share");r(H,O)};b(Z,H=>{s(),Ee(l()),Re(()=>s().get(l()))?H(ae):H(j,!1)}),r(I,Q)},$$slots:{default:!0,iconLeft:(I,B)=>{oe(I,{slot:"iconLeft",name:"share-2"})}}});var q=_(X,2),V=I=>{He.Item(I,{color:"error",onSelect:()=>{m()?.()},children:(B,Q)=>{var Z=se("Delete");r(B,Z)},$$slots:{default:!0,iconLeft:(B,Q)=>{var Z=o$(),ae=g(Z);oe(ae,{name:"trash-2"}),r(B,Z)}}})};b(q,I=>{m()&&I(V)});var N=_(q,2),U=I=>{var B=i$(),Q=S(B);He.Separator(Q,{});var Z=_(Q,2);He.Label(Z,{children:(j,H)=>{var O=se("Branch");r(j,O)},$$slots:{default:!0}});var ae=_(Z,2);He.Item(ae,{disabled:!0,children:(j,H)=>{var O=se();pe(()=>ze(O,c())),r(j,O)},$$slots:{default:!0}}),r(I,B)};b(N,I=>{c()&&I(U)}),r(F,D)},$$slots:{default:!0}}),r(x,L)},$$slots:{default:!0},$$legacy:!0}),Ae(),o()}var u$=v('<div class="c-thread-header__banner svelte-4g48lc"><!></div>'),h$=v('<div class="c-thread-header__title-notice"><!></div>'),g$=v('<div class="c-thread-header__info-row svelte-4g48lc"><!></div>'),v$=v('<div class="c-thread-header__status svelte-4g48lc"><!></div>'),p$=v('<div class="c-thread-header svelte-4g48lc"><!> <!> <!> <!></div>');const m$=i=>{var e=w$(),n=g(e);Le(n,{size:1,weight:"medium",children:(s,a)=>{var o=b$();r(s,o)},$$slots:{default:!0}}),r(i,e)};var f$=v('<div class="c-agent-header-banner__with-icon svelte-1gnicmu"><!> <div class="c-agent-header-banner__stack svelte-1gnicmu"><div class="c-agent-header-banner__text svelte-1gnicmu">Running in the cloud</div> <div class="c-agent-header-banner__text c-agent-header-banner__text--secondary svelte-1gnicmu">Workspace opened via SSH in this VSCode window</div></div></div>'),_$=v('<span class="c-agent-header-banner__text svelte-1gnicmu"><div class="c-setup-script-badge svelte-1gnicmu"><!></div> Generate a setup script</span>'),y$=v('<div class="c-agent-header__actions svelte-1gnicmu"><!></div>'),$$=v('<div class="c-agent-header__banner svelte-1gnicmu"><!> <!></div>'),b$=v(`We've tasked an agent to generate a setup script for your repository.<span class="c-agent-title-content__long-text-alternative svelte-1gnicmu">..</span> <span class="c-agent-title-content__long-text svelte-1gnicmu">Once created, save it to use in a new remote agent, to install dependencies & configure the
        env before the agent starts.</span>`,1),w$=v('<div class="c-agent-title-content svelte-1gnicmu"><!></div>'),C$=v('<div class="c-agent-info-row svelte-1gnicmu"><!> <!></div>'),k$=v("<div><!></div>");function A$(i,e){ke(e,!0);const n=()=>Y(c,"$remoteAgentsModel",s),[s,a]=at(),o=z=>{var D=$$(),M=g(D),w=X=>{var q=f$(),V=g(q);oe(V,{name:"cloud-upload",size:2}),r(X,q)},W=X=>{var q=ee(),V=S(q),N=U=>{var I=_$(),B=g(I),Q=g(B);oe(Q,{name:"square-terminal",size:2}),r(U,I)};b(V,U=>{t(m)&&U(N)},!0),r(X,q)};b(M,X=>{t($)?X(w):X(W,!1)});var P=_(M,2),K=X=>{var q=y$();d$(g(q),{get agentId(){return t(u)},get selectedBranch(){return t(x)},get isPinned(){return t(f)},togglePinned:R,onDelete:C}),r(X,q)};b(P,X=>{t(u)&&t(G)&&X(K)}),r(z,D)},l=z=>{var D=C$(),M=g(D);gg(M,{get repoUrl(){return t(h)},get repoName(){return t(y)}});var w=_(M,2),W=P=>{vg(P,{get repoUrl(){return t(h)},get branchName(){return t(x)}})};b(w,P=>{t(x)&&P(W)}),r(z,D)},c=Fe(an.key),d=p(()=>n()?.currentAgent),u=p(()=>t(d)?.remote_agent_id),h=p(()=>t(d)?.workspace_setup?.starting_files?.github_commit_ref?.repository_url||""),y=p(()=>cc(t(h))),m=p(()=>t(d)?.is_setup_script_agent),f=p(()=>t(u)&&n()?.pinnedAgents[t(u)]||!1),$=p(()=>n()?.isRemoteAgentSshWindow);function R(){t(u)&&c?.toggleAgentPinned(t(u),t(f))}const C=async()=>{!t(u)||!c||await c?.deleteAgent(t(u))&&c.setCurrentAgent(void 0)},x=p(()=>t(d)?.workspace_setup?.starting_files?.github_commit_ref?.git_ref),G=p(()=>t($)||t(m)),L=p(()=>t(u)&&t(G));var A=ee(),E=S(A),F=z=>{var D=k$();let M;var w=g(D);{let W=p(()=>t(G)||t(L)?o:void 0),P=p(()=>t(m)?m$:void 0);(function(K,X){const q=k(X,"isSquished",3,!1);var V=p$(),N=g(V),U=H=>{var O=u$(),J=g(O);Rt(J,()=>X.banner),r(H,O)};b(N,H=>{X.banner&&H(U)});var I=_(N,2),B=H=>{var O=h$(),J=g(O);Rt(J,()=>X.titleNotice),r(H,O)};b(I,H=>{X.titleNotice&&H(B)});var Q=_(I,2),Z=H=>{var O=g$(),J=g(O);Rt(J,()=>X.infoRow),r(H,O)};b(Q,H=>{!q()&&X.infoRow&&H(Z)});var ae=_(Q,2),j=H=>{var O=v$(),J=g(O);Rt(J,()=>X.status),r(H,O)};b(ae,H=>{X.status&&H(j)}),r(K,V)})(w,{get banner(){return t(W)},get titleNotice(){return t(P)},get infoRow(){return l}})}pe(W=>M=Lt(D,1,"c-agent-header svelte-1gnicmu",null,M,W),[()=>({"c-agent-header--setup-script":t(m),"c-agent-header--is-in-remote":t($)})]),r(z,D)};b(E,z=>{t(d)&&z(F)}),r(i,A),Ae(),a()}var S$=v('<!> <div class="l-thread-header__portal-container svelte-15nn78n" id="thread-header-portal-container"></div>',1);function M$(i,e){ke(e,!1);const[n,s]=at(),a=Fe(an.key);wt();var o=S$(),l=S(o),c=d=>{A$(d,{})};b(l,d=>{Y(a,"$remoteAgentsModel",n)?.isActive&&d(c)}),r(i,o),Ae(),s()}var ps=(i=>(i.disableCopilot="ShouldDisableCopilot",i.disableCodeium="ShouldDisableCodeium",i.workspacePopulated="WorkspacePopulated",i.workspaceNotPopulated="WorkspaceNotPopulated",i.workspaceNotSelected="WorkspaceNotSelected",i.signInRequired="UserShouldSignIn",i.allActionsComplete="AllActionsComplete",i.syncingPermissionNeeded="SyncingPermissionNeeded",i.workspaceTooLarge="workspaceTooLarge",i.uploadingHomeDir="uploadingHomeDir",i))(ps||{}),id=(i=>(i.signInInProgress="SignInInProgress",i))(id||{}),x$=v("<!> <!>",1),T$=v('<div class="c-callout-wrapper svelte-gdfdqy"><!> <!></div>'),R$=v('<div class="c-base-card svelte-gdfdqy"><!> <!></div>');function no(i,e){ke(e,!0);var n=R$(),s=g(n),a=c=>{var d=x$(),u=S(d);ns(u,{variant:"soft",size:1,get color(){return e.color},children:(y,m)=>{Ta(y,{get markdown(){return e.description}})},$$slots:{default:!0}});var h=_(u,2);ns(h,{variant:"soft",size:1,color:"info",get icon(){return e.icon},children:(y,m)=>{Ta(y,{get markdown(){return e.callout}})},$$slots:{default:!0}}),r(c,d)},o=c=>{ns(c,{variant:"soft",size:1,get color(){return e.color},get icon(){return e.icon},children:(d,u)=>{var h=T$(),y=g(h);Ta(y,{get markdown(){return e.description}});var m=_(y,2),f=$=>{vt($,{variant:"ghost",color:"neutral",size:1,$$events:{click:()=>e.onClose()},children:(R,C)=>{oe(R,{name:"x"})},$$slots:{default:!0}})};b(m,$=>{e.onClose&&$(f)}),r(d,h)},$$slots:{default:!0}})};b(s,c=>{e.callout?c(a):c(o,!1)});var l=_(s,2);Rt(l,()=>e.children??Kt),r(i,n),Ae()}var E$=v('<div class="c-progress-bar svelte-1rwe3h9"><div class="c-progress-bar__bar svelte-1rwe3h9"></div></div>'),I$=v('<div class="c-btns-card__buttons svelte-1nln15u"></div> <!>',1);function Zr(i,e){ke(e,!0);let n=k(e,"buttons",19,()=>[]),s=k(e,"inProgress",3,!1),a=k(e,"callout",19,()=>{});no(i,{get color(){return e.color},get description(){return e.description},get callout(){return a()},get icon(){return e.icon},children:(o,l)=>{var c=I$(),d=S(c);ln(d,21,n,ls,(y,m)=>{let f=()=>t(m).text,$=()=>t(m).appearance;{let R=p(()=>$()?$():"accent");Mt(y,{size:2,variant:"solid",get color(){return t(R)},class:"c-btns-card__button",get title(){return f()},$$events:{click:()=>function(C){Rn.postMessage({type:Sn.mainPanelPerformAction,data:C})}(t(m).action)},children:(C,x)=>{var G=se();pe(()=>ze(G,f())),r(C,G)},$$slots:{default:!0}})}});var u=_(d,2),h=y=>{(function(m){var f=E$();r(m,f)})(y)};b(u,y=>{s()&&y(h)}),r(o,c)},$$slots:{default:!0}}),Ae()}function ld(i,e){ke(e,!0);const[n,s]=at(),a=Io("userTier"),o=Io("maxTrackableFileCount");var l=ee(),c=S(l),d=h=>{Zr(h,{color:"neutral",description:"Welcome to Augment! Sign in to your existing account or create a new one to get started.",buttons:[{text:"Start using Augment",action:"sign-in"}],icon:m=>{oe(m,{name:"info"})},$$slots:{icon:!0}})},u=h=>{var y=ee(),m=S(y),f=R=>{Zr(R,{color:"neutral",description:"Please complete the sign-in process in your browser.",buttons:[{text:"Cancel",action:"cancel-sign-in",appearance:"neutral"}],inProgress:!0,icon:x=>{oe(x,{name:"info"})},$$slots:{icon:!0}})},$=R=>{var C=ee(),x=S(C),G=A=>{Zr(A,{color:"warning",description:"GitHub Copilot suggestions will collide with Augment's suggestions. Turn off Copilot to fix this.",buttons:[{text:"Disable Github Copilot",action:"disable-github-copilot"}],icon:F=>{oe(F,{name:"circle-alert"})},$$slots:{icon:!0}})},L=A=>{var E=ee(),F=S(E),z=M=>{Zr(M,{color:"warning",description:"Codeium suggestions will collide with Augment's suggestions. Turn off Codeium to fix this.",buttons:[{text:"Disable Codeium",action:"disable-codeium"}],icon:W=>{oe(W,{name:"circle-alert"})},$$slots:{icon:!0}})},D=M=>{var w=ee(),W=S(w),P=X=>{{const q=N=>{oe(N,{name:"info"})};let V=p(()=>Y(a,"$userTier",n)==="community"?"You are subscribed to the Community plan, we may use any code you share to train our AI models.":void 0);Zr(X,{color:"neutral",description:"To provide the best quality responses, Augment will index your code in our secure cloud. Your data always stays secure and private. [Learn More](https://docs.augmentcode.com/setup-augment/workspace-indexing)",get callout(){return t(V)},buttons:[{text:"Enable Indexing",action:"grant-sync-permission"}],icon:q,$$slots:{icon:!0}})}},K=X=>{var q=ee(),V=S(q),N=I=>{{const B=Z=>{oe(Z,{name:"circle-alert"})};let Q=p(()=>`The workspace you have opened exceeds Augment's ${Y(o,"$maxTrackableFileCount",n)} file upload limit. Please use a .augmentignore or .gitignore to exclude files from being uploaded, or open a smaller workspace.`);no(I,{color:"warning",get description(){return t(Q)},icon:B,$$slots:{icon:!0}})}},U=I=>{var B=ee(),Q=S(B),Z=j=>{no(j,{color:"warning",description:"Current workspace contains your home directory. Augment cannot upload your home directory to the cloud. Please open a different workspace",icon:O=>{oe(O,{name:"circle-alert"})},$$slots:{icon:!0}})},ae=j=>{var H=ee(),O=S(H),J=te=>{};b(O,te=>{e.card===ps.allActionsComplete&&te(J)},!0),r(j,H)};b(Q,j=>{e.card===ps.uploadingHomeDir?j(Z):j(ae,!1)},!0),r(I,B)};b(V,I=>{e.card===ps.workspaceTooLarge?I(N):I(U,!1)},!0),r(X,q)};b(W,X=>{e.card===ps.syncingPermissionNeeded?X(P):X(K,!1)},!0),r(M,w)};b(F,M=>{e.card===ps.disableCodeium?M(z):M(D,!1)},!0),r(A,E)};b(x,A=>{e.card===ps.disableCopilot?A(G):A(L,!1)},!0),r(R,C)};b(m,R=>{e.card===id.signInInProgress?R(f):R($,!1)},!0),r(h,y)};b(c,h=>{e.card===ps.signInRequired?h(d):h(u,!1)}),r(i,l),Ae(),s()}function z$(i,e){ke(e,!0);const n=()=>Y(l,"$clientAnnouncement",s),[s,a]=at(),o=Fe("chatModel");let l=_u(),c=Kh();const d=yu($u);let u=p(()=>n()?.length&&!Y(c,"$displayedAnnouncements",s).includes(n()));var h=ee(),y=S(h),m=f=>{no(f,{color:"accent",get description(){return n()},onClose:async()=>{T(u,!1),d(n()),o.save()},icon:R=>{oe(R,{name:"info"})},$$slots:{icon:!0}})};b(y,f=>{t(u)&&f(m)}),r(i,h),Ae(),a()}var D$=v('<div role="tabpanel"><!></div>');function Aa(i,e){ke(e,!0);const[n,s]=at();let a=k(e,"class",3,""),o=k(e,"forceMount",3,!1);const l=co();if(!l)throw new Error("TabPanelAugment must be used within a TabsAugment component");const{activeTab:c}=l.model;let d=p(()=>Y(c,"$activeTab",n)===e.value),u=p(()=>o()||t(d)),h=ct(!1),y=ct(!1),m=!1;function f(){T(h,!1),T(y,!1)}zt(()=>{t(d)!==m&&(t(d)?(T(h,!0),T(y,!1)):(T(h,!1),T(y,!0)),m=t(d))});var $=ee(),R=S($),C=x=>{var G=D$();let L;var A=g(G);Rt(A,()=>e.children??Kt),pe(E=>{L=Lt(G,1,Ko(["ds-tab-panel",a()]),"svelte-g8i1xj",L,E),en(G,"aria-labelledby",`tab-${e.value??""}`),en(G,"aria-hidden",!t(d)),G.inert=!t(d),en(G,"data-state",t(d)?"active":"inactive")},[()=>({"ds-tab-panel--active":t(d),"ds-tab-panel--entering":t(h),"ds-tab-panel--leaving":t(y),"ds-tab-panel--hidden":!t(d)})]),Nt("animationend",G,f),r(x,G)};b(R,x=>{t(u)&&x(C)}),r(i,$),Ae(),s()}function L$(i,e){ke(e,!1);const n=Ar.tryGetFromContext();wt(),uo(i,{footer:a=>{Mt(a,{size:1,variant:"soft",$$events:{click:()=>{n?.setActiveTab(An.messageHistory)}},children:(o,l)=>{var c=se("Return to Thread");r(o,c)},$$slots:{default:!0,iconLeft:(o,l)=>{oe(o,{name:"arrow-left",slot:"iconLeft"})}}})},children:(a,o)=>{ir(a,{header:c=>{Le(c,{size:4,children:(d,u)=>{var h=se("No Code Edits");r(d,h)},$$slots:{default:!0}})},children:(c,d)=>{Le(c,{size:1,variant:"surface",children:(u,h)=>{var y=se("Edits will appear here once your agent makes changes to files.");r(u,y)},$$slots:{default:!0}})}})}}),Ae()}var P$=v('<div class="c-agent-edit-list-tab__header svelte-d13gz5"><!></div> <div class="c-edits-list svelte-d13gz5"><div class="c-edits-section svelte-d13gz5"></div></div>',1),O$=v('<div class="c-agent-edit-list-tab svelte-d13gz5"><!></div>');function N$(i,e){ke(e,!0);const[n,s]=at(),a=Fe("chatModel"),o=Fe("agentConversationModel"),l=go(),c=Xn(),{targetCheckpointSummary:d}=l,{isCurrConversationAgentic:u}=o;let h=p(()=>Y(d,"$targetCheckpointSummary",n)?.filter($=>$.changesSummary&&($.changesSummary.totalAddedLines>0||$.changesSummary.totalRemovedLines>0)));var y=ee(),m=S(y),f=$=>{var R=O$(),C=g(R),x=L=>{var A=P$(),E=S(A);ed(g(E),{});var F=_(E,2),z=g(F);ln(z,21,()=>t(h),D=>D.qualifiedPathName.relPath,(D,M)=>{ho(D,{get qualifiedPathName(){return t(M).qualifiedPathName},get lineChanges(){return t(M).changesSummary},onClickFile:()=>{return w=t(M).qualifiedPathName,void c(ws({repoRoot:w.rootPath,pathName:w.relPath,allowOutOfWorkspace:!0}));var w},onClickReview:()=>function(w){const W=o.getBaselineTimestamp();a.extensionClient.showAgentReview(w,W,void 0,!1,!0)}(t(M).qualifiedPathName),onClickRevert:()=>function(w){const W=o.getBaselineTimestamp();l.revertDocumentToTimestamp(w,W)}(t(M).qualifiedPathName)})}),r(L,A)},G=L=>{L$(L,{})};b(C,L=>{t(h).length>0?L(x):L(G,!1)}),r($,R)};b(m,$=>{Y(u,"$isCurrConversationAgentic",n)&&$(f)}),r(i,y),Ae(),s()}var cs=(i=>(i.REPO_LIST_REQUEST="git.repo.list.request",i.REPO_LIST_RESPONSE="git.repo.list.response",i.REPO_TRACK_REQUEST="git.repo.track.request",i.REPO_TRACK_RESPONSE="git.repo.track.response",i.REPO_INFO_REQUEST="git.repo.info.request",i.REPO_INFO_RESPONSE="git.repo.info.response",i.REPO_STATE_REQUEST="git.repo.state.request",i.REPO_STATE_RESPONSE="git.repo.state.response",i.REPO_REFRESH_REQUEST="git.repo.refresh.request",i.REPO_REFRESH_RESPONSE="git.repo.refresh.response",i.REPO_VALIDATE_REQUEST="git.repo.validate.request",i.REPO_VALIDATE_RESPONSE="git.repo.validate.response",i.FILE_STATUS_REQUEST="git.file.status.request",i.FILE_STATUS_RESPONSE="git.file.status.response",i.FILE_STAGE_REQUEST="git.file.stage.request",i.FILE_STAGE_RESPONSE="git.file.stage.response",i.FILE_UNSTAGE_REQUEST="git.file.unstage.request",i.FILE_UNSTAGE_RESPONSE="git.file.unstage.response",i.FILE_CHECKOUT_REQUEST="git.file.checkout.request",i.FILE_CHECKOUT_RESPONSE="git.file.checkout.response",i.FILE_RESET_TO_INDEX_REQUEST="git.file.resetToIndex.request",i.FILE_RESET_TO_INDEX_RESPONSE="git.file.resetToIndex.response",i.COMMIT_CREATE_REQUEST="git.commit.create.request",i.COMMIT_CREATE_RESPONSE="git.commit.create.response",i.DIFF_OPEN_REQUEST="git.diff.open.request",i.DIFF_OPEN_RESPONSE="git.diff.open.response",i.UPDATE_EVENT="git.update.event",i))(cs||{});class F${constructor(e){if(this._extensionClient=e,!e)throw new Error("ExtensionClient is required for MultiRepoGitRPCClient")}async listRepositories(){return(await this._extensionClient.sendGitMessage({type:cs.REPO_LIST_REQUEST,data:{}})).data.repositories}async trackRepository(e){return(await this._extensionClient.sendGitMessage({type:cs.REPO_TRACK_REQUEST,data:{repoRoot:e}})).data}async getRepositoryInfo(e){return(await this._extensionClient.sendGitMessage({type:cs.REPO_INFO_REQUEST,data:{repoRoot:e}})).data}async getRepositoryState(e){return(await this._extensionClient.sendGitMessage({type:cs.REPO_STATE_REQUEST,data:{repoRoot:e}})).data}async refreshRepository(e){const n=await this._extensionClient.sendGitMessage({type:cs.REPO_REFRESH_REQUEST,data:{repoRoot:e}});return{success:n.data.success,metadata:n.data.metadata}}async validateRepository(e){const n=await this._extensionClient.sendGitMessage({type:cs.REPO_VALIDATE_REQUEST,data:{repoRoot:e}});return{isValid:n.data.isValid,metadata:n.data.metadata}}async getStatusMatrix(e,n){const s=await this._extensionClient.sendGitMessage({type:cs.FILE_STATUS_REQUEST,data:{repoRoot:e,...n}});return{statusMatrix:s.data.statusMatrix,metadata:s.data.metadata}}async stageFiles(e,n){const s=await this._extensionClient.sendGitMessage({type:cs.FILE_STAGE_REQUEST,data:{repoRoot:e,...n}});return{success:s.data.success,stagedFiles:s.data.stagedFiles,metadata:s.data.metadata}}async unstageFiles(e,n){const s=await this._extensionClient.sendGitMessage({type:cs.FILE_UNSTAGE_REQUEST,data:{repoRoot:e,...n}});return{success:s.data.success,unstagedFiles:s.data.unstagedFiles,metadata:s.data.metadata}}async checkoutFiles(e,n){const s=await this._extensionClient.sendGitMessage({type:cs.FILE_CHECKOUT_REQUEST,data:{repoRoot:e,...n}});return{success:s.data.success,checkedOutFiles:s.data.checkedOutFiles,reference:s.data.reference,metadata:s.data.metadata}}async resetToIndex(e,n){const s=await this._extensionClient.sendGitMessage({type:cs.FILE_RESET_TO_INDEX_REQUEST,data:{repoRoot:e,...n}});return{success:s.data.success,resetFiles:s.data.resetFiles,metadata:s.data.metadata}}async commit(e,n){const s=await this._extensionClient.sendGitMessage({type:cs.COMMIT_CREATE_REQUEST,data:{repoRoot:e,...n}});return{commitOid:s.data.commitOid,metadata:s.data.metadata}}async openGitDiff(e,n){const s=await this._extensionClient.sendGitMessage({type:cs.DIFF_OPEN_REQUEST,data:{repoRoot:e,...n}});return{success:s.data.success,metadata:s.data.metadata}}}var Ot=(i=>(i.idle="idle",i.initializing="initializing",i.refreshing="refreshing",i.staging="staging",i.unstaging="unstaging",i.committing="committing",i.checkingOut="checkingOut",i))(Ot||{});const q$="HEAD",Cn={isNew:i=>{const[,e]=i;return e===0},isUntracked:i=>{const[,e,n,s]=i;return e===0&&n===2&&s===0},hasStaged:i=>{const[,e,,n]=i;return n!==e},hasUnstaged:i=>{const[,,e,n]=i;return!!Cn.isUntracked(i)||e!==n},isDeleted:i=>{const[,,e]=i;return e===0},isDeletionStaged:i=>{const[,e,n,s]=i;return e===1&&n===0&&s!==1},isUnmodified:i=>{const[,e,n,s]=i;return e===1&&n===1&&s===1},isPartiallyStaged:i=>Cn.hasStaged(i)&&Cn.hasUnstaged(i),hasChangedSinceHead:i=>{const[,e,n,s]=i;return!(e===1&&n===1&&s===1)}};function B$(i){const e=function(l){const c=Ct(l,y=>y?.metadata?.headOid??""),d=Ct(l,y=>y?.metadata?.currentBranch??""),u=Ct(l,y=>y?.workdir??""),h=Ct(l,y=>y?.gitdir??"");return{headOid:c,currentBranch:d,workdir:u,gitdir:h,repositoryInfo:Ct([c,d,u,h],([y,m,f,$])=>({headOid:y,currentBranch:m,workdir:f,gitdir:$}))}}(i),n=function(l){return{files:Ct(l,d=>d?.files??[])}}(i),s=function(l){const c=Ct(l,h=>h?.isOperationInProgress??!1),d=Ct(l,h=>h?.currentOperation),u=Ct(l,h=>h?.lastError);return{isOperationInProgress:c,currentOperation:d,repositoryLastError:u}}(i),a=function(l){const c=Ct(l,u=>u?.lastUpdated??0),d=Ct(c,u=>u===0?0:Date.now()-u);return{lastUpdated:c,timeSinceUpdate:d,isStale:Ct(d,u=>u>3e5)}}(i);return{isInitialized:Ct(i,l=>l!==void 0),metadata:e,files:n,operationState:s,timing:a}}class ms{static CTX_KEY=Symbol("git-agent-edit-context");static setInContext(e,n){Nn(ms.CTX_KEY,{model:e,controller:n})}static getContext(){return Fe(ms.CTX_KEY)}static requireContext(){const e=ms.getContext();if(!e)throw new Error("GitAgentEditModel context missing");return e}_repositoryState=Dt(void 0);_lastError=Dt(void 0);_currStatus=Dt(Ot.idle);_filesToUpdate=new Set;_gitCommitInputMessage=Dt("");_isGeneratingCommitMessage=Dt(!1);_commitMessageGenerationError=Dt(void 0);_canCancelCommitMessageGeneration=Dt(!1);repositoryState=Hn(this._repositoryState);lastError=Hn(this._lastError);currStatus=Hn(this._currStatus);flagsModel=function(e){return{canStageFiles:Ct(e,n=>{const s=n===Ot.idle,a=n===Ot.unstaging;return s||a}),canUnstageFiles:Ct(e,n=>{const s=n===Ot.idle,a=n===Ot.staging;return s||a}),canModifyIndividualFiles:Ct(e,n=>n===Ot.idle),canCommit:Ct(e,n=>n===Ot.idle),canRefresh:Ct(e,n=>n===Ot.idle),canRevertFiles:Ct(e,n=>n===Ot.idle)}}(this.currStatus);operationStatusModel=function(e){return{operationMetadata:Ct(e,n=>({status:n,startedAt:n!=="idle"?Date.now():void 0})),isIdle:Ct(e,n=>n==="idle"),isOperationInProgress:Ct(e,n=>n!=="idle")}}(this.currStatus);uiStateModel=function(e){const n=Ct(e,a=>{switch(a){case Ot.committing:return"Committing changes...";case Ot.staging:return"Staging files...";case Ot.unstaging:return"Unstaging files...";case Ot.refreshing:return"Refreshing repository...";case Ot.initializing:return"Initializing repository...";case Ot.checkingOut:return"Checking out files...";case Ot.idle:default:return"Enter commit message"}}),s=Ct(e,a=>{switch(a){case Ot.committing:return"Committing changes";case Ot.staging:return"Staging files";case Ot.unstaging:return"Unstaging files";case Ot.refreshing:return"Refreshing repository";case Ot.initializing:return"Initializing repository";case Ot.checkingOut:return"Checking out files";case Ot.idle:default:return"Ready"}});return{uiState:Ct([n,s],([a,o])=>({commitPlaceholder:a,operationDescription:o})),commitPlaceholder:n,operationDescription:s}}(this.currStatus);repositoryStateModel=B$(this.repositoryState);fileCollectionsModel=function(e){const n=e,s=Ct(n,o=>o.filter(l=>Cn.hasUnstaged(l.statusRow))),a=Ct(n,o=>o.filter(l=>Cn.hasStaged(l.statusRow)));return{allFiles:n,unstagedFiles:s,stagedFiles:a,unstagedFilesWithUI:Ct(s,o=>o.map(l=>({qualifiedPathName:l.qualifiedPathName,statusRow:l.statusRow,changesSummary:l.changesSummary}))),stagedFilesWithUI:Ct(a,o=>o.map(l=>({qualifiedPathName:l.qualifiedPathName,statusRow:l.statusRow,changesSummary:l.changesSummary})))}}(this.repositoryStateModel.files.files);commitInputModel=function(e,n,s,a){return{message:e,isGenerating:n,generationError:s,canCancelGeneration:a,state:Ct([e,n,s,a],([o,l,c,d])=>({message:o,isGenerating:l,generationError:c,canCancelGeneration:d})),isInputDisabled:Ct(n,o=>!!o),placeholderText:Ct([n,s],([o,l])=>l?"Generation failed - try again or write manually":o?"Generating commit message...":"Write or generate a commit message...")}}(Hn(this._gitCommitInputMessage),Hn(this._isGeneratingCommitMessage),Hn(this._commitMessageGenerationError),Hn(this._canCancelCommitMessageGeneration));_getWritableStores(){return{repositoryState:this._repositoryState,lastError:this._lastError,currStatus:this._currStatus,gitCommitInputMessage:this._gitCommitInputMessage,isGeneratingCommitMessage:this._isGeneratingCommitMessage,commitMessageGenerationError:this._commitMessageGenerationError,canCancelCommitMessageGeneration:this._canCancelCommitMessageGeneration}}_addFilesToUpdate(e){for(const n of e)this._filesToUpdate.add(n)}_getAndClearFilesToUpdate(){const e=Array.from(this._filesToUpdate);return this._filesToUpdate.clear(),e}_getFilesToUpdateCount(){return this._filesToUpdate.size}}class so{constructor(e,n,s,a){this._model=e,this.gitRPCClient=n,this._extensionClient=s,this._repoRoot=a,this._stores=this._model._getWritableStores(),this._throttledReloadFiles=_r(()=>this._executeThrottledReload(),so.RELOAD_THROTTLE_MS),this._repoRoot||this.initialize()}_stores;_commitMessageGenerationAbortController;_throttledReloadFiles;static RELOAD_THROTTLE_MS=500;_ensureIdle(){const e=Ze(this._stores.currStatus);if(e!==Ot.idle)throw new Error(`Cannot start operation: ${e} is already in progress`)}async _executeOperation(e,n){this._ensureIdle();try{return this._stores.currStatus.set(e),this._stores.lastError.set(void 0),await n()}catch(s){const a=s instanceof Error?s.message:"Unknown error",o=this._getContextualErrorMessage(e,a);throw this._stores.lastError.set(o),s}finally{this._stores.currStatus.set(Ot.idle)}}_getContextualErrorMessage(e,n){return`${this._getOperationContext(e)}: ${n}`}_getOperationContext(e){switch(e){case Ot.initializing:return"Failed to initialize git repository";case Ot.refreshing:return"Failed to refresh repository state";case Ot.staging:return"Failed to stage files";case Ot.unstaging:return"Failed to unstage files";case Ot.checkingOut:return"Failed to checkout files";case Ot.committing:return"Failed to commit changes";default:return"Operation failed"}}clearError(){this._stores.lastError.set(void 0),Ze(this._stores.currStatus)!==Ot.idle&&this._stores.currStatus.set(Ot.idle)}getWritableStores(){return this._stores}_updateMetadata(e){e&&this._stores.repositoryState.update(n=>n&&{...n,metadata:{...n.metadata,...e}})}async initialize(){return this._executeOperation(Ot.initializing,async()=>{this._stores.repositoryState.set(void 0),this._stores.lastError.set(void 0),await this._refreshRepositoryInternal()})}async refreshRepository(){return this._executeOperation(Ot.refreshing,async()=>{await this._refreshRepositoryInternal()})}async _refreshRepositoryInternal(){const e=this._repoRoot||"",n=await this.gitRPCClient.getRepositoryState(e);this._stores.repositoryState.set(n)}async refreshSpecificFiles(e){try{const n=Ze(this._stores.repositoryState);if(!n)return void await this.refreshRepository();const s=this._repoRoot||"",a=await this.gitRPCClient.getStatusMatrix(s,{filepaths:e,includeStatistics:!0,filterChangedOnly:!0});this._updateMetadata(a.metadata);const o=a.statusMatrix.filter(c=>{const[,d,u,h]=c.statusRow;return d!==u||d!==h}),l=[...n.files.filter(c=>!e.includes(c.qualifiedPathName.relPath)),...o];this._stores.repositoryState.set({...n,files:l,lastUpdated:Date.now()}),this._stores.lastError.set(void 0)}catch(n){const s=n instanceof Error?n.message:"Unknown error";throw this._stores.lastError.set(`Failed to refresh specific files: ${s}`),n}}async stageFile(e){return this.stageFiles([e])}async stageFiles(e){return this._executeOperation(Ot.staging,async()=>{const n=this._repoRoot||"",s=await this.gitRPCClient.stageFiles(n,{filePaths:e});this._updateMetadata(s.metadata),await this.refreshSpecificFiles(e)})}async unstageFile(e){return this.unstageFiles([e])}async unstageFiles(e){return this._executeOperation(Ot.unstaging,async()=>{const n=this._repoRoot||"",s=await this.gitRPCClient.unstageFiles(n,{filePaths:e});this._updateMetadata(s.metadata),await this.refreshSpecificFiles(e)})}async checkoutFileToHead(e){return this.checkoutFilesToHead([e])}async checkoutFilesToHead(e){return this._executeOperation(Ot.checkingOut,async()=>{const n=this._repoRoot||"",s=await this.gitRPCClient.checkoutFiles(n,{filePaths:e,reference:q$});this._updateMetadata(s.metadata),await this.refreshSpecificFiles(e)})}async checkoutFileToReference(e,n){return this.checkoutFilesToReference([e],n)}async checkoutFilesToReference(e,n){return this._executeOperation(Ot.checkingOut,async()=>{const s=this._repoRoot||"",a=await this.gitRPCClient.checkoutFiles(s,{filePaths:e,reference:n});this._updateMetadata(a.metadata),await this.refreshSpecificFiles(e)})}async resetToIndexFile(e){return this.resetToIndexFiles([e])}async resetToIndexFiles(e){return this._executeOperation(Ot.checkingOut,async()=>{const n=this._repoRoot||"";await this.gitRPCClient.resetToIndex(n,{filePaths:e}),await this.refreshSpecificFiles(e)})}async stageAllUnstaged(){const e=Ze(this._model.fileCollectionsModel.unstagedFiles).map(n=>n.qualifiedPathName.relPath);await this.stageFiles(e)}async unstageAllStaged(){const e=Ze(this._model.fileCollectionsModel.stagedFiles).map(n=>n.qualifiedPathName.relPath);await this.unstageFiles(e)}async commit(e){return this._executeOperation(Ot.committing,async()=>{const n=this._repoRoot||"",s=await this.gitRPCClient.commit(n,{message:e});this._updateMetadata(s.metadata);const a=Ze(this._stores.repositoryState);if(a){const o=a.files.map(l=>l.qualifiedPathName.relPath);await this.refreshSpecificFiles(o)}return s.commitOid})}clearStagedChanges(){const e=Ze(this._stores.repositoryState);if(!e)return;const n=e.files.map(s=>{const[a,o,l]=s.statusRow;return{...s,statusRow:[a,o,l,o],changesSummary:void 0}});this._stores.repositoryState.set({...e,files:n})}async validateRepository(){try{const e=this._repoRoot||"",n=await this.gitRPCClient.validateRepository(e);return this._updateMetadata(n.metadata),n.isValid}catch(e){const n=e instanceof Error?e.message:"Unknown error";return this._stores.lastError.set(`Failed to validate repository: ${n}`),!1}}async openGitDiff(e,n=!1){const s=this._repoRoot||"",a=await this.gitRPCClient.openGitDiff(s,{filePath:e,staged:n});this._updateMetadata(a.metadata)}async generateCommitMessage(){if(!Ze(this._stores.isGeneratingCommitMessage)&&Ze(this._stores.currStatus)===Ot.idle){this._stores.commitMessageGenerationError.set(void 0),this._stores.isGeneratingCommitMessage.set(!0),this._stores.canCancelCommitMessageGeneration.set(!0),this._stores.gitCommitInputMessage.set(""),this._commitMessageGenerationAbortController=new AbortController;try{let e="";for await(const n of this._extensionClient.generateCommitMessage()){if(this._commitMessageGenerationAbortController.signal.aborted)break;n.response_text&&(e+=n.response_text,this._stores.gitCommitInputMessage.set(e))}if(!this._commitMessageGenerationAbortController.signal.aborted){const n=e.trim();this._stores.gitCommitInputMessage.set(n)}}catch(e){const n=e instanceof Error?e.message:"Unknown error";this._stores.commitMessageGenerationError.set(`Failed to generate commit message: ${n}`),console.error("Failed to generate commit message:",e)}finally{this._commitMessageGenerationAbortController&&!this._commitMessageGenerationAbortController.signal.aborted&&this._commitMessageGenerationAbortController.abort(),this._stores.isGeneratingCommitMessage.set(!1),this._stores.canCancelCommitMessageGeneration.set(!1),this._commitMessageGenerationAbortController=void 0}}}cancelCommitMessageGeneration(){this._commitMessageGenerationAbortController&&Ze(this._stores.isGeneratingCommitMessage)&&(this._commitMessageGenerationAbortController.abort(),this._stores.isGeneratingCommitMessage.set(!1),this._stores.canCancelCommitMessageGeneration.set(!1),this._stores.commitMessageGenerationError.set("Generation cancelled"),this._commitMessageGenerationAbortController=void 0)}setCommitInputMessage(e){this._stores.gitCommitInputMessage.set(e),this._stores.commitMessageGenerationError.set(void 0)}reloadFiles(e){this._model._addFilesToUpdate(e),this._throttledReloadFiles()}async _executeThrottledReload(){const e=this._model._getAndClearFilesToUpdate();if(e.length!==0)try{await this.refreshSpecificFiles(e)}catch(n){console.error("Failed to reload specific files:",n),this._model._addFilesToUpdate(e)}}clearCommitInputMessage(){this._stores.gitCommitInputMessage.set(""),this._stores.commitMessageGenerationError.set(void 0)}}class Ps{static CTX_KEY=Symbol("multi-repo-git-context");_repositories;_activeRepository;_operationStatus;_lastError;repositories;activeRepository;operationStatus;lastError;availableRepositories;activeRepositoryModel;activeRepositoryState;activeRepositoryMetadata;constructor(){this._repositories=Dt(new Map),this._activeRepository=Dt(void 0),this._operationStatus=Dt("idle"),this._lastError=Dt(void 0),this.repositories=Hn(this._repositories),this.activeRepository=Hn(this._activeRepository),this.operationStatus=Hn(this._operationStatus),this.lastError=Hn(this._lastError),this.availableRepositories=Ct(this._repositories,e=>Array.from(e.keys()).sort()),this.activeRepositoryModel=Ct([this._repositories,this._activeRepository],([e,n])=>n?e.get(n):void 0),this.activeRepositoryState=Ct(this.activeRepositoryModel,e=>e?Ze(e.repositoryState):void 0),this.activeRepositoryMetadata=Ct(this.activeRepositoryModel,e=>{if(!e?.repositoryStateModel?.metadata)return{currentBranch:void 0,shortCommit:void 0};const n=e.repositoryStateModel.metadata,s=Ze(n.currentBranch),a=Ze(n.headOid);return{currentBranch:s,shortCommit:a?a.substring(0,7):void 0}})}getFileCollectionsModel(e){return Ze(this._repositories).get(e)?.fileCollectionsModel}getRepositoryStateModel(e){return Ze(this._repositories).get(e)?.repositoryStateModel}static setInContext(e,n){Nn(Ps.CTX_KEY,{model:e,controller:n})}static getContext(){return Fe(Ps.CTX_KEY)}static requireContext(){const e=Ps.getContext();if(!e)throw new Error("MultiRepoGitModel context missing");return e}_getWritableStores(){return{repositories:this._repositories,activeRepository:this._activeRepository,operationStatus:this._operationStatus,lastError:this._lastError}}}class pi{constructor(e,n,s,a){this._model=e,this._rpcClient=n,this._extensionClient=s,this._enableAgentGitTracker=a,this._stores=this._model._getWritableStores(),this._throttledRefreshRepositories=_r(async()=>{try{Ze(this._stores.operationStatus)==="idle"&&await this.refreshRepositories()}catch(o){console.warn("Failed to refresh git repositories on update event:",o)}},pi.REFRESH_THROTTLE_MS,{leading:!0,trailing:!0}),this._enableAgentGitTracker.subscribe(o=>{this.maybeInitializeRepos(o)})}_controllers=new Map;_stores;_throttledRefreshRepositories;static REFRESH_THROTTLE_MS=1e3;maybeInitializeRepos(e){if(e){const n=Ze(this._stores.operationStatus),s=Ze(this._model.availableRepositories);n==="idle"&&s.length===0&&this.listRepositories().catch(a=>{console.warn("Failed to initialize repositories when git tracking was enabled:",a)})}}_ensureIdle(){const e=Ze(this._stores.operationStatus);if(e!=="idle")throw new Error(`Cannot start operation: ${e} is already in progress`)}async _executeOperation(e,n){if(!this._enableAgentGitTracker)throw new Error("Git tracking is disabled");this._ensureIdle();try{return this._stores.operationStatus.set(e),this._stores.lastError.set(void 0),await n()}catch(s){const a=s instanceof Error?s.message:"Unknown error";throw this._stores.lastError.set(a),s}finally{this._stores.operationStatus.set("idle")}}clearError(){this._stores.lastError.set(void 0)}async listRepositories(){return this._enableAgentGitTracker?this._executeOperation("discovering",async()=>{const e=await this._rpcClient.listRepositories();for(const n of e){const s=n.repoRoot;if(Ze(this._stores.repositories).has(s))continue;const a=new ms,o=new so(a,this._rpcClient,this._extensionClient,s);this._stores.repositories.update(l=>{const c=new Map(l);return c.set(s,a),c}),this._controllers.set(s,o),await o.initialize()}return!Ze(this._stores.activeRepository)&&e.length>0&&this._stores.activeRepository.set(e[0].repoRoot),e}):[]}async refreshRepositories(){return this._executeOperation("refreshing",async()=>{const e=Ze(this._stores.repositories),n=Array.from(e.keys()).map(async s=>{const a=this._controllers.get(s);if(a)try{await a.refreshRepository()}catch(o){console.error(`Failed to refresh repository ${s}:`,o)}});await Promise.all(n)})}async ensureRepository(e){return this._executeOperation("tracking",async()=>{await this._ensureRepositoryInternal(e)})}async _ensureRepositoryInternal(e){if(Ze(this._stores.repositories).has(e))return;const n=await this._rpcClient.trackRepository(e),s=new ms,a=new so(s,this._rpcClient,this._extensionClient,e);this._updateRepositoryMetadata(e,n.metadata),this._stores.repositories.update(o=>{const l=new Map(o);return l.set(e,s),l}),this._controllers.set(e,a),await a.initialize()}async selectRepository(e){return this._executeOperation("selecting",async()=>{const n=Ze(this._stores.activeRepository);if(n&&n!==e){const s=this._controllers.get(n);s&&s.clearCommitInputMessage()}await this._ensureRepositoryInternal(e),this._stores.activeRepository.set(e)})}getActiveRepositoryController(){const e=Ze(this._stores.activeRepository);return e?this._controllers.get(e):void 0}getRepositoryController(e){return this._controllers.get(e)}_updateRepositoryMetadata(e,n){if(!n)return;const s=this.getRepositoryController(e);s&&s.getWritableStores().repositoryState.update(a=>a&&{...a,metadata:{...a.metadata,...n}})}handleMessageFromExtension(e){const n=e.data;if(n.type===Sn.gitUpdateEvent){const s=n.data.changedFiles;return s===void 0?this._throttledRefreshRepositories():this._reloadSpecificFiles(s),!0}return!1}_reloadSpecificFiles(e){const n=new Map;for(const s of e){const a=s.rootPath;n.has(a)||n.set(a,[]),n.get(a).push(s.relPath)}for(const[s,a]of n){const o=this._controllers.get(s);o&&o.reloadFiles(a)}}}var U$=v("<!> <!> <!>",1),H$=v("<!> <!> <!>",1),G$=v('<div class="c-git-repo-chips svelte-1gcvbyl"><!></div>'),W$=v("<!> <!>",1),j$=v("<span><!></span>"),V$=v('<div><!> <div class="c-git-file-item__buttons svelte-17nlls9"><!> <!> <!> <!></div></div>');function K$(i,e){ke(e,!1);const n=_e(),s=_e(),a=_e(),o=_e(),l=_e(),c=_e(),d=_e();let u=k(e,"file",8),h=k(e,"onViewDiff",8),y=k(e,"showStageAction",8,!1),m=k(e,"showUnstageAction",8,!1),f=k(e,"showRevertAction",8,!1);const{controller:$}=ms.requireContext();async function R(){try{await $.stageFile(t(n))}catch(q){console.error(`Failed to stage file ${t(n)}:`,q)}}async function C(){try{await $.unstageFile(t(n))}catch(q){console.error(`Failed to unstage file ${t(n)}:`,q)}}const x=Xn();function G(){x(ws({pathName:t(n),repoRoot:""}))}async function L(){try{await $.resetToIndexFile(t(n))}catch(q){console.error(`Failed to reset file ${t(n)}:`,q)}}Ne(()=>Ee(u()),()=>{T(n,u().qualifiedPathName.relPath)}),Ne(()=>t(n),()=>{T(s,li(t(n)))}),Ne(()=>t(n),()=>{T(a,No(t(n)))}),Ne(()=>Ee(u()),()=>{var q;T(o,(q=u().statusRow,Cn.isUntracked(q)?"file-x":Cn.isNew(q)&&Cn.hasStaged(q)?"file-plus":Cn.isDeleted(q)?"file-minus":"file-diff"))}),Ne(()=>Ee(u()),()=>{var q;T(l,(q=u().statusRow,Cn.isUntracked(q)||Cn.isNew(q)&&Cn.hasStaged(q)?"var(--ds-color-success-9)":Cn.isDeleted(q)?"var(--ds-color-error-9)":"var(--ds-color-neutral-11)"))}),Ne(()=>Ee(u()),()=>{T(c,function(q){if(Cn.isUntracked(q)){if(Cn.hasUnstaged(q)&&y())return"Untracked file - unstaged changes";if(Cn.hasStaged(q)&&m())return"Untracked file - staged for commit"}if(Cn.isNew(q)){if(Cn.hasStaged(q)&&m())return"New file - staged for commit";if(Cn.hasUnstaged(q)&&y())return"New file - unstaged changes"}if(Cn.isDeleted(q)){if(Cn.hasStaged(q)&&m())return"File deleted - staged for commit";if(Cn.hasUnstaged(q)&&y())return"File deleted - unstaged"}return Cn.hasStaged(q)?"File modified - staged for commit":Cn.hasUnstaged(q)?"File modified - unstaged changes":"File status"}(u().statusRow))}),Ne(()=>Ee(u()),()=>{T(d,Cn.isUntracked(u().statusRow))}),hn(),wt();var A=V$();let E;var F=g(A);Mt(F,{variant:"ghost",color:"neutral",size:1,alignment:"left",class:"c-git-file-item__file-button",$$events:{click(...q){h()?.apply(this,q)}},children:(q,V)=>{var N=W$(),U=S(N);{let B=Ge(()=>(Ee(Be),Re(()=>[Be.Hover]))),Q=Ge(()=>t(d)?"View Diff  Untracked file":"View Diff");je(U,{class:"c-git-file-item__file-tooltip",get triggerOn(){return t(B)},get content(){return t(Q)},children:(Z,ae)=>{Br(Z,{shrink:!0,size:1,greyTextTruncateDirection:"left",$$slots:{text:(j,H)=>{var O=se();pe(()=>ze(O,t(s))),r(j,O)},grayText:(j,H)=>{var O=se();pe(()=>ze(O,t(a)||"")),r(j,O)}}})},$$slots:{default:!0}})}var I=_(U,2);Et(I,e,"changeSummary",{},null),r(q,N)},$$slots:{default:!0,iconLeft:(q,V)=>{var N=ee(),U=S(N),I=B=>{{let Q=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(B,{get triggerOn(){return t(Q)},get content(){return t(c)},children:(Z,ae)=>{var j=j$(),H=g(j);oe(H,{get name(){return t(o)},size:1}),pe(()=>kr(j,`color: ${t(l)??""}`)),r(Z,j)},$$slots:{default:!0}})}};b(U,B=>{t(o)&&B(I)}),r(q,N)}}});var z=_(F,2),D=g(z);{let q=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(D,{get triggerOn(){return t(q)},content:"Open file",children:(V,N)=>{vt(V,{variant:"ghost",size:1,$$events:{click:G},children:(U,I)=>{oe(U,{name:"external-link"})},$$slots:{default:!0}})},$$slots:{default:!0}})}var M=_(D,2),w=q=>{{let V=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(q,{get triggerOn(){return t(V)},content:"Reset to staged state (or HEAD if not staged)",children:(N,U)=>{vt(N,{variant:"ghost",size:1,$$events:{click:L},children:(I,B)=>{oe(I,{name:"trash-2"})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(M,q=>{f()&&q(w)});var W=_(M,2),P=q=>{{let V=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(q,{get triggerOn(){return t(V)},content:"Stage file: Mark changes as reviewed, approved, and ready to commit",children:(N,U)=>{vt(N,{variant:"ghost",size:1,$$events:{click:R},children:(I,B)=>{oe(I,{name:"plus"})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(W,q=>{y()&&q(P)});var K=_(W,2),X=q=>{{let V=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(q,{get triggerOn(){return t(V)},content:"Unstage file: Mark changes as not ready to commit",children:(N,U)=>{vt(N,{variant:"ghost",size:1,$$events:{click:C},children:(I,B)=>{oe(I,{name:"circle-minus"})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(K,q=>{m()&&q(X)}),pe(q=>E=Lt(A,1,"c-git-file-item svelte-17nlls9",null,E,q),[()=>({"c-git-file-item--untracked":t(d)})]),r(i,A),Ae()}var X$=v('<div class="c-git-file-list__empty svelte-sayqy6"><!></div>'),J$=v('<div class="c-git-file-list svelte-sayqy6"><!></div>');function cd(i,e){ke(e,!1);let n=k(e,"files",24,()=>[]);const s="unstaged";let a=k(e,"showStageAction",8,!1),o=k(e,"showUnstageAction",8,!1),l=k(e,"showRevertAction",8,!1),c=k(e,"onViewDiff",8);var d={fileType:s};wt();var u=J$(),h=g(u),y=f=>{var $=ee(),R=S($);ln(R,1,n,C=>`${s}-${C.qualifiedPathName.relPath}+${C.changesSummary?.unstagedChanges?.addedLines}-${C.changesSummary?.unstagedChanges?.removedLines}`,(C,x)=>{K$(C,{get file(){return t(x)},get showStageAction(){return a()},get showUnstageAction(){return o()},get showRevertAction(){return l()},onViewDiff:()=>c()(t(x)),$$slots:{changeSummary:(G,L)=>{var A=ee(),E=S(A);Et(E,e,"changeSummary",{get file(){return t(x)}},null),r(G,A)}}})}),r(f,$)},m=f=>{var $=X$(),R=g($);Et(R,e,"empty",{},C=>{}),r(f,$)};return b(h,f=>{Ee(n()),Re(()=>n()&&n().length>0)?f(y):f(m,!1)}),r(i,u),Gn(e,"fileType",s),Ae(d)}var Y$=v('<div class="c-git-section-summary svelte-1oxdpot"><!> <!> <!></div>');function dd(i,e){ke(e,!1);const n=_e(),s=_e(),a=_e(),o=_e(),l=_e(),c=_e();let d=k(e,"files",24,()=>{}),u=k(e,"changeType",8,"unstaged"),h=_e();Ne(()=>Ee(d()),()=>{T(n,d()?.length||0)}),Ne(()=>(Ee(d()),Ee(u())),()=>{T(s,d()?.reduce(($,R)=>{const C=u()==="staged"?R.changesSummary?.stagedChanges:R.changesSummary?.unstagedChanges;return $+(C?.addedLines||0)},0)||0)}),Ne(()=>(Ee(d()),Ee(u())),()=>{T(a,d()?.reduce(($,R)=>{const C=u()==="staged"?R.changesSummary?.stagedChanges:R.changesSummary?.unstagedChanges;return $+(C?.removedLines||0)},0)||0)}),Ne(()=>t(n),()=>{T(o,t(n)===1?"file":"files")}),Ne(()=>Ee(u()),()=>{T(h,u()==="staged"?"check":"search")}),Ne(()=>Ee(u()),()=>{T(l,u()==="staged"?"success":"warning")}),Ne(()=>Ee(u()),()=>{T(c,u()==="staged"?"reviewed and ready to commit":"with changes not yet reviewed")}),hn(),wt();var y=ee(),m=S(y),f=$=>{var R=Y$(),C=g(R);{let E=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(C,{get triggerOn(){return t(E)},get content(){return`${t(n)??""} ${t(o)??""} ${t(c)??""}`},children:(F,z)=>{Jt.Root(F,{variant:"soft",get color(){return t(l)},size:1,children:(D,M)=>{Le(D,{size:1,weight:"medium",children:(w,W)=>{var P=se();pe(()=>ze(P,t(n))),r(w,P)},$$slots:{default:!0}})},$$slots:{default:!0,leftButtons:(D,M)=>{Jt.IconButton(D,{slot:"leftButtons",children:(w,W)=>{oe(w,{get name(){return t(h)},size:1})},$$slots:{default:!0}})}}})},$$slots:{default:!0}})}var x=_(C,2),G=E=>{{let F=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(E,{get triggerOn(){return t(F)},get content(){return`${t(s)??""} lines added across all files`},children:(z,D)=>{Jt.Root(z,{variant:"soft",color:"success",size:1,children:(M,w)=>{Le(M,{size:1,weight:"medium",children:(W,P)=>{var K=se();pe(()=>ze(K,`+${t(s)??""}`)),r(W,K)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(x,E=>{t(s)>0&&E(G)});var L=_(x,2),A=E=>{{let F=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(E,{get triggerOn(){return t(F)},get content(){return`${t(a)??""} lines removed across all files`},children:(z,D)=>{Jt.Root(z,{variant:"soft",color:"error",size:1,children:(M,w)=>{Le(M,{size:1,weight:"medium",children:(W,P)=>{var K=se();pe(()=>ze(K,`-${t(a)??""}`)),r(W,K)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(L,E=>{t(a)>0&&E(A)}),r($,R)};b(m,$=>{t(n)>0&&$(f)}),r(i,y),Ae()}var Q$=v('<div class="c-git-change-summary svelte-1dm378"><!> <!></div>');function ud(i,e){ke(e,!0);let n=k(e,"addedLines",3,0),s=k(e,"removedLines",3,0),a=p(()=>n()>0||s()>0);var o=ee(),l=S(o),c=d=>{var u=Q$(),h=g(u),y=$=>{{let R=p(()=>[Be.Hover]);je($,{get triggerOn(){return t(R)},get content(){return`${n()??""} lines added`},children:(C,x)=>{Lo(C,{color:"success",children:(G,L)=>{var A=se();pe(()=>ze(A,`+${n()??""}`)),r(G,A)},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(h,$=>{n()>0&&$(y)});var m=_(h,2),f=$=>{{let R=p(()=>[Be.Hover]);je($,{get triggerOn(){return t(R)},get content(){return`${s()??""} lines removed`},children:(C,x)=>{Lo(C,{color:"error",children:(G,L)=>{var A=se();pe(()=>ze(A,`-${s()??""}`)),r(G,A)},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(m,$=>{s()>0&&$(f)}),r(d,u)};b(l,d=>{t(a)&&d(c)}),r(i,o),Ae()}var Z$=v('<div class="c-git-section-changes__content svelte-1dl5jtk"><!></div>'),eb=v('<div class="c-git-section-changes__header svelte-1dl5jtk"><div class="c-git-section-changes__header-left svelte-1dl5jtk"><!> <!> <!></div> <div class="c-git-section-changes__controls svelte-1dl5jtk"><!> <!></div></div>'),tb=v('<div class="c-git-section-changes c-git-section-changes__wrapper svelte-1dl5jtk"><!></div>');function nb(i,e){ke(e,!1);const n=()=>Y(t(o),"$unstagedFiles",s),[s,a]=at(),o=_e(),l=_e(),c=_e(),{model:d,controller:u}=ms.requireContext();async function h(){if(u)try{await u.stageAllUnstaged()}catch(R){console.error("Failed to stage all unstaged files:",R)}}async function y(){if(u&&n())try{const R=n().map(C=>C.qualifiedPathName.relPath);await u.resetToIndexFiles(R)}catch(R){console.error("Failed to reset all unstaged files:",R)}}Ne(()=>{},()=>{ds(T(o,d.fileCollectionsModel.unstagedFiles),"$unstagedFiles",s)}),Ne(()=>{},()=>{ds(T(l,d.fileCollectionsModel.unstagedFilesWithUI),"$unstagedFilesWithUI",s)}),Ne(()=>n(),()=>{T(c,(n()?.length??0)>0)}),hn(),wt();var m=ee(),f=S(m),$=R=>{var C=tb(),x=g(C);ur(x,{children:(G,L)=>{var A=Z$();cd(g(A),{get files(){return Y(t(l),"$unstagedFilesWithUI",s)},showStageAction:!0,showUnstageAction:!1,showRevertAction:!0,onViewDiff:E=>u?.openGitDiff(E.qualifiedPathName.relPath,!1),$$slots:{changeSummary:(E,F)=>{const z=Ge(()=>F.file);{let D=Ge(()=>(Ee(t(z)),Re(()=>t(z).changesSummary?.unstagedChanges?.addedLines||0))),M=Ge(()=>(Ee(t(z)),Re(()=>t(z).changesSummary?.unstagedChanges?.removedLines||0)));ud(E,{slot:"changeSummary",get addedLines(){return t(D)},get removedLines(){return t(M)}})}}}}),r(G,A)},$$slots:{default:!0,header:(G,L)=>{var A=eb(),E=g(A),F=g(E);Wr(F,{});var z=_(F,2);{let W=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(z,{get triggerOn(){return t(W)},content:"Unstaged files: Files with changes that are not queued to commit to git",children:(P,K)=>{Le(P,{size:1,weight:"bold",class:"c-git-section-changes__title",children:(X,q)=>{var V=se("Unreviewed");r(X,V)},$$slots:{default:!0}})},$$slots:{default:!0}})}dd(_(z,2),{get files(){return n()},changeType:"unstaged"});var D=_(E,2),M=g(D);{let W=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(M,{get triggerOn(){return t(W)},content:"Reset all to staged state (or HEAD if not staged)",children:(P,K)=>{vt(P,{variant:"ghost",size:1,$$events:{click:y},children:(X,q)=>{oe(X,{name:"trash-2"})},$$slots:{default:!0}})},$$slots:{default:!0}})}var w=_(M,2);{let W=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(w,{get triggerOn(){return t(W)},content:"Stage files: Mark all changes as reviewed, approved, and ready to commit",children:(P,K)=>{vt(P,{variant:"ghost",size:1,$$events:{click:h},children:(X,q)=>{oe(X,{name:"plus"})},$$slots:{default:!0}})},$$slots:{default:!0}})}r(G,A)}}}),r(R,C)};b(f,R=>{t(c)&&R($)}),r(i,m),Ae(),a()}var sb=v('<div class="c-git-section-staged__content svelte-1jgkyxv"><!></div>'),rb=v('<div class="c-git-section-staged__header svelte-1jgkyxv"><div class="c-git-section-staged__header-left svelte-1jgkyxv"><!> <!> <!></div> <div class="c-git-section-staged__controls svelte-1jgkyxv"><!></div></div>'),ab=v('<div class="c-git-section-staged c-git-section-staged__wrapper svelte-1jgkyxv"><!></div>');function ob(i,e){ke(e,!1);const n=()=>Y(t(o),"$stagedFiles",s),[s,a]=at(),o=_e(),l=_e(),c=_e(),{model:d,controller:u}=ms.requireContext();async function h(){if(u)try{await u.unstageAllStaged()}catch($){console.error("Failed to unstage all staged files:",$)}}Ne(()=>{},()=>{ds(T(o,d.fileCollectionsModel.stagedFiles),"$stagedFiles",s)}),Ne(()=>{},()=>{ds(T(l,d.fileCollectionsModel.stagedFilesWithUI),"$stagedFilesWithUI",s)}),Ne(()=>n(),()=>{T(c,(n()?.length??0)>0)}),hn(),wt();var y=ee(),m=S(y),f=$=>{var R=ab(),C=g(R);ur(C,{children:(x,G)=>{var L=sb();cd(g(L),{get files(){return Y(t(l),"$stagedFilesWithUI",s)},showStageAction:!1,showUnstageAction:!0,onViewDiff:A=>u?.openGitDiff(A.qualifiedPathName.relPath,!0),$$slots:{changeSummary:(A,E)=>{const F=Ge(()=>E.file);{let z=Ge(()=>(Ee(t(F)),Re(()=>t(F).changesSummary?.stagedChanges?.addedLines||0))),D=Ge(()=>(Ee(t(F)),Re(()=>t(F).changesSummary?.stagedChanges?.removedLines||0)));ud(A,{slot:"changeSummary",get addedLines(){return t(z)},get removedLines(){return t(D)}})}}}}),r(x,L)},$$slots:{default:!0,header:(x,G)=>{var L=rb(),A=g(L),E=g(A);Wr(E,{});var F=_(E,2);{let M=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(F,{get triggerOn(){return t(M)},content:"Staged files: Files that are reviewed, approved, and ready to commit to git",children:(w,W)=>{Le(w,{size:1,weight:"bold",class:"c-git-section-staged__title",children:(P,K)=>{var X=se("Reviewed and Approved");r(P,X)},$$slots:{default:!0}})},$$slots:{default:!0}})}dd(_(F,2),{get files(){return n()},changeType:"staged"});var z=_(A,2),D=g(z);{let M=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(D,{get triggerOn(){return t(M)},content:"Mark all changes as unapproved and not ready to commit",children:(w,W)=>{vt(w,{variant:"ghost",size:1,$$events:{click:h},children:(P,K)=>{oe(P,{name:"circle-minus"})},$$slots:{default:!0}})},$$slots:{default:!0}})}r(x,L)}}}),r($,R)};b(m,$=>{t(c)&&$(f)}),r(i,y),Ae(),a()}function ib(i,e,n,s,a){t(e)&&n.repositoryPath!==s()&&t(e).selectRepository(n.repositoryPath)}var lb=v('<span class="c-git-repository-section__expand-placeholder svelte-1kzm13i"><!></span>'),cb=v('<div class="c-git-repository-section__error svelte-1kzm13i"><!></div>'),db=v('<div class="c-git-repository-section__loading svelte-1kzm13i"><!></div>'),ub=v('<div class="c-git-repository-section__header svelte-1kzm13i"><div class="c-git-repository-section__header-left svelte-1kzm13i"><!> <!></div> <div class="c-git-repository-section__header-right svelte-1kzm13i"><!></div></div>'),hb=v('<div class="c-git-repository-section__content svelte-1kzm13i"><!> <!></div>'),gb=v('<div class="c-git-repository-section__empty svelte-1kzm13i"><!></div>'),vb=v('<div tabindex="-1"><!></div>');function pb(i,e){ke(e,!0);const n=()=>Y(t(C),"$activeRepository",l),s=()=>Y(t(z),"$isOperationInProgress",l),a=()=>Y(t(F),"$lastError",l),o=()=>Y(t(x),"$availableRepositories",l),[l,c]=at();let d=k(e,"defaultOpen",3,!0);ms.setInContext(e.model,e.controller);const u=Ps.getContext();let h=ct(!d());function y(){t(R)&&e.repositoryPath!==n()&&t(R).selectRepository(e.repositoryPath)}function m(Q){Q.key!=="Enter"&&Q.key!==" "||!t(R)||e.repositoryPath===n()||(Q.preventDefault(),t(R).selectRepository(e.repositoryPath))}async function f(){if(!s())try{await e.controller.refreshRepository()}catch(Q){console.error("Failed to refresh repository:",Q)}}let $=p(()=>u?.model),R=p(()=>u?.controller),C=p(()=>t($)?.activeRepository),x=p(()=>t($)?.availableRepositories),G=p(()=>e.model.repositoryState),L=p(()=>e.model.fileCollectionsModel.unstagedFiles),A=p(()=>e.model.fileCollectionsModel.stagedFiles),E=p(()=>e.model.repositoryStateModel.isInitialized),F=p(()=>e.model.lastError),z=p(()=>e.model.operationStatusModel.isOperationInProgress),D=p(()=>Y(t(G),"$repositoryState",l)?.metadata?.currentBranch),M=p(()=>Y(t(A),"$stagedFiles",l)?.length||0),w=p(()=>Y(t(L),"$unstagedFiles",l)?.length||0),W=p(()=>Y(t(E),"$isGitInitialized",l)&&!a()),P=p(a),K=p(()=>t(M)>0||t(w)>0),X=p(()=>o()&&o().length===1);zt(()=>{t(X)&&t(h)&&T(h,!1)});let q=p(()=>e.repositoryPath?e.repositoryPath.split("/").pop()||e.repositoryPath:void 0),V=p(()=>o()&&o().length>1&&n()===e.repositoryPath),N=p(()=>o()&&o().length>1);var U=vb();let I;U.__focusin=[ib,R,e,n,C],U.__click=function(...Q){(t(N)?y:void 0)?.apply(this,Q)},U.__keydown=function(...Q){(t(N)?m:void 0)?.apply(this,Q)};var B=g(U);ur(B,{class:"c-git-repository-section",stickyHeader:!0,get defaultOpen(){return d()},get collapsed(){return t(h)},set collapsed(ae){T(h,ae,!0)},header:ae=>{var j=ub(),H=g(j),O=g(H),J=fe=>{Wr(fe,{})},te=fe=>{var ge=lb(),ce=g(ge);oe(ce,{name:"file-diff"}),r(fe,ge)};b(O,fe=>{t(X)?fe(te,!1):fe(J)});var ne=_(O,2),re=fe=>{(function(ge,ce){ke(ce,!1);const we=_e(),Se=_e(),ie=_e(),Ce=_e();let le=k(ce,"repositoryName",24,()=>{}),Me=k(ce,"currentBranch",24,()=>{}),ue=k(ce,"stagedCount",8,0),be=k(ce,"unstagedCount",8,0),ye=k(ce,"isValid",8,!0),de=k(ce,"isCollapsed",8,!1);Ne(()=>Ee(le()),()=>{T(we,le()?le().split("/").pop()||le():void 0)}),Ne(()=>Ee(Me()),()=>{T(Se,Me()||"unknown")}),Ne(()=>(Ee(ue()),Ee(be())),()=>{T(ie,ue()+be())}),Ne(()=>t(ie),()=>{T(Ce,t(ie)>0)}),hn(),wt();var xe=G$(),Oe=g(xe),De=Ie=>{var Ke=H$(),qe=S(Ke),Te=Ve=>{{let rt=Ge(()=>(Ee(Be),Re(()=>[Be.Hover]))),ve=Ge(()=>le()||t(we));je(Ve,{get triggerOn(){return t(rt)},get content(){return`Repository: ${t(ve)??""}`},children:(Pe,Je)=>{Jt.Root(Pe,{variant:"soft",color:"accent",size:1,children:(Xe,st)=>{Le(Xe,{size:1,weight:"medium",children:(nt,et)=>{var ht=se();pe(()=>ze(ht,t(we))),r(nt,ht)},$$slots:{default:!0}})},$$slots:{default:!0,leftButtons:(Xe,st)=>{Jt.IconButton(Xe,{slot:"leftButtons",children:(nt,et)=>{oe(nt,{name:"folder"})},$$slots:{default:!0}})}}})},$$slots:{default:!0}})}};b(qe,Ve=>{t(we)&&Ve(Te)});var Ye=_(qe,2);{let Ve=Ge(()=>(Ee(Be),Re(()=>[Be.Hover]))),rt=Ge(()=>Me()||"unknown");je(Ye,{get triggerOn(){return t(Ve)},get content(){return`Current branch: ${t(rt)??""}`},children:(ve,Pe)=>{Jt.Root(ve,{variant:"soft",color:"neutral",size:1,children:(Je,Xe)=>{Le(Je,{size:1,weight:"medium",children:(st,nt)=>{var et=se();pe(()=>ze(et,t(Se))),r(st,et)},$$slots:{default:!0}})},$$slots:{default:!0,leftButtons:(Je,Xe)=>{Jt.IconButton(Je,{slot:"leftButtons",children:(st,nt)=>{oe(st,{name:"git-branch"})},$$slots:{default:!0}})}}})},$$slots:{default:!0}})}var it=_(Ye,2),lt=Ve=>{var rt=U$(),ve=S(rt),Pe=et=>{{let ht=Ge(()=>(Ee(Be),Re(()=>[Be.Hover]))),dt=Ge(be),gt=Ge(()=>be()===1?"file":"files");je(et,{get triggerOn(){return t(ht)},get content(){return`${t(dt)??""} unstaged ${t(gt)??""} with changes not yet reviewed`},children:(Tt,mt)=>{Jt.Root(Tt,{variant:"soft",color:"warning",size:1,children:(pt,ot)=>{var ft=se();pe(()=>ze(ft,be())),r(pt,ft)},$$slots:{default:!0,leftButtons:(pt,ot)=>{Jt.IconButton(pt,{slot:"leftButtons",children:(ft,Wt)=>{oe(ft,{name:"search"})},$$slots:{default:!0}})}}})},$$slots:{default:!0}})}};b(ve,et=>{be()>0&&et(Pe)});var Je=_(ve,2),Xe=et=>{{let ht=Ge(()=>(Ee(Be),Re(()=>[Be.Hover]))),dt=Ge(ue),gt=Ge(()=>ue()===1?"file":"files");je(et,{get triggerOn(){return t(ht)},get content(){return`${t(dt)??""} staged ${t(gt)??""} reviewed and ready to commit`},children:(Tt,mt)=>{Jt.Root(Tt,{variant:"soft",color:"success",size:1,children:(pt,ot)=>{var ft=se();pe(()=>ze(ft,ue())),r(pt,ft)},$$slots:{default:!0,leftButtons:(pt,ot)=>{Jt.IconButton(pt,{slot:"leftButtons",children:(ft,Wt)=>{oe(ft,{name:"check"})},$$slots:{default:!0}})}}})},$$slots:{default:!0}})}};b(Je,et=>{ue()>0&&et(Xe)});var st=_(Je,2),nt=et=>{{let ht=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(et,{get triggerOn(){return t(ht)},content:"Repository is clean with no staged or unstaged changes",children:(dt,gt)=>{Jt.Root(dt,{variant:"soft",color:"neutral",size:1,children:(Tt,mt)=>{Le(Tt,{size:1,color:"neutral",children:(pt,ot)=>{var ft=se("No changes");r(pt,ft)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(st,et=>{t(Ce)||et(nt)}),r(Ve,rt)};b(it,Ve=>{de()&&Ve(lt)}),r(Ie,Ke)},Ue=Ie=>{{let Ke=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(Ie,{get triggerOn(){return t(Ke)},content:"Repository path is invalid or not a git repository",children:(qe,Te)=>{Jt.Root(qe,{variant:"soft",color:"error",size:1,children:(Ye,it)=>{Le(Ye,{size:1,color:"error",children:(lt,Ve)=>{var rt=se("Invalid repository");r(lt,rt)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(Oe,Ie=>{ye()?Ie(De):Ie(Ue,!1)}),r(ge,xe),Ae()})(fe,{get repositoryName(){return t(q)},get currentBranch(){return t(D)},get stagedCount(){return t(M)},get unstagedCount(){return t(w)},get isValid(){return t(W)},get isCollapsed(){return t(h)}})},he=fe=>{var ge=ee(),ce=S(ge),we=ie=>{var Ce=cb(),le=g(Ce);Le(le,{size:1,color:"error",children:(Me,ue)=>{var be=se();pe(()=>ze(be,t(P))),r(Me,be)},$$slots:{default:!0}}),r(ie,Ce)},Se=ie=>{var Ce=db(),le=g(Ce);Le(le,{size:1,color:"neutral",children:(Me,ue)=>{var be=se("Loading repository info...");r(Me,be)},$$slots:{default:!0}}),r(ie,Ce)};b(ce,ie=>{t(P)?ie(we):ie(Se,!1)},!0),r(fe,ge)};b(ne,fe=>{t(W)?fe(re):fe(he,!1)});var $e=_(H,2),me=g($e);{let fe=p(()=>[Be.Hover]);je(me,{get triggerOn(){return t(fe)},content:"Sync git state - refresh repository status, branches, and file changes",children:(ge,ce)=>{vt(ge,{variant:"ghost-block",color:"neutral",size:1,get disabled(){return s()},$$events:{click:f},children:(we,Se)=>{oe(we,{name:"refresh-ccw"})},$$slots:{default:!0}})},$$slots:{default:!0}})}r(ae,j)},children:ae=>{var j=ee(),H=S(j),O=te=>{var ne=hb(),re=g(ne);nb(re,{}),ob(_(re,2),{}),r(te,ne)},J=te=>{var ne=ee(),re=S(ne),he=$e=>{var me=gb(),fe=g(me);Le(fe,{size:1,color:"neutral",children:(ge,ce)=>{var we=se("No changes to review");r(ge,we)},$$slots:{default:!0}}),r($e,me)};b(re,$e=>{t(W)&&!t(K)&&$e(he)},!0),r(te,ne)};b(H,te=>{t(W)&&t(K)?te(O):te(J,!1)}),r(ae,j)},$$slots:{header:!0,default:!0}}),pe(Q=>{I=Lt(U,1,"c-git-repository-card svelte-1kzm13i",null,I,Q),en(U,"role",t(N)?"button":void 0),en(U,"aria-label",t(N)?`Repository ${t(q)||e.repositoryPath}`:void 0)},[()=>({"c-git-repository-card--can-highlight":o()&&o().length>1,"c-git-repository-card--highlighted":t(V)})]),r(i,U),Ae(),c()}Os(["focusin","click","keydown"]);var mb=v('<div class="c-git-agent-edit-tab c-git-agent-edit-tab--disabled svelte-1h1el28"><!></div>'),fb=v('<div class="c-git-agent-edit-tab c-git-agent-edit-tab--loading svelte-1h1el28"><!></div>'),_b=v('<div class="c-git-agent-edit-tab c-git-agent-edit-tab--error svelte-1h1el28"><!></div>'),yb=v('<div class="c-git-agent-edit-tab svelte-1h1el28"><div class="c-git-repository-container svelte-1h1el28"></div></div>'),$b=v('<div class="c-git-agent-edit-tab c-git-agent-edit-tab--unavailable svelte-1h1el28"><!></div>'),bb=v('<div class="c-git-agent-edit-tab c-git-agent-edit-tab--unavailable svelte-1h1el28"><!></div>');function wb(i,e){ke(e,!0);const n=()=>Y(t($),"$availableRepositories",c),s=()=>Y(A,"$isGitEnabled",c),a=()=>Y(h,"$isCurrConversationAgentic",c),o=()=>Y(t(x),"$isGitInitialized",c),l=()=>Y(t(G),"$lastError",c),[c,d]=at(),u=Fe("agentConversationModel"),{isCurrConversationAgentic:h}=u,y=Ps.requireContext();let m=p(()=>y.model),f=p(()=>y.controller),$=p(()=>t(m)?.availableRepositories),R=p(()=>n()?.[0]),C=p(()=>t(R)?t(m)?.getRepositoryStateModel(t(R)):void 0),x=p(()=>t(C)?.isInitialized||{subscribe:()=>()=>{}}),G=p(()=>t(m)?.lastError),L=p(()=>t(m)?.repositories),A=_t("enableAgentGitTracker"),E=p(()=>s()&&a()&&o());mn(async()=>{if(s()&&a())try{await t(f).listRepositories()}catch(w){console.error("Failed to list repositories:",w)}});var F=ee(),z=S(F),D=w=>{var W=mb(),P=g(W);Le(P,{size:1,color:"neutral",children:(K,X)=>{var q=se("Git tracking is disabled");r(K,q)},$$slots:{default:!0}}),r(w,W)},M=w=>{var W=ee(),P=S(W),K=q=>{var V=ee(),N=S(V),U=B=>{var Q=fb(),Z=g(Q);Le(Z,{size:1,color:"neutral",children:(ae,j)=>{var H=se("Initializing git interface...");r(ae,H)},$$slots:{default:!0}}),r(B,Q)},I=B=>{var Q=ee(),Z=S(Q),ae=H=>{var O=_b(),J=g(O);Le(J,{size:1,color:"error",children:(te,ne)=>{var re=se();pe(()=>ze(re,`Error: ${l()??""}`)),r(te,re)},$$slots:{default:!0}}),r(H,O)},j=H=>{var O=ee(),J=S(O),te=re=>{var he=yb(),$e=g(he);ln($e,5,n,me=>me,(me,fe)=>{const ge=p(()=>Y(t(L),"$repoStates",c)?.get(t(fe))),ce=p(()=>t(f)?.getRepositoryController(t(fe)));var we=ee(),Se=S(we),ie=Ce=>{var le=ee(),Me=S(le);qr(Me,()=>t(fe),ue=>{{let be=p(()=>t(fe)===n()[0]);pb(ue,{get model(){return t(ge)},get controller(){return t(ce)},get repositoryPath(){return t(fe)},get defaultOpen(){return t(be)}})}}),r(Ce,le)};b(Se,Ce=>{t(ge)&&t(ce)&&Ce(ie)}),r(me,we)}),r(re,he)},ne=re=>{var he=$b(),$e=g(he);Le($e,{size:1,color:"neutral",children:(me,fe)=>{var ge=se("Git interface not available");r(me,ge)},$$slots:{default:!0}}),r(re,he)};b(J,re=>{t(E)&&n()&&n().length>0?re(te):re(ne,!1)},!0),r(H,O)};b(Z,H=>{l()?H(ae):H(j,!1)},!0),r(B,Q)};b(N,B=>{o()?B(I,!1):B(U)}),r(q,V)},X=q=>{var V=bb(),N=g(V);Le(N,{size:1,color:"neutral",children:(U,I)=>{var B=se("Git interface only available in agent conversations");r(U,B)},$$slots:{default:!0}}),r(q,V)};b(P,q=>{a()?q(K):q(X,!1)},!0),r(w,W)};b(z,w=>{s()?w(M,!1):w(D)}),r(i,F),Ae(),d()}var Cb=v('<div class="c-tasks-list svelte-1to9q56"><div class="c-tasks-section svelte-1to9q56"><!></div></div>'),kb=v('<div class="c-tasks-list c-tasks-list--empty svelte-1to9q56"><!></div>'),Ab=v('<div class="c-task-list-tab svelte-1to9q56"><div class="c-task-list-tab__header svelte-1to9q56"><div class="c-task-list-tab__title svelte-1to9q56"><!></div> <div class="c-task-list-tab__actions svelte-1to9q56"><!> <!> <!> <!></div></div> <!></div>');function Sb(i,e){ke(e,!1);const n=()=>Y(G,"$rootTask",s),[s,a]=at(),o=_e(),l=_e(),c=_e(),d=_e(),u=_e(),h=_e(),y=_e(),m=_e(),f=jc(),$=oo(),R=Xh(),C=Ar.tryGetFromContext(),{isCurrConversationAgentic:x}=f,{rootTask:G}=$;let L=_e(new Set(Object.values(Fn)));async function A(){if(n()){const D=Wa(n()),M={action:Ha.addSubtask,totalTasksCount:D.total,triggeredBy:Ua.user};R.extensionClient.reportAgentSessionEvent({eventName:Rs.taskListUsage,conversationId:R.id,eventData:{taskListUsageData:M}});const w=await $.createTask("","",n().uuid);setTimeout(()=>{document.getElementById(`task-${w}`)?.querySelector(".c-task-tree-item__name-editable")?.querySelector("input")?.focus()},100)}}Ne(()=>n(),()=>{T(o,Kl(n()))}),Ne(()=>t(o),()=>{T(l,t(o).notStarted)}),Ne(()=>t(o),()=>{T(c,t(o).inProgress)}),Ne(()=>t(o),()=>{T(d,t(o).completed)}),Ne(()=>t(o),()=>{T(u,t(o).cancelled)}),Ne(()=>n(),()=>{T(h,n()?.subTasksData&&n().subTasksData.length>0)}),Ne(()=>(t(l),t(c),t(d),t(u)),()=>{T(y,[{value:Fn.NOT_STARTED,label:rr(Fn.NOT_STARTED),count:t(l)},{value:Fn.IN_PROGRESS,label:rr(Fn.IN_PROGRESS),count:t(c)},{value:Fn.COMPLETE,label:rr(Fn.COMPLETE),count:t(d)},{value:Fn.CANCELLED,label:rr(Fn.CANCELLED),count:t(u)}])}),Ne(()=>(n(),t(L)),()=>{T(m,n()?Zo(n(),t(L)):void 0)}),hn(),wt();var E=ee(),F=S(E),z=D=>{var M=Ab(),w=g(M),W=g(w),P=g(W);Le(P,{size:2,weight:"medium",color:"primary",children:(Q,Z)=>{var ae=se("Task List");r(Q,ae)},$$slots:{default:!0}});var K=_(W,2),X=g(K),q=Q=>{{let Z=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(Q,{content:"Run All Tasks",get triggerOn(){return t(Z)},children:(ae,j)=>{vt(ae,{size:1,variant:"ghost-block",color:"neutral",disabled:!1,$$events:{click:()=>{C&&C.setActiveTab(An.messageHistory);const H=Wa(n()),O={action:Ha.runAllTasks,totalTasksCount:H.total,triggeredBy:Ua.user};R.extensionClient.reportAgentSessionEvent({eventName:Rs.taskListUsage,conversationId:R.id,eventData:{taskListUsageData:O}}),$.runAllTasks()}},children:(H,O)=>{oe(H,{name:"circle-play"})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(X,Q=>{t(h)&&Q(q)});var V=_(X,2);{let Q=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(V,{content:"Add New Task",get triggerOn(){return t(Q)},children:(Z,ae)=>{{let j=Ge(()=>!n());vt(Z,{size:1,variant:"ghost-block",color:"neutral",get disabled(){return t(j)},$$events:{click:A},children:(H,O)=>{oe(H,{name:"plus"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}var N=_(V,2);sd(N,{get taskFilters(){return t(y)},get activeTaskFilter(){return t(L)},set activeTaskFilter(Q){T(L,Q)},$$legacy:!0}),nd(_(N,2),{});var U=_(w,2),I=Q=>{var Z=Cb(),ae=g(Z),j=g(ae);Xl(j,{get task(){return t(m)},get taskStore(){return $},editable:!0}),r(Q,Z)},B=Q=>{var Z=kb(),ae=g(Z);Le(ae,{size:1,color:"neutral",children:(j,H)=>{var O=se("No tasks to show");r(j,O)},$$slots:{default:!0}}),r(Q,Z)};b(U,Q=>{t(m),Re(()=>t(m)?.isVisible&&t(m).subTasksData?.length)?Q(I):Q(B,!1)}),r(D,M)};b(F,D=>{Y(x,"$isCurrConversationAgentic",s)&&n()&&D(z)}),r(i,E),Ae(),a()}const Mb=Ag({position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",transform:"translateX(-100%)"}),xb=typeof window<"u"?window:void 0;new class{#e;#t;constructor(i={}){const{window:e=xb,document:n=e?.document}=i;e!==void 0&&(this.#e=n,this.#t=Nd(s=>{const a=Ei(e,"focusin",s),o=Ei(e,"focusout",s);return()=>{a(),o()}}))}get current(){return this.#t?.(),this.#e?function(i){let e=i.activeElement;for(;e?.shadowRoot;){const n=e.shadowRoot.activeElement;if(n===e)break;e=n}return e}(this.#e):null}};class hd{#e;#t;constructor(e){this.#e=e,this.#t=Symbol(e)}get key(){return this.#t}exists(){return Fd(this.#t)}get(){const e=Fe(this.#t);if(e===void 0)throw new Error(`Context "${this.#e}" not found`);return e}getOr(e){const n=Fe(this.#t);return n===void 0?e:n}set(e){return Nn(this.#t,e)}}function gd(i,e,n,s={}){const{lazy:a=!1}=s;let o=!a,l=Array.isArray(i)?[]:void 0;(function(c,d){switch(c){case"post":zt(d);break;case"pre":qd(d)}})(e,()=>{const c=Array.isArray(i)?i.map(u=>u()):i();if(!o)return o=!0,void(l=c);const d=Re(()=>n(c,l));return l=c,d})}function ro(i,e,n){gd(i,"post",e,n)}ro.pre=function(i,e,n){gd(i,"pre",e,n)};const Tb=vc({component:"checkbox",parts:["root","group","group-label","input"]}),Rb=new hd("Checkbox.Group"),vd=new hd("Checkbox.Root");class mi{static create(e,n=null){return vd.set(new mi(e,n))}opts;group;#e=p(()=>this.group&&this.group.opts.name.current?this.group.opts.name.current:this.opts.name.current);get trueName(){return t(this.#e)}set trueName(e){T(this.#e,e)}#t=p(()=>!(!this.group||!this.group.opts.required.current)||this.opts.required.current);get trueRequired(){return t(this.#t)}set trueRequired(e){T(this.#t,e)}#n=p(()=>!(!this.group||!this.group.opts.disabled.current)||this.opts.disabled.current);get trueDisabled(){return t(this.#n)}set trueDisabled(e){T(this.#n,e)}#r=p(()=>!(!this.group||!this.group.opts.readonly.current)||this.opts.readonly.current);get trueReadonly(){return t(this.#r)}set trueReadonly(e){T(this.#r,e)}attachment;constructor(e,n){this.opts=e,this.group=n,this.attachment=gc(this.opts.ref),this.onkeydown=this.onkeydown.bind(this),this.onclick=this.onclick.bind(this),ro.pre([()=>Sg(this.group?.opts.value.current),()=>this.opts.value.current],([s,a])=>{s&&a&&(this.opts.checked.current=s.includes(a))}),ro.pre(()=>this.opts.checked.current,s=>{this.group&&(s?this.group?.addValue(this.opts.value.current):this.group?.removeValue(this.opts.value.current))})}onkeydown(e){this.trueDisabled||this.trueReadonly||(e.key==="Enter"&&e.preventDefault(),e.key===" "&&(e.preventDefault(),this.#s()))}#s(){this.opts.indeterminate.current?(this.opts.indeterminate.current=!1,this.opts.checked.current=!0):this.opts.checked.current=!this.opts.checked.current}onclick(e){this.trueDisabled||this.trueReadonly||(this.opts.type.current!=="submit"?(e.preventDefault(),this.#s()):this.#s())}#a=p(()=>({checked:this.opts.checked.current,indeterminate:this.opts.indeterminate.current}));get snippetProps(){return t(this.#a)}set snippetProps(e){T(this.#a,e)}#o=p(()=>({id:this.opts.id.current,role:"checkbox",type:this.opts.type.current,disabled:this.trueDisabled,"aria-checked":Mg(this.opts.checked.current,this.opts.indeterminate.current),"aria-required":ji(this.trueRequired),"aria-readonly":ji(this.trueReadonly),"data-disabled":Wi(this.trueDisabled),"data-readonly":Wi(this.trueReadonly),"data-state":Eb(this.opts.checked.current,this.opts.indeterminate.current),[Tb.root]:"",onclick:this.onclick,onkeydown:this.onkeydown,...this.attachment}));get props(){return t(this.#o)}set props(e){T(this.#o,e)}}class fi{static create(){return new fi(vd.get())}root;#e=p(()=>this.root.group?!(this.root.opts.value.current===void 0||!this.root.group.opts.value.current.includes(this.root.opts.value.current)):this.root.opts.checked.current);get trueChecked(){return t(this.#e)}set trueChecked(e){T(this.#e,e)}#t=p(()=>!!this.root.trueName);get shouldRender(){return t(this.#t)}set shouldRender(e){T(this.#t,e)}constructor(e){this.root=e,this.onfocus=this.onfocus.bind(this)}onfocus(e){this.root.opts.ref.current instanceof HTMLElement&&this.root.opts.ref.current.focus()}#n=p(()=>({type:"checkbox",checked:this.root.opts.checked.current===!0,disabled:this.root.trueDisabled,required:this.root.trueRequired,name:this.root.trueName,value:this.root.opts.value.current,readonly:this.root.trueReadonly,onfocus:this.onfocus}));get props(){return t(this.#n)}set props(e){T(this.#n,e)}}function Eb(i,e){return e?"indeterminate":i?"checked":"unchecked"}var Ib=v("<input/>"),zb=v("<input/>");function Db(i,e){ke(e,!1);const n=fi.create();wt();var s=ee(),a=S(s),o=l=>{(function(c,d){ke(d,!0);let u=k(d,"value",15),h=wr(d,["$$slots","$$events","$$legacy","value"]);const y=p(()=>ri(h,{"aria-hidden":"true",tabindex:-1,style:Mb}));var m=ee(),f=S(m),$=C=>{var x=Ib();br(x,()=>({...t(y),value:u()}),void 0,void 0,void 0,!0),r(C,x)},R=C=>{var x=zb();br(x,()=>({...t(y)}),void 0,void 0,void 0,!0),Xa(x,u),r(C,x)};b(f,C=>{t(y).type==="checkbox"?C($):C(R,!1)}),r(c,m),Ae()})(l,Vs(()=>n.props))};b(a,l=>{n.shouldRender&&l(o)}),r(i,s),Ae()}var Lb=v("<button><!></button>"),Pb=v("<!> <!>",1);function Ob(i,e){const n=zl();ke(e,!0);let s=k(e,"checked",15,!1),a=k(e,"ref",15,null),o=k(e,"disabled",3,!1),l=k(e,"required",3,!1),c=k(e,"name",19,()=>{}),d=k(e,"value",3,"on"),u=k(e,"id",19,()=>pc(n)),h=k(e,"indeterminate",15,!1),y=k(e,"type",3,"button"),m=wr(e,["$$slots","$$events","$$legacy","checked","ref","onCheckedChange","children","disabled","required","name","value","id","indeterminate","onIndeterminateChange","child","type","readonly"]);const f=Rb.getOr(null);f&&d()&&(f.opts.value.current.includes(d())?s(!0):s(!1)),ro.pre(()=>d(),()=>{f&&d()&&(f.opts.value.current.includes(d())?s(!0):s(!1))});const $=mi.create({checked:as(()=>s(),A=>{s(A),e.onCheckedChange?.(A)}),disabled:as(()=>o()??!1),required:as(()=>l()),name:as(()=>c()),value:as(()=>d()),id:as(()=>u()),ref:as(()=>a(),A=>a(A)),indeterminate:as(()=>h(),A=>{h(A),e.onIndeterminateChange?.(A)}),type:as(()=>y()),readonly:as(()=>!!e.readonly)},f),R=p(()=>ri({...m},$.props));var C=Pb(),x=S(C),G=A=>{var E=ee(),F=S(E);{let z=p(()=>({props:t(R),...$.snippetProps}));Rt(F,()=>e.child,()=>t(z))}r(A,E)},L=A=>{var E=Lb();br(E,()=>({...t(R)}));var F=g(E);Rt(F,()=>e.children??Kt,()=>$.snippetProps),r(A,E)};b(x,A=>{e.child?A(G):A(L,!1)}),Db(_(x,2),{}),r(i,C),Ae()}const Nb=vc({component:"progress",parts:["root"]});class _i{static create(e){return new _i(e)}opts;attachment;constructor(e){this.opts=e,this.attachment=gc(this.opts.ref)}#e=p(()=>({role:"progressbar",value:this.opts.value.current,"aria-valuemin":this.opts.min.current,"aria-valuemax":this.opts.max.current,"aria-valuenow":this.opts.value.current===null?void 0:this.opts.value.current,"data-value":this.opts.value.current===null?void 0:this.opts.value.current,"data-state":Fb(this.opts.value.current,this.opts.max.current),"data-max":this.opts.max.current,"data-min":this.opts.min.current,"data-indeterminate":this.opts.value.current===null?"":void 0,[Nb.root]:"",...this.attachment}));get props(){return t(this.#e)}set props(e){T(this.#e,e)}}function Fb(i,e){return i===null?"indeterminate":i===e?"loaded":"loading"}var qb=v("<div><!></div>");function Bb(i,e){const n=zl();ke(e,!0);let s=k(e,"value",3,0),a=k(e,"max",3,100),o=k(e,"min",3,0),l=k(e,"id",19,()=>pc(n)),c=k(e,"ref",15,null),d=wr(e,["$$slots","$$events","$$legacy","child","children","value","max","min","id","ref"]);const u=_i.create({value:as(()=>s()),max:as(()=>a()),min:as(()=>o()),id:as(()=>l()),ref:as(()=>c(),R=>c(R))}),h=p(()=>ri(d,u.props));var y=ee(),m=S(y),f=R=>{var C=ee(),x=S(C);Rt(x,()=>e.child,()=>({props:t(h)})),r(R,C)},$=R=>{var C=qb();br(C,()=>({...t(h)}));var x=g(C);Rt(x,()=>e.children??Kt),r(R,C)};b(m,R=>{e.child?R(f):R($,!1)}),r(i,y),Ae()}var Ub=Jo('<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.2892 4.96914C15.6744 5.221 15.7825 5.73746 15.5307 6.12266L9.86399 14.7894C9.73044 14.9936 9.51408 15.129 9.27203 15.1599C9.02996 15.1908 8.78652 15.114 8.60595 14.9499L4.93928 11.6166C4.59873 11.307 4.57364 10.7799 4.88323 10.4394C5.19281 10.0988 5.71985 10.0737 6.0604 10.3833L9.00389 13.0592L14.1357 5.21058C14.3876 4.82538 14.904 4.71728 15.2892 4.96914Z" fill="currentColor"></path></svg>'),Hb=Jo('<svg width="6" height="2" viewBox="0 0 6 2" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.666626 0.999992C0.666626 0.742261 0.875562 0.533325 1.13329 0.533325H4.86663C5.12436 0.533325 5.33329 0.742261 5.33329 0.999992C5.33329 1.25772 5.12436 1.46666 4.86663 1.46666H1.13329C0.875562 1.46666 0.666626 1.25772 0.666626 0.999992Z" fill="currentColor"></path></svg>'),Gb=v('<div data-slot="checkbox-indicator" class="c-checkbox-augment__indicator svelte-1e15djx"><!></div>');function bl(i,e){ke(e,!0);let n=k(e,"ref",15,null),s=k(e,"checked",15,!1),a=k(e,"indeterminate",15,!1),o=k(e,"size",3,2),l=k(e,"variant",3,"primary"),c=k(e,"state",19,()=>{}),d=wr(e,["$$slots","$$events","$$legacy","ref","checked","indeterminate","size","variant","state","class"]);const u=p(()=>`c-checkbox-augment--size-${o()}`),h=p(()=>`c-checkbox-augment--variant-${l()}`),y=p(()=>c()==="hover"?"c-checkbox-augment--hover":c()==="active"?"c-checkbox-augment--active":"");var m=ee(),f=S(m);{const $=(C,x)=>{var G=Gb(),L=g(G),A=F=>{(function(z){var D=Ub();r(z,D)})(F)},E=F=>{var z=ee(),D=S(z),M=w=>{(function(W){var P=Hb();r(W,P)})(w)};b(D,w=>{x?.().indeterminate&&w(M)},!0),r(F,z)};b(L,F=>{x?.().checked?F(A):F(E,!1)}),r(C,G)};let R=p(()=>["c-checkbox-augment",t(u),t(h),t(y),e.class]);Qe(f,()=>Ob,(C,x)=>{x(C,Vs({"data-slot":"checkbox",get class(){return t(R)}},()=>d,{get ref(){return n()},set ref(G){n(G)},get checked(){return s()},set checked(G){s(G)},get indeterminate(){return a()},set indeterminate(G){a(G)},children:$,$$slots:{default:!0}}))})}r(i,m),Ae()}var Wb=v('<div class="c-task-filter-dropdown__filter-item svelte-126g2tg"><!> <!> <div class="c-task-filter-dropdown__filter-item-count svelte-126g2tg"> </div></div>'),jb=v('<div class="c-task-filter-dropdown__filter-item svelte-126g2tg"><!> <!> <!> <div class="c-task-filter-dropdown__filter-item-count svelte-126g2tg"> </div></div>'),Vb=v("<!> <!> <!>",1),Kb=v("<!> <!>",1);function Xb(i,e){ke(e,!0);let n=k(e,"initiallyOpen",3,!1);const s=ch(),a=p(()=>s.hasActiveFilters),o=p(()=>s.allSelected),l=p(()=>s.isIndeterminate),c=p(()=>s.activeFilters),d=p(()=>s.taskFilters),u=p(()=>s.taskCounts),h=p(()=>Object.values(t(u)).reduce((f,$)=>f+$,0));var y=ee(),m=S(y);Qe(m,()=>He.Root,(f,$)=>{$(f,{get defaultOpen(){return n()},children:(R,C)=>{var x=Kb(),G=S(x);Qe(G,()=>He.Trigger,(A,E)=>{E(A,{children:(F,z)=>{Mt(F,{size:.5,variant:"soft",color:"neutral",children:(D,M)=>{Le(D,{size:1,children:(w,W)=>{var P=ee(),K=S(P),X=V=>{var N=se();pe(()=>ze(N,`${t(c).size??""} Selected`)),r(V,N)},q=V=>{var N=se("Filter Tasks");r(V,N)};b(K,V=>{t(a)?V(X):V(q,!1)}),r(w,P)},$$slots:{default:!0}})},$$slots:{default:!0,iconLeft:(D,M)=>{oe(D,{name:"sliders-vertical",size:1,slot:"iconLeft"})},iconRight:(D,M)=>{var w=ee(),W=S(w);Qe(W,()=>He.Chevron,(P,K)=>{K(P,{slot:"iconRight"})}),r(D,w)}}})},$$slots:{default:!0}})});var L=_(G,2);Qe(L,()=>He.Content,(A,E)=>{E(A,{side:"bottom",align:"start",size:1,children:(F,z)=>{var D=Vb(),M=S(D);Qe(M,()=>He.Item,(P,K)=>{K(P,{onSelect:()=>{s.toggleAll()},children:(X,q)=>{var V=Wb(),N=g(V);bl(N,{get indeterminate(){return t(l)},get checked(){return t(o)},onclick:Q=>Q.preventDefault(),size:1,variant:"primary"});var U=_(N,2);Le(U,{size:1,color:"neutral",children:(Q,Z)=>{var ae=se("All");r(Q,ae)},$$slots:{default:!0}});var I=_(U,2),B=g(I);pe(()=>ze(B,t(h))),r(X,V)},$$slots:{default:!0}})});var w=_(M,2);Qe(w,()=>He.Separator,(P,K)=>{K(P,{})});var W=_(w,2);ln(W,17,()=>t(d),P=>P.value,(P,K)=>{const X=p(()=>t(K).value),q=p(()=>t(c).has(t(X)));var V=ee(),N=S(V);Qe(N,()=>He.Item,(U,I)=>{I(U,{onSelect:()=>function(B){s.toggleFilter(B)}(t(X)),children:(B,Q)=>{var Z=jb(),ae=g(Z);bl(ae,{get checked(){return t(q)},onclick:te=>te.preventDefault(),size:1,variant:"primary"});var j=_(ae,2);dh(j,{get taskState(){return t(X)},size:2});var H=_(j,2);Le(H,{size:1,color:"neutral",children:(te,ne)=>{var re=se();pe(()=>ze(re,t(K).label)),r(te,re)},$$slots:{default:!0}});var O=_(H,2),J=g(O);pe(()=>ze(J,t(u)[t(K).value]??0)),r(B,Z)},$$slots:{default:!0}})}),r(P,V)}),r(F,D)},$$slots:{default:!0}})}),r(R,x)},$$slots:{default:!0}})}),r(i,y),Ae()}var Jb=v("<!> <!> <!> <!> <!>",1),Yb=v("<!> <!>",1),Qb=v("<!> <!>",1),Zb=v('<div class="c-task-panel-header svelte-1bdxp6v"><!> <!> <!> <div class="c-task-panel-header__right svelte-1bdxp6v"><!></div></div>');function e1(i,e){ke(e,!0);const n=()=>Y(l,"$rootTask",s),[s,a]=at(),o=oo(),{rootTask:l}=o,c=ei(),d=Do(),u=uh(),h=Ar.tryGetFromContext(),y=p(()=>n()?.subTasksData&&n().subTasksData.length>0);function m(M){for(const w of M)if(w.state===Fn.COMPLETE||w.subTasksData&&m(w.subTasksData))return!0;return!1}function f(M){for(const w of M)if(w.state===Fn.NOT_STARTED||w.state===Fn.IN_PROGRESS||w.subTasksData&&f(w.subTasksData))return!0;return!1}const $=p(()=>!!n()?.subTasksData&&m(n().subTasksData)),R=p(()=>!!n()?.subTasksData&&f(n().subTasksData));async function C(){c?.resetFilters(),d?.reportAddTask();const M=n()?.subTasksData||[],w=M[M.length-1];if(w&&!w.name.trim()&&!w.description.trim())return u?.cancelDeletion(),void Po(w.uuid);const W=await o.createTask();Po(W)}async function x(){d?.reportClearCompletedTasks(),await o.clearCompletedTasks()}async function G(){h&&h.setActiveTab(An.messageHistory),d?.reportRunAllTasks(),await o.runAllTasks()}var L=Zb(),A=g(L);Xb(A,{});var E=_(A,2);{let M=p(()=>[Be.Hover]);je(E,{content:"Add New",get triggerOn(){return t(M)},children:(w,W)=>{vt(w,{size:.5,variant:"ghost-block",color:"neutral",onclick:C,children:(P,K)=>{oe(P,{name:"circle-fading-plus",size:2})},$$slots:{default:!0}})},$$slots:{default:!0}})}var F=_(E,2),z=M=>{var w=Qb(),W=S(w);{let K=p(()=>t($)?"Clear Completed":"No completed tasks"),X=p(()=>[Be.Hover]);je(W,{get content(){return t(K)},get triggerOn(){return t(X)},children:(q,V)=>{{let N=p(()=>!t($));vt(q,{size:.5,variant:"ghost-block",color:"neutral",onclick:x,get disabled(){return t(N)},children:(U,I)=>{oe(U,{name:"brush-cleaning",size:2})},$$slots:{default:!0}})}},$$slots:{default:!0}})}var P=_(W,2);{let K=p(()=>t(R)?"Run All":"No tasks to run"),X=p(()=>[Be.Hover]);je(P,{get content(){return t(K)},get triggerOn(){return t(X)},children:(q,V)=>{{let N=p(()=>!t(R));vt(q,{size:.5,variant:"ghost-block",color:"neutral",onclick:G,get disabled(){return t(N)},children:(U,I)=>{oe(U,{name:"play",size:2})},$$slots:{default:!0}})}},$$slots:{default:!0}})}r(M,w)};b(F,M=>{t(y)&&M(z)});var D=_(F,2);(function(M,w){ke(w,!0);const W=()=>Y(U,"$rootTask",K),P=()=>Y(N,"$isImportingExporting",K),[K,X]=at();let q=k(w,"initiallyOpen",3,!1);const V=Fe(ks.key),{isImportingExporting:N,rootTask:U}=V,I=Fe("chatModel"),B=Do();let Q=ct(void 0);const Z=p(()=>W()?.subTasksData&&W().subTasksData.length>0);async function ae(){P()||(B?.reportExportTaskList(),await V.exportTasksToMarkdown(),t(Q)?.())}async function j(){P()||(B?.reportImportTaskList(),await V.importTasksFromMarkdown(),t(Q)?.())}async function H(){B?.reportContinueTasksInNewChat();const ne=Ze(U);if(!ne)return;const re=I.currentConversationId,he=await V.cloneHydratedTask(ne);re===I.currentConversationId&&he&&await I.setCurrentConversation(void 0,!0,{newTaskUuid:he.uuid}),t(Q)?.()}async function O(){B?.reportClearAllTasks(),await V.clearTaskList(),t(Q)?.()}var J=ee(),te=S(J);Qe(te,()=>He.Root,(ne,re)=>{re(ne,{get defaultOpen(){return q()},get requestClose(){return t(Q)},set requestClose(he){T(Q,he,!0)},children:(he,$e)=>{var me=Yb(),fe=S(me);Qe(fe,()=>He.Trigger,(ce,we)=>{we(ce,{children:(Se,ie)=>{vt(Se,{size:.5,variant:"ghost-block",color:"neutral",get disabled(){return P()},children:(Ce,le)=>{var Me=ee(),ue=S(Me),be=de=>{Dn(de,{size:1})},ye=de=>{oe(de,{name:"ellipsis",size:2})};b(ue,de=>{P()?de(be):de(ye,!1)}),r(Ce,Me)},$$slots:{default:!0}})},$$slots:{default:!0}})});var ge=_(fe,2);Qe(ge,()=>He.Content,(ce,we)=>{we(ce,{size:1,side:"bottom",align:"end",children:(Se,ie)=>{var Ce=Jb(),le=S(Ce);{let de=p(()=>P()||!t(Z));Qe(le,()=>He.Item,(xe,Oe)=>{Oe(xe,{onSelect:ae,get disabled(){return t(de)},children:(De,Ue)=>{var Ie=se("Export to Markdown");r(De,Ie)},$$slots:{default:!0,iconLeft:(De,Ue)=>{oe(De,{name:"share",size:1,slot:"iconLeft"})}}})})}var Me=_(le,2);Qe(Me,()=>He.Item,(de,xe)=>{xe(de,{onSelect:j,get disabled(){return P()},children:(Oe,De)=>{var Ue=se("Import from Markdown");r(Oe,Ue)},$$slots:{default:!0,iconLeft:(Oe,De)=>{oe(Oe,{name:"file-input",size:1,slot:"iconLeft"})}}})});var ue=_(Me,2);{let de=p(()=>!t(Z));Qe(ue,()=>He.Item,(xe,Oe)=>{Oe(xe,{onSelect:H,get disabled(){return t(de)},children:(De,Ue)=>{var Ie=se("Continue in New Chat");r(De,Ie)},$$slots:{default:!0,iconLeft:(De,Ue)=>{oe(De,{name:"wand-sparkles",size:1,slot:"iconLeft"})}}})})}var be=_(ue,2);Qe(be,()=>He.Separator,(de,xe)=>{xe(de,{})});var ye=_(be,2);{let de=p(()=>!t(Z));Qe(ye,()=>He.Item,(xe,Oe)=>{Oe(xe,{onSelect:O,get disabled(){return t(de)},children:(De,Ue)=>{var Ie=se("Clear Task List");r(De,Ie)},$$slots:{default:!0,iconLeft:(De,Ue)=>{oe(De,{name:"trash-2",size:1,slot:"iconLeft"})}}})})}r(Se,Ce)},$$slots:{default:!0}})}),r(he,me)},$$slots:{default:!0}})}),r(M,J),Ae(),X()})(g(D),{}),r(i,L),Ae(),a()}function t1(i,e){ke(e,!1);const n=oo(),s=ei(),a=Ar.tryGetFromContext();wt(),uo(i,{footer:l=>{Mt(l,{size:1,variant:"soft",$$events:{click:()=>{a?.setActiveTab(An.messageHistory)}},children:(c,d)=>{var u=se("Return to Thread");r(c,u)},$$slots:{default:!0,iconLeft:(c,d)=>{oe(c,{name:"arrow-left",slot:"iconLeft"})}}})},children:(l,c)=>{ir(l,{header:h=>{Le(h,{color:"primary",size:4,children:(y,m)=>{var f=se("Get Started with Tasks");r(y,f)},$$slots:{default:!0}})},footer:h=>{Mt(h,{size:1,variant:"soft",$$events:{click:()=>async function(){s?.resetFilters();const y=await n.createTask();Po(y)}()},children:(y,m)=>{var f=se("Add Task");r(y,f)},$$slots:{default:!0,iconLeft:(y,m)=>{oe(y,{name:"circle-fading-plus",slot:"iconLeft"})}}})},children:(h,y)=>{Le(h,{size:1,variant:"surface",children:(m,f)=>{var $=se(`Ask your agent to make a plan which you can refine here in your agent task list. Or, make your
      own plan.`);r(m,$)},$$slots:{default:!0}})}})}}),Ae()}function n1(i,e){ke(e,!1);const n=ei();wt(),uo(i,{children:(s,a)=>{ir(s,{header:c=>{Le(c,{size:4,children:(d,u)=>{var h=se("No Results Found");r(d,h)},$$slots:{default:!0}})},footer:c=>{Mt(c,{size:1,variant:"soft",$$events:{click:()=>{n?.resetFilters()}},children:(d,u)=>{var h=se("Reset Filters");r(d,h)},$$slots:{default:!0,iconLeft:(d,u)=>{oe(d,{name:"undo-2",slot:"iconLeft"})}}})},children:(c,d)=>{Le(c,{size:1,variant:"surface",children:(u,h)=>{var y=se("Try updating your search or filter.");r(u,y)},$$slots:{default:!0}})}})}}),Ae()}var s1=v('<div class="c-task-panel__list svelte-z43r1o"><!></div>'),r1=v('<div class="c-task-panel__empty svelte-z43r1o"><!></div>'),a1=v('<div class="c-task-panel svelte-z43r1o"><div class="c-task-panel__header svelte-z43r1o"><!></div> <!></div>');function o1(i,e){ke(e,!0);const n=()=>Y(u,"$rootTask",s),[s,a]=at(),o=jc(),l=oo(),c=Fe("chatModel"),{isCurrConversationAgentic:d}=o,{rootTask:u}=l,h=new vh;hh(h);const y=new Wl({chatModel:c,taskStore:l,version:jl.v2});Vl(y),zt(()=>{h.taskCounts=gh(n())});const m=p(()=>n()?Zo(n(),h.activeFilters):void 0);mn(()=>{n()&&y.reportViewTaskList(),l.refreshTasks().catch(console.error)});var f=ee(),$=S(f),R=C=>{var x=a1(),G=g(x);e1(g(G),{});var L=_(G,2),A=F=>{var z=s1(),D=g(z);ph(D,{get task(){return t(m)},editable:!0}),Mn(1,z,()=>Ls,()=>({duration:150,y:10})),r(F,z)},E=F=>{var z=ee(),D=S(z),M=W=>{n1(W,{})},w=W=>{var P=r1();t1(g(P),{}),r(W,P)};b(D,W=>{n().subTasks.length?W(M):W(w,!1)},!0),r(F,z)};b(L,F=>{t(m)?.isVisible&&t(m).subTasksData?.length?F(A):F(E,!1)}),r(C,x)};b($,C=>{Y(d,"$isCurrConversationAgentic",s)&&n()&&C(R)}),r(i,f),Ae(),a()}const i1=`## Augment just finished syncing with your codebase! Here is a summary of what we saw:

`;class l1{constructor(e,n){this._chatModel=e,this._convertModelDisplayToId=n}handleMessageFromExtension=e=>(e.data.type===Sn.shouldShowSummary&&this.showProjectSummary(),!0);async retryProjectSummary(e){const[n]=await Promise.all([this.generateQuestions(),this._chatModel.currentConversationModel.resendTurn(e)]);await this.attachQuestions(n)}async showProjectSummary(){this._chatModel.extensionClient.setChatMode(Ks.chat);try{this._chatModel.extensionClient.showAugmentPanel();const e=this.generateQuestions();await this.generateSummary();const n=await e;await this.attachQuestions(n)}finally{this._chatModel.extensionClient.setChatMode(Ks.agent),this._chatModel.saveImmediate()}}async generateQuestions(){const{responseText:e}=await this._chatModel.currentConversationModel.sendSilentExchange({request_message:"Give me the five most important questions a developer would need answered about this codebase. These questions should be separated by a newline. I want you to say absolutely nothing else.",model_id:this._convertModelDisplayToId("Overview"),disableSelectedCodeDetails:!0,chatHistory:[]});return e.split(`
`).filter(s=>s.trim()!=="")}async generateSummary(){await this._chatModel.currentConversationModel.sendExchange({chatItemType:ja.summaryResponse,request_message:"Provide a short summary of this project",model_id:this._convertModelDisplayToId("Overview"),status:zn.draft,disableSelectedCodeDetails:!0,chatHistory:[]},!0)}async attachQuestions(e){const n=this._chatModel.currentConversationModel.chatHistory.findLast(ni);n?.request_id&&e&&this._chatModel.currentConversationModel.updateChatItem(n.request_id,{questionsLoaded:!0,questions:e})}}const c1=function(i){let e;return(...n)=>{const s=i(...n);return Kg(s,e)?e:(e=s,s)}}(i=>i.filter(e=>Gr(e)||ec(e)||Ph(e)||tc(e)||ni(e)||nc(e)||ca(e))),pd=(i,e,n)=>(Gr(e)&&Zl(e)&&i.length>0||ca(e)&&i.length>0?i[i.length-1].push({turn:e,idx:n}):i.push([{turn:e,idx:n}]),i),d1=Yl(i=>i.reduce(pd,[])),u1=Yl(i=>{if(!Array.isArray(i))return console.warn("groupByToolUses received non-array input:",i),[];const e=structuredClone(i),n=[];let s=0;for(let a=0;a<e.length;a++){const o=e[a],l=s;if(Bi(o)&&o){o.structured_output_nodes=o.structured_output_nodes?.map(c=>({...c,requestId:o.request_id}));for(let c=a+1;c<e.length;c++){const d=e[c],u=!d.response_text;if(!(d.response_text&&d.response_text.length<100)&&!u||!Bi(d))break;{const h=d.structured_output_nodes?.map(y=>({...y,requestId:d.request_id}));o.structured_output_nodes?.push(...h??[]),s++,e.splice(c,1),c--}}}pd(n,o,l),s++}return n}),h1=(i,e,n,s)=>{const a={retryMessage:void 0,showGeneratingResponse:!1,showResumingRemoteAgent:!1,showAwaitingUserInput:!1,showRunningSpacer:!1,showStopped:!1,remoteAgentErrorConfig:void 0,showPaused:!1};if(e===Is.running){const o=i?.lastExchange;if(o?.isRetriable&&o?.display_error_message)a.retryMessage=o.display_error_message;else if(n||s.isActive){const l=s.isActive?s.getLastToolUseState():i.getLastToolUseState();s.isActive?s.currentAgent?.workspace_status===yr.workspaceResuming?a.showResumingRemoteAgent=!0:l.phase!==$r.running?a.showGeneratingResponse=!0:a.showRunningSpacer=!0:l.phase!==$r.running?a.showGeneratingResponse=!0:a.showRunningSpacer=!0}else a.showGeneratingResponse=!0}else e===Is.awaitingUserAction?(a.showAwaitingUserInput=!0,a.showRunningSpacer=!0):((o,l)=>{const c=o?.lastExchange?.status,d=c===zn.cancelled,u=o?.getLastToolUseState().phase,h=u===$r.cancelled;return!l.isActive&&(d||h)})(i,s)&&(a.showStopped=!0);return s.isActive&&s.currentAgent?.workspace_status===yr.workspacePaused&&(a.showPaused=!0),a},g1=(i,e,n,s,a=!1)=>{const o=((y,m)=>m.isActive?m.getCurrentChatHistory():c1(y.chatHistory))(i,s),l=a?u1(o):d1(o),c=((y,m)=>m.isActive?m.currentAgent?.workspace_status===yr.workspaceResuming||m.isCurrentAgentRunning?Is.running:Is.notRunning:y)(e,s),d=h1(i,c,n,s),u=!s.isActive,h=!!s.isActive;if(s.isActive){if(s.sendMessageError&&s.currentAgentId){const y=s.currentAgentId,m=s.sendMessageError;d.remoteAgentErrorConfig={error:m,onRetry:m.canRetry&&m.failedExchangeId?()=>s.retryFailedMessage(y,m.failedExchangeId):void 0,onDelete:m.type===dc.agentFailed?()=>s.deleteAgent(y):void 0}}else if(s.agentChatHistoryError&&s.currentAgentId){const y=s.currentAgentId;d.remoteAgentErrorConfig={error:s.agentChatHistoryError,onRetry:()=>s.refreshAgentChatHistory(y)}}}return{chatHistory:Array.isArray(o)?o:[],groupedChatHistory:l,lastGroupConfig:d,doShowFloatingButtons:u,doShowAgentSetupLogs:h}},v1=(i,e=40)=>Ql(i)<=e,wl={[_o.SUCCESS]:"success",[_o.FAILED]:"error",[_o.SKIPPED]:"skipped"},Cl={[Rr.success]:"success",[Rr.failure]:"error",[Rr.running]:null,[Rr.unknown]:"unknown",[Rr.skipped]:"skipped"};var p1=v('<div class="c-command-output__collapsible-header__spacer svelte-114stxo"></div>'),m1=v('<div class="c-command-output__status-icon c-command-output__status-icon--loading svelte-114stxo"><!></div>'),f1=v("<div><!></div>"),_1=v("<!> <!>",1),y1=v('<div class="c-command-output__collapsible-header svelte-114stxo"><!> <!> <div class="c-command-output__status-indicator svelte-114stxo"><!> <!></div></div>'),$1=v('<div class="c-command-output__code-block svelte-114stxo"><!></div>'),b1=v('<div class="c-command-output__code-block c-command-output__code-block--output svelte-114stxo"><!></div>'),w1=v('<div class="c-command-output__command-details"><!> <!> <!></div>'),C1=v('<div class="c-command-output__container svelte-114stxo"><!></div>');function k1(i,e){i.key!=="Enter"&&i.key!==" "||(i.preventDefault(),e())}var A1=v('<div><div class="c-agent-setup-logs-summary svelte-xmsmd1" role="button" tabindex="0"><div class="c-agent-setup-logs-summary-content svelte-xmsmd1"><div class="c-agent-setup-logs-summary-left svelte-xmsmd1"><!> <!></div> <div class="c-agent-setup-logs-summary-icon svelte-xmsmd1"><!></div></div></div> <div><div class="c-agent-setup-logs svelte-xmsmd1"></div></div></div>'),S1=v('<div class="c-agent-no-setup-logs svelte-xmsmd1"><!> <!></div>');function M1(i,e){ke(e,!0);const n=()=>Y(o,"$remoteAgentsModel",s),[s,a]=at(),o=Fe(an.key),l=Fe("chatModel");let c=p(()=>n()?.currentAgent?.status||In.agentUnspecified),d=p(()=>[In.agentIdle,In.agentRunning,In.agentFailed].includes(t(c))),u=p(()=>n()?.agentSetupLogs),h=ct(!1);function y(){T(h,!t(h))}function m(G){G.stopPropagation(),y()}function f(G){return G===Rr.running&&!t(d)}zt(()=>{T(h,!t(d))});var $=ee(),R=S($),C=G=>{var L=A1();let A;var E=g(L);E.__click=y,E.__keydown=[k1,y];var F=g(E),z=g(F),D=g(z);{let I=p(()=>t(h)?"c-agent-setup-logs-toggle-button--expanded":"");vt(D,{variant:"ghost",color:"neutral",size:1,onclick:m,get class(){return`c-agent-setup-logs-toggle-button ${t(I)??""}`},children:(B,Q)=>{oe(B,{name:"chevron-down"})},$$slots:{default:!0}})}var M=_(D,2),w=I=>{Le(I,{size:1,class:"c-agent-setup-logs-summary-text",children:(B,Q)=>{var Z=se("Environment created");r(B,Z)},$$slots:{default:!0}})},W=I=>{Le(I,{size:1,class:"c-agent-setup-logs-summary-text",children:(B,Q)=>{var Z=se("Environment is being created...");r(B,Z)},$$slots:{default:!0}})};b(M,I=>{t(d)?I(w):I(W,!1)});var P=_(z,2),K=g(P),X=I=>{oe(I,{name:"check"})},q=I=>{Dn(I,{size:1})};b(K,I=>{t(d)?I(X):I(q,!1)});var V=_(E,2);let N;var U=g(V);ln(U,21,()=>t(u).steps,ls,(I,B)=>{{let Q=p(()=>{return(H=t(B).status)in wl?wl[H]:H in Cl?Cl[H]:null;var H}),Z=p(()=>f(t(B).status)),ae=p(()=>!f(t(B).status)),j=p(()=>!!t(B).logs);(function(H,O){ke(O,!0);let J=k(O,"title",3,""),te=k(O,"command",3,""),ne=k(O,"output",3,null),re=k(O,"status",3,null),he=k(O,"collapsed",3,!1),$e=k(O,"useMonaco",3,!1),me=k(O,"monacoLang",3,"bash"),fe=k(O,"viewButtonTooltip",3,"View full output in editor"),ge=k(O,"showCollapseButton",3,!0),ce=k(O,"isLoading",3,!1);var we=C1(),Se=g(we);ur(Se,{get collapsed(){return he()},header:Ce=>{var le=y1(),Me=g(le),ue=Te=>{Wr(Te,{})},be=Te=>{var Ye=p1();r(Te,Ye)};b(Me,Te=>{ge()&&re()!=="skipped"?Te(ue):Te(be,!1)});var ye=_(Me,2),de=Te=>{Le(Te,{size:1,weight:"medium",children:(Ye,it)=>{var lt=se();pe(()=>ze(lt,J())),r(Ye,lt)},$$slots:{default:!0}})},xe=Te=>{Le(Te,{size:1,type:"monospace",children:(Ye,it)=>{var lt=se();pe(()=>ze(lt,te())),r(Ye,lt)},$$slots:{default:!0}})};b(ye,Te=>{J()?Te(de):Te(xe,!1)});var Oe=_(ye,2),De=g(Oe),Ue=Te=>{var Ye=m1(),it=g(Ye);Dn(it,{size:1}),r(Te,Ye)},Ie=Te=>{var Ye=ee(),it=S(Ye),lt=Ve=>{var rt=_1(),ve=S(rt),Pe=Xe=>{Le(Xe,{size:1,children:(st,nt)=>{var et=se("Skipped");r(st,et)},$$slots:{default:!0}})};b(ve,Xe=>{re()==="skipped"&&Xe(Pe)});var Je=_(ve,2);{let Xe=p(()=>function(nt){switch(nt){case"success":return"Success";case"error":return"Failed";case"skipped":return"Skipped";case"unknown":return"Unknown";case null:return"Running"}}(re())),st=p(()=>[Be.Hover]);je(Je,{get content(){return t(Xe)},get triggerOn(){return t(st)},children:(nt,et)=>{var ht=f1();let dt;var gt=g(ht);{let Tt=p(()=>{return(mt=re())==="success"||mt==="skipped"?"check":"circle-x";var mt});oe(gt,{get name(){return t(Tt)},size:1})}pe(Tt=>dt=Lt(ht,1,"c-command-output__status-icon svelte-114stxo",null,dt,Tt),[()=>({"c-command-output__status-icon--success":re()==="success","c-command-output__status-icon--error":re()==="error","c-command-output__status-icon--warning":re()==="skipped"})]),r(nt,ht)},$$slots:{default:!0}})}r(Ve,rt)};b(it,Ve=>{re()!==null&&Ve(lt)},!0),r(Te,Ye)};b(De,Te=>{ce()?Te(Ue):Te(Ie,!1)});var Ke=_(De,2),qe=Te=>{je(Te,{get content(){return fe()},align:"end",children:(Ye,it)=>{vt(Ye,{variant:"ghost-block",color:"neutral",size:1,$$events:{click:lt=>O.onViewOutput(lt,ne())},children:(lt,Ve)=>{oe(lt,{name:"external-link"})},$$slots:{default:!0}})},$$slots:{default:!0}})};b(Ke,Te=>{!ne()||re()&&re()==="skipped"||ce()||Te(qe)}),r(Ce,le)},children:(Ce,le)=>{var Me=w1(),ue=g(Me),be=Oe=>{var De=$1(),Ue=g(De);Le(Ue,{size:1,type:"monospace",children:(Ie,Ke)=>{var qe=se();pe(()=>ze(qe,te())),r(Ie,qe)},$$slots:{default:!0}}),r(Oe,De)};b(ue,Oe=>{te()&&!J()&&Oe(be)});var ye=_(ue,2),de=Oe=>{var De=b1(),Ue=g(De),Ie=qe=>{var Te=ee(),Ye=S(Te);Qe(Ye,()=>Dl.Root,(it,lt)=>{lt(it,{children:(Ve,rt)=>{Ud(Ve,{get text(){return ne()},get lang(){return me()}})},$$slots:{default:!0}})}),r(qe,Te)},Ke=qe=>{Le(qe,{size:1,type:"monospace",children:(Te,Ye)=>{var it=se();pe(()=>ze(it,ne())),r(Te,it)},$$slots:{default:!0}})};b(Ue,qe=>{$e()?qe(Ie):qe(Ke,!1)}),r(Oe,De)};b(ye,Oe=>{!ne()||re()&&re()==="skipped"||Oe(de)});var xe=_(ye,2);Rt(xe,()=>O.children??Kt),r(Ce,Me)},$$slots:{header:!0,default:!0}}),r(H,we),Ae()})(I,{get title(){return t(B).step_description},get output(){return t(B).logs},get status(){return t(Q)},get isLoading(){return t(Z)},get collapsed(){return t(ae)},get showCollapseButton(){return t(j)},viewButtonTooltip:"View full output in editor",onViewOutput:(H,O)=>{var J;(J=O)&&l&&l.extensionClient.openScratchFile(J,"plaintext")}})}}),pe((I,B)=>{A=Lt(L,1,"c-agent-setup-logs-container svelte-xmsmd1",null,A,I),en(E,"aria-expanded",t(h)),N=Lt(V,1,"c-agent-setup-logs-wrapper svelte-xmsmd1",null,N,B)},[()=>({"c-agent-setup-logs-container--loading":!t(d)}),()=>({"is-hidden":!t(h)})]),r(G,L)},x=G=>{var L=S1(),A=g(L);Le(A,{size:1,color:"secondary",children:(F,z)=>{var D=se("Waiting to start agent environment...");r(F,D)},$$slots:{default:!0}});var E=_(A,2);Dn(E,{size:1}),r(G,L)};b(R,G=>{t(u)&&t(u).steps&&t(u).steps.length>0?G(C):G(x,!1)}),r(i,$),Ae(),a()}Os(["click","keydown"]);var x1=v("<!> <!>",1),T1=v("<!> <!> <!> <!> <!>  <!>",1),R1=v("<!> <!> <!>",1),E1=v('<span class="character-counter"> </span>'),I1=v("<!> <!> <!>",1),z1=v("<div><!></div>"),D1=v('<span slot="tooltipContent"><!></span>'),L1=v("<!> <!> <!> <!>",1),P1=v('<!> <!> <!> <div class="c-chat-input__context-bar svelte-vzdet8"><!></div>',1),O1=v('<div class="c-chat-input__collapse-button svelte-vzdet8"><!></div>'),N1=v('<div role="button" tabindex="-1"><!></div>');function F1(i,e){ke(e,!1);const n=()=>Y(M,"$chatModel",h),s=()=>Y(P,"$remoteAgentModel",h),a=()=>Y(t(R),"$conversationType",h),o=()=>Y(me,"$enableEditableHistory",h),l=()=>Y(t(A),"$selectedModel",h),c=()=>Y(Se,"$currentRepoUrl",h),d=()=>Y(t(m),"$currentConversationModel",h),u=()=>Y(fe,"$enableChatMultimodal",h),[h,y]=at(),m=_e(),f=_e(),$=_e(),R=_e(),C=_e(),x=_e(),G=_e(),L=_e(),A=_e(),E=_e(),F=_e(),z=_e(),D=_e(),M=Fe("chatModel"),w=Fe(Ys.key),W=Fe("agentConversationModel"),P=Fe(an.key),K=Fe(ar.key),X=Fe("modelRegistry"),q=Xo(Na);let V=k(e,"collapsedMaxHeight",8,120),N=k(e,"requestId",24,()=>{}),U=k(e,"placeholder",8,"Edit your message..."),I=k(e,"content",8),B=k(e,"collapsed",8,!1),Q=k(e,"onSubmitEdit",8),Z=k(e,"onCancelEdit",8,()=>{}),ae=k(e,"setIsCollapsed",8),j=k(e,"userExpanded",12),H=k(e,"showExpandButton",8,!1),O=k(e,"isEditing",12,!1);const J=()=>{Ce()};let te,ne=_e(void 0),re=[],he=_e(!1);const $e=_t("enableModelRegistry"),me=_t("enableEditableHistory"),fe=_t("enableChatMultimodal"),ge=_t("enableDebugFeatures");function ce(){T(he,!t(he))}function we(){O()&&setTimeout(()=>{t(Oe)?.requestFocus()},100)}const Se=K?.currentRepositoryUrl;async function ie(){try{const Ve=t(ne)?.rawText||"";if(!Ve||Ve.trim()==="")return;const rt=t(ne);try{let ve;const{responseText:Pe}=await d().sendSilentExchange({request_message:Kc(Ve),disableRetrieval:!1,chatHistory:ve});d().extensionClient.reportAgentSessionEvent({eventName:Rs.enhancedPrompt,conversationId:d().id});let Je="";const Xe=/<augment-enhanced-prompt>([\s\S]*?)<\/augment-enhanced-prompt>/,st=Pe.match(Xe);if(st&&st[1])Je=st[1].trim();else{Je=Ve,console.warn("Enhanced prompt tags not found in response, using original prompt");const nt=t(Ie).querySelector(".c-rewrite-prompt-button");nt&&Zc({className:"enhance-prompt-error-tooltip",message:"Failed to enhance prompt, sorry about that",referenceElement:nt})}if(Je?.trim()){let nt;if(rt?.richTextJsonRepr&&typeof rt?.richTextJsonRepr=="object"){if(nt={...rt.richTextJsonRepr},nt.content&&Array.isArray(nt.content)){const et=[];let ht=!1;for(const dt of nt.content)if(dt.type!=="paragraph"||ht)dt.type!=="paragraph"&&et.push(dt);else{const gt=Je.split(`
`),Tt={type:"paragraph",content:[]};gt.forEach((mt,pt)=>{mt.length>0&&Tt.content?.push({type:"text",text:mt}),pt<gt.length-1&&Tt.content?.push({type:"hardBreak"})}),et.push(Tt),ht=!0}nt.content=et}}else nt={type:"doc",content:[{type:"paragraph",content:[{type:"text",text:Je}]}]};T(ne,{rawText:Je,richTextJsonRepr:nt}),setTimeout(()=>{Ue();try{const et=t(Ie).querySelector(".ProseMirror");if(et){const ht=et.querySelector("p");if(ht){const dt=document.createRange(),gt=window.getSelection();dt.setStart(ht,0),dt.collapse(!0),gt&&(gt.removeAllRanges(),gt.addRange(dt))}}}catch{}},200)}else T(ne,rt)}catch{T(ne,rt)}Ue()}catch{}}async function Ce(){t(L)&&(j(!0),B()&&ae()(!1),te&&T(ne,te),O(!0),await Kn(),Ue())}function le(){return!(!t(z)||!t(ne))&&(te=void 0,Q()(t(ne),re),!0)}function Me(){O(!1),j(!1),O(!1)}function ue(){return Me(),te=t(ne),T(ne,void 0),!0}function be(){return Me(),te=void 0,T(ne,void 0),Z()(),T(he,!1),!0}function ye(Ve){Ve!==t(ne)&&T(ne,Ve)}function de(Ve){re=Ve.current}let xe=_e(void 0),Oe=_e(void 0);const De=()=>t(Oe)?.requestFocus(),Ue=()=>t(Oe)?.forceFocus();let Ie=_e();function Ke(){return t(Ie)}Ne(()=>n(),()=>{ds(T(m,n().currentConversationModel),"$currentConversationModel",h)}),Ne(()=>s(),()=>{T(f,!!s()?.isActive)}),Ne(()=>s(),()=>{T($,Qo(s()))}),Ne(()=>{},()=>{ds(T(R,w.chatModeType),"$conversationType",h)}),Ne(()=>t(C),()=>{ds(T(C,W.isCurrConversationAgentic),"$isCurrConversationAgentic",h)}),Ne(()=>(t(ne),Ee(I())),()=>{T(x,t(ne)?.richTextJsonRepr??I())}),Ne(()=>(a(),Ee(I()),t(he)),()=>{if(a()==="localAgent"&&I()){const Ve=ac.detectAskModeInContent(I());Ve!==t(he)&&T(he,Ve)}}),Ne(()=>t(ne),()=>{T(G,t(ne)?.rawText.trim()?.length??0)}),Ne(()=>(o(),t(f)),()=>{T(L,o()&&!t(f))}),Ne(()=>{},()=>{ds(T(A,X?.selectedModel??q),"$selectedModel",h)}),Ne(()=>l(),()=>{T(E,l()?.disabled??!1)}),Ne(()=>l(),()=>{T(F,l()?.disabled_reason??"")}),Ne(()=>(Ee(O()),t(L),t(E),t(ne),Ee(I()),Hr),()=>{T(z,O()&&t(L)&&!t(E)&&t(ne)!==void 0&&t(ne).rawText.trim()!==""&&t(ne).rawText!==I()&&t(ne).richTextJsonRepr!==I()&&!Hr.hasLoadingImages(t(ne).richTextJsonRepr))}),Ne(()=>(s(),c(),t(z)),()=>{T(D,Vc(s(),c(),!t(z)))}),hn();var qe={requestStartEdit:J,getEditorContainer:Ke};wt();var Te=N1();let Ye;Nt("mousedown",ts,function(...Ve){(O()?ue:void 0)?.apply(this,Ve)});var it=g(Te);{let Ve=Ge(()=>!O()||O()&&t(he)?"accent":"default");pn(dr.Root(it,{get editable(){return O()},get variant(){return t(Ve)},$$events:{click:rt=>rt.stopPropagation(),dblclick:Ce},children:(rt,ve)=>{var Pe=T1(),Je=S(Pe),Xe=gt=>{var Tt=x1(),mt=S(Tt),pt=ot=>{Bc(ot,{})};b(mt,ot=>{O()&&ot(pt)}),_(mt,2);{let ot=Ge(()=>Y(ge,"$enableDebugFeatures",h)?["image","text"]:["image"]);Gc(0,{changeImageMode:ft=>{N()&&ft&&d().updateChatItem(N(),{rich_text_json_repr:ft})},get saveImage(){return n(),Re(()=>n().saveImage)},get saveAttachment(){return n(),Re(()=>n().saveAttachment)},get deleteImage(){return n(),Re(()=>n().deleteImage)},get renderImage(){return n(),Re(()=>n().renderImage)},isEditable:()=>O(),get supportedFileTypes(){return t(ot)}})}r(gt,Tt)};b(Je,gt=>{u()&&gt(Xe)});var st=_(Je,2);pn(ii(st,{requestEditorFocus:De,onMentionItemsUpdated:de,$$legacy:!0}),gt=>T(xe,gt),()=>t(xe));var nt=_(st,2);qc(0,{get isAskMode(){return t(he)},onAskModeChange:gt=>T(he,gt),onAskModeToggleComplete:we});var et=_(nt,2);oi(et,{get placeholder(){return U()}});var ht=_(et,2);dr.Content(ht,{get content(){return t(x)},onContentChanged:ye});var dt=_(ht,2);Et(dt,e,"default",{},null),r(rt,Pe)},$$slots:{default:!0,footer:(rt,ve)=>{var Pe=ee(),Je=S(Pe),Xe=nt=>{var et=P1(),ht=S(et);Wn(ht,{name:"cancelMessageEdit",handler:be});var dt=_(ht,2);ai(dt,{shortcuts:{Enter:(mt,pt,ot)=>(fr("enter"),!0),Escape:(mt,pt,ot)=>(fr("escape"),!0)}});var gt=_(dt,2);os.Root(gt,{$$slots:{leftAlign:(mt,pt)=>{var ot=I1(),ft=S(ot),Wt=tt=>{var ut=R1(),yt=S(ut);Yc(yt,{get chatModel(){return M},get agentConversationModel(){return W}});var kt=_(yt,2);je(kt,{maxWidth:"200px",children:(tn,cn)=>{{let Vt=Ge(()=>t(he)?"soft":"ghost-block"),Yt=Ge(()=>t(he)?"accent":"neutral");vt(tn,{class:"c-chat-input__ask-mode-btn",size:1,get variant(){return t(Vt)},get color(){return t(Yt)},$$events:{click:ce},children:(nn,fn)=>{oe(nn,{name:"message-square-text"})},$$slots:{default:!0}})}},$$slots:{default:!0,content:(tn,cn)=>{ha(tn,{heading:"Ask a question",description:"Get answers without modifying code",shortcutCommandName:"toggleAskMode"})}}});var Pt=_(kt,2);da(Pt,{orientation:"vertical",class:"c-chat-input__ask-separator"}),r(tt,ut)};b(ft,tt=>{a()==="localAgent"&&tt(Wt)});var Ut=_(ft,2),Ft=tt=>{var ut=E1(),yt=g(ut);pe(()=>ze(yt,`${t(G)??""}/${Fr}`)),r(tt,ut)};b(Ut,tt=>{t(G)>Fr&&tt(Ft)});var $t=_(Ut,2),We=tt=>{Jc(tt,{})};b($t,tt=>{Y(t(C),"$isCurrConversationAgentic",h)&&Y($e,"$enableModelRegistry",h)&&tt(We)}),r(mt,ot)},rightAlign:(mt,pt)=>{var ot=L1(),ft=S(ot),Wt=tt=>{os.AddFileButton(tt,{accept:".png,.jpg,.jpeg"})};b(ft,tt=>{u(),t($),Re(()=>u()&&!t($).doHideMultimodalActions)&&tt(Wt)});var Ut=_(ft,2),Ft=tt=>{var ut=z1(),yt=g(ut);os.RewritePromptButton(yt,{onRewrite:ie,get isDisabled(){return t(D),Re(()=>t(D).isDisabled)},get disabledReason(){return t(D),Re(()=>t(D).disabledReason)}}),Mn(3,ut,()=>to,()=>({axis:"x",duration:200,scale:.4})),r(tt,ut)};b(Ut,tt=>{t(D),Re(()=>!t(D).isHidden)&&tt(Ft)});var $t=_(Ut,2);Wn($t,{name:"submitMessageEdit",handler:le});var We=_($t,2);{let tt=Ge(()=>!t(z)),ut=Ge(()=>t(E)?t(F):"");os.SendButton(We,{get isDisabled(){return t(tt)},get disabledReason(){return t(ut)},primaryAction:le,$$slots:{tooltipContent:(yt,kt)=>{var Pt=D1(),tn=g(Pt);hs(tn,{commandName:"submitMessageEdit",keysOnly:!0}),r(yt,Pt)}}})}r(mt,ot)}}});var Tt=_(gt,2);{const mt=pt=>{{let ot=Ge(()=>(t(xe),Re(()=>t(xe)?.insertMentionNode)));os.ContextMenu(pt,{onCloseDropdown:De,get onInsertMentionable(){return t(ot)}})}};Qc(g(Tt),{get chatModel(){return M},prepend:mt,$$slots:{prepend:!0}})}r(nt,et)},st=nt=>{var et=ee(),ht=S(et),dt=gt=>{var Tt=O1(),mt=g(Tt);{let pt=Ge(()=>t(he)?"accent":"neutral");Mt(mt,{variant:"soft",get color(){return t(pt)},size:.5,$$events:{click:()=>{j(!j()),ae()(!B())}},children:(ot,ft)=>{var Wt=ee(),Ut=S(Wt),Ft=We=>{oe(We,{slot:"iconLeft",name:"chevron-down"})},$t=We=>{oe(We,{slot:"iconLeft",name:"chevron-up"})};b(Ut,We=>{B()?We(Ft):We($t,!1)}),r(ot,Wt)},$$slots:{default:!0}})}r(gt,Tt)};b(ht,gt=>{H()&&gt(dt)},!0),r(nt,et)};b(Je,nt=>{O()?nt(Xe):nt(st,!1)}),r(rt,Pe)}},$$legacy:!0}),rt=>T(Oe,rt),()=>t(Oe))}pn(Te,Ve=>T(Ie,Ve),()=>t(Ie)),pe(Ve=>{Ye=Lt(Te,1,"c-chat-input c-chat-edit-message svelte-vzdet8",null,Ye,Ve),kr(Te,`--chat-input-collapsed-height: ${V()??""}px;`)},[()=>({"is-collapsed":B(),"is-editing":O()})]),Nt("mousedown",Te,Xs(function(Ve){vn.call(this,e,Ve)})),r(i,Te),Gn(e,"requestStartEdit",J),Gn(e,"getEditorContainer",Ke);var lt=Ae(qe);return y(),lt}class zr{constructor(e){this._options=e;const n=zr._getNextPluginId(),s=this._setResizeObserver,a=this._clearResizeObserver,o=this._checkHeight;this._tipTapExtension=lc.create({name:n,onCreate:function(){this.editor.view?.dom&&(s(this.editor),this.editor.on("destroy",a))},onUpdate:function(){const l=this.editor.view?.dom;l&&o(l)},onDestroy:()=>{this._resizeObserver?.disconnect(),this._resizeObserver=void 0}})}static _sequenceId=0;static RESIZE_OBSERVER_PLUGIN_KEY_BASE="augment-resize-observer-plugin-{}";static _getSequenceId=()=>zr._sequenceId++;static _getNextPluginId=()=>{const e=zr._getSequenceId().toString();return zr.RESIZE_OBSERVER_PLUGIN_KEY_BASE.replace("{}",e)};_tipTapExtension;_resizeObserver;_checkHeight=e=>{const n=e.getBoundingClientRect().height;this._options.onResize?.(n)};_setResizeObserver=e=>{const n=e.view?.dom;n&&(this._resizeObserver=new ResizeObserver(s=>{for(const a of s)this._checkHeight(a.target)}),this._resizeObserver.observe(n),this._checkHeight(n))};_clearResizeObserver=()=>{this._resizeObserver?.disconnect(),this._resizeObserver=void 0};updateOptions=e=>{this._options={...this._options,...e}};get tipTapExtension(){return this._tipTapExtension}}var q1=v('<div class="c-user-msg__actions svelte-1ncstye"><!></div>');function B1(i,e){ke(e,!0);const[n,s]=at();let a=k(e,"requestId",19,()=>{}),o=k(e,"richTextJsonRepr",19,()=>{}),l=k(e,"timestamp",19,()=>{}),c=k(e,"onStartEdit",3,()=>{}),d=k(e,"onAcceptEdit",3,()=>{}),u=k(e,"onCancelEdit",3,()=>{});const h=Fe(an.key),y=Fe("agentConversationModel"),m=Fe("toolsWebviewModel"),f=_t("enableChatMultimodal"),$=_t("fullFeatured"),R=_t("enableEditableHistory"),C=120;let x=ct(!1),G=ct(!1);async function L(V){await Kn(),T(x,V&&t(P)&&!t(G),!0)}let A=ct(!1);const E=V=>{t(X)&&a()&&(L(!1),t(D)?.requestStartEdit(),c()(),V?.stopPropagation())},F=()=>{u()()};async function z(V,N){if(!a())return;e.chatModel.currentConversationModel.awaitingReply&&(Ze(y.isCurrConversationAgentic)?await y.interruptAgent().catch(console.error):await m.interruptToolsConversation()),e.chatModel.currentConversationModel.clearHistoryFrom(a());const U=Y(f,"$enableChatMultimodal",n)&&V.richTextJsonRepr?e.chatModel.currentConversationModel.createStructuredRequestNodes(V.richTextJsonRepr):void 0;e.chatModel.currentConversationModel.sendExchange({request_message:V.rawText,rich_text_json_repr:V.richTextJsonRepr,status:zn.draft,mentioned_items:N,structured_request_nodes:U,model_id:e.chatModel.currentConversationModel.selectedModelId??void 0}),d()()}let D=ct(void 0),M=ct(!1),w=p(()=>!!h?.isActive),W=p(()=>a()===void 0||a()===Y(e.chatModel,"$chatModel",n)?.currentConversationModel?.lastExchange?.request_id),P=p(()=>!t(W)&&!t(A)),K=ct(0);const X=p(()=>a()!==void 0&&Y($,"$fullFeatured",n)&&Y(R,"$enableEditableHistory",n)&&!t(w)),q=p(()=>[{label:"Edit message",action:E,id:"edit-message",disabled:!1,lucideIconName:"pencil"}]);zt(()=>{t(K)&&t(P)&&t(D)?.getEditorContainer()&&t(K)&&t(P)&&(t(x)&&t(K)<C?L(!1):L(t(K)>C),T(M,t(K)>C))}),ti(i,{get timestamp(){return l()},get isEditing(){return t(A)},set isEditing(U){T(A,U,!0)},content:U=>{{let I=p(()=>o()??e.msg);pn(F1(U,{get collapsed(){return t(x)},get showExpandButton(){return t(M)},get content(){return t(I)},collapsedMaxHeight:C,get requestId(){return a()},onSubmitEdit:z,onCancelEdit:F,setIsCollapsed:L,get isEditing(){return t(A)},set isEditing(B){T(A,B,!0)},get userExpanded(){return t(G)},set userExpanded(B){T(G,B,!0)},children:(B,Q)=>{(function(Z,ae){ke(ae,!0);let j=k(ae,"height",15,0);const H=ne=>{j(ne)},O=Fe(ua.CONTEXT_KEY),J=new zr({onResize:H}),te=O.pluginManager.registerPlugin(J);As(te),zt(()=>{J.updateOptions({onResize:H})}),Ae()})(0,{get height(){return t(K)},set height(Z){T(K,Z,!0)}})},$$slots:{default:!0}}),B=>T(D,B,!0),()=>t(D))}},userActions:U=>{var I=q1(),B=g(I),Q=Z=>{_h(Z,{get items(){return t(q)}})};b(B,Z=>{t(X)&&!t(A)&&Z(Q)}),r(U,I)},$$slots:{content:!0,userActions:!0}}),Ae(),s()}var U1=v('Connection lost. Please <button class="svelte-inyi2h">try again</button> to restart the conversation!',1),H1=v('We encountered an issue sending your message. Please <button class="svelte-inyi2h">try again</button>',1),G1=v('<div class="c-msg-list__request-id svelte-inyi2h"><span> </span> <!></div>'),W1=v('<div class="c-msg-list__turn-response-failure svelte-inyi2h"><!> <!></div>'),j1=v('<div class="c-msg-list__turn svelte-inyi2h"><!> <!> <!></div>');function V1(i,e){ke(e,!0);const n=()=>Y(d,"$remoteAgentsModel",s),[s,a]=at();let o=k(e,"isLastTurn",3,!1),l=k(e,"turnIndex",3,0),c=k(e,"messageListContainer",19,()=>{});const d=Fe(an.key),u=Fe("toolsWebviewModel");let h=p(()=>e.turn.request_id),y=p(()=>n()?.isActive&&n()?.currentAgent?.is_setup_script_agent===!0),m=p(()=>l()===0),f=p(()=>t(y)&&t(m));const $=()=>{e.chatModel.currentConversationModel.resendTurn(e.turn),e.chatModel.eventTracker?.trackEvent(us.MESSAGE_SEND_RETRY_CLICKED,{source:"button",errorMessagePreview:e.turn.display_error_message?.substring(0,100),requestId:e.turn.request_id})},R=_t("enableRichTextHistory");let C,x=p(()=>Y(R,"$enableRichTextHistory",s)?e.turn.rich_text_json_repr:void 0),G=p(()=>Zl(e.turn)),L=ct("Copy request ID"),A=ct(()=>{});function E(q){q||(clearTimeout(C),C=void 0,T(L,"Copy request ID"))}async function F(){t(h)&&(await navigator.clipboard.writeText(t(h)),T(L,"Copied!"),clearTimeout(C),C=setTimeout(t(A),1500))}const z=p(()=>u?.allToolsUsesResolved(e.turn.request_id??"")),D=p(()=>$h(e.group,e.turn)&&t(z));var M=j1(),w=g(M),W=q=>{{let V=p(()=>e.turn.request_message??"");B1(q,{get msg(){return t(V)},get richTextJsonRepr(){return t(x)},get chatModel(){return e.chatModel},get requestId(){return t(h)},get timestamp(){return e.turn.timestamp}})}};b(w,q=>{t(G)||nc(e.turn)||t(f)||q(W)});var P=_(w,2);{let q=p(()=>e.turn.response_text??"");yh(P,{get turn(){return e.turn},get turnIndex(){return l()},get requestId(){return t(h)},get isLastTurn(){return o()},get group(){return e.group},get showFooter(){return t(D)},get markdown(){return t(q)},get messageListContainer(){return c()}})}var K=_(P,2),X=q=>{var V=W1(),N=g(V),U=Z=>{var ae=se();pe(()=>ze(ae,e.turn.display_error_message)),r(Z,ae)},I=Z=>{var ae=ee(),j=S(ae),H=J=>{var te=U1(),ne=_(S(te)),re=p(()=>or($));ne.__click=function(...he){t(re)?.apply(this,he)},r(J,te)},O=J=>{var te=H1(),ne=_(S(te)),re=p(()=>or($));ne.__click=function(...he){t(re)?.apply(this,he)},r(J,te)};b(j,J=>{e.turn.response_text&&e.turn.response_text.length>0?J(H):J(O,!1)},!0),r(Z,ae)};b(N,Z=>{e.turn.display_error_message?Z(U):Z(I,!1)});var B=_(N,2),Q=Z=>{var ae=G1(),j=g(ae),H=g(j),O=_(j,2);{let J=p(()=>[Be.Hover]);je(O,{onOpenChange:E,get content(){return t(L)},get triggerOn(){return t(J)},get requestClose(){return t(A)},set requestClose(te){T(A,te,!0)},children:(te,ne)=>{vt(te,{variant:"ghost",color:"neutral",size:1,onclick:F,children:(re,he)=>{oe(re,{name:"copy"})},$$slots:{default:!0}})},$$slots:{default:!0}})}pe(()=>ze(H,`Request ID: ${t(h)??""}`)),r(Z,ae)};b(B,Z=>{t(h)&&Z(Q)}),r(q,V)};b(K,q=>{e.turn.status===zn.failed&&q(X)}),r(i,M),Ae(),a()}Os(["click"]);var K1=v('<div class="c-msg-list-bottom-button svelte-1d6jflg"><!></div>'),X1=v("<div><!></div>"),J1=v("<span> </span>"),Y1=v('<div class="c-gen-response svelte-17m6ry2"><span class="c-gen-response__text svelte-17m6ry2"><!> <!></span> <!></div>');function md(i,e){ke(e,!0);let n,s,a=k(e,"timeToTimerMs",3,5e3),o=ct(0),l=Date.now(),c=ct(!1);function d(){T(o,Math.floor((Date.now()-l)/1e3),!0)}function u(){T(c,!0),d(),s=setInterval(d,1e3)}let h=p(()=>function(x){return x>=60?`${Math.floor(x/60)}:${String(x%60).padStart(2,"0")}`:`0:${String(x).padStart(2,"0")}`}(t(o)));mn(function(){return n=setTimeout(u,a()),l=Date.now(),()=>{T(o,0),T(c,!1),clearTimeout(n),clearInterval(s)}});var y=Y1(),m=g(y),f=g(m);Dn(f,{size:1});var $=_(f,2);Le($,{size:1,weight:"light",color:"secondary",children:(x,G)=>{var L=se("Generating response...");r(x,L)},$$slots:{default:!0}});var R=_(m,2),C=x=>{var G=ee(),L=S(G);Qe(L,()=>Jt.Root,(A,E)=>{E(A,{color:"neutral",size:1,children:(F,z)=>{Le(F,{type:"monospace",size:1,weight:"light",color:"secondary",children:(D,M)=>{var w=J1();let W;var P=g(w);pe(K=>{W=Lt(w,1,"c-gen-response__timer svelte-17m6ry2",null,W,K),ze(P,t(h))},[()=>({is_minutes:t(o)>=60})]),r(D,w)},$$slots:{default:!0}})},$$slots:{default:!0}})}),r(x,G)};b(R,x=>{t(c)&&x(C)}),r(i,y),Ae()}class Bs{constructor(e){this.text=e}type="plainText"}class Sa{constructor(e){this.text=e}type="specialBlock"}function kl(i){return i.map(e=>e.text).join("")}var Q1=v('Please <button class="svelte-9nhc5x">try again</button>.',1),Z1=v("Connection lost.<!>",1),ew=v('Please <button class="svelte-9nhc5x">try again</button>',1),tw=v("We encountered an issue sending your message.<!>.",1),nw=v('<div class="c-msg-failure svelte-9nhc5x"><!></div>'),sw=v("<!> <!>",1);function Ro(i,e){ke(e,!0);let n=k(e,"turn",15),s=k(e,"preamble",3,""),a=k(e,"resendTurn",19,()=>{}),o=k(e,"markdownBlocks",19,()=>[]),l=k(e,"showLoadingIndicator",3,!0),c={code:Wg,codespan:Gg,link:bh};zt(()=>{n(n().response_text=n().response_text??"",!0)});let d=p(()=>n().response_text?[new Bs(n().response_text)]:o()),u=p(()=>n().response_text??"");mn(()=>{if(n().seen_state===sc.seen)return void n(n().response_text=kl(t(d)),!0);let h=Date.now();const y=function*($){for(const R of $)if(R.type==="specialBlock")yield R.text;else for(const C of R.text)yield C}(t(d));let m=y.next();const f=()=>{let $=Date.now();const R=Math.round(($-h)/8);let C="";for(let x=0;x<R&&!m.done;x++)C+=m.value,m=y.next();n(n().response_text+=C,!0),h=$,m.done||requestAnimationFrame(f)};f()}),ti(i,{isAugment:!0,content:y=>{var m=ee(),f=S(m),$=C=>{var x=ee(),G=S(x),L=A=>{md(A,{})};b(G,A=>{l()&&A(L)}),r(C,x)},R=C=>{var x=ee(),G=S(x),L=E=>{var F=nw(),z=g(F),D=w=>{var W=se();pe(()=>ze(W,n().display_error_message)),r(w,W)},M=w=>{var W=ee(),P=S(W),K=q=>{var V=Z1(),N=_(S(V)),U=I=>{var B=Q1(),Q=_(S(B)),Z=p(()=>or(a()));Q.__click=function(...ae){t(Z)?.apply(this,ae)},r(I,B)};b(N,I=>{a()&&I(U)}),r(q,V)},X=q=>{var V=tw(),N=_(S(V)),U=I=>{var B=ew(),Q=_(S(B)),Z=p(()=>or(a()));Q.__click=function(...ae){t(Z)?.apply(this,ae)},r(I,B)};b(N,I=>{a()&&I(U)}),r(q,V)};b(P,q=>{n().response_text&&n().response_text.length>0?q(K):q(X,!1)},!0),r(w,W)};b(z,w=>{n().display_error_message?w(D):w(M,!1)}),r(E,F)},A=E=>{var F=sw(),z=S(F);{let w=p(()=>s()+t(u));Ta(z,{get renderers(){return c},get markdown(){return t(w)}})}var D=_(z,2),M=w=>{var W=ee(),P=S(W);Rt(P,()=>e.children??Kt),r(w,W)};b(D,w=>{n().status&&n().status!==zn.success||t(u)!==kl(t(d))||w(M)}),r(E,F)};b(G,E=>{n().status===zn.failed?E(L):E(A,!1)},!0),r(C,x)};b(f,C=>{(!n().status||n().status===zn.sent)&&t(u).length<=0?C($):C(R,!1)}),r(y,m)},$$slots:{content:!0}}),Ae()}Os(["click"]);var rw=v("<!> <!>",1),aw=v("<!> <!>",1),ow=v("<div><!> <!></div>");function iw(i,e){ke(e,!0);const n=()=>Y(d,"$targetCheckpointIdx",o),s=()=>Y(h,"$uuidToIdx",o),a=()=>Y(u,"$totalCheckpointCount",o),[o,l]=at(),c=Fe("checkpointStore"),{targetCheckpointIdx:d,totalCheckpointCount:u,uuidToIdx:h}=c;async function y(){await c.revertToCheckpoint(e.turn.uuid)}let m=p(()=>s().get(e.turn.uuid)??-1),f=p(()=>e.turn.toTimestamp),$=p(()=>{return z=t(m),D=a(),M=n(),z===M||M===void 0&&z===D-1;var z,D,M}),R=p(()=>{return z=t(m),D=a(),M=n(),z===M&&M!==void 0&&M<D-1;var z,D,M}),C=p(()=>t(m)===a()-1),x=p(()=>t(m)+1),G=p(()=>Va(e.turn)),L=p(()=>Va(e.turn)?function(z){if(z.revertTarget?.uuid){const D=s().get(z.revertTarget.uuid);return D===void 0?void 0:`Reverted to Checkpoint ${D+1}`}return z.revertTarget?.filePath?`Undid changes to ${z.revertTarget.filePath.relPath}`:void 0}(e.turn):void 0);var A=ee(),E=S(A),F=z=>{var D=ow();let M;var w=g(D);uc(w,{size:1,insetContent:!0,variant:"ghost",class:"c-checkpoint-tag","data-testid":"checkpoint-version-tag",$$events:{click:()=>{return P=t(m),void zs(d,P);var P}},children:(P,K)=>{Br(P,{size:1,shrink:!0,align:"left",leftIcon:N=>{oe(N,{name:"milestone"})},text:N=>{var U=se();pe(()=>ze(U,`Checkpoint ${t(x)??""}`)),r(N,U)},grayText:N=>{var U=ee(),I=S(U),B=Z=>{var ae=se();pe(()=>ze(ae,t(L))),r(Z,ae)},Q=Z=>{var ae=ee(),j=S(ae),H=O=>{var J=se();pe(te=>ze(J,te),[()=>td(t(f))]),r(O,J)};b(j,O=>{t($)&&O(H)},!0),r(Z,ae)};b(I,Z=>{t(L)?Z(B):Z(Q,!1)}),r(N,U)},$$slots:{leftIcon:!0,text:!0,grayText:!0}})},$$slots:{default:!0}});var W=_(w,2);{let P=p(()=>t($)?"soft":"ghost-block"),K=p(()=>t($)||t(C));vt(W,{get variant(){return t(P)},color:"neutral",size:1,get disabled(){return t(K)},class:"c-revert-button","data-testid":"revert-button",$$events:{click:y},children:(X,q)=>{{let V=p(()=>[Be.Hover]),N=p(()=>t($)||t(C)?"Cannot revert to current version":"Revert to this version");je(X,{get triggerOn(){return t(V)},get content(){return t(N)},children:(U,I)=>{oe(U,{name:"undo-2"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}pe(P=>{M=Lt(D,1,"c-checkpoint-container svelte-1d92nhn",null,M,P),en(D,"data-checkpoint-number",t(m))},[()=>({"c-checkpoint-container--target-checkpoint":t($),"c-checkpoint-container--dimmed-marker":t(R)})]),r(z,D)};b(E,z=>{t(C)&&!t(G)||z(F)}),r(i,A),Ae(),l()}var lw=v('<span class="c-checkpoint-files-count"> </span>'),cw=v(" <!>",1),dw=v('<div class="c-checkpoint-summary"><!></div>'),uw=v('<div class="c-checkpoint-header svelte-1u1yjkn"><div class="c-checkpoint-tag"><!> <!></div> <!> <!></div>');function hw(i,e){ke(e,!1);const[n,s]=at();let a=k(e,"displayCheckpointIdx",8),o=k(e,"filesCount",8,0),l=k(e,"timestamp",8,""),c=k(e,"revertMessage",24,()=>{}),d=k(e,"diffSummary",24,()=>({totalAddedLines:0,totalRemovedLines:0})),u=k(e,"hasChanges",8,!1),h=k(e,"isTarget",8,!1),y=k(e,"onRevertClick",8);const m=$g(),f=m.collapsed,$=m.expandable;function R(D){D.stopPropagation(),D.preventDefault(),y()()}wt();var C=uw(),x=g(C),G=g(x);wh(G,{get expandable(){return Y($,"$expandable",n)},get collapsed(){return Y(f,"$collapsed",n)},$$slots:{icon:(D,M)=>{oe(D,{name:"milestone",slot:"icon"})}}});var L=_(G,2);Br(L,{size:1,shrink:!0,align:"left",$$slots:{text:(D,M)=>{var w=cw(),W=S(w),P=_(W),K=X=>{var q=lw(),V=g(q);pe(N=>ze(V,`(${N??""})`),[()=>(Ee(cr),Ee(o()),Re(()=>cr(o(),"file")))]),r(X,q)};b(P,X=>{o()>0&&X(K)}),pe(()=>ze(W,`Checkpoint ${a()??""} `)),r(D,w)},grayText:(D,M)=>{var w=ee(),W=S(w),P=X=>{var q=se();pe(()=>ze(q,c())),r(X,q)},K=X=>{var q=ee(),V=S(q),N=U=>{var I=se();pe(()=>ze(I,l())),r(U,I)};b(V,U=>{l()&&U(N)},!0),r(X,q)};b(W,X=>{c()?X(P):X(K,!1)}),r(D,w)}}});var A=_(x,2),E=D=>{var M=dw(),w=g(M);ao(w,{size:0,get totalAddedLines(){return Ee(d()),Re(()=>d().totalAddedLines)},get totalRemovedLines(){return Ee(d()),Re(()=>d().totalRemovedLines)}}),r(D,M)};b(A,D=>{u()&&D(E)});var F=_(A,2),z=D=>{{let M=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(D,{get triggerOn(){return t(M)},content:"Revert to this Checkpoint",children:(w,W)=>{Mt(w,{variant:"ghost-block",color:"neutral",size:.5,class:"c-revert-button","data-testid":"revert-button","data-collapsible-button":"false",$$events:{click:R},children:(P,K)=>{var X=se("Revert");r(P,X)},$$slots:{default:!0,iconLeft:(P,K)=>{oe(P,{name:"undo-2",slot:"iconLeft"})}}})},$$slots:{default:!0}})}};b(F,D=>{h()||D(z)}),r(i,C),Ae(),s()}var gw=v('<div class="c-edits-list svelte-1f7mk8i"></div>'),vw=v('<div class="c-edits-list c-edits-list--empty svelte-1f7mk8i"><!></div>'),pw=v("<div><!></div>");function mw(i,e){ke(e,!0);const n=()=>Y(m,"$uuidToIdx",o),s=()=>Y(y,"$totalCheckpointCount",o),a=()=>Y(h,"$targetCheckpointIdx",o),[o,l]=at(),c=Fe("checkpointStore"),d=Fe("chatModel"),u=Xn(),{targetCheckpointIdx:h,totalCheckpointCount:y,uuidToIdx:m}=c;let f=ct(!0);function $(){c.revertToCheckpoint(e.turn.uuid)}let R=p(()=>n().get(e.turn.uuid)??-1),C=p(()=>e.turn.toTimestamp),x=p(()=>e.turn.fromTimestamp),G=p(()=>{return N=t(R),U=s(),I=a(),N===I||I===void 0&&N===U-1;var N,U,I}),L=p(()=>{return N=t(R),U=s(),I=a(),N===I&&I!==void 0&&I<U-1;var N,U,I}),A=p(()=>t(R)===s()-1),E=p(()=>t(R)+1),F=p(()=>Va(e.turn)),z=p(()=>Va(e.turn)?function(N){if(N.revertTarget?.uuid){const U=n().get(N.revertTarget.uuid);return U===void 0?void 0:`Reverted to Checkpoint ${U+1}`}return N.revertTarget?.filePath?`Undid changes to ${N.revertTarget.filePath.relPath}`:void 0}(e.turn):void 0),D=ct(Cr([])),M=p(()=>t(D).filter(N=>N.changesSummary&&(N.changesSummary.totalAddedLines>0||N.changesSummary.totalRemovedLines>0))),w=p(()=>t(M).reduce((N,U)=>(N.totalAddedLines+=U.changesSummary?.totalAddedLines??0,N.totalRemovedLines+=U.changesSummary?.totalRemovedLines??0,N),{totalAddedLines:0,totalRemovedLines:0})),W=p(()=>t(M).length>0),P=ct(!1),K=ct(!1);zt(()=>{t(P)&&e.turn&&!t(K)&&c.getCheckpointSummary(e.turn).then(N=>{T(D,N,!0),T(K,!0)})});var X=ee(),q=S(X),V=N=>{var U=pw();let I;var B=g(U);ur(B,{class:"c-checkpoint-collapsible",stickyHeader:!0,toggleHeader:!0,get collapsed(){return t(f)},set collapsed(Z){T(f,Z,!0)},header:Z=>{{let ae=p(()=>td(t(C)));hw(Z,{get displayCheckpointIdx(){return t(E)},get filesCount(){return t(M).length},get timestamp(){return t(ae)},get revertMessage(){return t(z)},get diffSummary(){return t(w)},get hasChanges(){return t(W)},get isTarget(){return t(G)},onRevertClick:$})}},children:(Z,ae)=>{var j=ee(),H=S(j),O=te=>{var ne=gw();ln(ne,21,()=>t(M),ls,(re,he)=>{ho(re,{get qualifiedPathName(){return t(he).qualifiedPathName},get lineChanges(){return t(he).changesSummary},onClickFile:()=>{return $e=t(he).qualifiedPathName,void u(ws({repoRoot:$e.rootPath,pathName:$e.relPath,allowOutOfWorkspace:!0}));var $e},onClickReview:()=>{return $e=t(he).qualifiedPathName,void d?.extensionClient.showAgentReview($e,t(x),t(C),!1);var $e}})}),r(te,ne)},J=te=>{var ne=ee(),re=S(ne),he=$e=>{var me=vw(),fe=g(me);Le(fe,{size:1,color:"neutral",children:(ge,ce)=>{var we=se("No changes to show");r(ge,we)},$$slots:{default:!0}}),r($e,me)};b(re,$e=>{t(f)||$e(he)},!0),r(te,ne)};b(H,te=>{t(W)?te(O):te(J,!1)}),r(Z,j)},$$slots:{header:!0,default:!0}}),is(U,(Q,Z)=>Ch?.(Q,Z),()=>({onVisible:()=>T(P,!0),scrollTarget:document.body})),pe(Q=>{I=Lt(U,1,"c-checkpoint-container svelte-1f7mk8i",null,I,Q),en(U,"data-checkpoint-number",t(R))},[()=>({"c-checkpoint-container--target-checkpoint":t(G),"c-checkpoint-container--dimmed-marker":t(L)})]),r(N,U)};b(q,N=>{t(A)&&!t(F)||N(V)}),r(i,X),Ae(),l()}var fw=v('<span class="c-gen-response svelte-cnl3c"><!> </span>'),_w=v('<div class="c-paused-remote-agent svelte-181522i"><span class="c-paused-remote-agent__text svelte-181522i">This agent is paused and will resume when you send a new message</span></div>'),yw=v('<div><div class="c-remote-agent-error__content svelte-a88bhq"><span class="c-remote-agent-error__message svelte-a88bhq"> <!></span> <div class="c-remote-agent-error__actions"><!> <!></div></div></div>');function Al(i,e){ke(e,!0);let n=k(e,"onRetry",19,()=>{}),s=k(e,"onDelete",19,()=>{}),a=p(()=>"type"in e.error),o=p(()=>t(a)&&e.error.type===dc.agentFailed),l=p(()=>e.error.errorMessage),c=p(()=>t(a)?void 0:e.error.retryAt),d=p(()=>t(c)!==void 0),u=p(()=>t(o)&&s()),h=p(n),y=ct(void 0);zt(()=>{if(t(c))return function(){if(t(c))return ig(t(c),D=>{T(y,D,!0)})}()});var m=yw();let f;var $=g(m),R=g($),C=g(R),x=_(C),G=D=>{var M=se();pe(()=>ze(M,`Retrying in ${t(y)??""}`)),r(D,M)};b(x,D=>{t(d)&&t(y)&&D(G)});var L=_(R,2),A=g(L),E=D=>{Mt(D,{class:"c-remote-agent-error__button c-remote-agent-error__button--retry",variant:"soft",color:"neutral",size:1,$$events:{click:M=>{M.preventDefault(),n()?.()}},children:(M,w)=>{var W=se();pe(()=>ze(W,"Retry"+(t(d)?" now":""))),r(M,W)},$$slots:{default:!0}})};b(A,D=>{t(h)&&D(E)});var F=_(A,2),z=D=>{Mt(D,{class:"c-remote-agent-error__button c-remote-agent-error__button--delete",variant:"soft",color:"error",size:1,$$events:{click:M=>{M.preventDefault(),s()?.()}},children:(M,w)=>{var W=se("Delete Agent");r(M,W)},$$slots:{default:!0}})};b(F,D=>{t(u)&&D(z)}),pe(D=>{f=Lt(m,1,"c-remote-agent-error svelte-a88bhq",null,f,D),ze(C,`${t(l)??""} `)},[()=>({"c-remote-agent-error--unrecoverable":t(o)})]),r(i,m),Ae()}var $w=v("<span> </span>"),bw=v('<div class="c-resuming-agent svelte-1eu6ps4"><span class="c-resuming-agent__text svelte-1eu6ps4"><!> <!></span> <!></div>');function ww(i,e){ke(e,!0);let n,s,a=k(e,"timeToTimerMs",3,5e3),o=ct(0),l=Date.now(),c=ct(!1);function d(){T(o,Math.floor((Date.now()-l)/1e3),!0)}function u(){T(c,!0),d(),s=setInterval(d,1e3)}let h=p(()=>function(x){return x>=60?`${Math.floor(x/60)}:${String(x%60).padStart(2,"0")}`:`0:${String(x).padStart(2,"0")}`}(t(o)));mn(function(){return n=setTimeout(u,a()),l=Date.now(),()=>{T(o,0),T(c,!1),clearTimeout(n),clearInterval(s)}});var y=bw(),m=g(y),f=g(m);Dn(f,{size:1});var $=_(f,2);Le($,{size:1,weight:"light",color:"secondary",children:(x,G)=>{var L=se("Resuming remote agent...");r(x,L)},$$slots:{default:!0}});var R=_(m,2),C=x=>{var G=ee(),L=S(G);Qe(L,()=>Jt.Root,(A,E)=>{E(A,{color:"neutral",size:1,children:(F,z)=>{Le(F,{type:"monospace",size:1,weight:"light",color:"secondary",children:(D,M)=>{var w=$w();let W;var P=g(w);pe(K=>{W=Lt(w,1,"c-resuming-agent__timer svelte-1eu6ps4",null,W,K),ze(P,t(h))},[()=>({is_minutes:t(o)>=60})]),r(D,w)},$$slots:{default:!0}})},$$slots:{default:!0}})}),r(x,G)};b(R,x=>{t(c)&&x(C)}),r(i,y),Ae()}var Cw=v('<span class="c-retry-response svelte-uflx1w"><!> </span>'),kw=v("<!> Stopped",1),Aw=v('<span class="c-stopped svelte-9oscf2"><!></span>'),Sw=v('<div class="c-msg-list__floating c-msg-list__navigation-controls svelte-1dpaky9"><!></div>'),Mw=v('<div class="c-msg-list__turn--hidden"></div>'),xw=v('<div class="c-msg-list__turn-seen svelte-1dpaky9"></div>'),Tw=v("<!> <!>",1),Rw=v('<div class="c-agent-running-spacer svelte-1dpaky9"></div>'),Ew=v("<!> <!>",1),Iw=v("<!> <!>",1),zw=v('<div class="c-msg-list__floating c-msg-list__scroll-to-bottom svelte-1dpaky9"><!></div>'),Dw=v('<div data-testid="chat-message-list"><!> <div><div class="c-msg-list__content svelte-1dpaky9"><!> <!> <!></div></div> <!></div>');function fd(i,e){ke(e,!0);const n=()=>Y(e.chatModel,"$chatModel",c),s=()=>Y(t(G),"$conversationModel",c),a=()=>Y(h,"$enableGroupedTools",c),o=()=>Y(y,"$enableIntersectionObserverManager",c),l=()=>Y(m,"$fullFeatured",c),[c,d]=at();let u=k(e,"msgListElement",15);const h=_t("enableGroupedTools"),y=_t("enableIntersectionObserverManager"),m=_t("fullFeatured"),f=_t("enableRichCheckpointInfo"),$=Fe("agentConversationModel"),{agentExchangeStatus:R,isCurrConversationAgentic:C}=$,x=Fe(an.key);let G=p(()=>n().currentConversationModel),L=p(()=>g1(s(),Y(R,"$ideAgentExchangeStatus",c),Y(C,"$isCurrConversationAgentic",c),Y(x,"$remoteAgentsModel",c),a())),A=p(()=>t(L).chatHistory),E=p(()=>t(L).groupedChatHistory),F=p(()=>t(L).lastGroupConfig),z=p(()=>t(L).doShowFloatingButtons),D=p(()=>t(L).doShowAgentSetupLogs),M=p(()=>t(F).remoteAgentErrorConfig),w=ct(!1),W=ct(!1),P=!1;function K(ie){T(w,!1),P||(P=!0,fa(ie,{smooth:!0,scrollDuration:100,onScrollFinish:()=>P=!1}))}function X(){T(w,!0)}let q=ct(0),V=p(()=>t(q)),N=p(()=>t(w)),U=p(()=>n()?.currentConversationModel?.focusModel),I=p(()=>Y(t(U),"$focusModel",c).focusedItem?.request_id),B=p(()=>function(ie){return ie.map(Ce=>Ce[0]?.turn.timestamp).filter(Boolean)??[]}(t(E)));const Q=Ni(),Z=()=>26;let ae=p(()=>`${t(V)}px 0px ${t(V)}px 0px`);const j=kh({root:u(),rootMargin:"300px 0px 300px 0px",threshold:0,enabled:o()});Ah(),zt(()=>{j.setConfig({root:u(),rootMargin:t(ae),threshold:0,enabled:o()})});var H=Dw();let O;var J=g(H),te=ie=>{var Ce=Sw(),le=g(Ce);Qe(le,()=>Sh.Controls,(Me,ue)=>{ue(Me,{})}),Mn(3,Ce,()=>Ja,()=>({duration:150,start:.9})),r(ie,Ce)};b(J,ie=>{t(z)&&t(W)&&ie(te)});var ne=_(J,2);let re;var he=g(ne),$e=g(he),me=ie=>{M1(ie,{})};b($e,ie=>{t(D)&&ie(me)});var fe=_($e,2);ln(fe,17,()=>t(E),ls,(ie,Ce,le)=>{const Me=p(()=>le+1===t(E).length);{let ue=p(()=>t(Ce)[0]?.turn?.request_id),be=p(()=>t(Me)?t(V):0);(function(ye,de){let xe=k(de,"dataRequestId",19,()=>{}),Oe=k(de,"class",3,"");var De=X1(),Ue=g(De);Rt(Ue,()=>de.children??Kt),pe(()=>{Lt(De,1,`c-msg-list__item ${Oe()}`,"svelte-1na30ls"),kr(De,`--msg-list-item-min-height: ${de.minHeight}px`),en(De,"data-request-id",xe())}),r(ye,De)})(ie,{class:"c-msg-list__item--grouped",get dataRequestId(){return t(ue)},get minHeight(){return t(be)},children:(ye,de)=>{var xe=Iw(),Oe=S(xe);ln(Oe,19,()=>t(Ce),({turn:Ie,idx:Ke})=>Ie.request_id??`no-request-id-${Ke}`,(Ie,Ke,qe)=>{let Te=()=>t(Ke).turn;const Ye=p(()=>t(Me)&&t(qe)+1===t(Ce).length),it=p(()=>Gr(Te())&&Te().hidden);var lt=Tw(),Ve=S(lt),rt=Xe=>{var st=Mw();r(Xe,st)},ve=Xe=>{var st=ee(),nt=S(st),et=dt=>{Ro(dt,{get turn(){return Te()}})},ht=dt=>{var gt=ee(),Tt=S(gt),mt=ot=>{(function(ft,Wt){ke(Wt,!0);const[Ut,Ft]=at(),$t=_t("suggestedEditsAvailable"),We={seen_state:Wt.turn.seen_state,status:zn.success};let tt={type:"doc",content:[{type:"paragraph",content:[{type:"text",text:"What can "},{type:"mention",attrs:{id:"Augment",label:"Augment",data:{id:"Augment",label:"Augment"}}},{type:"text",text:" do?"}]}]};const ut=[[new Sa("[**Chat**](https://docs.augmentcode.com/using-augment/chat)"),new Bs(": Explore your codebase, get up to speed on unfamiliar code, and work through technical problems using natural language.")],[new Sa("[**Code Completions**](https://docs.augmentcode.com/using-augment/completions)"),new Bs(": Receive intelligent code suggestions that take your entire codebase into account as you type.")],[new Sa("[**Instructions**](https://docs.augmentcode.com/using-augment/instructions)"),new Bs(": Use natural language prompts to write or modify code, applied as a diff for your review.")]];Y($t,"$suggestedEditsAvailable",Ut)&&ut.push([new Sa("[**Suggested Edits**](https://docs.augmentcode.com/using-augment/suggested-edits)"),new Bs(": Take your completions beyond the cursor and across your workspace.")]);let yt=[new Bs(`Welcome to Augment!

Augment can help you understand code, debug issues, and ship faster with its deep understanding of your codebase. Here is what Augment can do for you:

`),...ut.flatMap((Vt,Yt)=>[new Bs(`${Yt+1}. `),...Vt,new Bs(`

`)]),new Bs("Ask questions to learn more! Just remember to tag **@Augment** when asking about Augment's capabilities.")],kt=ct(void 0);function Pt(){t(kt)?.requestFocus()}var tn=aw(),cn=S(tn);ti(cn,{content:Yt=>{var nn=ee(),fn=S(nn);Qe(fn,()=>dr.Root,(jt,Ht)=>{pn(Ht(jt,{children:(Xt,At)=>{var xt=rw(),Bt=S(xt);Qe(Bt,()=>dr.Content,(Zt,_n)=>{_n(Zt,{get content(){return tt}})});var Gt=_(Bt,2);ii(Gt,{requestEditorFocus:Pt}),r(Xt,xt)},$$slots:{default:!0}}),Xt=>T(kt,Xt,!0),()=>t(kt))}),r(Yt,nn)},$$slots:{content:!0}}),Ro(_(cn,2),{get turn(){return We},get markdownBlocks(){return yt}}),r(ft,tn),Ae(),Ft()})(ot,{get turn(){return Te()}})},pt=ot=>{var ft=ee(),Wt=S(ft),Ut=$t=>{Ro($t,{get turn(){return Te()},showLoadingIndicator:!1,get preamble(){return i1},resendTurn:()=>e.onboardingWorkspaceModel.retryProjectSummary(Te()),children:(We,tt)=>{Mh(We,{get conversationModel(){return s()},get turn(){return Te()}})},$$slots:{default:!0}})},Ft=$t=>{var We=ee(),tt=S(We),ut=kt=>{V1(kt,{get group(){return t(Ce)},get chatModel(){return e.chatModel},get turn(){return Te()},get turnIndex(){return t(Ke).idx},get isLastTurn(){return t(Ye)},get messageListContainer(){return u()}})},yt=kt=>{var Pt=ee(),tn=S(Pt),cn=Vt=>{{let Yt=p(()=>`checkpoint-${Te().request_id}`);xh(Vt,{get intersectionId(){return t(Yt)},estimatedHeight:Z,children:(nn,fn)=>{var jt=ee(),Ht=S(jt),Xt=xt=>{mw(xt,{get turn(){return Te()}})},At=xt=>{iw(xt,{get turn(){return Te()}})};b(Ht,xt=>{Y(f,"$enableRichCheckpointInfo",c)?xt(Xt):xt(At,!1)}),r(nn,jt)},$$slots:{default:!0}})}};b(tn,Vt=>{ca(Te())&&Te().status===zn.success&&Vt(cn)},!0),r(kt,Pt)};b(tt,kt=>{Nh(Te())?kt(ut):kt(yt,!1)},!0),r($t,We)};b(Wt,$t=>{ni(Te())?$t(Ut):$t(Ft,!1)},!0),r(ot,ft)};b(Tt,ot=>{tc(Te())?ot(mt):ot(pt,!1)},!0),r(dt,gt)};b(nt,dt=>{ec(Te())?dt(et):dt(ht,!1)},!0),r(Xe,st)};b(Ve,Xe=>{t(it)?Xe(rt):Xe(ve,!1)});var Pe=_(Ve,2),Je=Xe=>{var st=xw();is(st,(nt,et)=>function(ht,dt){let gt=dt;const Tt=_r(()=>{gt.onSeen()},1e3,{leading:!0,trailing:!0}),mt=new IntersectionObserver(ot=>{for(const ft of ot)if(ft.target===ht&&ft.isIntersecting){Tt();break}},{threshold:.5}),pt=()=>{mt.disconnect(),gt.track&&mt.observe(ht)};return pt(),{update(ot){const ft=gt;gt=ot,gt.track!==ft.track&&pt()},destroy:()=>{mt.disconnect(),gt.onSeen()}}}(nt,et),()=>({onSeen:()=>(nt=>s().markSeen(nt))(Te()),track:Te().seen_state!==sc.seen})),r(Xe,st)};b(Pe,Xe=>{Oh(Te())&&Xe(Je)}),r(Ie,lt)});var De=_(Oe,2),Ue=Ie=>{var Ke=Ew(),qe=S(Ke),Te=Ve=>{Al(Ve,{get error(){return t(M).error},get onRetry(){return t(M).onRetry},get onDelete(){return t(M).onDelete}})},Ye=Ve=>{var rt=ee(),ve=S(rt),Pe=Xe=>{(function(st,nt){let et=k(nt,"message",3,"Retrying...");var ht=Cw(),dt=g(ht);Dn(dt,{size:1});var gt=_(dt);pe(()=>ze(gt,` ${et()??""}`)),r(st,ht)})(Xe,{get message(){return t(F).retryMessage}})},Je=Xe=>{var st=ee(),nt=S(st),et=dt=>{ww(dt,{})},ht=dt=>{var gt=ee(),Tt=S(gt),mt=ot=>{(function(ft){var Wt=_w();r(ft,Wt)})(ot)},pt=ot=>{var ft=ee(),Wt=S(ft),Ut=$t=>{md($t,{})},Ft=$t=>{var We=ee(),tt=S(We),ut=kt=>{(function(Pt,tn){ke(tn,!0);let cn=ct(".");mn(()=>{const fn=setInterval(()=>{T(cn,t(cn).length>=3?".":t(cn)+".",!0)},500);return()=>clearInterval(fn)});var Vt=fw(),Yt=g(Vt);oe(Yt,{name:"pause"});var nn=_(Yt);pe(()=>ze(nn,` Waiting for user input${t(cn)??""}`)),r(Pt,Vt),Ae()})(kt,{})},yt=kt=>{var Pt=ee(),tn=S(Pt),cn=Vt=>{(function(Yt){var nn=Aw(),fn=g(nn);Le(fn,{size:1,children:(jt,Ht)=>{var Xt=kw(),At=S(Xt);oe(At,{name:"square"}),r(jt,Xt)},$$slots:{default:!0}}),r(Yt,nn)})(Vt)};b(tn,Vt=>{t(F).showStopped&&Vt(cn)},!0),r(kt,Pt)};b(tt,kt=>{t(F).showAwaitingUserInput?kt(ut):kt(yt,!1)},!0),r($t,We)};b(Wt,$t=>{t(F).showGeneratingResponse?$t(Ut):$t(Ft,!1)},!0),r(ot,ft)};b(Tt,ot=>{t(F).showPaused?ot(mt):ot(pt,!1)},!0),r(dt,gt)};b(nt,dt=>{t(F).showResumingRemoteAgent?dt(et):dt(ht,!1)},!0),r(Xe,st)};b(ve,Xe=>{t(F).retryMessage?Xe(Pe):Xe(Je,!1)},!0),r(Ve,rt)};b(qe,Ve=>{t(M)?Ve(Te):Ve(Ye,!1)});var it=_(qe,2),lt=Ve=>{var rt=Rw();r(Ve,rt)};b(it,Ve=>{t(F).showRunningSpacer&&Ve(lt)}),r(Ie,Ke)};b(De,Ie=>{t(Me)&&Ie(Ue)}),r(ye,xe)},$$slots:{default:!0}})}});var ge=_(fe,2),ce=ie=>{Al(ie,{get error(){return t(M).error},get onRetry(){return t(M).onRetry},get onDelete(){return t(M).onDelete}})};b(ge,ie=>{!t(A).length&&t(M)&&ie(ce)}),pn(ne,ie=>u(ie),()=>u()),is(ne,(ie,Ce)=>function(le,Me={}){let ue=Me,be={scrollTop:0,scrollBottom:0,scrollHeight:0,scrolledIntoBottom:!0,scrolledAwayFromBottom:!1};const ye=()=>{const{scrollTop:de,scrollHeight:xe,offsetHeight:Oe}=le,De=Ql(le),Ue=de>be.scrollTop,Ie=xe-be.scrollHeight,Ke=!(Ie<0&&be.scrollBottom<-Ie)&&de<be.scrollTop&&De>be.scrollBottom,qe=xe>Oe,Te=v1(le)&&qe&&Ue,Ye=Ke||!qe;Te&&!be.scrolledIntoBottom?ue.onScrollIntoBottom?.(le):Ye&&!be.scrolledAwayFromBottom&&ue.onScrollAwayFromBottom?.(le),be={scrollTop:de,scrollBottom:De,scrolledIntoBottom:Te,scrolledAwayFromBottom:Ye,scrollHeight:xe},ue.onScroll?.(de)};return le.addEventListener("scroll",ye),{update(de){ue=de},destroy(){le.removeEventListener("scroll",ye)}}}(ie,Ce),()=>({onScrollIntoBottom:K,onScrollAwayFromBottom:X})),is(ne,(ie,Ce)=>function(le,Me){let ue=Me;return{update(be){if(be!==ue&&!ue?.startsWith(Jh)){const ye=le.querySelector(`[data-request-id="${be}"]`);ye?Gl(le,ye,{smooth:!0}):fa(le,{smooth:!0})}ue=be}}}(ie,Ce),()=>t(I)),is(ne,(ie,Ce)=>function(le,Me){let ue=le.offsetHeight,be=Me;const ye=new ResizeObserver(de=>{const xe=de[0].contentRect.height;de.length===1?xe!==ue&&(be.onHeightChange?.(xe),ue=xe):console.warn("Unexpected number of resize entries: ",de)});return ye.observe(le),be?.onHeightChange?.(ue),{update(de){be=de},destroy:()=>ye.disconnect()}}(ie,Ce),()=>({onHeightChange:ia(ie=>T(q,Math.ceil(ie),!0),10)})),is(ne,(ie,Ce)=>function(le,Me={items:[],conversationNavigationItems:Ni()}){let ue=Me,be=[],ye=null;const{conversationNavigationItems:de}=Me;function xe(Te){ue=Te,de.update(Ye=>({...Ye,all:Te.items??[]}))}function Oe(){if((ue.items?.length??0)<1)return;const Te=new Set(ue.items),Ye=le.querySelectorAll("[data-timestamp-id]");be=[];for(const it of Ye){const lt=it.getAttribute("data-timestamp-id");if(lt&&Te.has(lt)){const Ve=it.offsetTop;be.push({id:lt,element:it,offsetTop:Ve})}}be.sort((it,lt)=>it.offsetTop-lt.offsetTop),De()}function De(Te){if(be.length===0)return;const Ye=Te??le.scrollTop;let it,lt,Ve=1/0,rt=1/0;for(const Pe of be){if(Pe.offsetTop>Ye+80){const Je=Pe.offsetTop-Ye;Je<Ve&&(Ve=Je,it={id:Pe.id,offsetTop:Pe.offsetTop})}if(Pe.offsetTop<Ye-80){const Je=Ye-Pe.offsetTop;Je<rt&&(rt=Je,lt={id:Pe.id,offsetTop:Pe.offsetTop})}}const ve=!mh(le);de.update(Pe=>Pe.next?.id===it?.id&&Pe.next?.offsetTop===it?.offsetTop&&Pe.prev?.id===lt?.id&&Pe.prev?.offsetTop===lt?.offsetTop&&Pe.canScrollToBottom===ve?Pe:{...Pe,next:it,prev:lt,canScrollToBottom:ve})}const Ue=_r(Te=>{De(Te.target.scrollTop)},100),Ie=_r(Oe,300),Ke=Te=>{fh(le,Te,{smooth:!0})},qe=()=>{fa(le,{smooth:!0})};return Oe(),de.update(Te=>({...Te,scrollTo:Ke,scrollToBottom:qe})),le.addEventListener("scroll",Ue,{passive:!0}),ye=new ResizeObserver(Ie),ye.observe(le),xe(Me),{update(Te){xe(Te),Oe()},destroy(){le.removeEventListener("scroll",Ue),ye?.disconnect(),be=[],de.update(()=>({all:[]}))}}}(ie,Ce),()=>({items:t(B),conversationNavigationItems:Q}));var we=_(ne,2),Se=ie=>{var Ce=zw();(function(le,Me){ke(Me,!0);let ue=k(Me,"messageListElement",3,null);var be=K1(),ye=g(be);vt(ye,{variant:"ghost-block",size:.5,onclick:()=>{ue()&&fa(ue(),{smooth:!0})},children:(de,xe)=>{oe(de,{name:"arrow-down"})},$$slots:{default:!0}}),r(le,be),Ae()})(g(Ce),{get messageListElement(){return u()}}),Mn(3,Ce,()=>Ja,()=>({duration:150,start:.9})),r(ie,Ce)};b(we,ie=>{t(z)&&t(W)&&t(N)&&ie(Se)}),pe((ie,Ce)=>{O=Lt(H,1,"c-msg-list-container svelte-1dpaky9",null,O,ie),re=Lt(ne,1,"c-msg-list svelte-1dpaky9",null,re,Ce)},[()=>({"c-msg-list--minimal":!l()}),()=>({"c-msg-list--minimal":!l(),"group-tools":a()})]),Nt("mouseenter",H,()=>T(W,!0)),Nt("mouseleave",H,()=>T(W,!1)),r(i,H),Ae(),d()}var Lw=v('<div class="c-new-agent-empty__header svelte-1qfz2l5"><div class="c-new-agent-empty__header-icon svelte-1qfz2l5"><!></div> <!></div>');function _d(i){ir(i,{header:n=>{var s=Lw(),a=g(s),o=g(a);oe(o,{name:"wand-sparkles",size:2});var l=_(a,2);Le(l,{color:"primary",size:4,children:(c,d)=>{var u=se("New Agent Thread");r(c,u)},$$slots:{default:!0}}),r(n,s)},children:(n,s)=>{Le(n,{size:1,variant:"surface",children:(a,o)=>{var l=se("Work with your agent to use tools and make file edits.");r(a,l)},$$slots:{default:!0}})}})}var Pw=v('<div class="c-message-history-tab__empty svelte-hepwid"><!></div>'),Ow=v('<div class="c-message-history-tab__message-list svelte-hepwid"><!></div>'),Nw=v('<div class="c-message-history-tab svelte-hepwid"><!></div>');function Fw(i,e){ke(e,!0);const n=()=>Y(e.remoteAgentsModel,"$remoteAgentsModel",a),s=()=>Y(t(l),"$conversationModel",a),[a,o]=at();let l=p(()=>Y(e.chatModel,"$chatModel",a).currentConversationModel),c=p(()=>n().currentAgentId),d=p(()=>n().isActive),u=p(()=>t(d)&&n().getCurrentChatHistory()?.length),h=p(()=>t(d)&&n().agentSetupLogs?.steps.length!==0),y=p(()=>t(d)?!t(u)&&!t(h):Ds.isEmptyExchanges(s())),m=p(()=>`${s().id}-${t(d)?t(c):""}`);var f=Nw(),$=g(f),R=x=>{var G=Pw();_d(g(G)),r(x,G)},C=x=>{var G=ee(),L=S(G);qr(L,()=>t(m),A=>{var E=Ow();fd(g(E),{get chatModel(){return e.chatModel},get onboardingWorkspaceModel(){return e.onboardingWorkspaceModel}}),r(A,E)}),r(x,G)};b($,x=>{t(y)?x(R):x(C,!1)}),r(i,f),Ae(),o()}var qw=v('<div class="ds-tab-panels svelte-1d4kh3p"><!></div>'),Bw=v("<!> <span>/</span> <!>",1),Uw=v('<div class="c-chat-thread-body__badge svelte-1q5wcvj"><!></div>'),Hw=v('<div class="c-chat-thread-body__badge svelte-1q5wcvj"><!></div>'),Gw=v("<!> <!> <!> <!>",1),Ww=v('<div class="c-chat-thread-body__tab-list"><!></div>'),jw=v("<!> <!> <!> <!>",1),Vw=v("<!> <!>",1),Kw=v('<div class="c-chat-thread-body svelte-1q5wcvj"><!></div>');function Xw(i,e){ke(e,!0);const n=()=>Y(t(z),"$repositories",c),s=()=>Y(t(D),"$availableRepositories",c),a=()=>Y(u,"$chatModel",c),o=()=>Y(L,"$availableTabs",c),l=()=>Y(R,"$diffSummary",c),[c,d]=at(),u=Fe("chatModel"),h=Fe("onboardingWorkspaceModel"),y=Fe(an.key),m=Fe(ks.key),f=go(),{taskProgress:$}=m,{diffSummary:R}=f,C=_t("enableAgentTabs"),x=Ar.getFromContext(),{activeTab:G,availableTabs:L,shouldShowTabs:A}=x,E=Ps.getContext(),F=p(()=>E?.model),z=p(()=>t(F)?.repositories),D=p(()=>t(F)?.availableRepositories),M=p(()=>Y($,"$taskProgress",c)),w=p(()=>t(M)?t(M).total:0),W=p(()=>{if(!n())return{totalFiles:0};const I=new Set;for(const[B,Q]of n()){const Z=Q.fileCollectionsModel;if(!Z)continue;const ae=Z.allFiles;(ae?Ze(ae):[]).forEach(j=>{I.add(`${B}:${j.qualifiedPathName.relPath}`)})}return{totalFiles:I.size}}),P=p(()=>t(W).totalFiles>0),K=p(()=>s()&&s().length>0);function X(I){a().sendModeModel.setMode(I),a().save()}function q(I){const B=I.detail.value;x.setActiveTab(B),B===An.tasks?X(js.addTask):X(js.send)}As(()=>x.destroy());var V=ee(),N=S(V),U=I=>{var B=Kw();Sc(g(B),{get value(){return Y(G,"$activeTab",c)},size:1,color:"neutral",scrollable:!0,hideLabelOnNarrow:!0,$$events:{change:q},children:(Q,Z)=>{var ae=Vw(),j=S(ae);ci(j,{target:"#thread-header-portal-container",children:(H,O)=>{var J=Ww();Mc(g(J),{showSlidingBackground:!0,expandToFit:!0,children:(te,ne)=>{var re=Gw(),he=S(re),$e=ie=>{Ir(ie,{get value(){return An.messageHistory},leftIcon:le=>{oe(le,{name:"wand-sparkles"})},children:(le,Me)=>{var ue=se("Thread");r(le,ue)},$$slots:{leftIcon:!0,default:!0}})};b(he,ie=>{o().includes(An.messageHistory)&&ie($e)});var me=_(he,2),fe=ie=>{Ir(ie,{get value(){return An.tasks},leftIcon:Me=>{oe(Me,{name:"list-checks"})},rightIcon:Me=>{var ue=ee(),be=S(ue),ye=de=>{var xe=ee(),Oe=S(xe);Qe(Oe,()=>Jt.Root,(De,Ue)=>{Ue(De,{color:"neutral",variant:"soft",size:0,children:(Ie,Ke)=>{var qe=Uw();zp(g(qe),{children:(Te,Ye)=>{var it=Bw(),lt=S(it);Ia(lt,{get value(){return t(M).completed},willChange:!0}),Ia(_(lt,4),{get value(){return t(M).total},willChange:!0}),r(Te,it)},$$slots:{default:!0}}),r(Ie,qe)},$$slots:{default:!0}})}),r(de,xe)};b(be,de=>{t(w)>0&&de(ye)}),r(Me,ue)},children:(Me,ue)=>{var be=se("Tasks");r(Me,be)},$$slots:{leftIcon:!0,rightIcon:!0,default:!0}})};b(me,ie=>{o().includes(An.tasks)&&ie(fe)});var ge=_(me,2),ce=ie=>{Ir(ie,{get value(){return An.agentEdits},leftIcon:Me=>{oe(Me,{name:"file-diff"})},rightIcon:Me=>{var ue=ee(),be=S(ue),ye=de=>{ao(de,{size:0,get totalAddedLines(){return l().totalAddedLines},get totalRemovedLines(){return l().totalRemovedLines}})};b(be,de=>{(l().totalAddedLines>0||l().totalRemovedLines>0)&&de(ye)}),r(Me,ue)},children:(Me,ue)=>{var be=se("Edits");r(Me,be)},$$slots:{leftIcon:!0,rightIcon:!0,default:!0}})};b(ge,ie=>{o().includes(An.agentEdits)&&ie(ce)});var we=_(ge,2),Se=ie=>{Ir(ie,{get value(){return An.agentGitEdits},leftIcon:Me=>{oe(Me,{name:"file-diff"})},rightIcon:Me=>{var ue=ee(),be=S(ue),ye=de=>{var xe=ee(),Oe=S(xe);Qe(Oe,()=>Jt.Root,(De,Ue)=>{Ue(De,{color:"neutral",variant:"soft",size:0,children:(Ie,Ke)=>{var qe=Hw();Ia(g(qe),{get value(){return t(W).totalFiles},willChange:!0}),r(Ie,qe)},$$slots:{default:!0}})}),r(de,xe)};b(be,de=>{t(P)&&de(ye)}),r(Me,ue)},children:(Me,ue)=>{var be=se("Changes");r(Me,be)},$$slots:{leftIcon:!0,rightIcon:!0,default:!0}})};b(we,ie=>{o().includes(An.agentGitEdits)&&t(K)&&ie(Se)}),r(te,re)},$$slots:{default:!0}}),r(H,J)},$$slots:{default:!0}}),function(H,O){var J=qw(),te=g(J);Rt(te,()=>O.children??Kt),r(H,J)}(_(j,2),{children:(H,O)=>{var J=jw(),te=S(J);Aa(te,{get value(){return An.messageHistory},forceMount:!0,children:(he,$e)=>{Fw(he,{get chatModel(){return u},get onboardingWorkspaceModel(){return h},get remoteAgentsModel(){return y}})},$$slots:{default:!0}});var ne=_(te,2);Aa(ne,{get value(){return An.tasks},children:(he,$e)=>{var me=ee(),fe=S(me),ge=we=>{o1(we,{})},ce=we=>{Sb(we,{})};b(fe,we=>{Y(C,"$enableAgentTabs",c)?we(ge):we(ce,!1)}),r(he,me)},$$slots:{default:!0}});var re=_(ne,2);Aa(re,{get value(){return An.agentEdits},children:(he,$e)=>{N$(he,{})},$$slots:{default:!0}}),Aa(_(re,2),{get value(){return An.agentGitEdits},children:(he,$e)=>{wb(he,{})},$$slots:{default:!0}}),r(H,J)}}),r(Q,ae)},$$slots:{default:!0}}),r(I,B)};b(N,I=>{Y(A,"$shouldShowTabs",c)&&I(U)}),r(i,V),Ae(),d()}var Jw=v('<div class="memory-queue-instance__edit-indicator">Memory is being edited.</div>'),Yw=v('<li class="svelte-dg83pr"><span class="memory-queue-instance__metadata-label svelte-dg83pr">Scope:</span> <span class="memory-queue-instance__metadata-value"> </span></li>'),Qw=v('<div class="memory-queue-instance__loading svelte-dg83pr" role="status" aria-live="polite"><!> <!></div>'),Zw=v("<!> <!> <!>",1),eC=v('<div class="memory-queue-instance__content svelte-dg83pr"><h3 class="memory-queue-instance__label svelte-dg83pr"><!></h3> <!></div> <div class="memory-queue-instance__metadata svelte-dg83pr" aria-label="Memory metadata"><ul class="svelte-dg83pr"><!> <li class="svelte-dg83pr"><span class="memory-queue-instance__metadata-label svelte-dg83pr">Created:</span> <span class="memory-queue-instance__metadata-value"> </span></li> <li class="svelte-dg83pr"><span class="memory-queue-instance__metadata-label svelte-dg83pr">Source:</span> <span class="memory-queue-instance__metadata-value"> </span></li></ul></div> <footer class="memory-queue-instance__actions svelte-dg83pr" role="group" aria-label="Memory actions"><!></footer>',1),tC=v('<div role="article"><!> <!> <!> <!></div>'),nC=v('<form class="memory-editor svelte-17ndyoq"><div class="memory-editor__scope"><div class="memory-editor__memory"><h3 class="memory-editor__memory-label svelte-17ndyoq"><!></h3> <!></div> <footer class="memory-editor__actions svelte-17ndyoq" role="group" aria-label="Memory actions"><!> <!></footer></div></form>'),sC=v(`Use <kbd class="memory-queue__navigation-icon svelte-21at3u">TAB</kbd> to navigate through the list, and save,
      reject or edit memories as you see fit.`,1),rC=v('<div class="memory-queue__saved-callout__content svelte-21at3u"><div> </div></div>'),aC=v('<div class="memory-queue__empty svelte-21at3u" role="status"><p class="memory-queue__empty-message svelte-21at3u">No memories remaining.</p> <!></div>'),oC=v('<div class="memory-queue__item" role="listitem"><!></div>'),iC=v('<div class="memory-queue__list svelte-21at3u" role="list"></div>'),lC=v('<header class="c-memory-queue__header svelte-21at3u"><div class="c-memory-queue__title-container svelte-21at3u"><!> <!></div> <div class="memory-queue__instructions"><!></div> <div class="memory-queue__open-memories"><!> <!></div> <!></header> <section class="memory-queue svelte-21at3u" aria-label="Memory queue"><!></section>',1);function cC(i,e){ke(e,!1);const n=_e(),s=_e(),a=_e();let o=k(e,"onSave",8),l=k(e,"onDiscard",8),c=k(e,"onMemoryUpdate",8),d=k(e,"onClose",8),u=k(e,"memories",8);async function h(N){await o()(N),requestAnimationFrame(()=>{m()})}async function y(N){await l()(N),requestAnimationFrame(()=>{m()})}function m(){const N=t(n).length;if(N===0)document.querySelector(".memory-queue__empty button")?.focus();else{const U=Math.min(C,N-1);document.querySelector(`.memory-queue__item:nth-child(${U+1}) .memory-queue-instance__actions button`)?.focus()}}let f=_e(null);function $(N){T(f,t(f)===N?null:N)}let R=_e(0),C=0;mn(()=>{t(n).length>0&&requestAnimationFrame(()=>{document.querySelector(".memory-queue__item .memory-queue-instance__actions button")?.focus()})}),Ne(()=>Ee(u()),()=>{T(n,u().filter(N=>N.state==="pending"||N.state===void 0))}),Ne(()=>t(n),()=>{T(s,t(n).length?`${t(n).length} memories pending review`:"No memories to review")}),Ne(()=>(Ee(u()),t(f)),()=>{T(a,u().find(N=>N.id===t(f)))}),hn(),wt();var x=lC(),G=S(x),L=g(G),A=g(L);Le(A,{size:2,color:"primary",class:"c-memory-queue__title",children:(N,U)=>{var I=se();pe(()=>ze(I,t(s))),r(N,I)},$$slots:{default:!0}});var E=_(A,2);vt(E,{size:1,variant:"ghost-block",color:"neutral",title:"Close modal",$$events:{click(...N){d()?.apply(this,N)}},children:(N,U)=>{oe(N,{name:"x"})},$$slots:{default:!0}});var F=_(L,2),z=g(F);Le(z,{size:1,color:"secondary",children:(N,U)=>{var I=sC();r(N,I)},$$slots:{default:!0}});var D=_(F,2),M=g(D);Le(M,{size:1,color:"secondary",children:(N,U)=>{var I=se("View your currently saved memories");r(N,I)},$$slots:{default:!0}});var w=_(M,2);Mt(w,{size:1,variant:"ghost",color:"neutral",slot:"icon",$$events:{click:()=>{Rn.postMessage({type:Sn.openMemoriesFile})}},$$slots:{iconRight:(N,U)=>{oe(N,{slot:"iconRight",name:"external-link"})}}});var W=_(D,2),P=N=>{ns(N,{variant:"soft",color:"info",size:1,class:"memory-queue__saved-callout",children:(U,I)=>{var B=rC(),Q=g(B),Z=g(Q);pe(()=>ze(Z,`${t(R)??""}
          ${t(R)===1?"memory":"memories"} saved.`)),r(U,B)},$$slots:{default:!0}})};b(W,N=>{t(R)>0&&N(P)});var K=_(G,2),X=g(K),q=N=>{(function(U,I){ke(I,!1);let B=k(I,"memory",8),Q=k(I,"onSave",8),Z=k(I,"onCancel",8),ae=_e(B().memory),j=_e();const H=()=>{Q()(t(ae).trim())},O=()=>{T(ae,B().memory),Z()()};mn(()=>{t(j)&&t(j).focus()}),Ne(()=>Ee(B()),()=>{B()&&T(ae,B().memory)}),hn(),wt();var J=nC(),te=g(J),ne=g(te),re=g(ne),he=g(re);Le(he,{size:1,color:"secondary",children:(ce,we)=>{var Se=se("Memory");r(ce,Se)},$$slots:{default:!0}});var $e=_(re,2);Xg($e,{rows:3,placeholder:"Edit memory...",onkeydown:ce=>{(ce.ctrlKey||ce.metaKey)&&ce.key==="Enter"&&(ce.preventDefault(),H()),ce.key==="Escape"&&(ce.preventDefault(),O())},get textInput(){return t(j)},set textInput(ce){T(j,ce)},get value(){return t(ae)},set value(ce){T(ae,ce)},$$legacy:!0});var me=_(ne,2),fe=g(me);Mt(fe,{size:1,variant:"solid",color:"accent",type:"submit",children:(ce,we)=>{var Se=se("Save Memory");r(ce,Se)},$$slots:{default:!0,iconLeft:(ce,we)=>{oe(ce,{name:"check",slot:"iconLeft"})}}});var ge=_(fe,2);Mt(ge,{size:1,variant:"ghost",color:"neutral",type:"button",$$events:{click:O},children:(ce,we)=>{var Se=se("Cancel");r(ce,Se)},$$slots:{default:!0}}),Nt("submit",J,or(H)),r(U,J),Ae()})(N,{get memory(){return t(a)},onSave:async U=>{await c()(t(a).id,U),T(f,null)},onCancel:()=>{$(t(a).id)}})},V=N=>{var U=ee(),I=S(U),B=Z=>{var ae=aC(),j=_(g(ae),2);Mt(j,{size:1,variant:"soft",color:"neutral",$$events:{click(...H){d()?.apply(this,H)}},children:(H,O)=>{var J=se("Return to Agent");r(H,J)},$$slots:{default:!0}}),r(Z,ae)},Q=Z=>{var ae=iC();ln(ae,7,u,j=>j.id,(j,H,O)=>{var J=oC();(function(te,ne){ke(ne,!1);let re=k(ne,"memory",8),he=k(ne,"onSave",24,()=>{}),$e=k(ne,"onDiscard",24,()=>{}),me=k(ne,"element",28,()=>{}),fe=k(ne,"toggleEditMode",24,()=>{}),ge=k(ne,"numberOfSavedMemories",12,0),ce=_e(re().state||"pending"),we=_e(!1);function Se(Ie,Ke){Ie.key==="Enter"&&Ke&&(Ie.preventDefault(),Ke())}async function ie(){if(he()){T(we,!0);try{await he()(re().id),ge(ge()+1),T(ce,"accepted")}finally{T(we,!1)}}}async function Ce(){if($e()){T(we,!0);try{await $e()(re().id),T(ce,"rejected")}finally{T(we,!1)}}}wt();var le=tC();let Me;var ue=g(le),be=Ie=>{ns(Ie,{variant:"soft",color:"success",size:1,role:"status","aria-live":"polite",icon:qe=>{oe(qe,{name:"check"})},children:(qe,Te)=>{var Ye=se("Memory has been saved.");r(qe,Ye)},$$slots:{icon:!0,default:!0}})};b(ue,Ie=>{t(ce)==="accepted"&&Ie(be)});var ye=_(ue,2),de=Ie=>{ns(Ie,{variant:"soft",color:"error",size:1,role:"status","aria-live":"polite",icon:qe=>{oe(qe,{name:"check"})},children:(qe,Te)=>{var Ye=se("Memory has been rejected.");r(qe,Ye)},$$slots:{icon:!0,default:!0}})};b(ye,Ie=>{t(ce)==="rejected"&&Ie(de)});var xe=_(ye,2),Oe=Ie=>{var Ke=Jw();r(Ie,Ke)};b(xe,Ie=>{t(ce)==="editing"&&Ie(Oe)});var De=_(xe,2),Ue=Ie=>{var Ke=eC(),qe=S(Ke),Te=g(qe),Ye=g(Te);Le(Ye,{size:1,color:"secondary",children:(mt,pt)=>{var ot=se("Memory");r(mt,ot)},$$slots:{default:!0}});var it=_(Te,2);Le(it,{color:"primary",size:1,children:(mt,pt)=>{var ot=se();pe(()=>ze(ot,(Ee(re()),Re(()=>re().memory)))),r(mt,ot)},$$slots:{default:!0}});var lt=_(qe,2),Ve=g(lt),rt=g(Ve),ve=mt=>{var pt=Yw(),ot=_(g(pt),2),ft=g(ot);pe(()=>ze(ft,(Ee(re()),Re(()=>re().scope)))),r(mt,pt)};b(rt,mt=>{Ee(re()),Re(()=>re().scope)&&mt(ve)});var Pe=_(rt,2),Je=_(g(Pe),2),Xe=g(Je),st=_(Pe,2),nt=_(g(st),2),et=g(nt),ht=_(lt,2),dt=g(ht),gt=mt=>{var pt=Qw(),ot=g(pt);Dn(ot,{size:1});var ft=_(ot,2);Le(ft,{size:1,color:"secondary",children:(Wt,Ut)=>{var Ft=se("Processing...");r(Wt,Ft)},$$slots:{default:!0}}),r(mt,pt)},Tt=mt=>{var pt=Zw(),ot=S(pt),ft=We=>{Mt(We,{size:1,color:"accent",variant:"soft","aria-label":"Save memory",$$events:{click:ie,keydown:tt=>Se(tt,ie)},children:(tt,ut)=>{var yt=se("Save");r(tt,yt)},$$slots:{default:!0,iconLeft:(tt,ut)=>{oe(tt,{name:"check",slot:"iconLeft"})}}})};b(ot,We=>{he()&&We(ft)});var Wt=_(ot,2),Ut=We=>{Mt(We,{size:1,color:"error",variant:"soft","aria-label":"Discard memory",$$events:{click:Ce,keydown:tt=>Se(tt,Ce)},children:(tt,ut)=>{var yt=se("Discard");r(tt,yt)},$$slots:{default:!0,iconLeft:(tt,ut)=>{oe(tt,{name:"x",slot:"iconLeft"})}}})};b(Wt,We=>{$e()&&We(Ut)});var Ft=_(Wt,2),$t=We=>{Mt(We,{size:1,color:"neutral",variant:"ghost","aria-label":"Edit memory",$$events:{click(...tt){fe()?.apply(this,tt)},keydown:tt=>Se(tt,fe())},children:(tt,ut)=>{var yt=se("Edit");r(tt,yt)},$$slots:{default:!0,iconLeft:(tt,ut)=>{oe(tt,{name:"pencil",slot:"iconLeft"})}}})};b(Ft,We=>{fe()&&We($t)}),r(mt,pt)};b(dt,mt=>{t(we)?mt(gt):mt(Tt,!1)}),pe(mt=>{ze(Xe,mt),ze(et,(Ee(re()),Re(()=>re().source)))},[()=>(Ee(re()),Re(()=>new Date(re().created).toLocaleDateString()))]),r(Ie,Ke)};b(De,Ie=>{t(ce)==="pending"&&Ie(Ue)}),pn(le,Ie=>me(Ie),()=>me()),pe(Ie=>{en(le,"aria-labelledby",`memory-${Ee(re()),Re(()=>re().id)??""}-title`),Me=Lt(le,1,"svelte-dg83pr",null,Me,Ie)},[()=>({"memory-queue-instance__callout":t(ce)==="accepted"||t(ce)==="rejected","memory-queue-instance__pending":t(ce)==="pending","memory-queue-instance__editing":t(ce)==="editing"})]),r(te,le),Ae()})(g(J),{get memory(){return t(H)},onSave:h,onDiscard:y,toggleEditMode:()=>$(t(H).id),get numberOfSavedMemories(){return t(R)},set numberOfSavedMemories(te){T(R,te)},$$legacy:!0}),Nt("focusin",J,()=>function(te){C=te}(t(O))),r(j,J)}),r(Z,ae)};b(I,Z=>{t(n),Re(()=>t(n).length===0)?Z(B):Z(Q,!1)},!0),r(N,U)};b(X,N=>{t(a)?N(q):N(V,!1)}),r(i,x),Ae()}var dC=v('<div class="c-memory-dropdown__loading svelte-1dx08at">Loading memories...</div>'),uC=v('<div class="c-memory-dropdown__content svelte-1dx08at"><!></div>');function hC(i,e){ke(e,!0);const n=()=>Y(l,"$memories",s),[s,a]=at(),o=Xn(),l=bu(),c=wu();async function d(C){o(fo(C,"accepted"))}async function u(C){o(fo(C,"rejected"))}async function h(C,x){o(fo(C,"pending",x))}let y=p(()=>n().map(C=>({id:C.id,state:C.state,memory:C.content,scope:void 0,source:"Agent",created:C.timestamp})));var m=uC(),f=g(m),$=C=>{var x=dC();r(C,x)},R=C=>{cC(C,{get memories(){return t(y)},onSave:d,onDiscard:u,onMemoryUpdate:h,get onClose(){return e.onClose}})};b(f,C=>{Y(c,"$isLoading",s)&&n().length===0?C($):C(R,!1)}),r(i,m),Ae(),a()}const yd=Symbol("full-size-overlay");var gC=v('<div class="c-memory-modal__content svelte-1ji12qo"><!></div>');function vC(i,e){ke(e,!1);const{close:n}=Fe(yd);wt();var s=gC();hC(g(s),{get onClose(){return n}}),r(i,s),Ae()}var pC=v('<div class="c-new-chat-empty__header svelte-b1qp3q"><div class="c-new-chat-empty__header-icon svelte-b1qp3q"><!></div> <!></div>'),mC=v('<div class="l-center-contents-empty svelte-dw2toi" data-testid="l-lazy-message-list-center-contents"><!></div>');function fC(i,e){ke(e,!0);const n=()=>Y(e.remoteAgentsModel,"$remoteAgentsModel",a),s=()=>Y(t(h),"$conversationModel",a),[a,o]=at(),l=Fe("agentConversationModel"),{isCurrConversationAgentic:c}=l;let d=p(()=>n().isActive&&!n().currentAgentId),u=p(()=>!t(d)),h=p(()=>Y(e.chatModel,"$chatModel",a).currentConversationModel),y=p(()=>n().currentAgentId),m=p(()=>n().isActive),f=p(()=>t(m)&&n().getCurrentChatHistory()?.length),$=p(()=>t(m)&&n().agentSetupLogs?.steps.length!==0),R=p(()=>t(m)?!t(f)&&!t($):Ds.isEmptyExchanges(s())),C=p(()=>`${s().id}-${t(m)?t(y):""}`);var x=ee(),G=S(x),L=A=>{var E=ee(),F=S(E);qr(F,()=>t(C),z=>{var D=ee(),M=S(D),w=P=>{var K=mC(),X=g(K),q=N=>{},V=N=>{var U=ee(),I=S(U),B=Z=>{_d(Z)},Q=Z=>{(function(ae){ir(ae,{header:H=>{var O=pC(),J=g(O),te=g(J);oe(te,{name:"message-square",size:2});var ne=_(J,2);Le(ne,{color:"primary",size:4,children:(re,he)=>{var $e=se("New Chat Thread");r(re,$e)},$$slots:{default:!0}}),r(H,O)},children:(H,O)=>{Le(H,{size:1,variant:"surface",children:(J,te)=>{var ne=se("Ask questions and plan with codebase awareness.");r(J,ne)},$$slots:{default:!0}})}})})(Z)};b(I,Z=>{Y(c,"$isCurrConversationAgentic",a)?Z(B):Z(Q,!1)},!0),r(N,U)};b(X,N=>{t(m)?N(q):N(V,!1)}),r(P,K)},W=P=>{fd(P,{get chatModel(){return e.chatModel},get onboardingWorkspaceModel(){return e.onboardingWorkspaceModel}})};b(M,P=>{t(R)?P(w):P(W,!1)}),r(z,D)}),r(A,E)};b(G,A=>{t(u)&&A(L)}),r(i,x),Ae(),o()}var _C=v('<div class="c-git-repository-badge svelte-p4qldl"><div class="c-git-repository-badge__chips svelte-p4qldl"><!> <!> <!></div></div>'),yC=v('<div class="c-git-repository-selector__item-content svelte-zgdx39"><!></div>'),$C=v("<!> <!>",1),bC=v("<!> <!>",1),wC=v('<div class="c-git-repository-selector svelte-zgdx39"><!></div>');function CC(i,e){ke(e,!0);let n=k(e,"activeRepository",19,()=>{}),s=k(e,"availableRepositories",19,()=>[]),a=k(e,"repositoryStates",19,()=>new Map);function o(h){const y=a().get(h),m=h.split("/").pop()||h;let f,$;if(y?.repositoryStateModel?.metadata){const R=y.repositoryStateModel.metadata;f=Ze(R.currentBranch);const C=Ze(R.headOid);$=C?C.substring(0,7):void 0}return{repositoryName:m,currentBranch:f,shortCommit:$}}let l=p(()=>n()?o(n()):{repositoryName:void 0,currentBranch:void 0,shortCommit:void 0}),c=ct(void 0);var d=wC(),u=g(d);Qe(u,()=>He.Root,(h,y)=>{y(h,{get requestClose(){return t(c)},set requestClose(m){T(c,m,!0)},children:(m,f)=>{var $=bC(),R=S($);Qe(R,()=>He.Trigger,(x,G)=>{G(x,{children:(L,A)=>{(function(E,F){ke(F,!0);let z=k(F,"repositoryName",19,()=>{}),D=k(F,"currentBranch",19,()=>{}),M=k(F,"shortCommit",19,()=>{}),w=p(()=>z()?z().split("/").pop()||z():"No repository"),W=p(()=>D()||"unknown"),P=p(()=>M()||"unknown");var K=_C(),X=g(K),q=g(X);{let B=p(()=>z()||t(w)),Q=p(()=>[Be.Hover]);je(q,{get content(){return t(B)},get triggerOn(){return t(Q)},children:(Z,ae)=>{var j=ee(),H=S(j);{const O=J=>{var te=ee(),ne=S(te);Qe(ne,()=>Jt.IconButton,(re,he)=>{he(re,{children:($e,me)=>{oe($e,{name:"folder"})},$$slots:{default:!0}})}),r(J,te)};Qe(H,()=>Jt.Root,(J,te)=>{te(J,{variant:"soft",color:"accent",size:1,leftButtons:O,children:(ne,re)=>{Le(ne,{class:"c-git-repository-badge__text",size:1,weight:"medium",children:(he,$e)=>{var me=se();pe(()=>ze(me,t(w))),r(he,me)},$$slots:{default:!0}})},$$slots:{leftButtons:!0,default:!0}})})}r(Z,j)},$$slots:{default:!0}})}var V=_(q,2),N=B=>{var Q=ee(),Z=S(Q);{const ae=j=>{var H=ee(),O=S(H);Qe(O,()=>Jt.IconButton,(J,te)=>{te(J,{children:(ne,re)=>{oe(ne,{name:"git-branch"})},$$slots:{default:!0}})}),r(j,H)};Qe(Z,()=>Jt.Root,(j,H)=>{H(j,{variant:"soft",color:"neutral",size:1,leftButtons:ae,children:(O,J)=>{Le(O,{class:"c-git-repository-badge__text",size:1,weight:"medium",children:(te,ne)=>{var re=se();pe(()=>ze(re,t(W))),r(te,re)},$$slots:{default:!0}})},$$slots:{leftButtons:!0,default:!0}})})}r(B,Q)};b(V,B=>{D()&&B(N)});var U=_(V,2),I=B=>{var Q=ee(),Z=S(Q);{const ae=j=>{var H=ee(),O=S(H);Qe(O,()=>Jt.IconButton,(J,te)=>{te(J,{children:(ne,re)=>{oe(ne,{name:"git-commit-vertical"})},$$slots:{default:!0}})}),r(j,H)};Qe(Z,()=>Jt.Root,(j,H)=>{H(j,{variant:"soft",color:"neutral",size:1,leftButtons:ae,children:(O,J)=>{Le(O,{class:"c-git-repository-badge__text",size:1,family:"mono",children:(te,ne)=>{var re=se();pe(()=>ze(re,t(P))),r(te,re)},$$slots:{default:!0}})},$$slots:{leftButtons:!0,default:!0}})})}r(B,Q)};b(U,B=>{M()&&B(I)}),r(E,K),Ae()})(L,{get repositoryName(){return t(l).repositoryName},currentBranch:void 0,shortCommit:void 0})},$$slots:{default:!0}})});var C=_(R,2);Qe(C,()=>He.Content,(x,G)=>{G(x,{size:1,side:"top",align:"start",children:(L,A)=>{var E=$C(),F=S(E);Qe(F,()=>He.Label,(D,M)=>{M(D,{children:(w,W)=>{var P=se("Select Repository");r(w,P)},$$slots:{default:!0}})});var z=_(F,2);ln(z,16,s,D=>D,(D,M)=>{const w=p(()=>o(M)),W=p(()=>M===n());var P=ee(),K=S(P);Qe(K,()=>He.Item,(X,q)=>{q(X,{onSelect:()=>async function(V){try{t(c)?.(),V!==n()&&await e.onSelectRepository(V)}catch(N){console.error("Failed to select repository:",N)}}(M),get highlight(){return t(W)},children:(V,N)=>{var U=yC(),I=g(U);Br(I,{shrink:!0,$$slots:{text:(B,Q)=>{Le(B,{slot:"text",size:1,weight:"medium",children:(Z,ae)=>{var j=se();pe(()=>ze(j,t(w).repositoryName)),r(Z,j)},$$slots:{default:!0}})},grayText:(B,Q)=>{var Z=se();pe(()=>ze(Z,`${(t(w).currentBranch||"")??""}${t(w).currentBranch&&t(w).shortCommit?"@":""}${(t(w).shortCommit||"")??""}`)),r(B,Z)}}}),r(V,U)},$$slots:{default:!0}})}),r(D,P)}),r(L,E)},$$slots:{default:!0}})}),r(m,$)},$$slots:{default:!0}})}),r(i,d),Ae()}var kC=v('<div class="c-git-commit-actions svelte-c9i3ym"><!></div>'),AC=v('<div class="c-git-commit-input__badges svelte-bjnzcp"><!> <!></div>'),SC=v("<!> <!>",1),MC=v("<div><!></div>"),xC=v("<!> <!> <!>",1),TC=v('<div class="c-chat-input svelte-bjnzcp"><!></div>');function RC(i,e){ke(e,!0);const n=()=>Y(t(z),"$activeRepoModel",c),s=()=>Y(t(Q),"$commitMessage",c),a=()=>Y(t(D),"$currStatus",c),o=()=>Y(t(V),"$availableRepositories",c),l=()=>Y(t(Z),"$isGenerating",c),[c,d]=at();let u=k(e,"variant",3,"solid"),h=k(e,"stagedFilesCount",3,0),y=k(e,"isCommitting",3,!1),m=k(e,"canCommit",3,!0),f=k(e,"placeholder",3,"Write or generate a commit message..."),$=Ps.getContext(),R=ct(void 0),C=ct(Cr({richTextJsonRepr:{type:"doc",content:[]},rawText:""}));function x(te){T(C,te,!0);const ne=te.rawText;if(n()?.commitInputModel&&ne!==s()){const re=$?.controller?.getActiveRepositoryController()||ms.getContext()?.controller;re&&re.setCommitInputMessage(ne)}}async function G(){if(!t(H))return;const te=F(t(C));try{await e.onCommit(te);const ne=$?.controller?.getActiveRepositoryController()||ms.getContext()?.controller;ne&&ne.clearCommitInputMessage()}catch(ne){console.error("Commit failed:",ne)}}let L=!1;async function A(te){if(t(I)&&!L){L=!0;try{await t(I).selectRepository(te)}catch(ne){console.error("Failed to select repository:",ne)}finally{L=!1}}}async function E(){const te=$?.controller?.getActiveRepositoryController()||ms.getContext()?.controller;te&&await te.generateCommitMessage()}function F(te){return te.rawText||""}let z=p(()=>$?.model?.activeRepositoryModel),D=p(()=>n()?.currStatus),M=p(()=>n()?.fileCollectionsModel.stagedFiles),w=p(()=>n()?.flagsModel.canCommit),W=p(()=>Y(t(M),"$stagedFiles",c)?.length??h()),P=p(()=>Y(t(w),"$canCommitFromContext",c)??m()),K=p(()=>a()===Ot.committing||y()),X=p(()=>$?.model),q=p(()=>t(X)?.activeRepository),V=p(()=>t(X)?.availableRepositories),N=p(()=>t(X)?.repositories),U=p(()=>t(X)?.activeRepositoryMetadata),I=p(()=>$?.controller),B=p(()=>n()?.commitInputModel),Q=p(()=>t(B)?.message),Z=p(()=>t(B)?.isGenerating),ae=p(()=>t(B)?.placeholderText);zt(()=>{s()!==void 0&&s()!==F(t(C))&&T(C,{richTextJsonRepr:{type:"doc",content:[]},rawText:s()},!0)});let j=p(()=>F(t(C)).trim().length>0),H=p(()=>t(P)&&t(W)>0&&t(j)&&!t(K));var O=TC(),J=g(O);{const te=ne=>{var re=MC(),he=g(re);{const $e=fe=>{var ge=ee(),ce=S(ge),we=Se=>{var ie=AC(),Ce=g(ie);{let Me=p(()=>Y(t(N),"$repositories",c)||new Map);CC(Ce,{get activeRepository(){return Y(t(q),"$activeRepository",c)},get availableRepositories(){return o()},get repositoryStates(){return t(Me)},onSelectRepository:A})}var le=_(Ce,2);{let Me=p(()=>Y(t(U),"$activeRepositoryMetadata",c)?.currentBranch);(function(ue,be){ke(be,!1);const ye=_e();let de=k(be,"currentBranch",24,()=>{});Ne(()=>Ee(de()),()=>{T(ye,de()||"unknown")}),hn();var xe=ee(),Oe=S(xe),De=Ue=>{Jt.Root(Ue,{variant:"soft",color:"neutral",size:1,children:(Ie,Ke)=>{Le(Ie,{size:1,weight:"medium",children:(qe,Te)=>{var Ye=se();pe(()=>ze(Ye,t(ye))),r(qe,Ye)},$$slots:{default:!0}})},$$slots:{default:!0,leftButtons:(Ie,Ke)=>{Jt.IconButton(Ie,{slot:"leftButtons",children:(qe,Te)=>{oe(qe,{name:"git-branch"})},$$slots:{default:!0}})}}})};b(Oe,Ue=>{de()&&Ue(De)}),r(ue,xe),Ae()})(le,{get currentBranch(){return t(Me)}})}r(Se,ie)};b(ce,Se=>{$&&o()&&o().length>0&&Se(we)}),r(fe,ge)},me=fe=>{var ge=SC(),ce=S(ge);je(ce,{content:"Generate commit message",children:(Se,ie)=>{{let Ce=p(()=>(l()??!1)||a()!==Ot.idle);vt(Se,{size:1,variant:"ghost-block",color:"neutral",get disabled(){return t(Ce)},$$events:{click:E},children:(le,Me)=>{oe(le,{name:"sparkles"})},$$slots:{default:!0}})}},$$slots:{default:!0}});var we=_(ce,2);{let Se=p(()=>!t(j)),ie=p(()=>l()??!1);(function(Ce,le){ke(le,!1);const Me=_e();let ue=k(le,"onCommit",8),be=k(le,"variant",8,"solid"),ye=k(le,"stagedFilesCount",8,0),de=k(le,"isCommitting",8,!1),xe=k(le,"canCommit",8,!0),Oe=k(le,"disabled",8,!1),De=k(le,"isGenerating",8,!1),Ue=_e("");async function Ie(){if(t(Me)&&!de())try{await ue()()}catch(Te){console.error("Failed to commit:",Te)}}Ne(()=>(Ee(xe()),Ee(ye()),Ee(Oe()),Ee(De())),()=>{T(Me,xe()&&ye()>0&&!Oe()&&!De())}),Ne(()=>(Ee(De()),Ee(xe()),Ee(ye()),Ee(Oe()),Ga),()=>{De()?T(Ue,"Generating commit message..."):xe()?ye()===0?T(Ue,"No staged files to commit"):Oe()?T(Ue,"Enter a commit message"):T(Ue,`Commit ${ye()} staged ${Ga(ye(),"file")}`):T(Ue,"Cannot commit at this time")}),hn(),wt();var Ke=kC(),qe=g(Ke);je(qe,{get content(){return t(Ue)},children:(Te,Ye)=>{{let it=Ge(()=>!t(Me)||de()||De()),lt=Ge(()=>de()||De());Mt(Te,{get variant(){return be()},size:1,get disabled(){return t(it)},get loading(){return t(lt)},class:"c-git-commit-actions__commit-button",$$events:{click:Ie},children:(Ve,rt)=>{var ve=se("Commit");r(Ve,ve)},$$slots:{default:!0,iconLeft:(Ve,rt)=>{oe(Ve,{slot:"iconLeft",name:"git-commit-horizontal"})}}})}},$$slots:{default:!0}}),r(Ce,Ke),Ae()})(we,{onCommit:G,get variant(){return u()},get stagedFilesCount(){return t(W)},get isCommitting(){return t(K)},get canCommit(){return t(P)},get disabled(){return t(Se)},get isGenerating(){return t(ie)}})}r(fe,ge)};Qe(he,()=>os.Root,(fe,ge)=>{ge(fe,{leftAlign:$e,rightAlign:me,$$slots:{leftAlign:!0,rightAlign:!0}})})}r(ne,re)};Qe(J,()=>dr.Root,(ne,re)=>{pn(re(ne,{alwaysShowBorder:!0,editable:!0,footer:te,children:(he,$e)=>{var me=xC(),fe=S(me);{let we=p(()=>s()||"");Qe(fe,()=>dr.Content,(Se,ie)=>{ie(Se,{get content(){return t(we)},onContentChanged:x})})}var ge=_(fe,2);{let we=p(()=>Y(t(ae),"$dynamicPlaceholder",c)||f());oi(ge,{get placeholder(){return t(we)}})}var ce=_(ge,2);{let we=p(()=>({"Mod-Enter":()=>!!t(H)&&(G(),!0)}));ai(ce,{get shortcuts(){return t(we)}})}r(he,me)},$$slots:{footer:!0,default:!0}}),he=>T(R,he,!0),()=>t(R))})}r(i,O),Ae(),d()}var EC=v('<div class="c-orientation-status--spin-icon svelte-10te45t"><!></div>');function IC(i,e){ke(e,!0);const n=k(e,"hideDelay",3,3e3),s=new io(Rn);let a=ct(Cr({state:rs.idle}));const o=p(()=>t(a).state),l={handleMessageFromExtension:f=>!(!f.data||f.data.type!==Sn.orientationStatusUpdate)&&(T(a,f.data.data,!0),!0)};mn(()=>{s.registerConsumer(l),Rn.postMessage({type:Sn.getOrientationStatus})});let c=ct(!1);const d=p(()=>function(f){return f===rs.succeeded?"success":f===rs.failed||f===rs.aborted?"error":"warning"}(t(o))),u=p(()=>function(f,$){return f===rs.succeeded?"Orientation complete! Check out `.augment/rules` folder.":f===rs.failed?$.errorMessage?`Orientation failed: ${$.errorMessage}`:"Orientation failed":f===rs.aborted?$.errorMessage?`Orientation aborted: ${$.errorMessage}`:"Orientation aborted":"Orienting to codebase and creating rules in `.augment/rules` folder... "}(t(o),t(a)));zt(()=>{t(c)?t(o)!==rs.succeeded&&t(o)!==rs.failed&&t(o)!==rs.aborted||setTimeout(()=>{T(c,!1)},n()):t(o)===rs.inProgress&&T(c,!0)});var h=ee();Nt("message",ts,function(...f){s.onMessageFromExtension?.apply(this,f)});var y=S(h),m=f=>{ns(f,{variant:"surface",get color(){return t(d)},size:1,icon:R=>{var C=ee(),x=S(C),G=A=>{oe(A,{name:"check"})},L=A=>{var E=ee(),F=S(E),z=M=>{oe(M,{name:"circle-alert"})},D=M=>{var w=EC(),W=g(w);oe(W,{name:"refresh-ccw"}),r(M,w)};b(F,M=>{t(o)===rs.failed||t(o)===rs.aborted?M(z):M(D,!1)},!0),r(A,E)};b(x,A=>{t(o)===rs.succeeded?A(G):A(L,!1)}),r(R,C)},children:(R,C)=>{var x=se();pe(()=>ze(x,`${t(u)??""}${t(o)===rs.inProgress?` ${t(a).progress}%`:""}`)),r(R,x)},$$slots:{icon:!0,default:!0}})};b(y,f=>{t(c)&&f(m)}),r(i,h),Ae()}var zC=v("<div><!></div>");function DC(i,e){ke(e,!1);const[n,s]=at(),a=Cu();wt();var o=ee(),l=S(o),c=d=>{var u=zC(),h=g(u);ns(h,{color:"error",variant:"surface",size:1,icon:m=>{oe(m,{name:"ban"})},children:(m,f)=>{var $=se("Syncing disabled");r(m,$)},$$slots:{icon:!0,default:!0}}),Mn(7,u,()=>Ls,()=>({y:-5,duration:250,opacity:0})),r(d,u)};b(l,d=>{Y(a,"$syncEnabledState",n)===ku.disabled&&d(c)}),r(i,o),Ae(),s()}var LC=v('<div class="ds-progress__indicator svelte-8qaaw3"></div>'),PC=v("<div><!></div>"),OC=v("<div><!></div>"),NC=v('<div class="c-sync-progress-bar svelte-5p1b4g"><div class="c-sync-status--spin-icon svelte-5p1b4g"><!></div> <!> <!> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),FC=v("<div><!></div>");function qC(i,e){ke(e,!0);let n=k(e,"showDoneBanner",3,!1),s=ct(!1);const a=p(()=>{return!(u=e.progress)||u.totalFiles<=0?NaN:u.status===Mr.done?100:Math.floor(u.syncedCount/u.totalFiles*100);var u});zt(()=>{t(s)?e.progress?.status===Mr.done&&setTimeout(()=>{T(s,!1)},3e3):e.progress&&e.progress.status!==Mr.done&&(e.progress.status===Mr.longRunning||e.progress.hasNewlyTrackedFolders)&&T(s,!0)});const o=p(()=>!isNaN(t(a))&&t(s)||n());var l=ee(),c=S(l),d=u=>{var h=FC(),y=g(h),m=$=>{var R=OC(),C=g(R);ns(C,{color:"accent",variant:"surface",size:1,icon:G=>{oe(G,{name:"check"})},children:(G,L)=>{var A=se("Codebase Indexing Complete!");r(G,A)},$$slots:{icon:!0,default:!0}}),Mn(3,R,()=>Ls,()=>({y:-5,duration:250,opacity:0})),r($,R)},f=$=>{var R=ee(),C=S(R),x=G=>{var L=NC(),A=g(L),E=g(A);oe(E,{name:"refresh-ccw",size:2});var F=_(A,2);Le(F,{size:1,children:(M,w)=>{var W=se("Indexing...");r(M,W)},$$slots:{default:!0}});var z=_(F,2);(function(M,w){ke(w,!0),k(w,"ref",11,null);let W=k(w,"max",3,100),P=k(w,"value",3,0),K=k(w,"color",3,"accent"),X=k(w,"size",3,2),q=k(w,"labelledby",19,xg),V=wr(w,["$$slots","$$events","$$legacy","ref","class","max","value","color","size","labelledby"]);const N=p(()=>Math.min(100,Math.max(0,(P()??0)/W()*100)));var U=PC();br(U,B=>({...B,class:["ds-progress",`ds-progress--size-${X()}`,w.class]}),[()=>Il(K())],void 0,"svelte-8qaaw3");var I=g(U);Qe(I,()=>Bb,(B,Q)=>{Q(B,Vs({get"aria-labelledby"(){return q()},class:"ds-progress__root",get value(){return P()},get max(){return W()}},()=>V,{children:(Z,ae)=>{var j=LC();let H;pe(O=>H=kr(j,"",H,O),[()=>({"--progress-percentage":`${t(N)??""}%`})]),r(Z,j)},$$slots:{default:!0}}))}),r(M,U),Ae()})(z,{get value(){return t(a)}});var D=_(z,2);Th(D,()=>({"--text-color":"var(--ds-color-accent-a11)"})),Le(D.lastChild,{size:1,color:"accent",children:(M,w)=>{var W=se();pe(()=>ze(W,`${t(a)??""}%`)),r(M,W)},$$slots:{default:!0}}),Mn(1,L,()=>Ls,()=>({y:-5,duration:250,opacity:0})),r(G,L)};b(C,G=>{e.progress?.status!==Mr.done&&G(x)},!0),r($,R)};b(y,$=>{e.progress?.status===Mr.done&&n()?$(m):$(f,!1)}),Mn(3,h,()=>Ls,()=>({y:-5,duration:250,opacity:0})),r(u,h)};b(c,u=>{t(o)&&u(d)}),r(i,l),Ae()}var BC=v('<div class="l-status-bars svelte-1hktxgr"><!> <!> <!></div>');function UC(i,e){ke(e,!1);const[n,s]=at(),a=Au();wt();var o=BC(),l=g(o);DC(l,{});var c=_(l,2);qC(c,{get progress(){return Y(a,"$syncProgress",n)}}),IC(_(c,2),{}),r(i,o),Ae(),s()}const $d="vscode-version-warning-hide-for-session",bd="conversation-history-warning-hide-for-session";class HC{constructor(e,n,s){this._chatModel=e,this._config=n,this._remoteAgentsModel=s,this._showVSCodeVersionWarning=Ct([this._config.isVscodeVersionOutdated,this._vscodeVersionWarningDismissed],([a,o])=>a&&!o&&!function(){try{const l=sessionStorage.getItem($d);return!!l&&JSON.parse(l).hideForSession===!0}catch(l){return console.error("Failed to read VSCode version warning preference from sessionStorage:",l),!1}}()),this._showConversationHistoryWarning=Ct([this._chatModel.currentConversationModel.totalCharactersStore,this._remoteAgentsModel,this._conversationHistoryBannerDismissedAt,this._config.conversationHistorySizeThresholdBytes],([a,o,l,c])=>!Bd()||function(){try{const d=sessionStorage.getItem(bd);return!!d&&JSON.parse(d).hideForSession===!0}catch(d){return console.error("Failed to read conversation history warning preference from sessionStorage:",d),!1}}()||o.isActive||l>0&&Date.now()-l<36e5?!1:a>c/2),this._showRemoteAgentDeletionWarning=Ct([this._remoteAgentsModel,this._config.remoteAgentsResumeHintAvailableTtlDays],([a,o])=>{if(!a.isActive)return!1;const l=a.currentAgent;return!!l&&bc(l,o)})}_showVSCodeVersionWarning;_vscodeVersionWarningDismissed=Dt(!1);_showConversationHistoryWarning;_conversationHistoryBannerDismissedAt=Dt(0);_showRemoteAgentDeletionWarning;get showVSCodeVersionWarning(){return this._showVSCodeVersionWarning}get showConversationHistoryWarning(){return this._showConversationHistoryWarning}get showRemoteAgentDeletionWarning(){return this._showRemoteAgentDeletionWarning}dismissVSCodeVersionWarning(){this._vscodeVersionWarningDismissed.set(!0)}dismissConversationHistoryWarning(){this._conversationHistoryBannerDismissedAt.set(Date.now())}}var GC=v("<div><!> <!></div>");function ta(i,e){let n=k(e,"text",19,()=>{}),s=k(e,"color",3,"accent");var a=GC(),o=g(a),l=h=>{var y=ee(),m=S(y);Rt(m,()=>e.leftContent??Kt),r(h,y)},c=h=>{Le(h,{size:1,color:"neutral",children:(y,m)=>{var f=se();pe(()=>ze(f,n())),r(y,f)},$$slots:{default:!0}})};b(o,h=>{e.leftContent?h(l):h(c,!1)});var d=_(o,2),u=h=>{var y=ee(),m=S(y);Rt(m,()=>e.rightContent??Kt),r(h,y)};b(d,h=>{e.rightContent&&h(u)}),pe(()=>Lt(a,1,`c-chat-input-banner c-chat-input-banner--${s()}`,"svelte-13y1pbi")),r(i,a)}var WC=v("<!> <!>",1),jC=v('<span class="l-conversation-history-warning__confirmation-text svelte-60o6f9">Hide for this session?</span> <div class="l-conversation-history-warning__confirmation-buttons svelte-60o6f9"><!> <!></div>',1),VC=v('<div class="l-conversation-history-warning__buttons svelte-60o6f9"><!></div>'),KC=v("<div><div><!></div> <!></div>"),XC=v('<span class="l-vscode-version-warning__confirmation-text svelte-a23a5s">Hide for this session?</span> <div class="l-vscode-version-warning__confirmation-buttons svelte-a23a5s"><!> <!></div>',1),JC=v('<div class="l-vscode-version-warning__buttons svelte-a23a5s"><!></div>'),YC=v("This remote agent will be deleted <!> due to inactivity.",1),QC=v('<div class="l-remote-agent-deletion-warning__left svelte-21oudt"><!></div>'),ZC=v('<div class="l-notification-banner__action-btn svelte-1bvwzqn"><!></div>'),ek=v("<div><!> <!></div>");function tk(i,e){ke(e,!0);let n=k(e,"level",3,"info"),s=k(e,"actionItems",19,()=>[]);const a=Xn();function o(d){const u=e.notificationId;a(Su(u)),Rn.postMessage({type:Sn.dismissBannerNotification,data:{notificationId:u,actionItemTitle:d}})}const l={info:"accent",warning:"warning",error:"error"};let c=p(()=>l[n()]);ta(i,{get text(){return e.message},get color(){return t(c)},rightContent:u=>{var h=ek();let y;var m=g(h);ln(m,17,s,ls,($,R)=>{var C=ZC(),x=g(C);Mt(x,{size:1,variant:"solid",get color(){return t(c)},"data-testid":"notification-action-button",$$events:{click:()=>function(G){G.url&&Rn.postMessage({type:Sn.augmentLink,data:G.url}),o(G.title)}(t(R))},children:(G,L)=>{var A=se();pe(()=>ze(A,t(R).title)),r(G,A)},$$slots:{default:!0}}),r($,C)});var f=_(m,2);{let $=p(()=>[Be.Hover]);je(f,{content:"Dismiss",get triggerOn(){return t($)},children:(R,C)=>{vt(R,{size:1,variant:"ghost-block",color:"neutral","data-testid":"dismiss-notification-button",$$events:{click:()=>o()},children:(x,G)=>{oe(x,{name:"x"})},$$slots:{default:!0}})},$$slots:{default:!0}})}pe($=>y=Lt(h,1,"l-notification-banner__right svelte-1bvwzqn",null,y,$),[()=>({"is-accent":t(c)==="accent","is-warning":t(c)==="warning"})]),r(u,h)},$$slots:{rightContent:!0}}),Ae()}const wd=Qs(i=>i.notifications);ql(wd.select);const nk=Bl(wd.select);function sk(i,e){const n=function(s){switch(s){case"chat":return xr.chat;case"localAgent":return xr.agent;case"remoteAgent":return xr.remoteAgent;default:return xr.allFeatures}}(e);if(i==null)return{shouldShow:!1,message:null,isError:!1,canDismiss:!0};if(i.featureGatingInfo){const s=function(u,h=xr.allFeatures){const y={feature_types:[h],state:Li.enabled,disabled_reason:0,end_date:void 0,display_info:void 0};if(!u?.feature_controls)return y;const m=u.feature_controls.find($=>$.feature_types?.includes(h));if(m)return m;const f=u.feature_controls.find($=>$.feature_types?.includes(xr.allFeatures));return f||y}(i.featureGatingInfo,n),a=s.state===Li.disabled,o=s.display_info?.banner,l=o?.message||null,c=o?.button?.title,d=o?.button?.url;return{shouldShow:!!l,message:l,isError:a,canDismiss:!a,buttonTitle:c,buttonUrl:d}}return{shouldShow:!1,message:null,isError:!1,canDismiss:!0,buttonTitle:void 0,buttonUrl:void 0}}function rk(i,e){ke(e,!0);const n=()=>Y(D,"$subscriptionInfo",a),s=()=>Y(l,"$notifications",a),[a,o]=at(),l=nk(),c=_c(),d=Fe(an.key),u=Fe(Ys.key).chatModeType,h=Mu(),y=_t("isVscodeVersionOutdated"),m=Pi("remoteAgentsResumeHintAvailableTtlDays"),f=Pi("conversationHistorySizeThresholdBytes"),$=new HC(c,{isVscodeVersionOutdated:y,remoteAgentsResumeHintAvailableTtlDays:m,conversationHistorySizeThresholdBytes:f},d),{showVSCodeVersionWarning:R,showConversationHistoryWarning:C,showRemoteAgentDeletionWarning:x}=$;function G(){$.dismissConversationHistoryWarning()}function L(){(function(){try{const q={hideForSession:!0,timestamp:new Date().toISOString()};sessionStorage.setItem(bd,JSON.stringify(q))}catch(q){console.error("Failed to save conversation history warning preference to sessionStorage:",q)}})(),$.dismissConversationHistoryWarning()}function A(){$.dismissVSCodeVersionWarning()}function E(){(function(){try{const q={hideForSession:!0,timestamp:new Date().toISOString()};sessionStorage.setItem($d,JSON.stringify(q))}catch(q){console.error("Failed to save VSCode version warning preference to sessionStorage:",q)}})()}async function F(){const q=Object.keys(c.conversations);q.length>0&&await c.deleteConversations(q)}const z=Xn(),D=xu(),M=Tu(),w=p(()=>sk(n(),Y(u,"$chatModeType",a)));var W=ee(),P=S(W),K=q=>{{let V=p(()=>t(w).message??""),N=p(()=>n()?.usageBalanceDepleted||!1),U=p(()=>n()?.type===Eu.inactive);(function(I,B){ke(B,!1);let Q=k(B,"warningMessage",8),Z=k(B,"isError",8,!1),ae=k(B,"buttonTitle",8,""),j=k(B,"buttonUrl",8,""),H=k(B,"onDismiss",8),O=k(B,"isInactive",8,!1),J=k(B,"usageBalanceDepleted",8,!1);function te(){Rn.postMessage({type:Sn.augmentLink,data:j()})}wt();{const ne=he=>{var $e=KC();let me;var fe=g($e);let ge;var ce=g(fe),we=Ce=>{{let le=Ge(()=>Z()?"error":"warning");Mt(Ce,{size:1,variant:"solid",get color(){return t(le)},"data-testid":"subscription-page-button",$$events:{click:te},children:(Me,ue)=>{var be=se();pe(()=>ze(be,ae())),r(Me,be)},$$slots:{default:!0}})}};b(ce,Ce=>{j()&&Ce(we)});var Se=_(fe,2),ie=Ce=>{{let le=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(Ce,{content:"Dismiss",get triggerOn(){return t(le)},children:(Me,ue)=>{vt(Me,{size:1,variant:"ghost-block",color:"neutral","data-testid":"dismiss-subscription-warning-button",$$events:{click(...be){H()?.apply(this,be)}},children:(be,ye)=>{oe(be,{name:"x"})},$$slots:{default:!0}})},$$slots:{default:!0}})}};b(Se,Ce=>{O()||J()||Ce(ie)}),pe((Ce,le)=>{me=Lt($e,1,"l-subscription-warning__right svelte-1jm27n7",null,me,Ce),ge=Lt(fe,1,"l-subscription-warning__upgrade-btn svelte-1jm27n7",null,ge,le)},[()=>({"is-error":Z()}),()=>({"is-error":Z()})]),r(he,$e)};let re=Ge(()=>Z()?"error":"warning");ta(I,{get text(){return Q()},get color(){return t(re)},rightContent:ne,$$slots:{rightContent:!0}})}Ae()})(q,{get warningMessage(){return t(V)},get isError(){return t(w).isError},get buttonTitle(){return t(w).buttonTitle},get buttonUrl(){return t(w).buttonUrl},get usageBalanceDepleted(){return t(N)},get isInactive(){return t(U)},onDismiss:()=>z(Ru())})}},X=q=>{var V=ee(),N=S(V),U=B=>{const Q=p(()=>s()[s().length-1]);{let Z=p(()=>t(Q).actionItems||[]);tk(B,{get notificationId(){return t(Q).notificationId},get message(){return t(Q).message},get level(){return t(Q).level},get actionItems(){return t(Z)}})}},I=B=>{var Q=ee(),Z=S(Q),ae=H=>{(function(O,J){ke(J,!1);let te=k(J,"onDismiss",8),ne=k(J,"onHideForSession",8),re=k(J,"minVersion",8),he=_e(!1);function $e(){T(he,!0)}function me(){ne()()}function fe(){te()()}wt(),ta(O,{get text(){return`VS Code ${re()??""}+ required. Some features may not work.`},color:"warning",rightContent:ce=>{var we=JC(),Se=g(we),ie=le=>{{let Me=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(le,{content:"Dismiss",get triggerOn(){return t(Me)},children:(ue,be)=>{vt(ue,{size:1,variant:"ghost-block",color:"neutral","data-testid":"dismiss-vscode-version-warning-button",$$events:{click:$e},children:(ye,de)=>{oe(ye,{name:"x"})},$$slots:{default:!0}})},$$slots:{default:!0}})}},Ce=le=>{var Me=XC(),ue=_(S(Me),2),be=g(ue);{let de=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(be,{content:"Yes, hide for this session",get triggerOn(){return t(de)},children:(xe,Oe)=>{vt(xe,{size:1,variant:"ghost-block",color:"neutral","data-testid":"hide-vscode-version-warning-for-session-button",$$events:{click:me},children:(De,Ue)=>{oe(De,{name:"check"})},$$slots:{default:!0}})},$$slots:{default:!0}})}var ye=_(be,2);{let de=Ge(()=>(Ee(Be),Re(()=>[Be.Hover])));je(ye,{content:"No, dismiss once",get triggerOn(){return t(de)},children:(xe,Oe)=>{vt(xe,{size:1,variant:"ghost-block",color:"neutral","data-testid":"cancel-vscode-version-confirmation-button",$$events:{click:fe},children:(De,Ue)=>{oe(De,{name:"x"})},$$slots:{default:!0}})},$$slots:{default:!0}})}r(le,Me)};b(Se,le=>{t(he)?le(Ce,!1):le(ie)}),r(ce,we)},$$slots:{rightContent:!0}}),Ae()})(H,{onDismiss:A,onHideForSession:E,get minVersion(){return Y(h,"$vsCodeMinVersion",a)}})},j=H=>{var O=ee(),J=S(O),te=re=>{(function(he,$e){ke($e,!0);let me=ct(!1);function fe(){T(me,!0)}function ge(){$e.onHideForSession()}function ce(){$e.onDismiss()}ta(he,{text:"Large conversation histories can lead to worse performance.",color:"warning",rightContent:Se=>{var ie=VC(),Ce=g(ie),le=ue=>{var be=WC(),ye=S(be);{let xe=p(()=>[Be.Hover,Be.Click]);je(ye,{content:"Delete all conversations",get triggerOn(){return t(xe)},children:(Oe,De)=>{vt(Oe,{size:1,variant:"ghost-block",color:"neutral","data-testid":"delete-all-history-warning-button",$$events:{click(...Ue){$e.onDeleteAllHistory?.apply(this,Ue)}},children:(Ue,Ie)=>{oe(Ue,{name:"trash-2"})},$$slots:{default:!0}})},$$slots:{default:!0}})}var de=_(ye,2);{let xe=p(()=>[Be.Hover]);je(de,{content:"Dismiss",get triggerOn(){return t(xe)},children:(Oe,De)=>{vt(Oe,{size:1,variant:"ghost-block",color:"neutral","data-testid":"dismiss-conversation-history-warning-button",$$events:{click:fe},children:(Ue,Ie)=>{oe(Ue,{name:"x"})},$$slots:{default:!0}})},$$slots:{default:!0}})}r(ue,be)},Me=ue=>{var be=jC(),ye=_(S(be),2),de=g(ye);{let Oe=p(()=>[Be.Hover]);je(de,{content:"Yes, hide for this session",get triggerOn(){return t(Oe)},children:(De,Ue)=>{vt(De,{size:1,variant:"ghost-block",color:"neutral","data-testid":"hide-conversation-history-warning-for-session-button",$$events:{click:ge},children:(Ie,Ke)=>{oe(Ie,{name:"check"})},$$slots:{default:!0}})},$$slots:{default:!0}})}var xe=_(de,2);{let Oe=p(()=>[Be.Hover]);je(xe,{content:"No, dismiss once",get triggerOn(){return t(Oe)},children:(De,Ue)=>{vt(De,{size:1,variant:"ghost-block",color:"neutral","data-testid":"cancel-conversation-history-confirmation-button",$$events:{click:ce},children:(Ie,Ke)=>{oe(Ie,{name:"x"})},$$slots:{default:!0}})},$$slots:{default:!0}})}r(ue,be)};b(Ce,ue=>{t(me)?ue(Me,!1):ue(le)}),r(Se,ie)},$$slots:{rightContent:!0}}),Ae()})(re,{onDeleteAllHistory:F,onDismiss:G,onHideForSession:L})},ne=re=>{var he=ee(),$e=S(he),me=fe=>{(function(ge,ce){ke(ce,!1);const we=()=>Y(ue,"$remoteAgentModel",Se),[Se,ie]=at(),Ce=_e(),le=_e(),Me=_e(),ue=Fe(an.key);let be=_e("");Ne(()=>we(),()=>{T(Ce,we().currentAgent)}),Ne(()=>(t(Ce),zo),()=>{T(le,t(Ce)?zo(new Date(t(Ce).expires_at),new Date):0)}),Ne(()=>(t(Ce),Fi),()=>{T(Me,t(Ce)?Fi(t(Ce).expires_at):void 0)}),Ne(()=>(t(le),cr),()=>{t(le)===0?T(be,"today"):t(le)<0?T(be,"soon"):T(be,`in ${cr(t(le),"day")}`)}),hn(),wt(),ta(ge,{color:"warning",leftContent:de=>{var xe=QC(),Oe=g(xe);Le(Oe,{size:1,color:"neutral",children:(De,Ue)=>{var Ie=YC(),Ke=_(S(Ie));je(Ke,{get content(){return t(Me)},children:(qe,Te)=>{var Ye=se();pe(()=>ze(Ye,t(be))),r(qe,Ye)},$$slots:{default:!0}}),r(De,Ie)},$$slots:{default:!0}}),r(de,xe)},$$slots:{leftContent:!0}}),Ae(),ie()})(fe,{})};b($e,fe=>{Y(x,"$showRemoteAgentDeletionWarning",a)&&fe(me)},!0),r(re,he)};b(J,re=>{Y(C,"$showConversationHistoryWarning",a)?re(te):re(ne,!1)},!0),r(H,O)};b(Z,H=>{Y(R,"$showVSCodeVersionWarning",a)?H(ae):H(j,!1)},!0),r(B,Q)};b(N,B=>{s().length>0?B(U):B(I,!1)},!0),r(q,V)};b(P,q=>{t(w).shouldShow&&!Y(M,"$isInfoDismissed",a)?q(K):q(X,!1)}),r(i,W),Ae(),o()}var ak=v('<div class="c-file-warning__line svelte-hdl29h"> </div>'),ok=v('<div class="c-file-warning__message svelte-hdl29h"></div>'),ik=v('<div class="c-file-warning svelte-hdl29h"><!></div>');class lk{handleMessageFromExtension(e){const n=Yh.getInstance(),s=e.data;return s.type===Sn.chatNotification&&(n.addNotification(s.data),!0)}}class ck{handleMessageFromExtension(e){return e.data?.type===Sn.hostWindowFocusChange&&(Tg(e.data.data),!0)}}const dk=(i,e,n)=>{e&&i.update(s=>{if(!s)return n;const a=new Set(s.activeWebviews);return e.isActive?a.add("chat"):a.delete("chat"),{...s,activeWebviews:Array.from(a),agentOverviews:e.agentOverviews,selectedAgentId:e.currentAgentId,pinnedAgents:e.pinnedAgents}})},uk=(i,e,n,s,a)=>{if(JSON.stringify(i)!==JSON.stringify(e.state)&&e){const{selectedAgentId:o,pinnedAgents:l}=e.state||{};o!==n.currentAgentId&&(s.extensionClient.showAugmentPanel(),n.setIsActive(!0),a.setToRemoteAgent(o),n.setCurrentAgent(o)),l&&JSON.stringify(l)!==JSON.stringify(n.pinnedAgents)&&n.setPinnedAgents(l)}},hk=Qs(i=>i.mainPanelActions.list),gk=Qs(i=>{const{list:e,currentIndex:n}=i.mainPanelActions;return e[n]});function Sl(i){return i.line_start===i.line_end?`L${i.line_start+1}`:`L${i.line_start+1}-${i.line_end+1}`}const vk=[{id:"find",label:"find",description:"things in your code base",requiresInput:!0,requiresEditorSelection:!1,placeholderText:"What code are you looking for?",selectionReminderMessage:"Select code in the editor to find.",visible:!0,promptFactory:async i=>`Find ${i}`},{id:"explain",label:"explain",description:"how selected code works",requiresInput:!1,requiresEditorSelection:!0,placeholderText:"",selectionReminderMessage:"Select code in the editor to explain.",visible:!0,promptFactory:async()=>"Explain the selected code"},{id:"fix",label:"fix",description:"issues in selected code",requiresInput:!1,requiresEditorSelection:!0,placeholderText:"",selectionReminderMessage:"Select code in the editor to fix.",visible:!0,promptFactory:async function(i,e){const n=await async function(a){let o=[];try{o=await a.extensionClient.getDiagnostics()}catch(l){console.error("Failed to get diagnostic messages:",l)}return o}(e);let s="Fix the selected code.";return s+=function(a){if(a.length===0)return" The IDE does not report any issues on the selected code.";if(a.length===1)return` The IDE reports the following issue:

 ${Sl(a[0].location)}: ${a[0].message}`;{const o=a.sort((u,h)=>u.location.line_start-h.location.line_start).reduce((u,h)=>{const y=`${h.location.line_start},${h.location.line_end}`;return u[y]||(u[y]=[]),u[y].push(h),u},{}),l=Object.entries(o).map(([u,h])=>{const[y,m]=u.split(",").map(Number),f=Sl({line_start:y,line_end:m});if(h.length===1)return` ${f}: ${h[0].message}`;{const $=h.map((R,C)=>`    ${C+1}. ${R.message}`).join(`
`);return` ${f}:
${$}`}}).join(`
`),c=Math.min(...a.map(u=>u.location.line_start)),d=Math.max(...a.map(u=>u.location.line_end));return` The IDE reports the following issues on ${c===d?`L${c+1}`:`L${c+1}-${d+1}`}:

${l}`}}(n),s}},{id:"write-test",label:"write-test",description:"add tests for selected code",requiresInput:!1,requiresEditorSelection:!0,placeholderText:"",selectionReminderMessage:"Select code in the editor to test.",visible:!0,promptFactory:async()=>"Write a test for the selected code"},{id:"document",label:"document",description:"write documentation for selected code",requiresInput:!1,requiresEditorSelection:!0,placeholderText:"",selectionReminderMessage:"Select code in the editor to document.",visible:!0,promptFactory:async()=>"Document selected code. Do not make unnecessary changes."},{id:"generate-commit-message",label:"generate-commit-message",description:"generate a commit message",requiresInput:!1,requiresEditorSelection:!1,placeholderText:"",selectionReminderMessage:"Hit enter or send to generate a commit message",visible:!0,promptFactory:async()=>""}],pk=Qs(i=>i.slashCommands.activeCommandId);var mk=v('<span data-slash-commands=""></span>');function fk(i,e){ke(e,!0);const n=()=>Y(d,"$activeCommandId",s),[s,a]=at(),o=Fe("chatModel"),l=Fe("agentConversationModel"),c={explain:mo.chatUseActionExplain,"write-test":mo.chatUseActionWriteTest,find:mo.chatUseActionFind},d=pk(),u=Xn();zt(()=>{const y=n()&&(m=n(),vk.find(f=>f.id===m));var m;y&&o&&((async f=>{f.id!=="fix"&&Ze(l.isCurrConversationAgentic)&&o.chatModeModel?.handleSetToThreadType("chat"),await o.setCurrentConversation(),f.id==="generate-commit-message"?o.currentConversationModel?.generateCommitMessage():o.currentConversationModel?.sendExchange({request_message:await f.promptFactory("",o),rich_text_json_repr:void 0,status:zn.draft,model_id:o.currentConversationModel?.selectedModelId??void 0}),o.host.postMessage({type:Sn.usedSlashAction});const $=f?c[f.id]:void 0;$&&o.extensionClient.reportWebviewClientEvent($)})(y),u(Iu()))});var h=mk();r(i,h),Ae(),a()}const Cd=Qs(i=>i.modals.collection),yi=ql(Cd.select);Bl(Cd.select),Qs(i=>{if(i.modals.currentModal)return yi.select(i,i.modals.currentModal)});const _k=Qs((i,e)=>!!yi.select(i,e)?.show);Qs((i,e)=>!_k.select(i,e));const kd="augment-modals-container";var yk=v('<dialog class="c-augment-full-size-overlay svelte-47x3ue"><div class="c-augment-full-size-overlay__content svelte-47x3ue"><!></div></dialog>'),$k=v("<!> <!> <!>",1);function bk(i,e){ke(e,!0);const n=k(e,"open",3,!1),s=k(e,"target",3,kd),a=k(e,"animationDirection",3,"down"),o=p(()=>{switch(a()){case"up":return{x:0,y:-5};case"down":default:return{x:0,y:5};case"left":return{x:-5,y:0};case"right":return{x:5,y:0}}});let l=ct(void 0),c=ct(Cr(n()));function d(){T(c,!0)}async function u(){T(c,!1),e.onClose?.()}function h(){T(c,!t(c))}zt(()=>{n()?(d(),t(l)?.show()):t(l)?.close()}),mn(()=>{n()&&t(l)&&!t(l).open&&t(l).show()}),Nn(yd,{open:d,close:u,toggle:h});var y={showModal:d,closeModal:u,toggleModal:h},m=ee(),f=S(m),$=R=>{Yo(R,{scope:"full-size-overlay",children:(C,x)=>{var G=$k(),L=S(G);(function(E,F){ke(F,!0),zt(()=>{const z=zu();return Rh(Du(z))}),Ae()})(0,{});var A=_(L,2);Wn(A,{name:"closeFullSizeOverlay",handler:u}),ci(_(A,2),{get target(){return`#${s()??""}`},children:(E,F)=>{var z=yk(),D=g(z),M=g(D);Rt(M,()=>e.children??Kt),pn(z,w=>T(l,w),()=>t(l)),is(z,(w,W)=>Og?.(w,W),()=>({enabled:t(c),restoreFocusOnClose:!1})),Nt("close",z,u),Mn(3,D,()=>Ls,()=>({duration:200,...t(o)})),Mn(1,z,()=>Oo,()=>({duration:100})),Mn(2,z,()=>Oo,()=>({duration:200})),r(E,z)},$$slots:{default:!0}}),r(C,G)},$$slots:{default:!0}})};return b(f,R=>{t(c)&&R($)}),r(i,m),Ae(y)}function Ml(i,e){ke(e,!0);const[n,s]=at(),a=k(e,"animationDirection",3,"down"),o=yi(e.modalId),l=Xn();{let c=p(()=>Y(o,"$modal",n)?.show);bk(i,{get open(){return t(c)},get animationDirection(){return a()},onClose:()=>l(Lu(e.modalId)),children:(d,u)=>{var h=ee(),y=S(h);Rt(y,()=>e.children??Kt),r(d,h)},$$slots:{default:!0}})}Ae(),s()}var wk=v("<!> <!>",1),Ck=v("<!> <!>",1),kk=v('<div class="l-chat-actions-area svelte-1hs4wcp"><!> <!> <!></div>'),Ak=v("<!> <!>",1),Sk=v("<!> <!>",1),Mk=v("<div><!></div>"),xk=v('<div class="l-chat-setup-area l-input-area-agent-setup l-input-area-design-system svelte-1hs4wcp"><!></div>'),Tk=v("<div><!></div>"),Rk=v('<div class="l-chat-footer-area svelte-1hs4wcp" id="chat-footer-area"></div>'),Ek=v("<!> <!> <!>",1),Ik=v('<!> <!> <!> <div class="chat svelte-1hs4wcp"><!> <!></div>',1);function zk(i,e){ke(e,!0);const n=()=>Y(W,"$modelDisplayNameToId",E),s=()=>Y(N,"$enableAgentAutoMode",E),a=()=>Y(H,"$enableRules",E),o=()=>Y(O,"$enablePersonalities",E),l=()=>Y(J,"$enableExternalSourcesInChat",E),c=()=>Y(te,"$retryChatStreamTimeouts",E),d=()=>Y(V,"$enableModelRegistry",E),u=()=>Y(Q,"$modelRegistryFlag",E),h=()=>Y(B,"$modelInfoRegistry",E),y=()=>Y(Z,"$enableDebugFeatures",E),m=()=>Y(q,"$enableAgentMode",E),f=()=>Y(xe,"$remoteAgentsModel",E),$=()=>Y(et,"$isCurrConversationAgentic",E),R=()=>Y(U,"$enableAgentTabs",E),C=()=>Y(ue,"$chatModel",E),x=()=>Y(ut,"$activeTab",E),G=()=>Y(cn,"$currentConversationId",E),L=()=>Y(X,"$currentAction",E),A=()=>Y(t(Wt),"$isRichTextEditorFocused",E),[E,F]=at();let z=k(e,"initialFlags",19,()=>{}),D=k(e,"initialConversation",19,()=>{}),M=k(e,"initialSubscriptionInfo",19,()=>{}),w=k(e,"initialSubscriptionDismissed",19,()=>{});const W=Ol(),P=Xn(),K=p(()=>At=>n()?.[At]??void 0),X=gk(),q=_t("enableAgentMode"),V=_t("enableModelRegistry"),N=_t("enableAgentAutoMode"),U=Io("enableAgentTabs"),I=_t("enableMemoryRetrieval"),B=Pu(),Q=Ou(),Z=_t("enableDebugFeatures"),ae=_t("enableAgentGitTracker"),j=_t("enableBackgroundAgents"),H=_t("enableRules"),O=_t("enablePersonalities"),J=_t("enableExternalSourcesInChat"),te=_t("retryChatStreamTimeouts"),ne=_t("enableTaskList"),re=_t("memoryClassificationOnFirstToken"),he=_t("fullFeatured"),$e=_t("enableChatMultimodal"),me=_t("useHistorySummary"),fe=Nu(),ge=_t("enableExchangeStorage"),ce=_t("enableEnhancedDehydrationMode"),we=_t("enablePreferenceCollection"),Se=_t("enableToolUseStateStorage"),ie=Fu(),Ce=qu(),le=new io(Rn);let Me=new lk;le.registerConsumer(Me);const ue=new Qh(le,Rn,Bu().store,{forceAgentConversation:!0,initialConversation:D(),enableAgentAutoMode:s(),fullFeatured:Y(he,"$fullFeatured",E),enableRules:a(),enablePersonalities:o(),enableExternalSourcesInChat:l(),retryChatStreamTimeouts:c(),enableChatMultimodal:Y($e,"$enableChatMultimodal",E),summaryTitles:Y(Ce,"$summaryTitles",E),enableModelRegistry:d(),useHistorySummary:Y(me,"$useHistorySummary",E),historySummaryParams:Y(fe,"$historySummaryParams",E),enableExchangeStorage:Y(ge,"$enableExchangeStorage",E),enableEnhancedDehydrationMode:Y(ce,"$enableEnhancedDehydrationMode",E),modelDisplayNameToId:n(),modelRegistry:u(),modelInfoRegistry:h(),enableDebugFeatures:y(),customPersonalityPrompts:Y(ie,"$customPersonalityPrompts",E),enablePreferenceCollection:Y(we,"$enablePreferenceCollection",E),enableToolUseStateStorage:Y(Se,"$enableToolUseStateStorage",E)});zt(()=>{const At=function(xt,Bt){return xt&&Object.keys(xt).length>0?Object.entries(xt).map(([Gt,Zt])=>({id:Gt,...Zt})):Bt?Object.entries(Bt||{}).map(([Zt,_n])=>({id:_n,displayName:Zt})):[]}(h(),u())?.sort(Vo);At&&it.registerModels(At)});const be=new xa(le);Nn(xa.key,be);const ye=new ar(le),de=function(At,xt){const Bt=new F$(At),Gt=new Ps,Zt=new pi(Gt,Bt,At,xt);return Ps.setInContext(Gt,Zt),{model:Gt,controller:Zt}}(ue.extensionClient,ae);le.registerConsumer(de.controller);const xe=new an({msgBroker:le,isActive:!1,extensionClientConfig:{enableRules:a(),enablePersonalities:o(),enableExternalSourcesInChat:l(),retryChatStreamTimeouts:c()},enableBackgroundAgents:j,host:Rn,gitRefModel:ye}),Oe=new i_(ue.currentConversationModel,ue.extensionClient,ue,{enableDebugFeatures:y()},be,xe),De=new Zy(m(),ue.currentConversationModel,ue.extensionClient);le.registerConsumer(De),le.registerConsumer(ue);const Ue=new Wc(ue,Oe,De,be,{enableMemoryRetrieval:Y(I,"$enableMemoryRetrieval",E),memoryClassificationOnFirstToken:Y(re,"$memoryClassificationOnFirstToken",E)}),Ie=new ks(ue,ue.extensionClient,ue.currentConversationModel,Ue,{enableTaskList:ne});le.registerConsumer(Ie);const Ke=new Gi(le);le.registerConsumer(xe),Nn(an.key,xe),Nn(ar.key,ye),Nn(Gi.key,Ke),Nn(ks.key,Ie),Nn(xa.key,be);const qe=Dt(-1);Nn(Jl,qe);const Te={agentOverviews:[],selectedAgentId:void 0,activeWebviews:["chat"],pinnedAgents:{}},Ye=new pg(le,Te,mg,fg);le.registerConsumer(Ye),Nn(hc,Ye);const it=new o_(ue,Z),lt=new Ys(ue,Ue,xe,{enableAgentAutoMode:s(),enableBackgroundAgents:Y(j,"$enableBackgroundAgents",E),enableModelRegistry:d()});le.registerConsumer(lt),Nn(Ys.key,lt),ue.setChatModeModel(lt),zt(()=>dk(Ye,f(),Te));let Ve=Ye.state;zt(()=>{uk(Ve,Y(Ye,"$sharedWebviewStore",E),f(),ue,lt)}),Eh(ue.eventTracker);const rt=new l1(ue,At=>t(K)(At));le.registerConsumer(rt),qg(ue),Nn("agentConversationModel",Ue),Nn("onboardingWorkspaceModel",rt),Nn("toolsWebviewModel",Oe),Nn("modelRegistry",it),e0(De),Rg(ue.extensionClient);const ve=p(()=>!f().isRemoteAgentSshWindow),Pe=p(()=>Qo(f())),Je=p(()=>!t(Pe).doHideStatusBars),Xe=p(()=>f().isCreatingAgent||f().isActive&&f().currentAgent?.status===In.agentStarting),st=function({isCurrConversationAgentic:At,remoteAgentsModel:xt,canShowTaskList:Bt}){return Ct([At,xt,Bt],([Gt,Zt,_n])=>{const qn=Gt&&!Zt?.isActive;return{showMessageHistory:qn,showTasks:qn&&_n,showAgentEdits:qn&&Gt}})}({isCurrConversationAgentic:Ue.isCurrConversationAgentic,remoteAgentsModel:xe,canShowTaskList:Ie.canShowTaskList}),nt=Ih(ae,st,Ue.isCurrConversationAgentic);Ar.setInContext(nt);const{isCurrConversationAgentic:et}=Ue,ht=p(()=>t(Xe)?"Remote Agent is starting":f().isActive?f().currentAgentId?"Ask Remote Agent to edit code, run tests, create a pull request":"Fix this bug, tackle this ticket, review comments in my pull request":$()?"Instruct your Augment agent":"Ask a question through chat"),dt=p(()=>f().isActive&&f().currentAgent&&!f().currentAgent?.is_setup_script_agent);le.registerConsumer(new class{constructor(At){this._agentConversationModel=At}handleMessageFromExtension(At){return At.data.type===Sn.resetAgentOnboarding&&(this._agentConversationModel.resetOnboarding(),!0)}}(Ue)),le.registerConsumer(new ck);let gt,Tt=!1;function mt(At){const xt=de.controller.getActiveRepositoryController();xt&&xt.commit(At)}zt(()=>(At=>{const xt=At.isRemoteAgentSshWindow,Bt=At.remoteAgentSshWindowId;Tt===xt&&gt===Bt||(Tt=xt,gt=Bt,xt&&Bt&&(lt.setToRemoteAgent(Bt),At.setCurrentAgent(Bt),At.setIsActive(!0)))})(f())),mn(()=>{P(Uu(!1)),M()?P(Hu(M())):P(Gu()),w()?P(Wu(new Date().toISOString())):P(ju()),z()&&P(Vu(z())),f().isRemoteAgentSshWindow&&f().remoteAgentSshWindowId&&(lt.setToRemoteAgent(f().remoteAgentSshWindowId),xe.setCurrentAgent(f().remoteAgentSshWindowId),xe.setIsActive(!0));const At=[Oe.dispose,xe.dispose,be?.dispose,ue.dispose];return ue.extensionClient.getChatInitData(),()=>{At.forEach(xt=>xt?.())}});let pt=ct(void 0),ot=ct(void 0);const ft=p(()=>m()&&$()&&R()&&!f().isActive),Wt=p(()=>t(ot)?.isFocused?.()??Dt(!1)),Ut=p(()=>f().isActive&&!f().currentAgentId),Ft=p(()=>f().isActive||t(Ut)),$t=p(()=>f().isActive&&f().currentAgentId&&!C().currentConversationModel.hasDraft),We=p(()=>C().currentConversationModel.draftExchange),tt=p(()=>t(We)?.rich_text_json_repr),ut=nt.activeTab,yt=p(()=>Y(ae,"$enableAgentGitTracker",E)&&x()===An.agentGitEdits&&$()&&!f().isActive),kt=p(()=>x()===An.tasks||x()===An.agentGitEdits||x()===An.agentEdits);zh();const Pt=()=>{ue.setCurrentConversation(ue.nextConversation?.id,!1)},tn=()=>{ue.setCurrentConversation(ue.previousConversation?.id,!1)},cn=la();zt(()=>{G()&&nt&&nt.getCurrentAvailableTabs().includes(An.messageHistory)&&nt.setActiveTab(An.messageHistory)});var Vt=Ik();Nt("message",ts,function(...At){le.onMessageFromExtension?.apply(this,At)}),Nt("beforeunload",ts,()=>{if(C().saveImmediate(),P(Ll()),G()){const At=C().getConversationExchangeCount(G());Zh(At)}});var Yt=S(Vt);(function(At,xt){ke(xt,!0);const Bt=Fe("chatModel"),Gt=Fe(an.key),Zt=Fe("chatModeModel");is(ts,(_n,qn)=>Yp?.(_n,qn),()=>({config:xt.hotkeyConfig,context:()=>({chatModel:Bt,remoteAgentsModel:Gt,chatModeModel:Zt})})),Ae()})(0,{get hotkeyConfig(){return Dh}});var nn=_(Yt,2);Ml(nn,{get modalId(){return Jr.threadsPanel},animationDirection:"left",children:(At,xt)=>{Kp(At,{get chatModel(){return ue},onClose:()=>P(Ku(Jr.threadsPanel))})},$$slots:{default:!0}});var fn=_(nn,2);Ml(fn,{get modalId(){return Jr.memories},children:(At,xt)=>{vC(At,{})},$$slots:{default:!0}});var jt=_(fn,2),Ht=g(jt);fk(Ht,{});var Xt=_(Ht,2);Yo(Xt,{scope:"chat",children:(At,xt)=>{var Bt=Ek(),Gt=S(Bt),Zt=gn=>{var Ln=wk(),Jn=S(Ln);Wn(Jn,{name:"goToNextConversation",handler:Pt});var ss=_(Jn,2);Wn(ss,{name:"goToPreviousConversation",handler:tn}),r(gn,Ln)};b(Gt,gn=>{y()&&!xe?.isActive&&gn(Zt)});var _n=_(Gt,2),qn=gn=>{Wn(gn,{name:"toggleThreadsPanel",handler:()=>P(Xu(Jr.threadsPanel))})};b(_n,gn=>{y()&&gn(qn)});{const gn=bt=>{kc(bt,{children:(St,Qt)=>{var dn=Ck(),on=S(dn);zf(on,{onOpenThreads:()=>P(Ju(Jr.threadsPanel)),get shouldShowThreadsList(){return t(ve)}}),M$(_(on,2),{}),r(St,dn)}})},Ln=bt=>{UC(bt,{})},Jn=bt=>{var St=ee(),Qt=S(St),dn=qt=>{Xw(qt,{})},on=qt=>{fC(qt,{get chatModel(){return ue},get onboardingWorkspaceModel(){return rt},get remoteAgentsModel(){return xe}})};b(Qt,qt=>{t(ft)?qt(dn):qt(on,!1)}),r(bt,St)},ss=bt=>{var St=Ak(),Qt=S(St),dn=qt=>{X0(qt,{})},on=qt=>{var $n=ee(),bn=S($n),xn=rn=>{var un=kk(),Tn=g(un),Yn=wn=>{z$(wn,{})};b(Tn,wn=>{$()&&wn(Yn)});var Pn=_(Tn,2),Bn=wn=>{b0(wn,{})};b(Pn,wn=>{m()&&$()&&!R()&&wn(Bn)});var On=_(Pn,2),gs=wn=>{ld(wn,{get card(){return L()}})};b(On,wn=>{L()&&wn(gs)}),r(rn,un)};b(bn,rn=>{t(Je)&&rn(xn)},!0),r(qt,$n)};b(Qt,qt=>{t(dt)?qt(dn):qt(on,!1)}),function(qt,$n){ke($n,!0);let bn=p(()=>Hc($n.richTextContent)),xn=p(()=>t(bn).hasWarning),rn=p(()=>t(bn).warningMessages);var un=ee(),Tn=S(un),Yn=Pn=>{var Bn=ik(),On=g(Bn);ns(On,{variant:"soft",color:"warning",size:1,icon:wn=>{oe(wn,{name:"circle-alert"})},children:(wn,Ss)=>{var Ns=ok();ln(Ns,20,()=>t(rn),Qn=>Qn,(Qn,vs)=>{var Es=ak(),jr=g(Es);pe(()=>ze(jr,vs)),r(Qn,Es)}),r(wn,Ns)},$$slots:{icon:!0,default:!0}}),r(Pn,Bn)};b(Tn,Pn=>{t(xn)&&Pn(Yn)}),r(qt,un),Ae()}(_(Qt,2),{get richTextContent(){return t(tt)}}),r(bt,St)},fs=bt=>{var St=ee(),Qt=S(St),dn=on=>{(function(qt,$n){ke($n,!0);const bn=k($n,"inputArea",15),xn=k($n,"onDragEnd",3,()=>{});let rn;var un=Xy();Nt("mousemove",Ri,Tn=>{if(!bn()||!rn)return;const Yn=Tn.clientY-rn.startY;bn(bn().style.height=`${Math.max(80,rn.initialHeight-Yn)}px`,!0)}),Nt("mouseup",Ri,()=>{bn()&&rn&&(xn()(),rn=void 0,bn()?.classList.remove("is-dragging"))}),un.__mousedown=Tn=>{bn()&&(rn={startY:Tn.clientY,initialHeight:bn().offsetHeight},bn().classList.add("is-dragging"))},r(qt,un),Ae()})(on,{onDragEnd:()=>{t($t)&&t(ot)?.requestFocus()},get inputArea(){return t(pt)},set inputArea(qt){T(pt,qt,!0)}})};b(Qt,on=>{t(kt)||on(dn)}),r(bt,St)},_s=bt=>{var St=ee(),Qt=S(St),dn=on=>{var qt=Sk(),$n=S(qt);Le($n,{size:1,class:"c-chat-input-hint",children:(xn,rn)=>{var un=se(`Kick off a remote agent to work in parallel, in an isolated environment that will keep
            running, even when you shut off your computer.`);r(xn,un)},$$slots:{default:!0}});var bn=_($n,2);Le(bn,{size:1,class:"c-chat-open-secret-manager",onclick:xn=>{xn.preventDefault(),ue.extensionClient.openSettingsPage("secret-manager")},children:(xn,rn)=>{var un=se("Need secrets to do the work? Configure them here.");r(xn,un)},$$slots:{default:!0}}),r(on,qt)};b(Qt,on=>{t(Ut)&&on(dn)}),r(bt,St)},ys=bt=>{var St=ee(),Qt=S(St),dn=qt=>{},on=qt=>{var $n=ee(),bn=S($n),xn=un=>{var Tn=Mk();let Yn;RC(g(Tn),{onCommit:mt,variant:"solid",stagedFilesCount:0,isCommitting:!1,canCommit:!0,placeholder:"Enter commit message..."}),pn(Tn,Pn=>T(pt,Pn),()=>t(pt)),pe(Pn=>Yn=Lt(Tn,1,"l-input-area-design-system svelte-1hs4wcp",null,Yn,Pn),[()=>({"l-input-area-design-system--tall":t(Ft),"l-input-area-design-system--shrunk":t($t),"l-input-area-design-system--editor-focused":A(),"l-input-area-design-system--has-banner":!0})]),r(un,Tn)},rn=un=>{var Tn=ee(),Yn=S(Tn),Pn=On=>{xo(On,{editable:!0,hasSendButton:!0,banner:wn=>{a$(wn,{})},$$slots:{banner:!0}})},Bn=On=>{var gs=ee(),wn=S(gs),Ss=Qn=>{var vs=xk();{const Es=hr=>{(function(Zs,gr){ke(gr,!1);const Un=()=>Y(yn,"$remoteAgentsModel",Fs),[Fs,er]=at(),vr=_e(),tr=_e(),Vr=_e(),nr=_e(),yn=Fe(an.key),Ad=Fe(ar.key);let ga=_e(""),Kr=_e(!1),va=_e(),$i=_e(null),bi=_e(null),wi=_e(null);mn(async()=>{try{const sn=await yn.getLastRemoteAgentSetup();T($i,sn.lastRemoteAgentGitRepoUrl),T(bi,sn.lastRemoteAgentGitBranch),T(wi,sn.lastRemoteAgentSetupScript),yn.setHasEverUsedRemoteAgent(!0),await yn.reportRemoteAgentEvent({eventName:Pl.setupPageOpened,remoteAgentId:"",eventData:{setupPageOpened:{}}}),await yn.reportRemoteAgentSetupWindowEvent($s.open)}catch(sn){console.error("Failed to load last remote agent setup:",sn)}}),As(async()=>{try{await yn.reportRemoteAgentSetupWindowEvent($s.close)}catch(sn){console.error("Failed to report remote agent setup window close event:",sn)}yn.setNewAgentDraft(null),yn.setCreationMetrics(void 0)}),Ne(()=>Un(),()=>{T(vr,Un().newAgentDraft?.commitRef??null)}),Ne(()=>Un(),()=>{T(tr,Un().newAgentDraft?.selectedBranch??null)}),Ne(()=>(t(vr),t(tr),t(Kr),t(ga),t(va)),()=>{T(Vr,(()=>{const sn=t(vr)?.github_commit_ref?.repository_url,jn=t(tr)?.name,po=!t(Kr)&&sn&&jn;return t(ga)||t(va)||(t(Kr)?"Loading repos and branches...":"")||!sn&&"Please select a repository"||!jn&&"Please select a branch"||(!po&&sn&&jn?"Loading branch data...":"")||""})())}),Ne(()=>t(Vr),()=>{T(nr,!!t(Vr))}),Ne(()=>t(nr),()=>{yn.newAgentDraft&&yn.newAgentDraft.isDisabled!==t(nr)&&yn.setNewAgentDraft({...yn.newAgentDraft,isDisabled:t(nr)})}),hn(),wt();var Ci=of(),Sd=g(Ci),Md=g(Sd),vo=g(Md);rf(g(vo),{get agentLimitErrorMessage(){return t(va)},set agentLimitErrorMessage(sn){T(va,sn)},$$legacy:!0});var ki=_(vo,2),xd=sn=>{var jn=af(),po=g(jn);ns(po,{color:"error",variant:"soft",size:2,children:(Ed,oA)=>{var Mi=se();pe(()=>ze(Mi,(Un(),Re(()=>Un().remoteAgentCreationError)))),r(Ed,Mi)},$$slots:{default:!0}}),Mn(3,jn,()=>Ls,()=>({y:10})),r(sn,jn)};b(ki,sn=>{Un(),Re(()=>Un().remoteAgentCreationError)&&sn(xd)});var Ai=_(ki,2);Pm(g(Ai),{get gitRefModel(){return Ad},get lastUsedRepoUrl(){return t($i)},get lastUsedBranchName(){return t(bi)},onSelectedRepo:async function(){const sn=yn.creationMetrics;yn.setCreationMetrics({changedRepo:!0,changedBranch:sn?.changedBranch??!1});try{await yn.reportRemoteAgentSetupWindowEvent($s.selectRepo)}catch(jn){console.error("Failed to report repo selection event:",jn)}},onSelectedBranch:async function(){const sn=yn.creationMetrics;yn.setCreationMetrics({changedRepo:sn?.changedRepo??!1,changedBranch:!0});try{await yn.reportRemoteAgentSetupWindowEvent($s.selectBranch)}catch(jn){console.error("Failed to report branch selection event:",jn)}},get errorMessage(){return t(ga)},set errorMessage(sn){T(ga,sn)},get isLoading(){return t(Kr)},set isLoading(sn){T(Kr,sn)},$$events:{commitRefChange:async function(sn){yn.setRemoteAgentCreationError(null);const jn=yn.newAgentDraft;jn?yn.setNewAgentDraft({...jn,commitRef:sn.detail.commitRef,selectedBranch:sn.detail.selectedBranch,isDisabled:t(nr)}):yn.setNewAgentDraft({commitRef:sn.detail.commitRef,selectedBranch:sn.detail.selectedBranch,setupScript:null,isDisabled:t(nr),enableNotification:!0})}},$$legacy:!0});var Td=_(Ai,2),Si=g(Td);tf(Si,{get lastUsedScriptPath(){return t(wi)},$$events:{setupScriptChange:function(sn){yn.setRemoteAgentCreationError(null);const jn=yn.newAgentDraft;jn?yn.setNewAgentDraft({...jn,setupScript:sn.detail.script,isDisabled:t(nr)}):yn.setNewAgentDraft({commitRef:null,selectedBranch:null,setupScript:sn.detail.script,isDisabled:t(nr),enableNotification:!0})}}});var Rd=_(Si,2);da(Rd,{size:4}),Mn(3,vo,()=>Ls,()=>({y:10})),r(Zs,Ci),Ae(),er()})(hr,{})},jr=hr=>{(function(Zs,gr){ke(gr,!1);let Un=k(gr,"remoteAgentsModel",8),Fs=_e(!1);wt(),Mt(Zs,{size:1,variant:"solid",color:"accent",get loading(){return t(Fs)},$$events:{click:async()=>{T(Fs,!0);try{try{await Un().reportRemoteAgentSetupWindowEvent($s.autoGenerateSetupScript)}catch(tr){console.error("Failed to auto-generate setup script event:",tr)}const er=Un().newAgentDraft;er&&Un().setNewAgentDraft({...er,isSetupScriptAgent:!0});const vr=await Un().createRemoteAgentFromDraft("SETUP_MODE");vr&&Un().setCurrentAgent(vr)}catch(er){console.error("Failed to select setup script generation:",er)}finally{T(Fs,!1)}}},children:(er,vr)=>{var tr=Jy(),Vr=S(tr);oe(Vr,{name:"wand-sparkles"}),r(er,tr)},$$slots:{default:!0}}),Ae()})(hr,{get remoteAgentsModel(){return xe}})};xo(g(vs),{editable:!0,hasSendButton:!0,banner:Es,activeButton:jr,$$slots:{banner:!0,activeButton:!0}})}pn(vs,Es=>T(pt,Es),()=>t(pt)),r(Qn,vs)},Ns=Qn=>{var vs=ee(),Es=S(vs),jr=hr=>{var Zs=Tk();let gr;{const Un=Fs=>{rk(Fs,{})};xo(g(Zs),{get placeholder(){return t(ht)},get richTextEditorRoot(){return t(ot)},set richTextEditorRoot(Fs){T(ot,Fs,!0)},banner:Un,$$slots:{banner:!0}})}pn(Zs,Un=>T(pt,Un),()=>t(pt)),pe(Un=>gr=Lt(Zs,1,"l-input-area-design-system svelte-1hs4wcp",null,gr,Un),[()=>({"l-input-area-design-system--tall":t(Ft),"l-input-area-design-system--shrunk":t($t),"l-input-area-design-system--editor-focused":A(),"l-input-area-design-system--has-banner":!0})]),r(hr,Zs)};b(Es,hr=>{t(Ut)||hr(jr)},!0),r(Qn,vs)};b(wn,Qn=>{t(Ut)?Qn(Ss):Qn(Ns,!1)},!0),r(On,gs)};b(Yn,On=>{f().isActive&&f().currentAgent?.is_setup_script_agent&&f().currentConversation?On(Pn):On(Bn,!1)},!0),r(un,Tn)};b(bn,un=>{t(yt)?un(xn):un(rn,!1)},!0),r(qt,$n)};b(Qt,qt=>{t(kt)?qt(dn):qt(on,!1)}),r(bt,St)},It=bt=>{var St=Rk();r(bt,St)};(function(bt,St){var Qt=Ky(),dn=g(Qt);en(dn,"data-vscode-context",JSON.stringify({preventDefaultContextMenuItems:!0}));var on=g(dn),qt=g(on);Rt(qt,()=>St.headerArea??Kt);var $n=_(on,2),bn=g($n);Rt(bn,()=>St.floatingArea??Kt);var xn=_($n,2),rn=g(xn),un=g(rn);Rt(un,()=>St.messageArea??Kt);var Tn=_(dn,2),Yn=g(Tn);Rt(Yn,()=>St.chatHint??Kt);var Pn=_(Tn,2),Bn=g(Pn);Rt(Bn,()=>St.inputHint??Kt);var On=_(Pn,2),gs=g(On);Rt(gs,()=>St.dividerArea??Kt);var wn=_(On,2),Ss=g(wn);Rt(Ss,()=>St.actionsArea??Kt);var Ns=_(Ss,2);Rt(Ns,()=>St.inputArea??Kt);var Qn=_(Ns,2);Rt(Qn,()=>St.footerArea??Kt),r(bt,Qt)})(_(_n,2),{headerArea:gn,floatingArea:Ln,messageArea:Jn,actionsArea:ss,dividerArea:fs,inputHint:_s,inputArea:ys,footerArea:It})}r(At,Bt)},$$slots:{default:!0}}),r(i,Vt),Ae(),F()}var Dk=v('<a class="svelte-4d4nqo">Chat</a> & <a class="svelte-4d4nqo">Agent,</a>',1),Lk=v(', <a class="svelte-4d4nqo">Instructions</a>,',1),Pk=v('<a class="svelte-4d4nqo">Code Completions</a><!>',1),Ok=v('<a class="svelte-4d4nqo">Next Edit</a>'),Nk=v('<div class="c-augment-features svelte-4d4nqo"><!> <!> <!> <!></div>');function xl(i,e){let n=k(e,"client",19,()=>{});var s=ee(),a=S(s),o=l=>{var c=Nk(),d=g(c);Le(d,{size:1,children:(f,$)=>{var R=se("Augment Features:");r(f,R)},$$slots:{default:!0}});var u=_(d,2);Le(u,{size:1,children:(f,$)=>{var R=Dk(),C=S(R),x=_(C,2);pe(()=>{en(C,"href",`https://docs.augmentcode.com/using-augment/chat?utm_source=${n()??""}`),en(x,"href",`https://docs.augmentcode.com/using-augment/agent?utm_source=${n()??""}`)}),r(f,R)},$$slots:{default:!0}});var h=_(u,2);Le(h,{size:1,children:(f,$)=>{var R=Pk(),C=S(R),x=_(C),G=L=>{var A=Lk(),E=_(S(A));pe(()=>en(E,"href",`https://docs.augmentcode.com/using-augment/instructions?utm_source=${n()??""}`)),r(L,A)};b(x,L=>{n()!=="intellij"&&L(G)}),pe(()=>en(C,"href",`https://docs.augmentcode.com/using-augment/completions?utm_source=${n()??""}`)),r(f,R)},$$slots:{default:!0}});var y=_(h,2),m=f=>{Le(f,{size:1,children:($,R)=>{var C=Ok();pe(()=>en(C,"href",`https://docs.augmentcode.com/using-augment/next-edit?utm_source=${n()??""}`)),r($,C)},$$slots:{default:!0}})};b(y,f=>{n()!=="intellij"&&f(m)}),r(l,c)};b(a,l=>{n()!==void 0&&l(o)}),r(i,s)}var Fk=v('<div class="c-onboarding-layout__logo svelte-1j9rq0d"><!></div>'),qk=v('<div class="c-onboarding-layout__error svelte-1j9rq0d"><!></div>'),Bk=v('<div><!> <div class="c-onboarding-layout__content svelte-1j9rq0d"><!></div> <!></div>');function Fa(i,e){const n=Ws(e);var s=Bk();Lt(s,1,"c-onboarding-layout svelte-1j9rq0d",null,{},{"c-onboarding-layout__has-logo":n.logo});var a=g(s),o=h=>{var y=Fk(),m=g(y);Et(m,e,"logo",{},null),r(h,y)};b(a,h=>{n.logo&&h(o)});var l=_(a,2),c=g(l);Et(c,e,"default",{},null);var d=_(l,2),u=h=>{var y=qk(),m=g(y);Et(m,e,"error",{},null),r(h,y)};b(d,h=>{n.error&&h(u)}),r(i,s)}var Uk=v('<div class="c-sign-in__title svelte-hylspq"><!> <!></div>');function Tl(i,e){var n=Uk(),s=g(n);Le(s,{size:2,weight:"bold",class:"c-sign-in__welcome",children:(o,l)=>{var c=se();pe(()=>ze(c,e.title)),r(o,c)},$$slots:{default:!0}});var a=_(s,2);Le(a,{size:1,children:(o,l)=>{var c=se();pe(()=>ze(c,e.subtitle)),r(o,c)},$$slots:{default:!0}}),r(i,n)}var Hk=v('<div class="c-sign-in svelte-10zf1qp"><!> <!> <!></div>'),Gk=v("<!> Back",1),Wk=v('<div class="c-back-button-container svelte-193bctn"><!></div>'),jk=v('<a href="https://docs.augmentcode.com/setup-augment/workspace-indexing" class="svelte-193bctn">Learn More</a>'),Vk=v("Your data always stays secure and private. <!>",1),Kk=v('<!> <div class="c-awaiting-syncing-permission svelte-193bctn"><!> <div class="c-awaiting-syncing-permission__text svelte-193bctn"><!> <!></div> <!> <!></div>',1),Xk=v('<div slot="error"><!></div>');function Jk(i,e){ke(e,!0);const[n,s]=at(),a=new io(Rn),o=_t("enableRules"),l=_t("enablePersonalities"),c=_t("enableExternalSourcesInChat"),d=_t("retryChatStreamTimeouts"),u=new Ul(Rn,a,{enableRules:Y(o,"$enableRules",n),enablePersonalities:Y(l,"$enablePersonalities",n),enableExternalSourcesInChat:Y(c,"$enableExternalSourcesInChat",n),retryChatStreamTimeouts:Y(d,"$retryChatStreamTimeouts",n)});let h=ct(!1);function y(){T(h,!0),u.grantSyncPermission()}function m(){u.openProjectFolder()}function f(){u.closeProjectFolder()}const $=Xn(),R=hk(),C=p(()=>function(A){const E=new Set([ps.workspaceNotSelected,ps.workspaceTooLarge,ps.uploadingHomeDir]);return A.filter(F=>E.has(F))}(Y(R,"$mainPanelActions",n))),x=p(()=>t(C)[0]);let G=ct(void 0);const L=p(()=>t(x)===ps.workspaceTooLarge||t(x)===ps.uploadingHomeDir);mn(()=>{$(Yu({type:Sn.awaitingSyncingPermissionLoaded}))}),Nt("message",ts,function(A){const E=A.data;E.type===Sn.awaitingSyncingPermissionInitialize&&T(G,E.data.workspaceName,!0)}),Fa(i,{children:(A,E)=>{var F=Kk(),z=S(F),D=V=>{var N=Wk(),U=g(N);Mt(U,{variant:"ghost",color:"neutral",size:1,$$events:{click:f},children:(I,B)=>{var Q=Gk(),Z=S(Q);oe(Z,{name:"chevron-left"}),r(I,Q)},$$slots:{default:!0}}),r(V,N)};b(z,V=>{El()&&V(D)});var M=_(z,2),w=g(M);Le(w,{size:2,weight:"bold",class:"c-awaiting-syncing-permission__title",children:(V,N)=>{var U=se("Index Codebase");r(V,U)},$$slots:{default:!0}});var W=_(w,2),P=g(W);Le(P,{size:1,children:(V,N)=>{var U=se(`Indexing allows Augment to make tailored code suggestions and explain common practices or
        patterns.`);r(V,U)},$$slots:{default:!0}});var K=_(P,2);Le(K,{size:1,children:(V,N)=>{var U=Vk(),I=_(S(U));Le(I,{size:1,children:(B,Q)=>{var Z=jk();r(B,Z)},$$slots:{default:!0}}),r(V,U)},$$slots:{default:!0}});var X=_(W,2);je(X,{content:"Open a new project",children:(V,N)=>{Mt(V,{variant:"outline",color:"neutral",size:2,$$events:{click:m},children:(U,I)=>{var B=se();pe(()=>ze(B,t(G)??"Open a folder")),r(U,B)},$$slots:{default:!0,iconLeft:(U,I)=>{oe(U,{name:"folder",slot:"iconLeft"})}}})},$$slots:{default:!0}});var q=_(X,2);{let V=p(()=>!t(G)||t(L));Mt(q,{variant:"solid",color:"accent",size:2,get disabled(){return t(V)},get loading(){return t(h)},$$events:{click:y},children:(N,U)=>{var I=se("Index Codebase");r(N,I)},$$slots:{default:!0}})}r(A,F)},$$slots:{default:!0,error:(A,E)=>{var F=Xk(),z=g(F),D=M=>{ld(M,{get card(){return t(x)}})};b(z,M=>{t(x)&&M(D)}),r(A,F)}}}),Ae(),s()}var Yk=v('<div class="c-folder-selection__project-name-input svelte-1t1vhbh"><!> <!></div>'),Qk=v('<div class="c-folder-selection svelte-1t1vhbh"><!> <div class="c-folder-selection__buttons svelte-1t1vhbh"><!> <!> <!> <!></div> <!></div>'),Zk=v('<div slot="error"><!></div>'),eA=v('<div class="c-loading"><!></div>');function tA(i){return i&&function(e){return e&&e instanceof HTMLAnchorElement}(i)?i.closest("a"):null}var nA=v("<div></div>"),sA=v("<main><!> <!></main>");function rA(i,e){ke(e,!1);const n=()=>Y(o,"$visibleApp",s),[s,a]=at(),o=Jg();mn(()=>{Rn.postMessage({type:Sn.mainPanelLoaded})}),wt();{let l=Ge(()=>n()===pr.chat),c=Ge(()=>n()===pr.chat);Qu(i,{get fetch(){return t(l)},get wait(){return t(c)},children:(d,u)=>{var h=sA(),y=g(h),m=$=>{(function(R){Fa(R,{children:(C,x)=>{var G=eA(),L=g(G);Dn(L,{}),r(C,G)},$$slots:{default:!0,logo:(C,x)=>{wo(C,{slot:"logo"})}}})})($)},f=$=>{var R=ee(),C=S(R),x=L=>{(function(A,E){function F(){Rn.postMessage({type:Sn.mainPanelPerformAction,data:"sign-in"})}ke(E,!1);let z=_e(void 0);Rn.postMessage({type:Sn.signInLoaded}),wt(),Nt("message",ts,D=>{const M=D.data;M.type===Sn.signInLoadedResponse&&T(z,M.data.client)}),Fa(A,{children:(D,M)=>{var w=Hk(),W=g(w);Tl(W,{title:"Welcome!",subtitle:"Please sign in below."});var P=_(W,2);Mt(P,{variant:"solid",color:"accent","data-testid":"sign-in-button",$$events:{click:F},children:(K,X)=>{var q=se("Sign In");r(K,q)},$$slots:{default:!0,iconLeft:(K,X)=>{oe(K,{name:"user-round",slot:"iconLeft"})}}}),xl(_(P,2),{get client(){return t(z)}}),r(D,w)},$$slots:{default:!0,logo:(D,M)=>{wo(D,{slot:"logo"})}}}),Ae()})(L,{})},G=L=>{var A=ee(),E=S(A),F=D=>{zk(D,{})},z=D=>{var M=ee(),w=S(M),W=K=>{Jk(K,{})},P=K=>{var X=ee(),q=S(X),V=N=>{(function(U,I){ke(I,!1);const[B,Q]=at(),Z=_t("enableRules"),ae=_t("enablePersonalities"),j=_t("enableExternalSourcesInChat"),H=_t("retryChatStreamTimeouts"),O=new Ul(Rn,new io(Rn),{enableRules:Y(Z,"$enableRules",B),enablePersonalities:Y(ae,"$enablePersonalities",B),enableExternalSourcesInChat:Y(j,"$enableExternalSourcesInChat",B),retryChatStreamTimeouts:Y(H,"$retryChatStreamTimeouts",B)});function J(ce){O.createProject(ce)}function te(){O.openProjectFolder()}function ne(){O.cloneRepository()}function re(){t(he)?T(he,!1):(T(he,!0),setTimeout(()=>{t(me)?.focus()},0))}let he=_e(!1),$e=_e(""),me=_e(void 0),fe=_e(!0),ge=_e(!1);Ne(()=>(t(ge),t($e),t(he)),()=>{T(ge,!/^[a-zA-Z0-9\-_ ]+$/.test(t($e))&&t($e).trim().length>0),T(fe,!t(he)||!t($e).trim().length||t(ge))}),hn(),wt(),Fa(U,{children:(ce,we)=>{var Se=Qk(),ie=g(Se);Tl(ie,{title:"Welcome back!",subtitle:"Please open a project folder to begin."});var Ce=_(ie,2),le=g(Ce);Mt(le,{variant:"outline",color:"neutral",size:2,alignment:"left",$$events:{click:re},children:(de,xe)=>{var Oe=se("Create a new project");r(de,Oe)},$$slots:{default:!0,iconLeft:(de,xe)=>{oe(de,{name:"square-pen",slot:"iconLeft"})}}});var Me=_(le,2),ue=de=>{var xe=Yk(),Oe=g(xe);{let Ue=Ge(()=>t(ge)?"error":"neutral");Nr(Oe,{get color(){return t(Ue)},placeholder:"Project Name",get value(){return t($e)},set value(Ie){T($e,Ie)},get textInput(){return t(me)},set textInput(Ie){T(me,Ie)},$$events:{keydown:Ie=>{Ie.key!=="Enter"||t(fe)||(Ie.preventDefault(),J(t($e).trim()))}},$$legacy:!0})}var De=_(Oe,2);vt(De,{get disabled(){return t(fe)},$$events:{click:()=>J(t($e).trim())},children:(Ue,Ie)=>{oe(Ue,{name:"arrow-right"})},$$slots:{default:!0}}),r(de,xe)};b(Me,de=>{t(he)&&de(ue)});var be=_(Me,2);Mt(be,{variant:"outline",color:"neutral",size:2,alignment:"left",$$events:{click:te},children:(de,xe)=>{var Oe=se("Open a local folder");r(de,Oe)},$$slots:{default:!0,iconLeft:(de,xe)=>{oe(de,{name:"folder-open",slot:"iconLeft"})}}});var ye=_(be,2);Mt(ye,{variant:"outline",color:"neutral",size:2,alignment:"left",$$events:{click:ne},children:(de,xe)=>{var Oe=se("Clone a repository");r(de,Oe)},$$slots:{default:!0,iconLeft:(de,xe)=>{oe(de,{name:"layers",slot:"iconLeft"})}}}),xl(_(Ce,2),{}),r(ce,Se)},$$slots:{default:!0,logo:(ce,we)=>{wo(ce,{slot:"logo"})},error:(ce,we)=>{var Se=Zk(),ie=g(Se),Ce=le=>{ns(le,{variant:"soft",color:"error",size:1,icon:ue=>{oe(ue,{name:"circle-alert"})},children:(ue,be)=>{var ye=se("Must contain only letters, numbers, hyphens, underscores, and spaces");r(ue,ye)},$$slots:{icon:!0,default:!0}})};b(ie,le=>{t(ge)&&le(Ce)}),r(ce,Se)}}}),Ae(),Q()})(N,{})};b(q,N=>{n()===pr.folderSelection&&N(V)},!0),r(K,X)};b(w,K=>{n()===pr.awaitingSyncingPermission?K(W):K(P,!1)},!0),r(D,M)};b(E,D=>{n()===pr.chat?D(F):D(z,!1)},!0),r(L,A)};b(C,L=>{n()===pr.signIn?L(x):L(G,!1)},!0),r($,R)};b(y,$=>{n()===pr.loading?$(m):$(f,!1)}),function($){var R=nA();pe(()=>en(R,"id",kd)),r($,R)}(_(y,2)),is(h,$=>function(R){function C(x){const G=tA(x.target);if(!G)return;const L=G.getAttribute("href");if(L&&L.startsWith("augment://")){const A=`Unhandled augment link: "${L}"`,E=new Error(A);return Rn.postMessage({type:Sn.reportError,data:{originalRequestId:null,sanitizedMessage:E.message,stackTrace:E.stack||"",diagnostics:[]}}),Rn.postMessage({type:Sn.showNotification,data:{message:A,type:"error"}}),x.stopImmediatePropagation(),x.preventDefault(),x.stopPropagation(),!1}}return R.addEventListener("click",C),{destroy(){R.removeEventListener("click",C)}}}($)),r(d,h)},$$slots:{default:!0}})}Ae(),a()}function aA(i){Dl.Root(i,{children:(e,n)=>{Zu(e,{children:(s,a)=>{rA(s,{})},$$slots:{default:!0}})},$$slots:{default:!0}})}(async function(){Rn&&Rn.initialize&&await Rn.initialize(),Rl(aA,{target:document.getElementById("app")})})();
//# sourceMappingURL=main-panel-DFA6rvEb.js.map
