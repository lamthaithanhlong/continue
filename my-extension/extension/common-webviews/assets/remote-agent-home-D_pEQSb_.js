import{t as ke,u as O,O as Me,a8 as nt,a9 as Ke,x as u,T as V,a5 as X,K as G,a0 as se,n as r,E as m,J as o,A as x,I as $,C as e,F as Ae,G as R,Q as S,L as Ve,a1 as $e,m as oe,a2 as A,a3 as rt,v as Ze,y as j,D as ae,$ as it,z as et,M as tt,ab as He,a4 as at,a6 as st,P as lt,aD as dt,aG as ot,ac as Xe,N as gt,an as ct,aE as vt}from"./TextAugment-CCgoKCVh.js";import"./design-system-init-D_ikSdGN.js";/* empty css                                */import{M as ut}from"./message-broker-CppRv-qk.js";import{S as mt,R as pt,B as ft,a as Qe,b as _t,v as ht,c as wt}from"./RepoBadge-BhbKrzzY.js";import{c as Be,I as ye,e as ce,i as $t}from"./IconButtonAugment-CsdawHyK.js";import{a as ne,R as Le,s as yt}from"./index-Czcl53hR.js";import{T as xe,a as ge,C as St}from"./CardAugment-Bqwu5ahx.js";import{C as bt}from"./CalloutAugment-BUb-HAQ6.js";import{b as kt,s as At,c as Ye}from"./utils-BOGwHecm.js";import{R as Ee}from"./remote-agents-client-3ykFyqEs.js";import{A as Rt}from"./augment-logo-CnRinIIJ.js";/* empty css                                                */import"./types-DGsjtdxm.js";try{we=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(Je=new we.Error().stack)&&(we._sentryDebugIds=we._sentryDebugIds||{},we._sentryDebugIds[Je]="3840723d-11af-4006-adad-7f8a35e68ad9",we._sentryDebugIdIdentifier="sentry-dbid-3840723d-11af-4006-adad-7f8a35e68ad9")}catch{}var we,Je,It=u(" <!>",1),Pt=u('<div class="agent-card-footer svelte-1paeqiw"><!> <div class="time-container"><!></div></div>'),zt=u('<div class="task-text-container svelte-4rg3b7"><!></div>'),Dt=u('<div class="task-status-indicator svelte-4rg3b7"><!></div>'),jt=u('<div class="task-item svelte-4rg3b7"><div></div> <!> <!></div>'),Ft=u(' <button class="error-dismiss svelte-6tidju" aria-label="Dismiss error">×</button>',1),Ot=u('<div class="deletion-error svelte-6tidju"><!></div>'),xt=u('<span class="setup-script-title svelte-6tidju">Generate a setup script</span>'),Et=u('<div class="setup-script-title-container svelte-6tidju"><div class="setup-script-badge svelte-6tidju"><!></div> <!></div>'),Ht=u('<div class="tasks-list svelte-6tidju"></div>'),Tt=u('<div class="card-commit-info svelte-6tidju"><!> <!></div>'),Wt=u('<div class="card-header svelte-6tidju"><div class="session-summary-container svelte-6tidju"><!></div> <div class="card-info"><!></div></div> <div class="card-content svelte-6tidju"><!> <!></div> <div class="card-actions svelte-6tidju"><!> <!> <!></div> <!>',1),Ct=u("<div><!> <!></div>");function Ut(Y,c){ke(c,!1);const y=oe(),I=oe(),F=oe(),Z=oe(),p=oe(),E=oe(),N=oe();let a=O(c,"agent",8),H=O(c,"selected",8,!1),h=O(c,"isPinned",8,!1),ve=O(c,"onSelect",8),ue=O(c,"onDelete",8),K=O(c,"deletionError",12,null),re=O(c,"isDeleting",8,!1),P=O(c,"onTogglePinned",24,()=>{}),w=O(c,"sshConfig",24,()=>{});function B(){K(null)}Ke(()=>{B()}),$e(()=>(e(y),e(I),A(w())),()=>{var l;l=w()||{onSSH:()=>Promise.resolve(!1),canSSH:!1},R(y,l.onSSH),R(I,l.canSSH)}),$e(()=>A(a()),()=>{R(F,a().turn_summaries||[])}),$e(()=>{},()=>{R(Z,!0)}),$e(()=>A(a()),()=>{R(p,a().workspace_setup?.starting_files?.github_commit_ref?.repository_url)}),$e(()=>(e(p),Ye),()=>{R(E,e(p)?Ye(e(p)):void 0)}),$e(()=>A(a()),()=>{R(N,a().workspace_setup?.starting_files?.github_commit_ref?.git_ref)}),rt(),Ze();var i=Ct();let z;var ze=m(i),Te=l=>{var d=Ot(),ee=m(d);bt(ee,{variant:"soft",color:"error",size:1,icon:T=>{ye(T,{name:"circle-alert"})},children:(T,W)=>{var C=Ft(),U=x(C),ie=o(U);G(()=>se(U,`${K()??""} `)),tt("click",ie,B),r(T,C)},$$slots:{icon:!0,default:!0}}),r(l,d)};$(ze,l=>{K()&&l(Te)});var We=o(ze,2);St(We,{variant:"surface",size:2,interactive:!0,class:"agent-card",$$events:{click:()=>ve()(a().remote_agent_id),keydown:l=>l.key==="Enter"&&ve()(a().remote_agent_id)},children:(l,d)=>{var ee=Wt(),te=x(ee),T=m(te),W=m(T),C=n=>{var s=Et(),t=m(s),g=m(t);ye(g,{name:"terminal"});var D=o(t,2);V(D,{size:2,weight:"medium",children:(b,k)=>{var L=xt();r(b,L)},$$slots:{default:!0}}),r(n,s)},U=n=>{V(n,{size:2,weight:"medium",class:"session-text",children:(s,t)=>{var g=X();G(()=>se(g,(A(a()),j(()=>a().session_summary)))),r(s,g)},$$slots:{default:!0}})};$(W,n=>{A(a()),j(()=>a().is_setup_script_agent)?n(C):n(U,!1)});var ie=o(T,2),Re=m(ie);mt(Re,{get status(){return A(a()),j(()=>a().status)},get workspaceStatus(){return A(a()),j(()=>a().workspace_status)},isExpanded:!0,get hasUpdates(){return A(a()),j(()=>a().has_updates)}});var me=o(te,2),Ie=m(me),Ce=n=>{var s=Ht();ce(s,5,()=>(e(F),j(()=>e(F).slice(0,3))),$t,(t,g)=>{(function(D,b){ke(b,!0);let k=O(b,"status",3,"info"),L=S(()=>function(q){switch(q){case"success":return"task-success";case"warning":return"task-warning";case"error":return"task-error";default:return"task-info"}}(k()));var pe=jt(),fe=m(pe),M=o(fe,2);{let q=S(()=>[ge.Hover]);xe(M,{get content(){return b.text},get triggerOn(){return e(q)},maxWidth:"400px",children:(_e,Oe)=>{var he=zt(),J=m(he);V(J,{size:1,color:"secondary",children:(de,Ne)=>{var qe=X();G(()=>se(qe,b.text)),r(de,qe)},$$slots:{default:!0}}),r(_e,he)},$$slots:{default:!0}})}var Q=o(M,2),le=q=>{var _e=Dt(),Oe=m(_e);{let he=S(()=>k()==="error"?"error":"neutral");V(Oe,{size:1,get color(){return e(he)},children:(J,de)=>{var Ne=X();G(()=>se(Ne,k()==="error"?"!":k()==="warning"?"⚠":"")),r(J,Ne)},$$slots:{default:!0}})}r(q,_e)};$(Q,q=>{k()!=="error"&&k()!=="warning"||q(le)}),G(()=>Ve(fe,1,`bullet-point ${e(L)??""}`,"svelte-4rg3b7")),r(D,pe),Ae()})(t,{get text(){return e(g)},status:"success"})}),r(n,s)};$(Ie,n=>{e(F),j(()=>e(F).length>0)&&n(Ce)});var De=o(Ie,2),Ue=n=>{var s=Tt(),t=m(s);pt(t,{get repoUrl(){return e(p)},get repoName(){return e(E)}});var g=o(t,2);ft(g,{get repoUrl(){return e(p)},get branchName(){return e(N)}}),r(n,s)};$(De,n=>{e(p)&&e(E)&&e(N)&&n(Ue)});var Pe=o(me,2),je=m(Pe),Ge=n=>{{let s=ae(()=>h()?"Unpin agent":"Pin agent"),t=ae(()=>(A(ge),j(()=>[ge.Hover])));xe(n,{get content(){return e(s)},get triggerOn(){return e(t)},side:"top",children:(g,D)=>{Be(g,{variant:"ghost",color:"neutral",size:1,$$events:{click:b=>{b.stopPropagation(),P()()}},children:(b,k)=>{var L=et(),pe=x(L),fe=Q=>{ye(Q,{name:"pin-off"})},M=Q=>{ye(Q,{name:"pin"})};$(pe,Q=>{h()?Q(fe):Q(M,!1)}),r(b,L)},$$slots:{default:!0}})},$$slots:{default:!0}})}};$(je,n=>{P()&&n(Ge)});var Fe=o(je,2),v=n=>{{let s=ae(()=>(A(ge),j(()=>[ge.Hover])));xe(n,{content:"SSH to agent",get triggerOn(){return e(s)},side:"top",children:(t,g)=>{{let D=ae(()=>!e(I)),b=ae(()=>e(I)?"SSH to agent":"SSH to agent (agent must be running or idle)");Be(t,{get disabled(){return e(D)},variant:"ghost",color:"neutral",size:1,get title(){return e(b)},$$events:{click:k=>{k.stopPropagation(),e(y)()}},children:(k,L)=>{ye(k,{name:"terminal"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}};$(Fe,n=>{w()&&n(v)});var f=o(Fe,2);{let n=ae(()=>(A(ge),j(()=>[ge.Hover])));xe(f,{content:"Delete agent",get triggerOn(){return e(n)},side:"top",children:(s,t)=>{{let g=ae(()=>re()?"Deleting agent...":"Delete agent");Be(s,{variant:"ghost",color:"neutral",size:1,get disabled(){return re()},get title(){return e(g)},$$events:{click:D=>{D.stopPropagation(),ue()(a().remote_agent_id)}},children:(D,b)=>{ye(D,{name:"trash-2"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}var _=o(Pe,2);{let n=ae(()=>(A(a()),j(()=>a().updated_at||a().started_at)));(function(s,t){ke(t,!0);let g=O(t,"isRemote",3,!1),D=Me(nt(kt(t.timestamp)));const b=At(t.timestamp,M=>{R(D,M,!0)});Ke(()=>{b()});var k=Pt(),L=m(k);V(L,{size:1,color:"secondary",class:"location-text",children:(M,Q)=>{var le=X();G(()=>se(le,g()?"Running in the cloud":"Running locally")),r(M,le)},$$slots:{default:!0}});var pe=o(L,2),fe=m(pe);V(fe,{size:1,color:"secondary",class:"time-text",children:(M,Q)=>{var le=It(),q=x(le),_e=o(q),Oe=J=>{var de=X();G(()=>se(de,e(D))),r(J,de)},he=J=>{var de=X("Unknown time");r(J,de)};$(_e,J=>{t.timestamp?J(Oe):J(he,!1)}),G(()=>se(q,(t.status===ne.agentRunning?"Last updated":"Started")+" ")),r(M,le)},$$slots:{default:!0}}),r(s,k),Ae()})(_,{get isRemote(){return e(Z)},get status(){return A(a()),j(()=>a().status)},get timestamp(){return e(n)}})}G(()=>it(T,"title",(A(a()),j(()=>a().is_setup_script_agent?"Generate a setup script":a().session_summary)))),r(l,ee)},$$slots:{default:!0}}),G(l=>z=Ve(i,1,"card-wrapper svelte-6tidju",null,z,l),[()=>({"selected-card":H(),"setup-script-card":a().is_setup_script_agent,deleting:re()})]),r(Y,i),Ae()}function Se(Y,c){ke(c,!0);const y=()=>st(E,"$sharedWebviewStore",I),[I,F]=at();let Z=O(c,"selected",3,!1);const p=He(Ee.key),E=He(Qe);let N=Me(!1),a=Me(null),H=null;function h(){R(a,null),H&&(clearTimeout(H),H=null)}let ve=S(()=>y().state?.pinnedAgents||{}),ue=S(()=>e(ve)?.[c.agent.remote_agent_id]===!0),K=S(()=>c.agent.status===ne.agentRunning||c.agent.status===ne.agentIdle);async function re(){return!!e(K)&&await(async P=>await p.sshToRemoteAgent(P.remote_agent_id))(c.agent)}{let P=S(()=>({onSSH:re,canSSH:e(K)}));Ut(Y,{get agent(){return c.agent},get selected(){return Z()},get isPinned(){return e(ue)},get onSelect(){return c.onSelect},onDelete:()=>async function(w){h(),R(N,!0);const B=y().state?.agentOverviews||[];try{if(!await p.deleteRemoteAgent(w))throw new Error("Failed to delete agent");if(E.update(i=>{if(i)return{...i,agentOverviews:i.agentOverviews.filter(z=>z.remote_agent_id!==w)}}),(y().state?.pinnedAgents||{})[w])try{await p.deletePinnedAgentFromStore(w);const i=await p.getPinnedAgentsFromStore();E.update(z=>{if(z)return{...z,pinnedAgents:i}})}catch(i){console.error("Failed to remove pinned status:",i)}}catch(i){console.error("Failed to delete agent:",i),E.update(z=>{if(z)return{...z,agentOverviews:B}}),R(a,i instanceof Error?i.message:"Failed to delete agent",!0),H=setTimeout(()=>{h()},5e3)}finally{R(N,!1)}}(c.agent.remote_agent_id),onTogglePinned:()=>async function(w){try{e(ue)?await p.deletePinnedAgentFromStore(w):await p.savePinnedAgentToStore(w,!0);const B=await p.getPinnedAgentsFromStore();E.update(i=>{if(i)return{...i,pinnedAgents:B}})}catch(B){console.error("Failed to toggle pinned status:",B)}}(c.agent.remote_agent_id),get sshConfig(){return e(P)},get deletionError(){return e(a)},set deletionError(w){R(a,w,!0)},get isDeleting(){return e(N)},set isDeleting(w){R(N,w,!0)}})}Ae(),F()}var Gt=u('<div class="section-header svelte-te8d84"><!></div>');function be(Y,c){var y=Gt(),I=m(y);V(I,{size:2,color:"secondary",children:(F,Z)=>{var p=X();G(()=>se(p,c.title)),r(F,p)},$$slots:{default:!0}}),r(Y,y)}var Nt=u('<div class="empty-state svelte-1verd7n"><div class="l-loading-container svelte-1verd7n"><!> <!></div></div>'),Bt=u('<div class="empty-state svelte-1verd7n"><!></div>'),Lt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Mt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Qt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),qt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Jt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Kt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Vt=u("<!> <!> <!> <!> <!> <!>",1),Xt=u('<div class="agent-list svelte-1verd7n"><!></div>'),Yt=u('<div class="l-main svelte-1foua77"><h1 class="l-main__title svelte-1foua77"><span class="l-main__title-logo svelte-1foua77"><!></span> Remote Agents</h1> <!></div>');vt(function(Y,c){ke(c,!1);const y=new ut(ot),I=new _t(y,void 0,ht,wt);y.registerConsumer(I),Xe(Qe,I);const F=new Ee(y);Xe(Ee.key,F),gt(()=>(I.fetchStateFromExtension().then(()=>{I.update(a=>{if(!a)return;const H=[...a.activeWebviews,"home"];return a.pinnedAgents?{...a,activeWebviews:H}:{...a,activeWebviews:H,pinnedAgents:{}}})}),()=>{y.dispose(),F.dispose()})),Ze();var Z=Yt();tt("message",ct,function(...a){y.onMessageFromExtension?.apply(this,a)});var p=m(Z),E=m(p),N=m(E);Rt(N),function(a,H){ke(H,!0);const h=()=>st(K,"$sharedWebviewStore",ve),[ve,ue]=at(),K=He(Qe),re=He(Ee.key);function P(l){K.update(d=>{if(d)return{...d,selectedAgentId:l}})}let w=S(()=>yt(h().state?.agentOverviews||[])),B=S(()=>h().state?.pinnedAgents||{}),i=S(()=>e(w).reduce((l,d)=>(e(B)?.[d.remote_agent_id]===!0?l.pinned.push(d):d.status===ne.agentIdle&&d.has_updates?l.readyToReview.push(d):d.status===ne.agentRunning||d.status===ne.agentStarting||d.workspace_status===Le.workspaceResuming?l.running.push(d):d.status===ne.agentFailed?l.failed.push(d):d.status===ne.agentIdle||d.workspace_status===Le.workspacePaused||d.workspace_status===Le.workspacePausing?l.idle.push(d):l.additional.push(d),l),{pinned:[],readyToReview:[],running:[],idle:[],failed:[],additional:[]}));lt(()=>{h().state?.agentOverviews||re.focusAugmentPanel()});var z=Xt(),ze=m(z),Te=l=>{var d=Nt(),ee=m(d),te=m(ee);dt(te,{});var T=o(te,2);V(T,{size:3,color:"secondary",children:(W,C)=>{var U=X("Loading the Augment panel...");r(W,U)},$$slots:{default:!0}}),r(l,d)},We=l=>{var d=et(),ee=x(d),te=W=>{var C=Bt(),U=m(C);V(U,{size:3,color:"secondary",children:(ie,Re)=>{var me=X("No agents available");r(ie,me)},$$slots:{default:!0}}),r(W,C)},T=W=>{var C=Vt(),U=x(C),ie=v=>{var f=Lt(),_=x(f);be(_,{title:"Pinned"});var n=o(_,2);ce(n,23,()=>e(i).pinned,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(U,v=>{e(i).pinned.length>0&&v(ie)});var Re=o(U,2),me=v=>{var f=Mt(),_=x(f);be(_,{title:"Ready to review"});var n=o(_,2);ce(n,23,()=>e(i).readyToReview,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(Re,v=>{e(i).readyToReview.length>0&&v(me)});var Ie=o(Re,2),Ce=v=>{var f=Qt(),_=x(f);be(_,{title:"Running agents"});var n=o(_,2);ce(n,23,()=>e(i).running,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(Ie,v=>{e(i).running.length>0&&v(Ce)});var De=o(Ie,2),Ue=v=>{var f=qt(),_=x(f);be(_,{title:"Idle agents"});var n=o(_,2);ce(n,23,()=>e(i).idle,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(De,v=>{e(i).idle.length>0&&v(Ue)});var Pe=o(De,2),je=v=>{var f=Jt(),_=x(f);be(_,{title:"Failed agents"});var n=o(_,2);ce(n,23,()=>e(i).failed,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(Pe,v=>{e(i).failed.length>0&&v(je)});var Ge=o(Pe,2),Fe=v=>{var f=Kt(),_=x(f);be(_,{title:"Other agents"});var n=o(_,2);ce(n,23,()=>e(i).additional,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(Ge,v=>{e(i).additional.length>0&&v(Fe)}),r(W,C)};$(ee,W=>{h().state?.agentOverviews.length===0?W(te):W(T,!1)},!0),r(l,d)};$(ze,l=>{h().state?.agentOverviews?l(We,!1):l(Te)}),r(a,z),Ae(),ue()}(o(p,2),{}),r(Y,Z),Ae()},{target:document.getElementById("app")});
//# sourceMappingURL=remote-agent-home-D_pEQSb_.js.map
